[0m09:35:53.634811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002291E6CCE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002291E6CCD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002291E6CCE00>]}


============================== 09:35:53.634811 | ef81af6e-ca05-43a7-9bfa-ed88ce145880 ==============================
[0m09:35:53.634811 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:35:53.634811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m09:35:53.671141 [info ] [MainThread]: dbt version: 1.9.3
[0m09:35:53.673149 [info ] [MainThread]: python version: 3.12.9
[0m09:35:53.673149 [info ] [MainThread]: python path: C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\python.exe
[0m09:35:53.673149 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m09:35:54.338590 [info ] [MainThread]: Using profiles dir at C:\Users\VarshaS\.dbt
[0m09:35:54.338590 [info ] [MainThread]: Using profiles.yml file at C:\Users\VarshaS\.dbt\profiles.yml
[0m09:35:54.338590 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\VarshaS\dbt_first\dbt_project.yml
[0m09:35:54.341562 [info ] [MainThread]: adapter type: snowflake
[0m09:35:54.341562 [info ] [MainThread]: adapter version: 1.9.2
[0m09:35:54.439515 [info ] [MainThread]: Configuration:
[0m09:35:54.439515 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:35:54.439515 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:35:54.439515 [info ] [MainThread]: Required dependencies:
[0m09:35:54.439515 [debug] [MainThread]: Executing "git --help"
[0m09:35:54.520938 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:35:54.520938 [debug] [MainThread]: STDERR: "b''"
[0m09:35:54.520938 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:35:54.520938 [info ] [MainThread]: Connection:
[0m09:35:54.520938 [info ] [MainThread]:   account: FBUCGJY-GAB18839
[0m09:35:54.520938 [info ] [MainThread]:   user: VARSHA
[0m09:35:54.520938 [info ] [MainThread]:   database: MYDB
[0m09:35:54.520938 [info ] [MainThread]:   warehouse: COMPUTE_wh
[0m09:35:54.520938 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m09:35:54.520938 [info ] [MainThread]:   schema: PUBLIC
[0m09:35:54.520938 [info ] [MainThread]:   authenticator: None
[0m09:35:54.520938 [info ] [MainThread]:   oauth_client_id: None
[0m09:35:54.520938 [info ] [MainThread]:   query_tag: None
[0m09:35:54.520938 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:35:54.520938 [info ] [MainThread]:   host: None
[0m09:35:54.520938 [info ] [MainThread]:   port: None
[0m09:35:54.520938 [info ] [MainThread]:   proxy_host: None
[0m09:35:54.520938 [info ] [MainThread]:   proxy_port: None
[0m09:35:54.520938 [info ] [MainThread]:   protocol: None
[0m09:35:54.520938 [info ] [MainThread]:   connect_retries: 1
[0m09:35:54.520938 [info ] [MainThread]:   connect_timeout: None
[0m09:35:54.520938 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:35:54.520938 [info ] [MainThread]:   retry_all: False
[0m09:35:54.520938 [info ] [MainThread]:   insecure_mode: False
[0m09:35:54.520938 [info ] [MainThread]:   reuse_connections: True
[0m09:35:54.520938 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m09:35:54.996462 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:35:58.353088 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:35:58.353088 [debug] [MainThread]: On debug: select 1 as id
[0m09:35:58.353088 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:36:01.478549 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.126 seconds
[0m09:36:01.494599 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:36:01.494599 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:36:01.494599 [debug] [MainThread]: Command `dbt debug` succeeded at 09:36:01.494599 after 8.06 seconds
[0m09:36:01.494599 [debug] [MainThread]: Connection 'debug' was left open.
[0m09:36:01.494599 [debug] [MainThread]: On debug: Close
[0m09:36:02.589740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002291E719AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002291E79E360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002291F532090>]}
[0m09:36:02.596033 [debug] [MainThread]: Flushing usage events
[0m09:36:03.510506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:49:07.461637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019585A85CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195887E9C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195887EB500>]}


============================== 09:49:07.468077 | 60436ca3-1bbf-450c-91b9-45de61fd727b ==============================
[0m09:49:07.468077 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:49:07.468077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile -m t_users', 'send_anonymous_usage_stats': 'True'}
[0m09:49:10.341387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60436ca3-1bbf-450c-91b9-45de61fd727b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195891FA6F0>]}
[0m09:49:10.389042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60436ca3-1bbf-450c-91b9-45de61fd727b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958951B590>]}
[0m09:49:10.404681 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m09:49:10.877564 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:49:10.877564 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:49:10.877564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60436ca3-1bbf-450c-91b9-45de61fd727b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195891D3F20>]}
[0m09:49:13.265311 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_first.Production
[0m09:49:13.286843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60436ca3-1bbf-450c-91b9-45de61fd727b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958AA292B0>]}
[0m09:49:13.358059 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m09:49:13.374635 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m09:49:13.455910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60436ca3-1bbf-450c-91b9-45de61fd727b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958AB0D8E0>]}
[0m09:49:13.455910 [info ] [MainThread]: Found 1 model, 4 data tests, 2 sources, 474 macros
[0m09:49:13.455910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60436ca3-1bbf-450c-91b9-45de61fd727b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958A7D9040>]}
[0m09:49:13.455910 [info ] [MainThread]: 
[0m09:49:13.455910 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:49:13.455910 [info ] [MainThread]: 
[0m09:49:13.455910 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:49:13.455910 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MYDB_PUBLIC'
[0m09:49:16.261777 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m09:49:16.261777 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m09:49:16.261777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:18.258357 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.004 seconds
[0m09:49:18.274410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60436ca3-1bbf-450c-91b9-45de61fd727b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958AADD4C0>]}
[0m09:49:18.290044 [debug] [Thread-1 (]: Began running node model.dbt_first.t_users
[0m09:49:18.290044 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.t_users'
[0m09:49:18.290044 [debug] [Thread-1 (]: Began compiling node model.dbt_first.t_users
[0m09:49:18.305399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.t_users"
[0m09:49:18.305399 [debug] [Thread-1 (]: Began executing node model.dbt_first.t_users
[0m09:49:18.305399 [debug] [Thread-1 (]: Finished running node model.dbt_first.t_users
[0m09:49:18.314900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:18.314900 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m09:49:18.314900 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m09:49:18.855025 [debug] [MainThread]: Connection 'model.dbt_first.t_users' was properly closed.
[0m09:49:18.855566 [debug] [MainThread]: Command end result
[0m09:49:18.870995 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m09:49:18.870995 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m09:49:18.886902 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m09:49:18.886902 [info ] [MainThread]: Compiled node 't_users' is:
select * from SNOWFLAKE_SAMPLE_DATA.TPCH_SF100.SUPPLIER
[0m09:49:18.886902 [debug] [MainThread]: Command `dbt compile` succeeded at 09:49:18.886902 after 11.67 seconds
[0m09:49:18.886902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019587987290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019586586660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019586586720>]}
[0m09:49:18.886902 [debug] [MainThread]: Flushing usage events
[0m09:49:19.942515 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:49:34.158042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6040DD340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6040DCF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6040DCFB0>]}


============================== 09:49:34.167675 | 0b9397b4-6cbe-41aa-8bb6-d35a5e1b8ed8 ==============================
[0m09:49:34.167675 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:49:34.167675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m t_users', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:49:34.601796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b9397b4-6cbe-41aa-8bb6-d35a5e1b8ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F604154B00>]}
[0m09:49:34.662217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b9397b4-6cbe-41aa-8bb6-d35a5e1b8ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F603C476E0>]}
[0m09:49:34.663802 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m09:49:34.979136 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:49:35.151987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:49:35.151987 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:49:35.158007 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_first.Production
[0m09:49:35.199472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b9397b4-6cbe-41aa-8bb6-d35a5e1b8ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F605F323F0>]}
[0m09:49:35.287361 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m09:49:35.290361 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m09:49:35.319764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b9397b4-6cbe-41aa-8bb6-d35a5e1b8ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F606134710>]}
[0m09:49:35.319764 [info ] [MainThread]: Found 1 model, 4 data tests, 2 sources, 474 macros
[0m09:49:35.320764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b9397b4-6cbe-41aa-8bb6-d35a5e1b8ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F601DE32F0>]}
[0m09:49:35.322765 [info ] [MainThread]: 
[0m09:49:35.322765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:49:35.323737 [info ] [MainThread]: 
[0m09:49:35.324732 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:49:35.325593 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MYDB'
[0m09:49:35.411794 [debug] [ThreadPool]: Using snowflake connection "list_MYDB"
[0m09:49:35.412727 [debug] [ThreadPool]: On list_MYDB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB"} */
show terse schemas in database MYDB
    limit 10000
[0m09:49:35.412727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:37.129102 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.717 seconds
[0m09:49:37.133287 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MYDB_PUBLIC'
[0m09:49:37.144648 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m09:49:37.144648 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m09:49:37.145689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:38.613014 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.467 seconds
[0m09:49:38.615023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b9397b4-6cbe-41aa-8bb6-d35a5e1b8ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F605F64DD0>]}
[0m09:49:38.620466 [debug] [Thread-1 (]: Began running node model.dbt_first.t_users
[0m09:49:38.620466 [info ] [Thread-1 (]: 1 of 1 START sql view model PUBLIC.t_users ..................................... [RUN]
[0m09:49:38.620466 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.t_users'
[0m09:49:38.620466 [debug] [Thread-1 (]: Began compiling node model.dbt_first.t_users
[0m09:49:38.620466 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.t_users"
[0m09:49:38.620466 [debug] [Thread-1 (]: Began executing node model.dbt_first.t_users
[0m09:49:38.650499 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.t_users"
[0m09:49:38.650499 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.t_users"
[0m09:49:38.650499 [debug] [Thread-1 (]: On model.dbt_first.t_users: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.t_users"} */
create or replace   view MYDB.PUBLIC.t_users
  
   as (
    select * from SNOWFLAKE_SAMPLE_DATA.TPCH_SF100.SUPPLIER
  );
[0m09:49:38.650499 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:49:40.405293 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.742 seconds
[0m09:49:40.430626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b9397b4-6cbe-41aa-8bb6-d35a5e1b8ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F60150DA90>]}
[0m09:49:40.430626 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PUBLIC.t_users ................................ [[32mSUCCESS 1[0m in 1.81s]
[0m09:49:40.431818 [debug] [Thread-1 (]: Finished running node model.dbt_first.t_users
[0m09:49:40.433856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:40.434160 [debug] [MainThread]: Connection 'list_MYDB' was left open.
[0m09:49:40.434160 [debug] [MainThread]: On list_MYDB: Close
[0m09:49:40.971695 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m09:49:40.971695 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m09:49:41.496217 [debug] [MainThread]: Connection 'model.dbt_first.t_users' was left open.
[0m09:49:41.497219 [debug] [MainThread]: On model.dbt_first.t_users: Close
[0m09:49:42.016562 [info ] [MainThread]: 
[0m09:49:42.016562 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.69 seconds (6.69s).
[0m09:49:42.016562 [debug] [MainThread]: Command end result
[0m09:49:42.038102 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m09:49:42.038102 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m09:49:42.038102 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m09:49:42.038102 [info ] [MainThread]: 
[0m09:49:42.038102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:49:42.052999 [info ] [MainThread]: 
[0m09:49:42.052999 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:49:42.052999 [debug] [MainThread]: Command `dbt run` succeeded at 09:49:42.052999 after 8.05 seconds
[0m09:49:42.052999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6040DD250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6037D5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6040B7A40>]}
[0m09:49:42.052999 [debug] [MainThread]: Flushing usage events
[0m09:49:43.023199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:51:44.126857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002854E5E0D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002854C319730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002854C77ED80>]}


============================== 09:51:44.126857 | 776b4738-9961-457d-84e4-3490bdc70383 ==============================
[0m09:51:44.126857 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:51:44.126857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m09:51:44.629030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '776b4738-9961-457d-84e4-3490bdc70383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002854FD34B00>]}
[0m09:51:44.691574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '776b4738-9961-457d-84e4-3490bdc70383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002854DF21190>]}
[0m09:51:44.691574 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m09:51:45.115334 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:51:46.433919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:51:46.435924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:51:46.441685 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_first.Production
[0m09:51:46.476983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '776b4738-9961-457d-84e4-3490bdc70383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028550EA6C90>]}
[0m09:51:46.510733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '776b4738-9961-457d-84e4-3490bdc70383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002855121F860>]}
[0m09:51:46.510733 [info ] [MainThread]: Found 1 model, 4 data tests, 2 sources, 474 macros
[0m09:51:46.510733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '776b4738-9961-457d-84e4-3490bdc70383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028550ECB950>]}
[0m09:51:46.510733 [info ] [MainThread]: 
[0m09:51:46.510733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:51:46.510733 [info ] [MainThread]: 
[0m09:51:46.510733 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:51:46.510733 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MYDB_PUBLIC'
[0m09:51:49.026089 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m09:51:49.039178 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m09:51:49.039178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:50.877640 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.846 seconds
[0m09:51:50.877640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '776b4738-9961-457d-84e4-3490bdc70383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002854EBA2630>]}
[0m09:51:50.877640 [debug] [Thread-1 (]: Began running node model.dbt_first.t_users
[0m09:51:50.877640 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.t_users'
[0m09:51:50.877640 [debug] [Thread-1 (]: Began compiling node model.dbt_first.t_users
[0m09:51:50.893371 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.t_users"
[0m09:51:50.893371 [debug] [Thread-1 (]: Began executing node model.dbt_first.t_users
[0m09:51:50.893371 [debug] [Thread-1 (]: Finished running node model.dbt_first.t_users
[0m09:51:50.893371 [debug] [Thread-1 (]: Began running node test.dbt_first.source_not_null_sources_LINEITEM_L_ORDERKEY.8ca15e0b32
[0m09:51:50.893371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.t_users, now test.dbt_first.source_not_null_sources_LINEITEM_L_ORDERKEY.8ca15e0b32)
[0m09:51:50.893371 [debug] [Thread-1 (]: Began compiling node test.dbt_first.source_not_null_sources_LINEITEM_L_ORDERKEY.8ca15e0b32
[0m09:51:50.909533 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.source_not_null_sources_LINEITEM_L_ORDERKEY.8ca15e0b32"
[0m09:51:50.909533 [debug] [Thread-1 (]: Began executing node test.dbt_first.source_not_null_sources_LINEITEM_L_ORDERKEY.8ca15e0b32
[0m09:51:50.909533 [debug] [Thread-1 (]: Finished running node test.dbt_first.source_not_null_sources_LINEITEM_L_ORDERKEY.8ca15e0b32
[0m09:51:50.909533 [debug] [Thread-1 (]: Began running node test.dbt_first.source_not_null_sources_SUPPLIER_S_SUPPKEY.fc62bd451d
[0m09:51:50.909533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.source_not_null_sources_LINEITEM_L_ORDERKEY.8ca15e0b32, now test.dbt_first.source_not_null_sources_SUPPLIER_S_SUPPKEY.fc62bd451d)
[0m09:51:50.909533 [debug] [Thread-1 (]: Began compiling node test.dbt_first.source_not_null_sources_SUPPLIER_S_SUPPKEY.fc62bd451d
[0m09:51:50.909533 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.source_not_null_sources_SUPPLIER_S_SUPPKEY.fc62bd451d"
[0m09:51:50.909533 [debug] [Thread-1 (]: Began executing node test.dbt_first.source_not_null_sources_SUPPLIER_S_SUPPKEY.fc62bd451d
[0m09:51:50.909533 [debug] [Thread-1 (]: Finished running node test.dbt_first.source_not_null_sources_SUPPLIER_S_SUPPKEY.fc62bd451d
[0m09:51:50.909533 [debug] [Thread-1 (]: Began running node test.dbt_first.source_unique_sources_LINEITEM_L_ORDERKEY.63ac7ce94e
[0m09:51:50.909533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.source_not_null_sources_SUPPLIER_S_SUPPKEY.fc62bd451d, now test.dbt_first.source_unique_sources_LINEITEM_L_ORDERKEY.63ac7ce94e)
[0m09:51:50.909533 [debug] [Thread-1 (]: Began compiling node test.dbt_first.source_unique_sources_LINEITEM_L_ORDERKEY.63ac7ce94e
[0m09:51:50.925382 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.source_unique_sources_LINEITEM_L_ORDERKEY.63ac7ce94e"
[0m09:51:50.925382 [debug] [Thread-1 (]: Began executing node test.dbt_first.source_unique_sources_LINEITEM_L_ORDERKEY.63ac7ce94e
[0m09:51:50.925382 [debug] [Thread-1 (]: Finished running node test.dbt_first.source_unique_sources_LINEITEM_L_ORDERKEY.63ac7ce94e
[0m09:51:50.925382 [debug] [Thread-1 (]: Began running node test.dbt_first.source_unique_sources_SUPPLIER_S_SUPPKEY.7204c6bc94
[0m09:51:50.925382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.source_unique_sources_LINEITEM_L_ORDERKEY.63ac7ce94e, now test.dbt_first.source_unique_sources_SUPPLIER_S_SUPPKEY.7204c6bc94)
[0m09:51:50.925382 [debug] [Thread-1 (]: Began compiling node test.dbt_first.source_unique_sources_SUPPLIER_S_SUPPKEY.7204c6bc94
[0m09:51:50.925382 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.source_unique_sources_SUPPLIER_S_SUPPKEY.7204c6bc94"
[0m09:51:50.925382 [debug] [Thread-1 (]: Began executing node test.dbt_first.source_unique_sources_SUPPLIER_S_SUPPKEY.7204c6bc94
[0m09:51:50.925382 [debug] [Thread-1 (]: Finished running node test.dbt_first.source_unique_sources_SUPPLIER_S_SUPPKEY.7204c6bc94
[0m09:51:50.925382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:50.925382 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m09:51:50.925382 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m09:51:51.491411 [debug] [MainThread]: Connection 'test.dbt_first.source_unique_sources_SUPPLIER_S_SUPPKEY.7204c6bc94' was properly closed.
[0m09:51:51.493419 [debug] [MainThread]: Command end result
[0m09:51:51.570356 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m09:51:51.570356 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m09:51:51.586200 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m09:51:51.926492 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m09:51:51.926492 [info ] [MainThread]: Building catalog
[0m09:51:51.926492 [debug] [ThreadPool]: Acquiring new snowflake connection 'SNOWFLAKE_SAMPLE_DATA.information_schema'
[0m09:51:51.950470 [debug] [ThreadPool]: Using snowflake connection "SNOWFLAKE_SAMPLE_DATA.information_schema"
[0m09:51:51.950470 [debug] [ThreadPool]: On SNOWFLAKE_SAMPLE_DATA.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "SNOWFLAKE_SAMPLE_DATA.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from SNOWFLAKE_SAMPLE_DATA.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'TPCH_SF100' and upper("table_schema") = upper('TPCH_SF100')

                    and 
    "table_name" ilike 'SUPPLIER' and upper("table_name") = upper('SUPPLIER')

                )
             or 
                (
                    
    "table_schema" ilike 'TPCH_SF100' and upper("table_schema") = upper('TPCH_SF100')

                    and 
    "table_name" ilike 'LINEITEM' and upper("table_name") = upper('LINEITEM')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from SNOWFLAKE_SAMPLE_DATA.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'TPCH_SF100' and upper("table_schema") = upper('TPCH_SF100')

                    and 
    "table_name" ilike 'SUPPLIER' and upper("table_name") = upper('SUPPLIER')

                )
             or 
                (
                    
    "table_schema" ilike 'TPCH_SF100' and upper("table_schema") = upper('TPCH_SF100')

                    and 
    "table_name" ilike 'LINEITEM' and upper("table_name") = upper('LINEITEM')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m09:51:51.950470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:51:55.390510 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 3.440 seconds
[0m09:51:55.390510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly SNOWFLAKE_SAMPLE_DATA.information_schema, now MYDB.information_schema)
[0m09:51:55.406342 [debug] [ThreadPool]: Using snowflake connection "MYDB.information_schema"
[0m09:51:55.406342 [debug] [ThreadPool]: On MYDB.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "MYDB.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from MYDB.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 't_users' and upper("table_name") = upper('t_users')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from MYDB.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 't_users' and upper("table_name") = upper('t_users')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m09:51:57.332677 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.933 seconds
[0m09:51:57.349976 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\VarshaS\dbt_first\target\catalog.json
[0m09:51:57.364126 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m09:51:57.379818 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m09:51:57.381823 [info ] [MainThread]: Catalog written to C:\Users\VarshaS\dbt_first\target\catalog.json
[0m09:51:57.381823 [debug] [MainThread]: Command `dbt docs generate` succeeded at 09:51:57.381823 after 13.45 seconds
[0m09:51:57.381823 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m09:51:57.381823 [debug] [MainThread]: Connection 'MYDB.information_schema' was left open.
[0m09:51:57.381823 [debug] [MainThread]: On MYDB.information_schema: Close
[0m09:51:57.921895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002854E6991F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028550ECBD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002854C21ECF0>]}
[0m09:51:57.921895 [debug] [MainThread]: Flushing usage events
[0m09:51:58.923118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:07.244953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202028DCE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202028DCF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202028DC110>]}


============================== 09:52:07.244953 | 54a9282a-1e77-430c-91f2-d26bae45ddd9 ==============================
[0m09:52:07.244953 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:52:07.252175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m09:52:07.699398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54a9282a-1e77-430c-91f2-d26bae45ddd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020203459EB0>]}
[0m09:52:07.752727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54a9282a-1e77-430c-91f2-d26bae45ddd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202036AF260>]}
[0m10:40:03.684654 [error] [MainThread]: Encountered an error:

[0m10:40:03.802188 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m10:40:03.804195 [debug] [MainThread]: Command `dbt docs serve` failed at 10:40:03.804195 after 2876.72 seconds
[0m10:40:03.811200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202028DCE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202047C74D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020203657410>]}
[0m10:40:03.818089 [debug] [MainThread]: Flushing usage events
[0m10:40:18.772578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002448784D370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002448784D340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002448784C3E0>]}


============================== 10:40:18.788567 | ff7e8e32-6bea-4b41-a561-b4c649f7c792 ==============================
[0m10:40:18.788567 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:40:18.788567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:40:19.768429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff7e8e32-6bea-4b41-a561-b4c649f7c792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024487A843E0>]}
[0m10:40:19.835103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff7e8e32-6bea-4b41-a561-b4c649f7c792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002448500F740>]}
[0m10:40:19.835103 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:40:20.318246 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:40:20.435583 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:40:20.435583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ff7e8e32-6bea-4b41-a561-b4c649f7c792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024487891790>]}
[0m10:40:22.783199 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt_first.Staging
- models.dbt_first.Mart
- models.dbt_first
- seeds.training
[0m10:40:22.787505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff7e8e32-6bea-4b41-a561-b4c649f7c792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244885C5670>]}
[0m10:40:22.854564 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:40:22.871735 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:40:22.926060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff7e8e32-6bea-4b41-a561-b4c649f7c792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244899B7140>]}
[0m10:40:22.927058 [info ] [MainThread]: Found 1 seed, 2 sources, 474 macros
[0m10:40:22.928058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff7e8e32-6bea-4b41-a561-b4c649f7c792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024488689400>]}
[0m10:40:22.930058 [info ] [MainThread]: 
[0m10:40:22.930058 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:40:22.931091 [info ] [MainThread]: 
[0m10:40:22.932057 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:40:22.933057 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MYDB_PUBLIC'
[0m10:40:25.840186 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m10:40:25.843440 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m10:40:25.843440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:40:27.846216 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.002 seconds
[0m10:40:27.850558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff7e8e32-6bea-4b41-a561-b4c649f7c792', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002448A072690>]}
[0m10:40:27.850558 [debug] [Thread-1 (]: Began running node seed.dbt_first.stripe_payments
[0m10:40:27.850558 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.dbt_first.stripe_payments'
[0m10:40:27.850558 [debug] [Thread-1 (]: Began compiling node seed.dbt_first.stripe_payments
[0m10:40:27.866684 [debug] [Thread-1 (]: Began executing node seed.dbt_first.stripe_payments
[0m10:40:27.866684 [debug] [Thread-1 (]: Finished running node seed.dbt_first.stripe_payments
[0m10:40:27.866684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:40:27.866684 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m10:40:27.866684 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m10:40:28.367253 [debug] [MainThread]: Connection 'seed.dbt_first.stripe_payments' was properly closed.
[0m10:40:28.367253 [debug] [MainThread]: Command end result
[0m10:40:28.399102 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:40:28.399102 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:40:28.399102 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:40:28.399102 [debug] [MainThread]: Command `dbt compile` succeeded at 10:40:28.399102 after 9.87 seconds
[0m10:40:28.399102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024487827710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244898F98E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244899B6BA0>]}
[0m10:40:28.399102 [debug] [MainThread]: Flushing usage events
[0m10:40:29.435674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:41:01.802485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198779FD0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198779FC530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198779FC050>]}


============================== 10:41:01.804234 | c066781e-3e7a-47e8-8357-5738a8700b24 ==============================
[0m10:41:01.804234 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:41:01.804234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:41:02.235826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c066781e-3e7a-47e8-8357-5738a8700b24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198785164B0>]}
[0m10:41:02.291335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c066781e-3e7a-47e8-8357-5738a8700b24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198786F4D70>]}
[0m10:41:02.291335 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:41:02.602281 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:41:02.741899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:41:02.741899 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:41:02.741899 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.dbt_first.Staging
- models.dbt_first
- models.dbt_first.Mart
- seeds.training
[0m10:41:02.775421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c066781e-3e7a-47e8-8357-5738a8700b24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019879A346B0>]}
[0m10:41:02.835568 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:41:02.838599 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:41:02.861114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c066781e-3e7a-47e8-8357-5738a8700b24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019879C0F650>]}
[0m10:41:02.861114 [info ] [MainThread]: Found 1 seed, 2 sources, 474 macros
[0m10:41:02.861114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c066781e-3e7a-47e8-8357-5738a8700b24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019876F1A030>]}
[0m10:41:02.861114 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:41:02.861114 [debug] [MainThread]: Command end result
[0m10:41:02.887180 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:41:02.888217 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:41:02.889185 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:41:02.889185 [debug] [MainThread]: Command `dbt run` succeeded at 10:41:02.889185 after 1.25 seconds
[0m10:41:02.889185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198798A5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198798A6CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198798A59D0>]}
[0m10:41:02.889185 [debug] [MainThread]: Flushing usage events
[0m10:41:03.830294 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:45:50.465404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC1E60D1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC1E60D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC1E60D250>]}


============================== 10:45:50.465404 | 7c044a87-cb65-4666-8538-c1b3c1567c3b ==============================
[0m10:45:50.465404 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:45:50.465404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:45:50.903030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c044a87-cb65-4666-8538-c1b3c1567c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC1BA1E810>]}
[0m10:45:50.950499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c044a87-cb65-4666-8538-c1b3c1567c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC1F376150>]}
[0m10:45:50.950499 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:45:51.263526 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:45:51.405966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m10:45:51.405966 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Staging\stg_orders.sql
[0m10:45:51.405966 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Staging\stg_payments.sql
[0m10:45:51.405966 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Staging\stg_customers.sql
[0m10:45:51.612890 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_first.stg_orders' (models\Staging\stg_orders.sql) depends on a source named 'sources.stg_orders' which was not found
[0m10:45:51.628857 [debug] [MainThread]: Command `dbt compile` failed at 10:45:51.627819 after 1.32 seconds
[0m10:45:51.628857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC1E0BFFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC1DA979B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC207A1970>]}
[0m10:45:51.628857 [debug] [MainThread]: Flushing usage events
[0m10:45:52.642564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:47:44.575187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014193BC9A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014195E61E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014195E61EE0>]}


============================== 10:47:44.584890 | d6617911-ee07-4934-8f6a-23cf7a6866de ==============================
[0m10:47:44.584890 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:47:44.584890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:47:45.047038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6617911-ee07-4934-8f6a-23cf7a6866de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141968D7800>]}
[0m10:47:45.107304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6617911-ee07-4934-8f6a-23cf7a6866de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014195E62390>]}
[0m10:47:45.109310 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:47:45.443130 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:47:45.590348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m10:47:45.592888 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Staging\stg_customers.sql
[0m10:47:45.592888 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Staging\stg_payments.sql
[0m10:47:45.594037 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Staging\stg_orders.sql
[0m10:47:45.874989 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_first.Mart
- seeds.training
[0m10:47:45.887303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6617911-ee07-4934-8f6a-23cf7a6866de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014198B3F410>]}
[0m10:47:45.965222 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:47:45.965222 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:47:46.000495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6617911-ee07-4934-8f6a-23cf7a6866de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141989993A0>]}
[0m10:47:46.000495 [info ] [MainThread]: Found 1 seed, 3 models, 2 sources, 474 macros
[0m10:47:46.001528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6617911-ee07-4934-8f6a-23cf7a6866de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001419875B6B0>]}
[0m10:47:46.003495 [info ] [MainThread]: 
[0m10:47:46.004257 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:47:46.004854 [info ] [MainThread]: 
[0m10:47:46.004854 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:47:46.009970 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MYDB_PUBLIC'
[0m10:47:46.108867 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m10:47:46.108867 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m10:47:46.108867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:47.975519 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.873 seconds
[0m10:47:47.985384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MYDB_PUBLIC, now list_customer_orders_PUBLIC_staging)
[0m10:47:47.985384 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_PUBLIC_staging"
[0m10:47:47.985384 [debug] [ThreadPool]: On list_customer_orders_PUBLIC_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_PUBLIC_staging"} */
show objects in customer_orders.PUBLIC_staging limit 10000;
[0m10:47:48.475471 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bae85c-0004-b885-0005-a3d30002a12a
[0m10:47:48.475471 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:47:48.478010 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:47:48.478010 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:47:48.478010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6617911-ee07-4934-8f6a-23cf7a6866de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014198B94800>]}
[0m10:47:48.483197 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m10:47:48.485267 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m10:47:48.485267 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m10:47:48.485267 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m10:47:48.485267 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m10:47:48.485267 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m10:47:48.495303 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_orders
[0m10:47:48.495303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_orders)
[0m10:47:48.495303 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_orders
[0m10:47:48.499876 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_orders"
[0m10:47:48.501883 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_orders
[0m10:47:48.501883 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_orders
[0m10:47:48.501883 [debug] [Thread-1 (]: Began running node seed.dbt_first.stripe_payments
[0m10:47:48.501883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_orders, now seed.dbt_first.stripe_payments)
[0m10:47:48.501883 [debug] [Thread-1 (]: Began compiling node seed.dbt_first.stripe_payments
[0m10:47:48.505396 [debug] [Thread-1 (]: Began executing node seed.dbt_first.stripe_payments
[0m10:47:48.555116 [debug] [Thread-1 (]: Finished running node seed.dbt_first.stripe_payments
[0m10:47:48.555116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:48.555116 [debug] [MainThread]: Connection 'list_customer_orders_PUBLIC_staging' was left open.
[0m10:47:48.555116 [debug] [MainThread]: On list_customer_orders_PUBLIC_staging: Close
[0m10:47:49.075308 [debug] [MainThread]: Connection 'seed.dbt_first.stripe_payments' was properly closed.
[0m10:47:49.075308 [debug] [MainThread]: Command end result
[0m10:47:49.098992 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:47:49.098992 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:47:49.105158 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:47:49.105158 [debug] [MainThread]: Command `dbt compile` succeeded at 10:47:49.105158 after 4.78 seconds
[0m10:47:49.105158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014194056DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014194057320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014198B3DAF0>]}
[0m10:47:49.105158 [debug] [MainThread]: Flushing usage events
[0m10:47:50.080342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:48:27.804859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5D784080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5D7848F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5D7845F0>]}


============================== 10:48:27.804859 | 63ad46a2-0079-405b-afc4-a66a3d61e5e2 ==============================
[0m10:48:27.804859 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:48:27.804859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:48:28.261708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63ad46a2-0079-405b-afc4-a66a3d61e5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5E4470E0>]}
[0m10:48:28.324907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63ad46a2-0079-405b-afc4-a66a3d61e5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5E297470>]}
[0m10:48:28.324907 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:48:28.655176 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:48:28.814945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:48:28.819072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:48:28.824851 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_first.Mart
- seeds.training
[0m10:48:28.865085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63ad46a2-0079-405b-afc4-a66a3d61e5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5F5844D0>]}
[0m10:48:28.944941 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:48:28.944941 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:48:28.975340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63ad46a2-0079-405b-afc4-a66a3d61e5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5F8CD520>]}
[0m10:48:28.975340 [info ] [MainThread]: Found 1 seed, 3 models, 2 sources, 474 macros
[0m10:48:28.975340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63ad46a2-0079-405b-afc4-a66a3d61e5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5F5AAE70>]}
[0m10:48:28.979824 [info ] [MainThread]: 
[0m10:48:28.979824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:48:28.979824 [info ] [MainThread]: 
[0m10:48:28.979824 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:48:28.984992 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders'
[0m10:48:29.079630 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m10:48:29.080632 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m10:48:29.080632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:30.797165 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.717 seconds
[0m10:48:30.799841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders, now create_customer_orders_PUBLIC_staging)
[0m10:48:30.799841 [debug] [ThreadPool]: Creating schema "database: "customer_orders"
schema: "PUBLIC_staging"
"
[0m10:48:30.805183 [debug] [ThreadPool]: Using snowflake connection "create_customer_orders_PUBLIC_staging"
[0m10:48:30.807250 [debug] [ThreadPool]: On create_customer_orders_PUBLIC_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "create_customer_orders_PUBLIC_staging"} */
create schema if not exists customer_orders.PUBLIC_staging
[0m10:48:31.225066 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.418 seconds
[0m10:48:31.227422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_PUBLIC_staging'
[0m10:48:31.245270 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_PUBLIC_staging"
[0m10:48:31.245270 [debug] [ThreadPool]: On list_customer_orders_PUBLIC_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_PUBLIC_staging"} */
show objects in customer_orders.PUBLIC_staging limit 10000;
[0m10:48:31.245270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:32.735642 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.495 seconds
[0m10:48:32.742723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_PUBLIC_staging, now list_MYDB_PUBLIC)
[0m10:48:32.744882 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m10:48:32.746946 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m10:48:33.055112 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.308 seconds
[0m10:48:33.060849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63ad46a2-0079-405b-afc4-a66a3d61e5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5AC23560>]}
[0m10:48:33.065057 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m10:48:33.065057 [info ] [Thread-1 (]: 1 of 2 START sql view model customer_orders.PUBLIC_staging.stg_customers ....... [RUN]
[0m10:48:33.065057 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m10:48:33.074900 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m10:48:33.085088 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m10:48:33.094085 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m10:48:33.127323 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_customers"
[0m10:48:33.127323 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_customers"
[0m10:48:33.127323 [debug] [Thread-1 (]: On model.dbt_first.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_customers"} */
create or replace   view customer_orders.PUBLIC_staging.stg_customers
  
   as (
    

select * from MYDB.PUBLIC.STG_CUSTOMERS
  );
[0m10:48:33.135232 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:48:34.735452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.603 seconds
[0m10:48:34.781207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63ad46a2-0079-405b-afc4-a66a3d61e5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5AB8DA30>]}
[0m10:48:34.783249 [info ] [Thread-1 (]: 1 of 2 OK created sql view model customer_orders.PUBLIC_staging.stg_customers .. [[32mSUCCESS 1[0m in 1.71s]
[0m10:48:34.784768 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m10:48:34.784768 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_orders
[0m10:48:34.784768 [info ] [Thread-1 (]: 2 of 2 START sql view model customer_orders.PUBLIC_staging.stg_orders .......... [RUN]
[0m10:48:34.784768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_orders)
[0m10:48:34.784768 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_orders
[0m10:48:34.790546 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_orders"
[0m10:48:34.790546 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_orders
[0m10:48:34.794851 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_orders"
[0m10:48:34.794851 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_orders"
[0m10:48:34.794851 [debug] [Thread-1 (]: On model.dbt_first.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_orders"} */
create or replace   view customer_orders.PUBLIC_staging.stg_orders
  
   as (
    

select * from MYDB.PUBLIC.STG_ORDERS
  );
[0m10:48:35.363341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m10:48:35.370168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63ad46a2-0079-405b-afc4-a66a3d61e5e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5FFD48C0>]}
[0m10:48:35.370168 [info ] [Thread-1 (]: 2 of 2 OK created sql view model customer_orders.PUBLIC_staging.stg_orders ..... [[32mSUCCESS 1[0m in 0.59s]
[0m10:48:35.370168 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_orders
[0m10:48:35.370168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:35.375038 [debug] [MainThread]: Connection 'create_customer_orders_PUBLIC_staging' was left open.
[0m10:48:35.375038 [debug] [MainThread]: On create_customer_orders_PUBLIC_staging: Close
[0m10:48:35.883148 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m10:48:35.883148 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m10:48:36.386491 [debug] [MainThread]: Connection 'model.dbt_first.stg_orders' was left open.
[0m10:48:36.386491 [debug] [MainThread]: On model.dbt_first.stg_orders: Close
[0m10:48:36.904839 [info ] [MainThread]: 
[0m10:48:36.904839 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 7.93 seconds (7.93s).
[0m10:48:36.904839 [debug] [MainThread]: Command end result
[0m10:48:36.936993 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:48:36.939215 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:48:36.945036 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:48:36.945036 [info ] [MainThread]: 
[0m10:48:36.945036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:48:36.947532 [info ] [MainThread]: 
[0m10:48:36.948232 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:48:36.950657 [debug] [MainThread]: Command `dbt run` succeeded at 10:48:36.950657 after 9.31 seconds
[0m10:48:36.950657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5CCD1F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5D44D5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023F5D44DB20>]}
[0m10:48:36.950657 [debug] [MainThread]: Flushing usage events
[0m10:48:38.001058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:01.073947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6A97C140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6A97C0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6A97C9E0>]}


============================== 10:52:01.084118 | 79d6f26c-90e6-4a61-830e-ea6e5602ac86 ==============================
[0m10:52:01.084118 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:52:01.084118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:52:01.632002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79d6f26c-90e6-4a61-830e-ea6e5602ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6B50ACC0>]}
[0m10:52:01.694024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79d6f26c-90e6-4a61-830e-ea6e5602ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6AC6EA50>]}
[0m10:52:01.697411 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:52:02.147355 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:52:02.245509 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:52:02.254112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79d6f26c-90e6-4a61-830e-ea6e5602ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6A4F7020>]}
[0m10:52:04.934069 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_first.Mart
- seeds.training
[0m10:52:04.954318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79d6f26c-90e6-4a61-830e-ea6e5602ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6C9BF590>]}
[0m10:52:05.036788 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:52:05.054236 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:52:05.087981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79d6f26c-90e6-4a61-830e-ea6e5602ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6CC13DD0>]}
[0m10:52:05.087981 [info ] [MainThread]: Found 3 models, 1 seed, 2 sources, 474 macros
[0m10:52:05.089989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79d6f26c-90e6-4a61-830e-ea6e5602ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6CC3C980>]}
[0m10:52:05.092146 [info ] [MainThread]: 
[0m10:52:05.092146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:52:05.092146 [info ] [MainThread]: 
[0m10:52:05.094154 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:52:05.095238 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MYDB'
[0m10:52:07.994291 [debug] [ThreadPool]: Using snowflake connection "list_MYDB"
[0m10:52:07.994291 [debug] [ThreadPool]: On list_MYDB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB"} */
show terse schemas in database MYDB
    limit 10000
[0m10:52:07.994291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:09.740553 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.739 seconds
[0m10:52:09.744301 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_PUBLIC_staging'
[0m10:52:09.754553 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_PUBLIC_staging"
[0m10:52:09.754553 [debug] [ThreadPool]: On list_customer_orders_PUBLIC_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_PUBLIC_staging"} */
show objects in customer_orders.PUBLIC_staging limit 10000;
[0m10:52:09.754553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:11.254072 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.505 seconds
[0m10:52:11.254072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_PUBLIC_staging, now list_MYDB_PUBLIC)
[0m10:52:11.264200 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m10:52:11.264200 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m10:52:11.590246 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.324 seconds
[0m10:52:11.599087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79d6f26c-90e6-4a61-830e-ea6e5602ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6B7D47D0>]}
[0m10:52:11.611317 [debug] [Thread-1 (]: Began running node seed.dbt_first.stripe_payments
[0m10:52:11.611317 [info ] [Thread-1 (]: 1 of 1 START seed file PUBLIC.stripe_payments .................................. [RUN]
[0m10:52:11.614254 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.dbt_first.stripe_payments'
[0m10:52:11.614254 [debug] [Thread-1 (]: Began compiling node seed.dbt_first.stripe_payments
[0m10:52:11.618729 [debug] [Thread-1 (]: Began executing node seed.dbt_first.stripe_payments
[0m10:52:11.680670 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.stripe_payments"
[0m10:52:11.680670 [debug] [Thread-1 (]: On seed.dbt_first.stripe_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.stripe_payments"} */
create table MYDB.PUBLIC.stripe_payments (ID integer,ORDERID integer,PAYMENTMETHOD text,STATUS text,AMOUNT integer,CREATED date)
[0m10:52:11.682216 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:52:13.284403 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.602 seconds
[0m10:52:13.301384 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.stripe_payments"
[0m10:52:13.301384 [debug] [Thread-1 (]: On seed.dbt_first.stripe_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.stripe_payments"} */
BEGIN
[0m10:52:13.645892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.348 seconds
[0m10:52:13.654169 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.stripe_payments"
[0m10:52:13.654169 [debug] [Thread-1 (]: On seed.dbt_first.stripe_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.stripe_payments"} */
insert into MYDB.PUBLIC.stripe_payments (ID, ORDERID, PAYMENTMETHOD, STATUS, AMOUNT, CREATED) values
            (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s...
[0m10:52:14.411348 [debug] [Thread-1 (]: SQL status: SUCCESS 120 in 0.756 seconds
[0m10:52:14.412781 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.stripe_payments"
[0m10:52:14.412781 [debug] [Thread-1 (]: On seed.dbt_first.stripe_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.stripe_payments"} */
COMMIT
[0m10:52:15.014441 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m10:52:15.024163 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_first.stripe_payments"
[0m10:52:15.049221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79d6f26c-90e6-4a61-830e-ea6e5602ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F69E606E0>]}
[0m10:52:15.049221 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file PUBLIC.stripe_payments .............................. [[32mINSERT 120[0m in 3.43s]
[0m10:52:15.049221 [debug] [Thread-1 (]: Finished running node seed.dbt_first.stripe_payments
[0m10:52:15.049221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:15.049221 [debug] [MainThread]: Connection 'list_MYDB' was left open.
[0m10:52:15.049221 [debug] [MainThread]: On list_MYDB: Close
[0m10:52:15.555520 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m10:52:15.562247 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m10:52:16.081395 [debug] [MainThread]: Connection 'seed.dbt_first.stripe_payments' was left open.
[0m10:52:16.081395 [debug] [MainThread]: On seed.dbt_first.stripe_payments: Close
[0m10:52:16.611046 [info ] [MainThread]: 
[0m10:52:16.612077 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 11.52 seconds (11.52s).
[0m10:52:16.613045 [debug] [MainThread]: Command end result
[0m10:52:16.635545 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:52:16.637568 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:52:16.644364 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:52:16.644364 [info ] [MainThread]: 
[0m10:52:16.644364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:52:16.644364 [info ] [MainThread]: 
[0m10:52:16.644364 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:52:16.647911 [debug] [MainThread]: Command `dbt seed` succeeded at 10:52:16.647911 after 15.85 seconds
[0m10:52:16.647911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6A97C0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F6A97C140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F69F206B0>]}
[0m10:52:16.648919 [debug] [MainThread]: Flushing usage events
[0m10:52:17.794391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:55:40.440411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9CEB51CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9CF5D32F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9D0CD6C60>]}


============================== 10:55:40.440411 | c0a42f55-a88c-458e-91be-7f2c4294841c ==============================
[0m10:55:40.440411 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:55:40.440411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile -m tag:payment', 'send_anonymous_usage_stats': 'True'}
[0m10:55:40.873360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0a42f55-a88c-458e-91be-7f2c4294841c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9D2537890>]}
[0m10:55:40.928740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0a42f55-a88c-458e-91be-7f2c4294841c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9D24A1820>]}
[0m10:55:40.930494 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:55:41.239109 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:55:41.334278 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:55:41.334278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0a42f55-a88c-458e-91be-7f2c4294841c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9D38E5700>]}
[0m10:55:42.617303 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_first.Mart
[0m10:55:42.620948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0a42f55-a88c-458e-91be-7f2c4294841c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9D3ACFE60>]}
[0m10:55:42.703655 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:55:42.703655 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:55:42.733711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0a42f55-a88c-458e-91be-7f2c4294841c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9D3BBE1E0>]}
[0m10:55:42.733711 [info ] [MainThread]: Found 3 models, 1 seed, 2 sources, 474 macros
[0m10:55:42.735451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0a42f55-a88c-458e-91be-7f2c4294841c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9D26A2750>]}
[0m10:55:42.735451 [info ] [MainThread]: 
[0m10:55:42.737663 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:55:42.737663 [info ] [MainThread]: 
[0m10:55:42.737663 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:55:42.742781 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_PUBLIC_staging'
[0m10:55:42.829861 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_PUBLIC_staging"
[0m10:55:42.829861 [debug] [ThreadPool]: On list_customer_orders_PUBLIC_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_PUBLIC_staging"} */
show objects in customer_orders.PUBLIC_staging limit 10000;
[0m10:55:42.830857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:44.468378 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.637 seconds
[0m10:55:44.468378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_PUBLIC_staging, now list_MYDB_PUBLIC_PUBLIC)
[0m10:55:44.472389 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC_PUBLIC"
[0m10:55:44.472389 [debug] [ThreadPool]: On list_MYDB_PUBLIC_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC_PUBLIC"} */
show objects in MYDB.PUBLIC_PUBLIC limit 10000;
[0m10:55:44.905344 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bae864-0004-b882-0005-a3d30002919a
[0m10:55:44.905344 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:55:44.905344 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:55:44.905344 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:55:44.905344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0a42f55-a88c-458e-91be-7f2c4294841c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9D3BBE2A0>]}
[0m10:55:44.905344 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_payments
[0m10:55:44.905344 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_payments'
[0m10:55:44.905344 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_payments
[0m10:55:44.905344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_payments"
[0m10:55:44.921412 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_payments
[0m10:55:44.921412 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_payments
[0m10:55:44.921412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:55:44.921412 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC_PUBLIC' was left open.
[0m10:55:44.921412 [debug] [MainThread]: On list_MYDB_PUBLIC_PUBLIC: Close
[0m10:55:45.432741 [debug] [MainThread]: Connection 'model.dbt_first.stg_payments' was properly closed.
[0m10:55:45.432741 [debug] [MainThread]: Command end result
[0m10:55:45.464523 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:55:45.464523 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:55:45.464523 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:55:45.464523 [debug] [MainThread]: Excluded node 'stg_payments' from results
[0m10:55:45.464523 [debug] [MainThread]: Command `dbt compile` succeeded at 10:55:45.464523 after 5.27 seconds
[0m10:55:45.464523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9D13856D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9D13879B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9D1387980>]}
[0m10:55:45.464523 [debug] [MainThread]: Flushing usage events
[0m10:55:46.549889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:56:09.621215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB5550D1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB551E2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB5550CE30>]}


============================== 10:56:09.621215 | 6759a836-ec18-4a3b-8275-c52d16281341 ==============================
[0m10:56:09.621215 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:56:09.628665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:payment', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:56:10.055907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6759a836-ec18-4a3b-8275-c52d16281341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB55555DC0>]}
[0m10:56:10.109013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6759a836-ec18-4a3b-8275-c52d16281341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB54E26660>]}
[0m10:56:10.109013 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:56:10.421758 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:56:10.576236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:56:10.576236 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:56:10.581995 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_first.Mart
[0m10:56:10.614805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6759a836-ec18-4a3b-8275-c52d16281341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB558BB140>]}
[0m10:56:10.693109 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:56:10.696108 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:56:10.722055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6759a836-ec18-4a3b-8275-c52d16281341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB57587290>]}
[0m10:56:10.722055 [info ] [MainThread]: Found 3 models, 1 seed, 2 sources, 474 macros
[0m10:56:10.722055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6759a836-ec18-4a3b-8275-c52d16281341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB57718C80>]}
[0m10:56:10.722055 [info ] [MainThread]: 
[0m10:56:10.726013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:56:10.726013 [info ] [MainThread]: 
[0m10:56:10.726013 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:56:10.728615 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders'
[0m10:56:10.815365 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m10:56:10.815365 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m10:56:10.815365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:12.492586 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.680 seconds
[0m10:56:12.497174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_PUBLIC_staging'
[0m10:56:12.508475 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_PUBLIC_staging"
[0m10:56:12.508475 [debug] [ThreadPool]: On list_customer_orders_PUBLIC_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_PUBLIC_staging"} */
show objects in customer_orders.PUBLIC_staging limit 10000;
[0m10:56:12.508475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:13.964324 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.455 seconds
[0m10:56:13.964324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_PUBLIC_staging, now list_MYDB_PUBLIC_PUBLIC)
[0m10:56:13.964324 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC_PUBLIC"
[0m10:56:13.964324 [debug] [ThreadPool]: On list_MYDB_PUBLIC_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC_PUBLIC"} */
show objects in MYDB.PUBLIC_PUBLIC limit 10000;
[0m10:56:14.273322 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bae865-0004-b9a2-0005-a3d30002d19e
[0m10:56:14.273322 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m10:56:14.273322 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m10:56:14.273322 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m10:56:14.273322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6759a836-ec18-4a3b-8275-c52d16281341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB57BD5520>]}
[0m10:56:14.273322 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_payments
[0m10:56:14.273322 [info ] [Thread-1 (]: 1 of 1 START sql view model customer_orders.PUBLIC_staging.stg_payments ........ [RUN]
[0m10:56:14.273322 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_payments'
[0m10:56:14.273322 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_payments
[0m10:56:14.290056 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_payments"
[0m10:56:14.291064 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_payments
[0m10:56:14.320883 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_payments"
[0m10:56:14.322863 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_payments"
[0m10:56:14.322863 [debug] [Thread-1 (]: On model.dbt_first.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_payments"} */
create or replace   view customer_orders.PUBLIC_staging.stg_payments
  
   as (
    
select * from MYDB.PUBLIC_PUBLIC.stripe_payments
  );
[0m10:56:14.323850 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:56:15.759371 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bae865-0004-b9a2-0005-a3d30002d1a2
[0m10:56:15.759371 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'MYDB.PUBLIC_PUBLIC' does not exist or not authorized.
[0m10:56:15.775493 [debug] [Thread-1 (]: Database Error in model stg_payments (models\Staging\stg_payments.sql)
  002003 (02000): SQL compilation error:
  Schema 'MYDB.PUBLIC_PUBLIC' does not exist or not authorized.
  compiled code at target\run\dbt_first\models\Staging\stg_payments.sql
[0m10:56:15.775493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6759a836-ec18-4a3b-8275-c52d16281341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB549E0B30>]}
[0m10:56:15.775493 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model customer_orders.PUBLIC_staging.stg_payments  [[31mERROR[0m in 1.50s]
[0m10:56:15.791148 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_payments
[0m10:56:15.791148 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.stg_payments' to be skipped because of status 'error'.  Reason: Database Error in model stg_payments (models\Staging\stg_payments.sql)
  002003 (02000): SQL compilation error:
  Schema 'MYDB.PUBLIC_PUBLIC' does not exist or not authorized.
  compiled code at target\run\dbt_first\models\Staging\stg_payments.sql.
[0m10:56:15.791148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:15.791148 [debug] [MainThread]: Connection 'list_customer_orders' was left open.
[0m10:56:15.791148 [debug] [MainThread]: On list_customer_orders: Close
[0m10:56:16.313620 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC_PUBLIC' was left open.
[0m10:56:16.313620 [debug] [MainThread]: On list_MYDB_PUBLIC_PUBLIC: Close
[0m10:56:16.844475 [debug] [MainThread]: Connection 'model.dbt_first.stg_payments' was left open.
[0m10:56:16.844475 [debug] [MainThread]: On model.dbt_first.stg_payments: Close
[0m10:56:17.360473 [info ] [MainThread]: 
[0m10:56:17.360473 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.63 seconds (6.63s).
[0m10:56:17.360473 [debug] [MainThread]: Command end result
[0m10:56:17.391889 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:56:17.393926 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:56:17.394927 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:56:17.394927 [info ] [MainThread]: 
[0m10:56:17.394927 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:56:17.394927 [info ] [MainThread]: 
[0m10:56:17.394927 [error] [MainThread]:   Database Error in model stg_payments (models\Staging\stg_payments.sql)
  002003 (02000): SQL compilation error:
  Schema 'MYDB.PUBLIC_PUBLIC' does not exist or not authorized.
  compiled code at target\run\dbt_first\models\Staging\stg_payments.sql
[0m10:56:17.394927 [info ] [MainThread]: 
[0m10:56:17.394927 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:56:17.404272 [debug] [MainThread]: Command `dbt run` failed at 10:56:17.404272 after 7.94 seconds
[0m10:56:17.405281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB55368770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB55F31F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB551E2570>]}
[0m10:56:17.405281 [debug] [MainThread]: Flushing usage events
[0m10:56:18.378200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:00:10.376714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297E0C57E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297DE7E8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297E0C57CE0>]}


============================== 11:00:10.381905 | 419ee3f1-8b7f-462e-8d8d-65e29feb653d ==============================
[0m11:00:10.381905 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:00:10.381905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:pay', 'send_anonymous_usage_stats': 'True'}
[0m11:00:10.815027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '419ee3f1-8b7f-462e-8d8d-65e29feb653d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297E1973260>]}
[0m11:00:10.862666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '419ee3f1-8b7f-462e-8d8d-65e29feb653d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297DE04E9C0>]}
[0m11:00:10.862666 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:00:11.174228 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:00:11.349144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m11:00:11.349144 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Staging\sources.yml
[0m11:00:11.349144 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Staging\stg_orders.sql
[0m11:00:11.349144 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Staging\stg_customers.sql
[0m11:00:11.349144 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Staging\stg_payments.sql
[0m11:00:11.697524 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_first.Mart
[0m11:00:11.701939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '419ee3f1-8b7f-462e-8d8d-65e29feb653d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297E2DD38F0>]}
[0m11:00:11.787654 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:00:11.790660 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:00:11.816157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '419ee3f1-8b7f-462e-8d8d-65e29feb653d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297E2C674D0>]}
[0m11:00:11.816157 [info ] [MainThread]: Found 1 seed, 3 models, 3 sources, 474 macros
[0m11:00:11.816157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '419ee3f1-8b7f-462e-8d8d-65e29feb653d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297E1753140>]}
[0m11:00:11.816157 [info ] [MainThread]: 
[0m11:00:11.820037 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:00:11.820037 [info ] [MainThread]: 
[0m11:00:11.820037 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:00:11.820037 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders'
[0m11:00:11.906322 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m11:00:11.906322 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m11:00:11.906322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:13.648726 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.752 seconds
[0m11:00:13.648726 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_PUBLIC_staging'
[0m11:00:13.672868 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_PUBLIC_staging"
[0m11:00:13.672868 [debug] [ThreadPool]: On list_customer_orders_PUBLIC_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_PUBLIC_staging"} */
show objects in customer_orders.PUBLIC_staging limit 10000;
[0m11:00:13.672868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:15.185763 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.521 seconds
[0m11:00:15.195898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_PUBLIC_staging, now list_MYDB_PUBLIC_PUBLIC)
[0m11:00:15.197905 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC_PUBLIC"
[0m11:00:15.197905 [debug] [ThreadPool]: On list_MYDB_PUBLIC_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC_PUBLIC"} */
show objects in MYDB.PUBLIC_PUBLIC limit 10000;
[0m11:00:15.605142 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bae869-0004-b9a2-0005-a3d30002d1a6
[0m11:00:15.605142 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:00:15.605142 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:00:15.605142 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:00:15.605142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '419ee3f1-8b7f-462e-8d8d-65e29feb653d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297E35361E0>]}
[0m11:00:15.605142 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_payments
[0m11:00:15.621237 [info ] [Thread-1 (]: 1 of 1 START sql view model customer_orders.PUBLIC_staging.stg_payments ........ [RUN]
[0m11:00:15.621237 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_payments'
[0m11:00:15.621237 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_payments
[0m11:00:15.630395 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_payments"
[0m11:00:15.630395 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_payments
[0m11:00:15.658671 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_payments"
[0m11:00:15.658671 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_payments"
[0m11:00:15.658671 [debug] [Thread-1 (]: On model.dbt_first.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_payments"} */
create or replace   view customer_orders.PUBLIC_staging.stg_payments
  
   as (
    

select * from MYDB.PUBLIC.STRIPE_PAYMENTS
  );
[0m11:00:15.658671 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:00:17.222049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.567 seconds
[0m11:00:17.238205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '419ee3f1-8b7f-462e-8d8d-65e29feb653d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297E0150980>]}
[0m11:00:17.238205 [info ] [Thread-1 (]: 1 of 1 OK created sql view model customer_orders.PUBLIC_staging.stg_payments ... [[32mSUCCESS 1[0m in 1.62s]
[0m11:00:17.238205 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_payments
[0m11:00:17.253926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:17.253926 [debug] [MainThread]: Connection 'list_customer_orders' was left open.
[0m11:00:17.253926 [debug] [MainThread]: On list_customer_orders: Close
[0m11:00:17.753281 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC_PUBLIC' was left open.
[0m11:00:17.753281 [debug] [MainThread]: On list_MYDB_PUBLIC_PUBLIC: Close
[0m11:00:18.254948 [debug] [MainThread]: Connection 'model.dbt_first.stg_payments' was left open.
[0m11:00:18.254948 [debug] [MainThread]: On model.dbt_first.stg_payments: Close
[0m11:00:18.803679 [info ] [MainThread]: 
[0m11:00:18.803679 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.98 seconds (6.98s).
[0m11:00:18.803679 [debug] [MainThread]: Command end result
[0m11:00:18.828685 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:00:18.831681 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:00:18.837724 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:00:18.837724 [info ] [MainThread]: 
[0m11:00:18.837724 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:00:18.837724 [info ] [MainThread]: 
[0m11:00:18.837724 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:00:18.837724 [debug] [MainThread]: Command `dbt run` succeeded at 11:00:18.837724 after 8.69 seconds
[0m11:00:18.837724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297DE30C6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297E0B43AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297E2F40680>]}
[0m11:00:18.837724 [debug] [MainThread]: Flushing usage events
[0m11:00:19.826075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:08:19.833387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F4BE25A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F4FDC5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F4FDCBC0>]}


============================== 11:08:19.843529 | dad39c44-f9f2-468f-bec6-654fbb7611c4 ==============================
[0m11:08:19.843529 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:08:19.843529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:08:20.375966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dad39c44-f9f2-468f-bec6-654fbb7611c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F5025F10>]}
[0m11:08:20.438805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dad39c44-f9f2-468f-bec6-654fbb7611c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F1869220>]}
[0m11:08:20.438805 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:08:20.855455 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:08:22.148343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m11:08:22.148343 [debug] [MainThread]: Partial parsing: added file: dbt_first://macros\currency_conv.sql
[0m11:08:22.148343 [debug] [MainThread]: Partial parsing: added file: dbt_first://macros\generate_schema.sql
[0m11:08:22.151855 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m11:08:23.339376 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_first.Mart
[0m11:08:23.352734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dad39c44-f9f2-468f-bec6-654fbb7611c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F73821E0>]}
[0m11:08:23.425431 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:08:23.427433 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:08:23.466436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dad39c44-f9f2-468f-bec6-654fbb7611c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F7135D00>]}
[0m11:08:23.466436 [info ] [MainThread]: Found 3 models, 1 seed, 3 sources, 476 macros
[0m11:08:23.466436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dad39c44-f9f2-468f-bec6-654fbb7611c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F73F06E0>]}
[0m11:08:23.470466 [info ] [MainThread]: 
[0m11:08:23.470466 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:08:23.470466 [info ] [MainThread]: 
[0m11:08:23.470466 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:08:23.476944 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MYDB_PUBLIC'
[0m11:08:26.166788 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m11:08:26.172233 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m11:08:26.172233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:27.934710 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.767 seconds
[0m11:08:27.934710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MYDB_PUBLIC, now list_customer_orders_staging)
[0m11:08:27.934710 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m11:08:27.934710 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m11:08:28.369820 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bae871-0004-b883-0005-a3d30002c206
[0m11:08:28.369820 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:08:28.369820 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:08:28.369820 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:08:28.369820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dad39c44-f9f2-468f-bec6-654fbb7611c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F243FA40>]}
[0m11:08:28.369820 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m11:08:28.369820 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m11:08:28.369820 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m11:08:28.385649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m11:08:28.385649 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m11:08:28.385649 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m11:08:28.385649 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_orders
[0m11:08:28.385649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_orders)
[0m11:08:28.385649 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_orders
[0m11:08:28.385649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_orders"
[0m11:08:28.385649 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_orders
[0m11:08:28.385649 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_orders
[0m11:08:28.385649 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_payments
[0m11:08:28.385649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_orders, now model.dbt_first.stg_payments)
[0m11:08:28.385649 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_payments
[0m11:08:28.385649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_payments"
[0m11:08:28.385649 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_payments
[0m11:08:28.385649 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_payments
[0m11:08:28.385649 [debug] [Thread-1 (]: Began running node seed.dbt_first.stripe_payments
[0m11:08:28.385649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_payments, now seed.dbt_first.stripe_payments)
[0m11:08:28.401774 [debug] [Thread-1 (]: Began compiling node seed.dbt_first.stripe_payments
[0m11:08:28.401774 [debug] [Thread-1 (]: Began executing node seed.dbt_first.stripe_payments
[0m11:08:28.401774 [debug] [Thread-1 (]: Finished running node seed.dbt_first.stripe_payments
[0m11:08:28.401774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:28.401774 [debug] [MainThread]: Connection 'list_customer_orders_staging' was left open.
[0m11:08:28.401774 [debug] [MainThread]: On list_customer_orders_staging: Close
[0m11:08:28.905581 [debug] [MainThread]: Connection 'seed.dbt_first.stripe_payments' was properly closed.
[0m11:08:28.905581 [debug] [MainThread]: Command end result
[0m11:08:28.937475 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:08:28.937475 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:08:28.937475 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:08:28.937475 [debug] [MainThread]: Command `dbt compile` succeeded at 11:08:28.937475 after 9.36 seconds
[0m11:08:28.937475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F4FB7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F3F4FE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6F7231850>]}
[0m11:08:28.937475 [debug] [MainThread]: Flushing usage events
[0m11:08:30.052888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:08:38.533533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80C62ACC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E809BE10D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80C62B560>]}


============================== 11:08:38.537542 | bf70ad25-79be-4392-ba1e-8f19bd8b550d ==============================
[0m11:08:38.537542 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:08:38.537542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:08:38.961336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf70ad25-79be-4392-ba1e-8f19bd8b550d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80D075FA0>]}
[0m11:08:39.013600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf70ad25-79be-4392-ba1e-8f19bd8b550d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80D2B3D40>]}
[0m11:08:39.013600 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:08:39.323798 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:08:39.466141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:08:39.482080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:08:39.482080 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_first.Mart
[0m11:08:39.526224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf70ad25-79be-4392-ba1e-8f19bd8b550d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80D276BD0>]}
[0m11:08:39.591531 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:08:39.591531 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:08:39.622802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf70ad25-79be-4392-ba1e-8f19bd8b550d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80E5F7C20>]}
[0m11:08:39.622802 [info ] [MainThread]: Found 3 models, 1 seed, 3 sources, 476 macros
[0m11:08:39.622802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf70ad25-79be-4392-ba1e-8f19bd8b550d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80E3F6F00>]}
[0m11:08:39.631469 [info ] [MainThread]: 
[0m11:08:39.631469 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:08:39.631469 [info ] [MainThread]: 
[0m11:08:39.631469 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:08:39.637483 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders'
[0m11:08:39.722225 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m11:08:39.722225 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m11:08:39.722225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:41.244023 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.523 seconds
[0m11:08:41.246032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders, now create_customer_orders_staging)
[0m11:08:41.246032 [debug] [ThreadPool]: Creating schema "database: "customer_orders"
schema: "staging"
"
[0m11:08:41.251273 [debug] [ThreadPool]: Using snowflake connection "create_customer_orders_staging"
[0m11:08:41.253279 [debug] [ThreadPool]: On create_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "create_customer_orders_staging"} */
create schema if not exists customer_orders.staging
[0m11:08:41.539854 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.294 seconds
[0m11:08:41.539854 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_staging'
[0m11:08:41.555762 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m11:08:41.555762 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m11:08:41.555762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:43.125113 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.573 seconds
[0m11:08:43.125113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_staging, now list_MYDB_PUBLIC)
[0m11:08:43.125113 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m11:08:43.125113 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m11:08:43.530262 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.402 seconds
[0m11:08:43.530262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf70ad25-79be-4392-ba1e-8f19bd8b550d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E809A5F680>]}
[0m11:08:43.546356 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m11:08:43.546356 [info ] [Thread-1 (]: 1 of 3 START sql view model customer_orders.staging.stg_customers .............. [RUN]
[0m11:08:43.546356 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m11:08:43.546356 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m11:08:43.557494 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m11:08:43.557494 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m11:08:43.580492 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_customers"
[0m11:08:43.580492 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_customers"
[0m11:08:43.580492 [debug] [Thread-1 (]: On model.dbt_first.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_customers"} */
create or replace   view customer_orders.staging.stg_customers
  
   as (
    

select * from MYDB.PUBLIC.STG_CUSTOMERS
  );
[0m11:08:43.580492 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:08:45.199595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.615 seconds
[0m11:08:45.212465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf70ad25-79be-4392-ba1e-8f19bd8b550d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8099CDA30>]}
[0m11:08:45.212465 [info ] [Thread-1 (]: 1 of 3 OK created sql view model customer_orders.staging.stg_customers ......... [[32mSUCCESS 1[0m in 1.67s]
[0m11:08:45.212465 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m11:08:45.212465 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_orders
[0m11:08:45.228287 [info ] [Thread-1 (]: 2 of 3 START sql view model customer_orders.staging.stg_orders ................. [RUN]
[0m11:08:45.228890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_orders)
[0m11:08:45.228890 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_orders
[0m11:08:45.228890 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_orders"
[0m11:08:45.228890 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_orders
[0m11:08:45.228890 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_orders"
[0m11:08:45.228890 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_orders"
[0m11:08:45.228890 [debug] [Thread-1 (]: On model.dbt_first.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_orders"} */
create or replace   view customer_orders.staging.stg_orders
  
   as (
    

select * from MYDB.PUBLIC.STG_ORDERS
  );
[0m11:08:45.651562 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.423 seconds
[0m11:08:45.651562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf70ad25-79be-4392-ba1e-8f19bd8b550d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80EEA3770>]}
[0m11:08:45.665000 [info ] [Thread-1 (]: 2 of 3 OK created sql view model customer_orders.staging.stg_orders ............ [[32mSUCCESS 1[0m in 0.42s]
[0m11:08:45.665000 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_orders
[0m11:08:45.665000 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_payments
[0m11:08:45.665000 [info ] [Thread-1 (]: 3 of 3 START sql view model customer_orders.staging.stg_payments ............... [RUN]
[0m11:08:45.665000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_orders, now model.dbt_first.stg_payments)
[0m11:08:45.665000 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_payments
[0m11:08:45.665000 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_payments"
[0m11:08:45.665000 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_payments
[0m11:08:45.665000 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_payments"
[0m11:08:45.665000 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_payments"
[0m11:08:45.665000 [debug] [Thread-1 (]: On model.dbt_first.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_payments"} */
create or replace   view customer_orders.staging.stg_payments
  
   as (
    

select * from MYDB.PUBLIC.STRIPE_PAYMENTS
  );
[0m11:08:46.219974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m11:08:46.219974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf70ad25-79be-4392-ba1e-8f19bd8b550d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80EE96F30>]}
[0m11:08:46.219974 [info ] [Thread-1 (]: 3 of 3 OK created sql view model customer_orders.staging.stg_payments .......... [[32mSUCCESS 1[0m in 0.55s]
[0m11:08:46.219974 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_payments
[0m11:08:46.219974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:46.219974 [debug] [MainThread]: Connection 'create_customer_orders_staging' was left open.
[0m11:08:46.219974 [debug] [MainThread]: On create_customer_orders_staging: Close
[0m11:08:46.732922 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m11:08:46.732922 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m11:08:47.266049 [debug] [MainThread]: Connection 'model.dbt_first.stg_payments' was left open.
[0m11:08:47.269665 [debug] [MainThread]: On model.dbt_first.stg_payments: Close
[0m11:08:47.789323 [info ] [MainThread]: 
[0m11:08:47.789323 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 8.16 seconds (8.16s).
[0m11:08:47.789323 [debug] [MainThread]: Command end result
[0m11:08:47.806484 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:08:47.817777 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:08:47.825250 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:08:47.825250 [info ] [MainThread]: 
[0m11:08:47.825250 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:08:47.825250 [info ] [MainThread]: 
[0m11:08:47.825250 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:08:47.825250 [debug] [MainThread]: Command `dbt run` succeeded at 11:08:47.825250 after 9.46 seconds
[0m11:08:47.825250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E808FCF050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80A3CF140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E80A3CE450>]}
[0m11:08:47.825250 [debug] [MainThread]: Flushing usage events
[0m11:08:48.834620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:10:25.955331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95E0B0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95D9D3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95E0B2270>]}


============================== 11:10:25.959358 | e147e4b6-8edf-4b8f-b2ec-3f5b4a1eec09 ==============================
[0m11:10:25.959358 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:10:25.960337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:10:26.387362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e147e4b6-8edf-4b8f-b2ec-3f5b4a1eec09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95D7216A0>]}
[0m11:10:26.434734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e147e4b6-8edf-4b8f-b2ec-3f5b4a1eec09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95EDF4E30>]}
[0m11:10:26.450804 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:10:26.770976 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:10:26.857938 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:10:26.857938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e147e4b6-8edf-4b8f-b2ec-3f5b4a1eec09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95DD26FF0>]}
[0m11:10:28.124577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e147e4b6-8edf-4b8f-b2ec-3f5b4a1eec09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F960474320>]}
[0m11:10:28.197977 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:10:28.201012 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:10:28.227710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e147e4b6-8edf-4b8f-b2ec-3f5b4a1eec09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F96055BD10>]}
[0m11:10:28.228738 [info ] [MainThread]: Found 4 models, 1 seed, 3 sources, 476 macros
[0m11:10:28.228738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e147e4b6-8edf-4b8f-b2ec-3f5b4a1eec09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9604827E0>]}
[0m11:10:28.230738 [info ] [MainThread]: 
[0m11:10:28.231712 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:10:28.231712 [info ] [MainThread]: 
[0m11:10:28.232728 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:10:28.233738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MYDB'
[0m11:10:28.307733 [debug] [ThreadPool]: Using snowflake connection "list_MYDB"
[0m11:10:28.307733 [debug] [ThreadPool]: On list_MYDB: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB"} */
show terse schemas in database MYDB
    limit 10000
[0m11:10:28.307733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:29.913488 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.597 seconds
[0m11:10:29.917283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_staging'
[0m11:10:29.917283 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m11:10:29.917283 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m11:10:29.917283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:31.470350 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.544 seconds
[0m11:10:31.470350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_staging, now list_customer_orders_mart)
[0m11:10:31.470350 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m11:10:31.470350 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m11:10:31.778646 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bae873-0004-b885-0005-a3d30002a20a
[0m11:10:31.778646 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:10:31.778646 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:10:31.778646 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:10:31.778646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_mart, now list_MYDB_PUBLIC)
[0m11:10:31.778646 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m11:10:31.778646 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m11:10:32.133814 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.354 seconds
[0m11:10:32.133814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e147e4b6-8edf-4b8f-b2ec-3f5b4a1eec09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95EEDA7B0>]}
[0m11:10:32.133814 [debug] [Thread-1 (]: Began running node seed.dbt_first.stripe_payments
[0m11:10:32.133814 [info ] [Thread-1 (]: 1 of 1 START seed file PUBLIC.stripe_payments .................................. [RUN]
[0m11:10:32.133814 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.dbt_first.stripe_payments'
[0m11:10:32.133814 [debug] [Thread-1 (]: Began compiling node seed.dbt_first.stripe_payments
[0m11:10:32.133814 [debug] [Thread-1 (]: Began executing node seed.dbt_first.stripe_payments
[0m11:10:32.192003 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.stripe_payments"
[0m11:10:32.193004 [debug] [Thread-1 (]: On seed.dbt_first.stripe_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.stripe_payments"} */
BEGIN
[0m11:10:32.193004 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:10:33.605390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.427 seconds
[0m11:10:33.621385 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.stripe_payments"
[0m11:10:33.621385 [debug] [Thread-1 (]: On seed.dbt_first.stripe_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.stripe_payments"} */
truncate table "MYDB"."PUBLIC"."STRIPE_PAYMENTS"
  ;
[0m11:10:34.058440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.433 seconds
[0m11:10:34.058440 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.stripe_payments"
[0m11:10:34.058440 [debug] [Thread-1 (]: On seed.dbt_first.stripe_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.stripe_payments"} */
COMMIT
[0m11:10:34.558743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.498 seconds
[0m11:10:34.574425 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.stripe_payments"
[0m11:10:34.574425 [debug] [Thread-1 (]: On seed.dbt_first.stripe_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.stripe_payments"} */
BEGIN
[0m11:10:35.207960 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.633 seconds
[0m11:10:35.212070 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.stripe_payments"
[0m11:10:35.212846 [debug] [Thread-1 (]: On seed.dbt_first.stripe_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.stripe_payments"} */
insert into MYDB.PUBLIC.stripe_payments (ID, ORDERID, PAYMENTMETHOD, STATUS, AMOUNT, CREATED) values
            (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s...
[0m11:10:36.076972 [debug] [Thread-1 (]: SQL status: SUCCESS 120 in 0.864 seconds
[0m11:10:36.079305 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.stripe_payments"
[0m11:10:36.079305 [debug] [Thread-1 (]: On seed.dbt_first.stripe_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.stripe_payments"} */
COMMIT
[0m11:10:36.630403 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m11:10:36.637950 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_first.stripe_payments"
[0m11:10:36.659755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e147e4b6-8edf-4b8f-b2ec-3f5b4a1eec09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95B58DA00>]}
[0m11:10:36.659755 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file PUBLIC.stripe_payments .............................. [[32mINSERT 120[0m in 4.52s]
[0m11:10:36.659755 [debug] [Thread-1 (]: Finished running node seed.dbt_first.stripe_payments
[0m11:10:36.659755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:36.659755 [debug] [MainThread]: Connection 'list_MYDB' was left open.
[0m11:10:36.659755 [debug] [MainThread]: On list_MYDB: Close
[0m11:10:37.172899 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m11:10:37.172899 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m11:10:37.714868 [debug] [MainThread]: Connection 'seed.dbt_first.stripe_payments' was left open.
[0m11:10:37.715864 [debug] [MainThread]: On seed.dbt_first.stripe_payments: Close
[0m11:10:38.234009 [info ] [MainThread]: 
[0m11:10:38.234974 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.00 seconds (10.00s).
[0m11:10:38.236228 [debug] [MainThread]: Command end result
[0m11:10:38.257272 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:10:38.259269 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:10:38.265684 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:10:38.265684 [info ] [MainThread]: 
[0m11:10:38.265684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:38.265684 [info ] [MainThread]: 
[0m11:10:38.265684 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:10:38.265684 [debug] [MainThread]: Command `dbt seed` succeeded at 11:10:38.265684 after 12.52 seconds
[0m11:10:38.265684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95E1BC0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95DCFE210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9605BB620>]}
[0m11:10:38.265684 [debug] [MainThread]: Flushing usage events
[0m11:10:39.230320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:17:43.395004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E278DAF9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2769FF3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2769FFE00>]}


============================== 11:17:43.395004 | c6eba7cc-5dc6-4d71-8e8d-1f909149d4a8 ==============================
[0m11:17:43.395004 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:17:43.395004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile -m mart_payments', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:17:43.834030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6eba7cc-5dc6-4d71-8e8d-1f909149d4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2797A7500>]}
[0m11:17:43.881632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6eba7cc-5dc6-4d71-8e8d-1f909149d4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E279AE3C50>]}
[0m11:17:43.881632 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:17:44.195313 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:17:44.298164 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:17:44.298164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c6eba7cc-5dc6-4d71-8e8d-1f909149d4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27AEB62D0>]}
[0m11:17:45.576343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6eba7cc-5dc6-4d71-8e8d-1f909149d4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27AED19A0>]}
[0m11:17:45.636466 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:17:45.652422 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:17:45.668408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6eba7cc-5dc6-4d71-8e8d-1f909149d4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27B072FF0>]}
[0m11:17:45.668408 [info ] [MainThread]: Found 4 models, 1 seed, 3 sources, 476 macros
[0m11:17:45.668408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6eba7cc-5dc6-4d71-8e8d-1f909149d4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27AE3B9E0>]}
[0m11:17:45.668408 [info ] [MainThread]: 
[0m11:17:45.668408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:17:45.668408 [info ] [MainThread]: 
[0m11:17:45.668408 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:17:45.687448 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_staging'
[0m11:17:45.773887 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m11:17:45.773887 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m11:17:45.774886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:47.529826 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.755 seconds
[0m11:17:47.532266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_staging, now list_customer_orders_mart)
[0m11:17:47.534265 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m11:17:47.535265 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m11:17:47.843292 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bae87a-0004-b881-0005-a3d30002b23a
[0m11:17:47.843292 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m11:17:47.845298 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m11:17:47.845298 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m11:17:47.845298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_mart, now list_MYDB_PUBLIC)
[0m11:17:47.847305 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m11:17:47.847305 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m11:17:48.161027 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.320 seconds
[0m11:17:48.169548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6eba7cc-5dc6-4d71-8e8d-1f909149d4a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E27B19A270>]}
[0m11:17:48.176729 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m11:17:48.176729 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.mart_payments'
[0m11:17:48.176729 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m11:17:48.176729 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m11:17:48.176729 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m11:17:48.176729 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m11:17:48.176729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:48.176729 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m11:17:48.176729 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m11:17:48.709057 [debug] [MainThread]: Connection 'model.dbt_first.mart_payments' was properly closed.
[0m11:17:48.709057 [debug] [MainThread]: Command end result
[0m11:17:48.738354 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:17:48.740901 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:17:48.740901 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:17:48.740901 [info ] [MainThread]: Compiled node 'mart_payments' is:


select 
    (AMOUNT / 83)::numeric(16, 2)
 as amount_usd from customer_orders.staging.stg_payments
[0m11:17:48.740901 [debug] [MainThread]: Command `dbt compile` succeeded at 11:17:48.740901 after 5.57 seconds
[0m11:17:48.740901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E278C6F6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E278D7C2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E277E36540>]}
[0m11:17:48.740901 [debug] [MainThread]: Flushing usage events
[0m11:17:49.776927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:01.734461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811B06EA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281188A42F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811AB37F20>]}


============================== 11:18:01.734461 | 987471ab-6d62-4e57-9893-b50622d0978c ==============================
[0m11:18:01.734461 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:18:01.734461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_payments', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:18:02.173291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '987471ab-6d62-4e57-9893-b50622d0978c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811D44C4A0>]}
[0m11:18:02.221734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '987471ab-6d62-4e57-9893-b50622d0978c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811D425FA0>]}
[0m11:18:02.236353 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:18:02.526518 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:18:02.684842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:18:02.684842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:18:02.716902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '987471ab-6d62-4e57-9893-b50622d0978c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811ABE23F0>]}
[0m11:18:02.805071 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:18:02.805071 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:18:02.837509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '987471ab-6d62-4e57-9893-b50622d0978c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811D831160>]}
[0m11:18:02.837509 [info ] [MainThread]: Found 4 models, 1 seed, 3 sources, 476 macros
[0m11:18:02.837509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '987471ab-6d62-4e57-9893-b50622d0978c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811D631A00>]}
[0m11:18:02.837509 [info ] [MainThread]: 
[0m11:18:02.837509 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:18:02.837509 [info ] [MainThread]: 
[0m11:18:02.837509 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:18:02.837509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders'
[0m11:18:02.929278 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m11:18:02.929278 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m11:18:02.929278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:04.544198 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.627 seconds
[0m11:18:04.560074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders, now create_customer_orders_mart)
[0m11:18:04.560074 [debug] [ThreadPool]: Creating schema "database: "customer_orders"
schema: "mart"
"
[0m11:18:04.575762 [debug] [ThreadPool]: Using snowflake connection "create_customer_orders_mart"
[0m11:18:04.575762 [debug] [ThreadPool]: On create_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "create_customer_orders_mart"} */
create schema if not exists customer_orders.mart
[0m11:18:04.888745 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.313 seconds
[0m11:18:04.888745 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_mart'
[0m11:18:04.903916 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m11:18:04.903916 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m11:18:04.903916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:06.324258 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.425 seconds
[0m11:18:06.334696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_mart, now list_customer_orders_staging)
[0m11:18:06.336703 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m11:18:06.336703 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m11:18:06.625584 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.293 seconds
[0m11:18:06.625584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_staging, now list_MYDB_PUBLIC)
[0m11:18:06.625584 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m11:18:06.625584 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m11:18:06.974550 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.343 seconds
[0m11:18:06.974550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '987471ab-6d62-4e57-9893-b50622d0978c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811C3968D0>]}
[0m11:18:06.974550 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m11:18:06.974550 [info ] [Thread-1 (]: 1 of 1 START sql table model customer_orders.mart.mart_payments ................ [RUN]
[0m11:18:06.974550 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.mart_payments'
[0m11:18:06.974550 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m11:18:06.997227 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m11:18:06.998227 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m11:18:07.030487 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.mart_payments"
[0m11:18:07.032493 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.mart_payments"
[0m11:18:07.032493 [debug] [Thread-1 (]: On model.dbt_first.mart_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.mart_payments"} */
create or replace transient table customer_orders.mart.mart_payments
         as
        (

select 
    (AMOUNT / 83)::numeric(16, 2)
 as amount_usd from customer_orders.staging.stg_payments
        );
[0m11:18:07.032493 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:18:09.303851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.272 seconds
[0m11:18:09.319724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '987471ab-6d62-4e57-9893-b50622d0978c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811AB50B00>]}
[0m11:18:09.319724 [info ] [Thread-1 (]: 1 of 1 OK created sql table model customer_orders.mart.mart_payments ........... [[32mSUCCESS 1[0m in 2.35s]
[0m11:18:09.328651 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m11:18:09.328651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:09.328651 [debug] [MainThread]: Connection 'create_customer_orders_mart' was left open.
[0m11:18:09.328651 [debug] [MainThread]: On create_customer_orders_mart: Close
[0m11:18:09.846945 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m11:18:09.846945 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m11:18:10.363713 [debug] [MainThread]: Connection 'model.dbt_first.mart_payments' was left open.
[0m11:18:10.363713 [debug] [MainThread]: On model.dbt_first.mart_payments: Close
[0m11:18:10.919429 [info ] [MainThread]: 
[0m11:18:10.919429 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.08 seconds (8.08s).
[0m11:18:10.919429 [debug] [MainThread]: Command end result
[0m11:18:10.952996 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:18:10.955029 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:18:10.956029 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:18:10.961632 [info ] [MainThread]: 
[0m11:18:10.962662 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:10.963645 [info ] [MainThread]: 
[0m11:18:10.964673 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:18:10.965641 [debug] [MainThread]: Command `dbt run` succeeded at 11:18:10.965641 after 9.39 seconds
[0m11:18:10.965641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811B06EA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811B67D0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002811B67CFB0>]}
[0m11:18:10.966687 [debug] [MainThread]: Flushing usage events
[0m11:18:12.055089 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:54.349308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33A10D2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33A10D430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33A10C350>]}


============================== 11:47:54.349308 | 5ce18c23-e90b-44f3-aa23-571fc138f61d ==============================
[0m11:47:54.349308 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:47:54.349308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile -m mart_payments', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:47:54.884714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ce18c23-e90b-44f3-aa23-571fc138f61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33A3183E0>]}
[0m11:47:54.933683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ce18c23-e90b-44f3-aa23-571fc138f61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33AD81730>]}
[0m11:47:54.933683 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:47:55.399179 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:47:56.717908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:47:56.717908 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\mart_payments.sql
[0m11:47:56.988123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ce18c23-e90b-44f3-aa23-571fc138f61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33C341A90>]}
[0m11:47:57.052683 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:47:57.078425 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:47:57.104806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ce18c23-e90b-44f3-aa23-571fc138f61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33C157050>]}
[0m11:47:57.104806 [info ] [MainThread]: Found 4 models, 1 seed, 3 sources, 476 macros
[0m11:47:57.105809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ce18c23-e90b-44f3-aa23-571fc138f61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33C309A00>]}
[0m11:47:57.106808 [info ] [MainThread]: 
[0m11:47:57.106808 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:47:57.107808 [info ] [MainThread]: 
[0m11:47:57.107808 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:47:57.112808 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_mart'
[0m11:47:59.838667 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m11:47:59.845143 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m11:47:59.845143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:01.642006 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.799 seconds
[0m11:48:01.642006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_mart, now list_customer_orders_staging)
[0m11:48:01.642006 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m11:48:01.642006 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m11:48:01.945051 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.302 seconds
[0m11:48:01.945051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_staging, now list_MYDB_PUBLIC)
[0m11:48:01.945051 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m11:48:01.945051 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m11:48:02.253893 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.307 seconds
[0m11:48:02.269851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ce18c23-e90b-44f3-aa23-571fc138f61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33AE12A50>]}
[0m11:48:02.333050 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m11:48:02.333050 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.mart_payments'
[0m11:48:02.333050 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m11:48:02.344352 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m11:48:02.348798 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m11:48:02.348798 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m11:48:02.348798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:02.348798 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m11:48:02.348798 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m11:48:02.885041 [debug] [MainThread]: Connection 'model.dbt_first.mart_payments' was properly closed.
[0m11:48:02.885041 [debug] [MainThread]: Command end result
[0m11:48:02.904843 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:48:02.908871 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:48:02.911253 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:48:02.916796 [info ] [MainThread]: Compiled node 'mart_payments' is:


select first_name, order_date, paymentmethod, 
    (AMOUNT / 83)::numeric(16, 2)
 as amount_usd from customer_orders.staging.stg_payments join customer_orders.staging.stg_customers using (CUSTOMER_ID) join customer_orders.staging.stg_orders using (ORDER_ID)
[0m11:48:02.916796 [debug] [MainThread]: Command `dbt compile` succeeded at 11:48:02.916796 after 8.77 seconds
[0m11:48:02.916796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E339C0DF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3395E07A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3395E1310>]}
[0m11:48:02.916796 [debug] [MainThread]: Flushing usage events
[0m11:48:03.947036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:48:34.034416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E24A7980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E24A6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E24A7DD0>]}


============================== 11:48:34.034416 | 8370aadb-9736-4660-b978-03e5fa79e86d ==============================
[0m11:48:34.034416 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:48:34.050128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_payments', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:48:34.473826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8370aadb-9736-4660-b978-03e5fa79e86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E2B6CB00>]}
[0m11:48:34.537400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8370aadb-9736-4660-b978-03e5fa79e86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E2BAC170>]}
[0m11:48:34.537400 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:48:34.897557 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:48:35.071259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:35.071259 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:35.118441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8370aadb-9736-4660-b978-03e5fa79e86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E28322D0>]}
[0m11:48:35.193911 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:48:35.197666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:48:35.211368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8370aadb-9736-4660-b978-03e5fa79e86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E4B610D0>]}
[0m11:48:35.211368 [info ] [MainThread]: Found 4 models, 1 seed, 3 sources, 476 macros
[0m11:48:35.211368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8370aadb-9736-4660-b978-03e5fa79e86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E37E58B0>]}
[0m11:48:35.211368 [info ] [MainThread]: 
[0m11:48:35.227422 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:35.227762 [info ] [MainThread]: 
[0m11:48:35.227762 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:48:35.227762 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders'
[0m11:48:35.314812 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m11:48:35.314812 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m11:48:35.314812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:37.003949 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.690 seconds
[0m11:48:37.008881 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MYDB_PUBLIC'
[0m11:48:37.019628 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m11:48:37.019628 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m11:48:37.019628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:38.426652 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.412 seconds
[0m11:48:38.426652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MYDB_PUBLIC, now list_customer_orders_mart)
[0m11:48:38.426652 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m11:48:38.426652 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m11:48:38.717533 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.287 seconds
[0m11:48:38.717533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_mart, now list_customer_orders_staging)
[0m11:48:38.717533 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m11:48:38.717533 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m11:48:39.024070 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.301 seconds
[0m11:48:39.024070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8370aadb-9736-4660-b978-03e5fa79e86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E36A4E30>]}
[0m11:48:39.024070 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m11:48:39.024070 [info ] [Thread-1 (]: 1 of 1 START sql table model customer_orders.mart.mart_payments ................ [RUN]
[0m11:48:39.024070 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.mart_payments'
[0m11:48:39.024070 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m11:48:39.048205 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m11:48:39.048205 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m11:48:39.077421 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.mart_payments"
[0m11:48:39.077421 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.mart_payments"
[0m11:48:39.077421 [debug] [Thread-1 (]: On model.dbt_first.mart_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.mart_payments"} */
create or replace transient table customer_orders.mart.mart_payments
         as
        (

select first_name, order_date, paymentmethod, 
    (AMOUNT / 83)::numeric(16, 2)
 as amount_usd from customer_orders.staging.stg_payments join customer_orders.staging.stg_customers using (CUSTOMER_ID) join customer_orders.staging.stg_orders using (ORDER_ID)
        );
[0m11:48:39.077421 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:48:40.772745 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bae899-0004-b882-0005-a3d3000292ce
[0m11:48:40.772745 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002004 (42601): SQL compilation error:
Invalid identifier CUSTOMER_ID
[0m11:48:40.785241 [debug] [Thread-1 (]: Database Error in model mart_payments (models\Mart\mart_payments.sql)
  002004 (42601): SQL compilation error:
  Invalid identifier CUSTOMER_ID
  compiled code at target\run\dbt_first\models\Mart\mart_payments.sql
[0m11:48:40.785241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8370aadb-9736-4660-b978-03e5fa79e86d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E506B2F0>]}
[0m11:48:40.785241 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model customer_orders.mart.mart_payments ....... [[31mERROR[0m in 1.76s]
[0m11:48:40.785241 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m11:48:40.785241 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.mart_payments' to be skipped because of status 'error'.  Reason: Database Error in model mart_payments (models\Mart\mart_payments.sql)
  002004 (42601): SQL compilation error:
  Invalid identifier CUSTOMER_ID
  compiled code at target\run\dbt_first\models\Mart\mart_payments.sql.
[0m11:48:40.785241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:40.785241 [debug] [MainThread]: Connection 'list_customer_orders' was left open.
[0m11:48:40.785241 [debug] [MainThread]: On list_customer_orders: Close
[0m11:48:41.336983 [debug] [MainThread]: Connection 'list_customer_orders_staging' was left open.
[0m11:48:41.336983 [debug] [MainThread]: On list_customer_orders_staging: Close
[0m11:48:41.840188 [debug] [MainThread]: Connection 'model.dbt_first.mart_payments' was left open.
[0m11:48:41.854073 [debug] [MainThread]: On model.dbt_first.mart_payments: Close
[0m11:48:42.375385 [info ] [MainThread]: 
[0m11:48:42.375385 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.15 seconds (7.15s).
[0m11:48:42.375385 [debug] [MainThread]: Command end result
[0m11:48:42.401819 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:48:42.404786 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:48:42.404786 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:48:42.404786 [info ] [MainThread]: 
[0m11:48:42.404786 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:48:42.404786 [info ] [MainThread]: 
[0m11:48:42.404786 [error] [MainThread]:   Database Error in model mart_payments (models\Mart\mart_payments.sql)
  002004 (42601): SQL compilation error:
  Invalid identifier CUSTOMER_ID
  compiled code at target\run\dbt_first\models\Mart\mart_payments.sql
[0m11:48:42.413599 [info ] [MainThread]: 
[0m11:48:42.414817 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:48:42.416137 [debug] [MainThread]: Command `dbt run` failed at 11:48:42.416137 after 8.53 seconds
[0m11:48:42.417298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E1E0AAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168E49785F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168DFDA7680>]}
[0m11:48:42.417298 [debug] [MainThread]: Flushing usage events
[0m11:48:43.441638 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:52:06.431729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC12038410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC119477A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC12038320>]}


============================== 11:52:06.431729 | 53869594-65b5-4541-bb7c-5fd557f15e19 ==============================
[0m11:52:06.431729 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:52:06.431729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_payments', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:52:06.866936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53869594-65b5-4541-bb7c-5fd557f15e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC12D2FA10>]}
[0m11:52:06.913664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53869594-65b5-4541-bb7c-5fd557f15e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC12D2F7D0>]}
[0m11:52:06.913664 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:52:07.224139 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:52:07.390618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:52:07.390618 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\mart_payments.sql
[0m11:52:07.653840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53869594-65b5-4541-bb7c-5fd557f15e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC1419EB10>]}
[0m11:52:07.717336 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:52:07.717336 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:52:07.749167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53869594-65b5-4541-bb7c-5fd557f15e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC14014980>]}
[0m11:52:07.749167 [info ] [MainThread]: Found 4 models, 1 seed, 3 sources, 476 macros
[0m11:52:07.749167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53869594-65b5-4541-bb7c-5fd557f15e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC140AE0C0>]}
[0m11:52:07.749167 [info ] [MainThread]: 
[0m11:52:07.749167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:52:07.749167 [info ] [MainThread]: 
[0m11:52:07.749167 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:52:07.749167 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders'
[0m11:52:07.849613 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m11:52:07.849613 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m11:52:07.850611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:09.586777 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.737 seconds
[0m11:52:09.588788 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_mart'
[0m11:52:09.600508 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m11:52:09.602512 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m11:52:09.602512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:10.972981 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.370 seconds
[0m11:52:10.974990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_mart, now list_customer_orders_staging)
[0m11:52:11.021843 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m11:52:11.021843 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m11:52:11.359280 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.336 seconds
[0m11:52:11.361289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_staging, now list_MYDB_PUBLIC)
[0m11:52:11.363295 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m11:52:11.364300 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m11:52:11.707501 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.354 seconds
[0m11:52:11.721233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53869594-65b5-4541-bb7c-5fd557f15e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC0F47F9B0>]}
[0m11:52:11.721233 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m11:52:11.721233 [info ] [Thread-1 (]: 1 of 1 START sql table model customer_orders.mart.mart_payments ................ [RUN]
[0m11:52:11.721233 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.mart_payments'
[0m11:52:11.721233 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m11:52:11.735296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m11:52:11.735296 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m11:52:11.772557 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.mart_payments"
[0m11:52:11.772557 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.mart_payments"
[0m11:52:11.772557 [debug] [Thread-1 (]: On model.dbt_first.mart_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.mart_payments"} */
create or replace transient table customer_orders.mart.mart_payments
         as
        (

select first_name, order_date, paymentmethod, 
    (AMOUNT / 83)::numeric(16, 2)
 as amount_usd from customer_orders.staging.stg_payments as p join customer_orders.staging.stg_orders as o using (order_id)
        );
[0m11:52:11.772557 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:52:13.223466 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bae89d-0004-b885-0005-a3d30002a2f6
[0m11:52:13.223466 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002004 (42601): SQL compilation error:
Invalid identifier ORDER_ID
[0m11:52:13.223466 [debug] [Thread-1 (]: Database Error in model mart_payments (models\Mart\mart_payments.sql)
  002004 (42601): SQL compilation error:
  Invalid identifier ORDER_ID
  compiled code at target\run\dbt_first\models\Mart\mart_payments.sql
[0m11:52:13.239018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53869594-65b5-4541-bb7c-5fd557f15e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC14172300>]}
[0m11:52:13.239018 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model customer_orders.mart.mart_payments ....... [[31mERROR[0m in 1.50s]
[0m11:52:13.239018 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m11:52:13.239018 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.mart_payments' to be skipped because of status 'error'.  Reason: Database Error in model mart_payments (models\Mart\mart_payments.sql)
  002004 (42601): SQL compilation error:
  Invalid identifier ORDER_ID
  compiled code at target\run\dbt_first\models\Mart\mart_payments.sql.
[0m11:52:13.239018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:13.239018 [debug] [MainThread]: Connection 'list_customer_orders' was left open.
[0m11:52:13.239018 [debug] [MainThread]: On list_customer_orders: Close
[0m11:52:13.757415 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m11:52:13.757415 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m11:52:14.291156 [debug] [MainThread]: Connection 'model.dbt_first.mart_payments' was left open.
[0m11:52:14.291156 [debug] [MainThread]: On model.dbt_first.mart_payments: Close
[0m11:52:14.808444 [info ] [MainThread]: 
[0m11:52:14.808444 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.06 seconds (7.06s).
[0m11:52:14.808444 [debug] [MainThread]: Command end result
[0m11:52:14.830244 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:52:14.830244 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:52:14.846347 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:52:14.846347 [info ] [MainThread]: 
[0m11:52:14.846347 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:52:14.846347 [info ] [MainThread]: 
[0m11:52:14.846347 [error] [MainThread]:   Database Error in model mart_payments (models\Mart\mart_payments.sql)
  002004 (42601): SQL compilation error:
  Invalid identifier ORDER_ID
  compiled code at target\run\dbt_first\models\Mart\mart_payments.sql
[0m11:52:14.846347 [info ] [MainThread]: 
[0m11:52:14.846347 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:52:14.846347 [debug] [MainThread]: Command `dbt run` failed at 11:52:14.846347 after 8.63 seconds
[0m11:52:14.846347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC0F74FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC14069160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC0FC9FE00>]}
[0m11:52:14.846347 [debug] [MainThread]: Flushing usage events
[0m11:52:15.826495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:37.146656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020003E44770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020003CE10A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020003E445C0>]}


============================== 11:53:37.162634 | 8537556c-f9b9-46f2-af8f-1f13dbfb001b ==============================
[0m11:53:37.162634 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:53:37.162634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_payments', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:53:37.585258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8537556c-f9b9-46f2-af8f-1f13dbfb001b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020003DF7A10>]}
[0m11:53:37.648529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8537556c-f9b9-46f2-af8f-1f13dbfb001b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200036E4B30>]}
[0m11:53:37.648529 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:53:37.969648 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:53:38.119422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:53:38.119422 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\mart_payments.sql
[0m11:53:38.387797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8537556c-f9b9-46f2-af8f-1f13dbfb001b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020006069850>]}
[0m11:53:38.451108 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:53:38.466865 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:53:38.482612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8537556c-f9b9-46f2-af8f-1f13dbfb001b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020005EFD490>]}
[0m11:53:38.482612 [info ] [MainThread]: Found 4 models, 1 seed, 3 sources, 476 macros
[0m11:53:38.482612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8537556c-f9b9-46f2-af8f-1f13dbfb001b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020004CE3290>]}
[0m11:53:38.482612 [info ] [MainThread]: 
[0m11:53:38.482612 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:53:38.498407 [info ] [MainThread]: 
[0m11:53:38.498407 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:53:38.498407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders'
[0m11:53:38.583488 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m11:53:38.583488 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m11:53:38.584491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:40.333963 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.751 seconds
[0m11:53:40.337760 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_mart'
[0m11:53:40.337760 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m11:53:40.337760 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m11:53:40.337760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:41.857430 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.511 seconds
[0m11:53:41.857430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_mart, now list_MYDB_PUBLIC)
[0m11:53:41.904951 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m11:53:41.904951 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m11:53:42.252394 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.339 seconds
[0m11:53:42.254351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MYDB_PUBLIC, now list_customer_orders_staging)
[0m11:53:42.256352 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m11:53:42.257351 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m11:53:42.570302 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.322 seconds
[0m11:53:42.570302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8537556c-f9b9-46f2-af8f-1f13dbfb001b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020005FE3FE0>]}
[0m11:53:42.586135 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m11:53:42.586135 [info ] [Thread-1 (]: 1 of 1 START sql table model customer_orders.mart.mart_payments ................ [RUN]
[0m11:53:42.586135 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.mart_payments'
[0m11:53:42.586135 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m11:53:42.597324 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m11:53:42.597324 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m11:53:42.629968 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.mart_payments"
[0m11:53:42.630966 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.mart_payments"
[0m11:53:42.631966 [debug] [Thread-1 (]: On model.dbt_first.mart_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.mart_payments"} */
create or replace transient table customer_orders.mart.mart_payments
         as
        (

select first_name, order_date, paymentmethod, 
    (AMOUNT / 83)::numeric(16, 2)
 as amount_usd from customer_orders.staging.stg_payments as p join customer_orders.staging.stg_orders as o on p.orderid = o.id
        );
[0m11:53:42.631966 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:53:44.100304 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bae89e-0004-b881-0005-a3d30002b30e
[0m11:53:44.100304 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 7
invalid identifier 'FIRST_NAME'
[0m11:53:44.103964 [debug] [Thread-1 (]: Database Error in model mart_payments (models\Mart\mart_payments.sql)
  000904 (42000): SQL compilation error: error line 5 at position 7
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\dbt_first\models\Mart\mart_payments.sql
[0m11:53:44.103964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8537556c-f9b9-46f2-af8f-1f13dbfb001b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200060A3740>]}
[0m11:53:44.103964 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model customer_orders.mart.mart_payments ....... [[31mERROR[0m in 1.52s]
[0m11:53:44.103964 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m11:53:44.103964 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.mart_payments' to be skipped because of status 'error'.  Reason: Database Error in model mart_payments (models\Mart\mart_payments.sql)
  000904 (42000): SQL compilation error: error line 5 at position 7
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\dbt_first\models\Mart\mart_payments.sql.
[0m11:53:44.103964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:44.103964 [debug] [MainThread]: Connection 'list_customer_orders' was left open.
[0m11:53:44.103964 [debug] [MainThread]: On list_customer_orders: Close
[0m11:53:44.671213 [debug] [MainThread]: Connection 'list_customer_orders_staging' was left open.
[0m11:53:44.671213 [debug] [MainThread]: On list_customer_orders_staging: Close
[0m11:53:45.189188 [debug] [MainThread]: Connection 'model.dbt_first.mart_payments' was left open.
[0m11:53:45.189188 [debug] [MainThread]: On model.dbt_first.mart_payments: Close
[0m11:53:45.717128 [info ] [MainThread]: 
[0m11:53:45.717128 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.22 seconds (7.22s).
[0m11:53:45.717128 [debug] [MainThread]: Command end result
[0m11:53:45.733886 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:53:45.733886 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:53:45.750770 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:53:45.751771 [info ] [MainThread]: 
[0m11:53:45.752770 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:53:45.752770 [info ] [MainThread]: 
[0m11:53:45.753797 [error] [MainThread]:   Database Error in model mart_payments (models\Mart\mart_payments.sql)
  000904 (42000): SQL compilation error: error line 5 at position 7
  invalid identifier 'FIRST_NAME'
  compiled code at target\run\dbt_first\models\Mart\mart_payments.sql
[0m11:53:45.754769 [info ] [MainThread]: 
[0m11:53:45.755770 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:53:45.755770 [debug] [MainThread]: Command `dbt run` failed at 11:53:45.755770 after 8.81 seconds
[0m11:53:45.755770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002000419B830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020001091FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020004C5D3A0>]}
[0m11:53:45.755770 [debug] [MainThread]: Flushing usage events
[0m11:53:46.888506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:54:06.207377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297F867D070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297F867D190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297F867CDA0>]}


============================== 11:54:06.207377 | 91785388-aeec-4ee5-96db-c26de7e2e45f ==============================
[0m11:54:06.207377 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:54:06.207377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_payments', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:54:06.644366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91785388-aeec-4ee5-96db-c26de7e2e45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297F945ED20>]}
[0m11:54:06.707544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91785388-aeec-4ee5-96db-c26de7e2e45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297F7BF1C70>]}
[0m11:54:06.707544 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:54:07.029038 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:54:07.178713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:54:07.178713 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\mart_payments.sql
[0m11:54:07.431927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91785388-aeec-4ee5-96db-c26de7e2e45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297FA900A10>]}
[0m11:54:07.515657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:54:07.517664 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:54:07.543516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91785388-aeec-4ee5-96db-c26de7e2e45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297FA6C59D0>]}
[0m11:54:07.543516 [info ] [MainThread]: Found 4 models, 1 seed, 3 sources, 476 macros
[0m11:54:07.543516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91785388-aeec-4ee5-96db-c26de7e2e45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297F6373AD0>]}
[0m11:54:07.543516 [info ] [MainThread]: 
[0m11:54:07.543516 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:54:07.543516 [info ] [MainThread]: 
[0m11:54:07.543516 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:54:07.553891 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders'
[0m11:54:07.637742 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m11:54:07.637742 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m11:54:07.637742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:09.269360 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.640 seconds
[0m11:54:09.285338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MYDB_PUBLIC'
[0m11:54:09.285338 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m11:54:09.285338 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m11:54:09.285338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:10.918474 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.623 seconds
[0m11:54:10.920416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MYDB_PUBLIC, now list_customer_orders_mart)
[0m11:54:10.968535 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m11:54:10.968535 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m11:54:11.280785 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.310 seconds
[0m11:54:11.283776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_mart, now list_customer_orders_staging)
[0m11:54:11.285782 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m11:54:11.285782 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m11:54:11.632081 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.349 seconds
[0m11:54:11.632081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91785388-aeec-4ee5-96db-c26de7e2e45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297FAD6A690>]}
[0m11:54:11.632081 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m11:54:11.632081 [info ] [Thread-1 (]: 1 of 1 START sql table model customer_orders.mart.mart_payments ................ [RUN]
[0m11:54:11.632081 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.mart_payments'
[0m11:54:11.632081 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m11:54:11.651789 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m11:54:11.653795 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m11:54:11.675979 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.mart_payments"
[0m11:54:11.675979 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.mart_payments"
[0m11:54:11.675979 [debug] [Thread-1 (]: On model.dbt_first.mart_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.mart_payments"} */
create or replace transient table customer_orders.mart.mart_payments
         as
        (

select order_date, paymentmethod, 
    (AMOUNT / 83)::numeric(16, 2)
 as amount_usd from customer_orders.staging.stg_payments as p join customer_orders.staging.stg_orders as o on p.orderid = o.id
        );
[0m11:54:11.675979 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:54:14.234925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.548 seconds
[0m11:54:14.250678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91785388-aeec-4ee5-96db-c26de7e2e45f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297F7B609B0>]}
[0m11:54:14.250678 [info ] [Thread-1 (]: 1 of 1 OK created sql table model customer_orders.mart.mart_payments ........... [[32mSUCCESS 1[0m in 2.62s]
[0m11:54:14.250678 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m11:54:14.250678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:14.250678 [debug] [MainThread]: Connection 'list_customer_orders' was left open.
[0m11:54:14.250678 [debug] [MainThread]: On list_customer_orders: Close
[0m11:54:14.767750 [debug] [MainThread]: Connection 'list_customer_orders_staging' was left open.
[0m11:54:14.767750 [debug] [MainThread]: On list_customer_orders_staging: Close
[0m11:54:15.285794 [debug] [MainThread]: Connection 'model.dbt_first.mart_payments' was left open.
[0m11:54:15.285794 [debug] [MainThread]: On model.dbt_first.mart_payments: Close
[0m11:54:15.796492 [info ] [MainThread]: 
[0m11:54:15.802102 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.25 seconds (8.25s).
[0m11:54:15.802102 [debug] [MainThread]: Command end result
[0m11:54:15.824010 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:54:15.824010 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:54:15.833506 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:54:15.833506 [info ] [MainThread]: 
[0m11:54:15.833506 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:54:15.833506 [info ] [MainThread]: 
[0m11:54:15.833506 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:54:15.833506 [debug] [MainThread]: Command `dbt run` succeeded at 11:54:15.833506 after 9.78 seconds
[0m11:54:15.833506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297F6373AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297FA7133E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000297F94360F0>]}
[0m11:54:15.833506 [debug] [MainThread]: Flushing usage events
[0m11:54:16.807223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:55:29.443033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132E6165C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132E893F9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132E893EA20>]}


============================== 11:55:29.443033 | c042fc91-dc6c-478f-9e96-3818faf56e6d ==============================
[0m11:55:29.443033 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:55:29.443033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_payments', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:55:29.879946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c042fc91-dc6c-478f-9e96-3818faf56e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132EAC34B00>]}
[0m11:55:29.930070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c042fc91-dc6c-478f-9e96-3818faf56e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132E65CF9B0>]}
[0m11:55:29.930070 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:55:30.241307 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:55:30.416143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:55:30.416143 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\mart_payments.sql
[0m11:55:30.664098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c042fc91-dc6c-478f-9e96-3818faf56e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132EB0D0710>]}
[0m11:55:30.727307 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:55:30.743412 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:55:30.763472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c042fc91-dc6c-478f-9e96-3818faf56e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132EAE94620>]}
[0m11:55:30.763472 [info ] [MainThread]: Found 4 models, 1 seed, 3 sources, 476 macros
[0m11:55:30.775520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c042fc91-dc6c-478f-9e96-3818faf56e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132EB110440>]}
[0m11:55:30.775520 [info ] [MainThread]: 
[0m11:55:30.775520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:55:30.775520 [info ] [MainThread]: 
[0m11:55:30.775520 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:55:30.775520 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders'
[0m11:55:30.863664 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m11:55:30.863664 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m11:55:30.863664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:32.474384 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.610 seconds
[0m11:55:32.476387 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_staging'
[0m11:55:32.488444 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m11:55:32.488444 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m11:55:32.488444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:33.965764 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.487 seconds
[0m11:55:33.965764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_staging, now list_customer_orders_mart)
[0m11:55:34.027358 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m11:55:34.027358 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m11:55:34.337981 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.323 seconds
[0m11:55:34.353989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_mart, now list_MYDB_PUBLIC)
[0m11:55:34.353989 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m11:55:34.353989 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m11:55:34.747253 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.391 seconds
[0m11:55:34.751261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c042fc91-dc6c-478f-9e96-3818faf56e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132EB2107A0>]}
[0m11:55:34.753264 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m11:55:34.753264 [info ] [Thread-1 (]: 1 of 1 START sql table model customer_orders.mart.mart_payments ................ [RUN]
[0m11:55:34.753264 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.mart_payments'
[0m11:55:34.753264 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m11:55:34.758958 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m11:55:34.758958 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m11:55:34.794576 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.mart_payments"
[0m11:55:34.794576 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.mart_payments"
[0m11:55:34.797816 [debug] [Thread-1 (]: On model.dbt_first.mart_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.mart_payments"} */
create or replace transient table customer_orders.mart.mart_payments
         as
        (

select order_date, paymentmethod, 
    (AMOUNT / 83)::numeric(16, 2)
 as amount_usd from customer_orders.staging.stg_payments as p join customer_orders.staging.stg_orders as o on p.orderid = o.id join customer_orders.staging.stg_customers as c on o.user_id = c.id
        );
[0m11:55:34.797816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:55:37.358135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.573 seconds
[0m11:55:37.389942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c042fc91-dc6c-478f-9e96-3818faf56e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132E626DB80>]}
[0m11:55:37.389942 [info ] [Thread-1 (]: 1 of 1 OK created sql table model customer_orders.mart.mart_payments ........... [[32mSUCCESS 1[0m in 2.64s]
[0m11:55:37.389942 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m11:55:37.389942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:37.389942 [debug] [MainThread]: Connection 'list_customer_orders' was left open.
[0m11:55:37.389942 [debug] [MainThread]: On list_customer_orders: Close
[0m11:55:37.891033 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m11:55:37.891033 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m11:55:38.449455 [debug] [MainThread]: Connection 'model.dbt_first.mart_payments' was left open.
[0m11:55:38.449455 [debug] [MainThread]: On model.dbt_first.mart_payments: Close
[0m11:55:38.939259 [info ] [MainThread]: 
[0m11:55:38.939259 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.16 seconds (8.16s).
[0m11:55:38.955254 [debug] [MainThread]: Command end result
[0m11:55:38.979980 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:55:38.982996 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:55:38.988714 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:55:38.988714 [info ] [MainThread]: 
[0m11:55:38.988714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:38.988714 [info ] [MainThread]: 
[0m11:55:38.988714 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:55:38.988714 [debug] [MainThread]: Command `dbt run` succeeded at 11:55:38.988714 after 9.77 seconds
[0m11:55:38.988714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132E905FFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132E851B0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132E851BC20>]}
[0m11:55:38.988714 [debug] [MainThread]: Flushing usage events
[0m11:55:39.946822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:54.082737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BCDA4B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA56B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BCDA6D20>]}


============================== 11:56:54.082737 | 78181e5b-e4bb-4e8e-b821-8beeb878d991 ==============================
[0m11:56:54.082737 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:56:54.082737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_payments', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:56:54.521599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78181e5b-e4bb-4e8e-b821-8beeb878d991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BDAF4E30>]}
[0m11:56:54.574632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78181e5b-e4bb-4e8e-b821-8beeb878d991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BD733E60>]}
[0m11:56:54.574632 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:56:54.900864 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:56:55.054372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:56:55.054372 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\mart_payments.sql
[0m11:56:55.319205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78181e5b-e4bb-4e8e-b821-8beeb878d991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BEFBF500>]}
[0m11:56:55.382339 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:56:55.382339 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:56:55.413704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78181e5b-e4bb-4e8e-b821-8beeb878d991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BEDD5760>]}
[0m11:56:55.413704 [info ] [MainThread]: Found 4 models, 1 seed, 3 sources, 476 macros
[0m11:56:55.413704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78181e5b-e4bb-4e8e-b821-8beeb878d991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BED4A1B0>]}
[0m11:56:55.413704 [info ] [MainThread]: 
[0m11:56:55.413704 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:56:55.413704 [info ] [MainThread]: 
[0m11:56:55.413704 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:56:55.429560 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders'
[0m11:56:55.512436 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m11:56:55.513437 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m11:56:55.513437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:57.100268 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.594 seconds
[0m11:56:57.100268 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MYDB_PUBLIC'
[0m11:56:57.116391 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m11:56:57.116391 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m11:56:57.116391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:58.506402 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.389 seconds
[0m11:56:58.506402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MYDB_PUBLIC, now list_customer_orders_staging)
[0m11:56:58.554336 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m11:56:58.554336 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m11:56:58.845497 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.294 seconds
[0m11:56:58.861480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_staging, now list_customer_orders_mart)
[0m11:56:58.861480 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m11:56:58.861480 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m11:56:59.203353 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.349 seconds
[0m11:56:59.203353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78181e5b-e4bb-4e8e-b821-8beeb878d991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BF5DF1D0>]}
[0m11:56:59.219069 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m11:56:59.219069 [info ] [Thread-1 (]: 1 of 1 START sql table model customer_orders.mart.mart_payments ................ [RUN]
[0m11:56:59.219069 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.mart_payments'
[0m11:56:59.219069 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m11:56:59.219069 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m11:56:59.219069 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m11:56:59.266060 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.mart_payments"
[0m11:56:59.267057 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.mart_payments"
[0m11:56:59.268061 [debug] [Thread-1 (]: On model.dbt_first.mart_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.mart_payments"} */
create or replace transient table customer_orders.mart.mart_payments
         as
        (

select first_name,order_date, paymentmethod, 
    (AMOUNT / 83)::numeric(16, 2)
 as amount_usd from customer_orders.staging.stg_payments as p join customer_orders.staging.stg_orders as o on p.orderid = o.id join customer_orders.staging.stg_customers as c on o.user_id = c.id
        );
[0m11:56:59.268061 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:57:01.451986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.199 seconds
[0m11:57:01.484150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78181e5b-e4bb-4e8e-b821-8beeb878d991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BC250B30>]}
[0m11:57:01.484150 [info ] [Thread-1 (]: 1 of 1 OK created sql table model customer_orders.mart.mart_payments ........... [[32mSUCCESS 1[0m in 2.27s]
[0m11:57:01.484150 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m11:57:01.484150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:01.484150 [debug] [MainThread]: Connection 'list_customer_orders' was left open.
[0m11:57:01.484150 [debug] [MainThread]: On list_customer_orders: Close
[0m11:57:02.001132 [debug] [MainThread]: Connection 'list_customer_orders_mart' was left open.
[0m11:57:02.003770 [debug] [MainThread]: On list_customer_orders_mart: Close
[0m11:57:02.511749 [debug] [MainThread]: Connection 'model.dbt_first.mart_payments' was left open.
[0m11:57:02.511749 [debug] [MainThread]: On model.dbt_first.mart_payments: Close
[0m11:57:03.069927 [info ] [MainThread]: 
[0m11:57:03.069927 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.66 seconds (7.66s).
[0m11:57:03.069927 [debug] [MainThread]: Command end result
[0m11:57:03.098072 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:57:03.100576 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:57:03.106550 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:57:03.107517 [info ] [MainThread]: 
[0m11:57:03.108057 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:57:03.108057 [info ] [MainThread]: 
[0m11:57:03.108057 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:57:03.108057 [debug] [MainThread]: Command `dbt run` succeeded at 11:57:03.108057 after 9.19 seconds
[0m11:57:03.108057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BAB4A5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BAB4A4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BAB4A480>]}
[0m11:57:03.108057 [debug] [MainThread]: Flushing usage events
[0m11:57:04.136298 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:13.868485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6F899E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6F899520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6F898140>]}


============================== 12:00:13.885327 | 08550f8d-2f00-4548-97ce-1e22cc7b4d16 ==============================
[0m12:00:13.885327 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:00:13.885327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m12:00:14.001675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08550f8d-2f00-4548-97ce-1e22cc7b4d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6F142900>]}
[0m12:00:14.035690 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:00:14.037694 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:00:14.038692 [debug] [MainThread]: Command `cli deps` succeeded at 12:00:14.038692 after 0.35 seconds
[0m12:00:14.038692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6F90E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6F142900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6F49D820>]}
[0m12:00:14.039721 [debug] [MainThread]: Flushing usage events
[0m12:00:15.054734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:40.341394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEC28831A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEC2881820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEC2C15AC0>]}


============================== 12:07:40.350664 | 115732e5-a917-4767-b209-076093fd35f5 ==============================
[0m12:07:40.350664 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:07:40.350664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:07:40.819954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '115732e5-a917-4767-b209-076093fd35f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEC2C48950>]}
[0m12:07:40.883008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '115732e5-a917-4767-b209-076093fd35f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEC3C38470>]}
[0m12:07:40.883008 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:07:41.354168 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:07:41.527331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:07:41.527331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:07:41.574680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '115732e5-a917-4767-b209-076093fd35f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEC4E9AA50>]}
[0m12:07:41.606373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '115732e5-a917-4767-b209-076093fd35f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEC5230440>]}
[0m12:07:41.606373 [info ] [MainThread]: Found 4 models, 1 seed, 3 sources, 476 macros
[0m12:07:41.606373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '115732e5-a917-4767-b209-076093fd35f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEC510CF50>]}
[0m12:07:41.606373 [info ] [MainThread]: 
[0m12:07:41.606373 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:07:41.606373 [info ] [MainThread]: 
[0m12:07:41.606373 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:07:41.623143 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MYDB_PUBLIC'
[0m12:07:44.444452 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m12:07:44.444452 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m12:07:44.444452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:46.398508 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.945 seconds
[0m12:07:46.404245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MYDB_PUBLIC, now list_customer_orders_mart)
[0m12:07:46.407954 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m12:07:46.407954 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m12:07:46.760280 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.354 seconds
[0m12:07:46.760280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_mart, now list_customer_orders_staging)
[0m12:07:46.760280 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m12:07:46.760280 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m12:07:47.082482 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.329 seconds
[0m12:07:47.098467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '115732e5-a917-4767-b209-076093fd35f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEC04D7440>]}
[0m12:07:47.098467 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m12:07:47.098467 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m12:07:47.098467 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m12:07:47.116305 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m12:07:47.116305 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m12:07:47.116305 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m12:07:47.116305 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_orders
[0m12:07:47.116305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_orders)
[0m12:07:47.116305 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_orders
[0m12:07:47.116305 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_orders"
[0m12:07:47.116305 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_orders
[0m12:07:47.116305 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_orders
[0m12:07:47.116305 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_payments
[0m12:07:47.116305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_orders, now model.dbt_first.stg_payments)
[0m12:07:47.116305 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_payments
[0m12:07:47.130019 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_payments"
[0m12:07:47.130019 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_payments
[0m12:07:47.130019 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_payments
[0m12:07:47.130019 [debug] [Thread-1 (]: Began running node seed.dbt_first.stripe_payments
[0m12:07:47.130019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_payments, now seed.dbt_first.stripe_payments)
[0m12:07:47.130019 [debug] [Thread-1 (]: Began compiling node seed.dbt_first.stripe_payments
[0m12:07:47.130019 [debug] [Thread-1 (]: Began executing node seed.dbt_first.stripe_payments
[0m12:07:47.130019 [debug] [Thread-1 (]: Finished running node seed.dbt_first.stripe_payments
[0m12:07:47.130019 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m12:07:47.130019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_first.stripe_payments, now model.dbt_first.mart_payments)
[0m12:07:47.130019 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m12:07:47.130019 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m12:07:47.130019 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m12:07:47.130019 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m12:07:47.130019 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:47.130019 [debug] [MainThread]: Connection 'list_customer_orders_staging' was left open.
[0m12:07:47.130019 [debug] [MainThread]: On list_customer_orders_staging: Close
[0m12:07:47.679293 [debug] [MainThread]: Connection 'model.dbt_first.mart_payments' was properly closed.
[0m12:07:47.684701 [debug] [MainThread]: Command end result
[0m12:07:47.757492 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:07:47.789535 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:07:47.789535 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:07:48.260588 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m12:07:48.260588 [info ] [MainThread]: Building catalog
[0m12:07:48.279303 [debug] [ThreadPool]: Acquiring new snowflake connection 'customer_orders.information_schema'
[0m12:07:48.289151 [debug] [ThreadPool]: Using snowflake connection "customer_orders.information_schema"
[0m12:07:48.289151 [debug] [ThreadPool]: On customer_orders.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "customer_orders.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from customer_orders.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_payments' and upper("table_name") = upper('stg_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'mart' and upper("table_schema") = upper('mart')

                    and 
    "table_name" ilike 'mart_payments' and upper("table_name") = upper('mart_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from customer_orders.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_payments' and upper("table_name") = upper('stg_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'mart' and upper("table_schema") = upper('mart')

                    and 
    "table_name" ilike 'mart_payments' and upper("table_name") = upper('mart_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m12:07:48.289151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:52.049586 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 3.768 seconds
[0m12:07:52.065734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly customer_orders.information_schema, now MYDB.information_schema)
[0m12:07:52.081656 [debug] [ThreadPool]: Using snowflake connection "MYDB.information_schema"
[0m12:07:52.081656 [debug] [ThreadPool]: On MYDB.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "MYDB.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from MYDB.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stripe_payments' and upper("table_name") = upper('stripe_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_ORDERS' and upper("table_name") = upper('STG_ORDERS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_CUSTOMERS' and upper("table_name") = upper('STG_CUSTOMERS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STRIPE_PAYMENTS' and upper("table_name") = upper('STRIPE_PAYMENTS')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from MYDB.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stripe_payments' and upper("table_name") = upper('stripe_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_ORDERS' and upper("table_name") = upper('STG_ORDERS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_CUSTOMERS' and upper("table_name") = upper('STG_CUSTOMERS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STRIPE_PAYMENTS' and upper("table_name") = upper('STRIPE_PAYMENTS')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m12:07:54.455396 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 2.369 seconds
[0m12:07:54.475246 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\VarshaS\dbt_first\target\catalog.json
[0m12:07:54.539009 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:07:54.539009 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:07:54.539009 [info ] [MainThread]: Catalog written to C:\Users\VarshaS\dbt_first\target\catalog.json
[0m12:07:54.539009 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:07:54.539009 after 14.40 seconds
[0m12:07:54.539009 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:07:54.539009 [debug] [MainThread]: Connection 'MYDB.information_schema' was left open.
[0m12:07:54.539009 [debug] [MainThread]: On MYDB.information_schema: Close
[0m12:07:55.058197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEC2522960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEC3BE9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEC2540A70>]}
[0m12:07:55.058197 [debug] [MainThread]: Flushing usage events
[0m12:07:56.190750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:04.805014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197F704F8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197F738A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197F7388440>]}


============================== 12:08:04.805014 | 6b6c8571-dea7-4493-afd5-6d03f9f22481 ==============================
[0m12:08:04.805014 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:08:04.805014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:08:05.177891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b6c8571-dea7-4493-afd5-6d03f9f22481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197F7F6BA70>]}
[0m12:08:05.241427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b6c8571-dea7-4493-afd5-6d03f9f22481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197F7E54E30>]}
[0m12:42:05.476134 [error] [MainThread]: Encountered an error:

[0m12:42:05.584389 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m12:42:05.589664 [debug] [MainThread]: Command `dbt docs serve` failed at 12:42:05.589664 after 2040.94 seconds
[0m12:42:05.592697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197F6E9C620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197F82045C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197F82069C0>]}
[0m12:42:05.594697 [debug] [MainThread]: Flushing usage events
[0m12:42:06.687466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:12.225094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017496F49BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017496F4AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174999C7500>]}


============================== 12:42:12.225094 | af76e99b-5e9b-4696-ba7b-5f0b6652fbfa ==============================
[0m12:42:12.225094 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:42:12.231155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:42:12.594690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af76e99b-5e9b-4696-ba7b-5f0b6652fbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001749792E870>]}
[0m12:42:12.640536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af76e99b-5e9b-4696-ba7b-5f0b6652fbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001749B2E76B0>]}
[0m12:42:12.640536 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:42:13.018275 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:42:13.184651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:42:13.184651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:42:13.228177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af76e99b-5e9b-4696-ba7b-5f0b6652fbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001749B10B320>]}
[0m12:42:13.238167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af76e99b-5e9b-4696-ba7b-5f0b6652fbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001749C75CFE0>]}
[0m12:42:13.238167 [info ] [MainThread]: Found 4 models, 1 seed, 3 sources, 476 macros
[0m12:42:13.238167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af76e99b-5e9b-4696-ba7b-5f0b6652fbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001749C7088C0>]}
[0m12:42:13.254133 [info ] [MainThread]: 
[0m12:42:13.254133 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:13.254133 [info ] [MainThread]: 
[0m12:42:13.254133 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:13.261950 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_staging'
[0m12:42:13.359814 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m12:42:13.359814 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m12:42:13.359814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:14.982479 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.627 seconds
[0m12:42:14.982479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_staging, now list_MYDB_PUBLIC)
[0m12:42:14.982479 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m12:42:14.982479 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m12:42:15.296997 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.304 seconds
[0m12:42:15.296997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MYDB_PUBLIC, now list_customer_orders_mart)
[0m12:42:15.302858 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m12:42:15.302858 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m12:42:15.612293 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.317 seconds
[0m12:42:15.612293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af76e99b-5e9b-4696-ba7b-5f0b6652fbfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001749C3A7320>]}
[0m12:42:15.628471 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m12:42:15.628471 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m12:42:15.628471 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m12:42:15.637906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m12:42:15.637906 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m12:42:15.637906 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m12:42:15.637906 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_orders
[0m12:42:15.644212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_orders)
[0m12:42:15.644212 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_orders
[0m12:42:15.646217 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_orders"
[0m12:42:15.648221 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_orders
[0m12:42:15.648221 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_orders
[0m12:42:15.648221 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_payments
[0m12:42:15.648221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_orders, now model.dbt_first.stg_payments)
[0m12:42:15.648221 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_payments
[0m12:42:15.648221 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_payments"
[0m12:42:15.648221 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_payments
[0m12:42:15.648221 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_payments
[0m12:42:15.648221 [debug] [Thread-1 (]: Began running node seed.dbt_first.stripe_payments
[0m12:42:15.648221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_payments, now seed.dbt_first.stripe_payments)
[0m12:42:15.648221 [debug] [Thread-1 (]: Began compiling node seed.dbt_first.stripe_payments
[0m12:42:15.648221 [debug] [Thread-1 (]: Began executing node seed.dbt_first.stripe_payments
[0m12:42:15.658125 [debug] [Thread-1 (]: Finished running node seed.dbt_first.stripe_payments
[0m12:42:15.658125 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m12:42:15.658125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_first.stripe_payments, now model.dbt_first.mart_payments)
[0m12:42:15.659862 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m12:42:15.663871 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m12:42:15.663871 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m12:42:15.665875 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m12:42:15.667879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:15.667879 [debug] [MainThread]: Connection 'list_customer_orders_mart' was left open.
[0m12:42:15.667879 [debug] [MainThread]: On list_customer_orders_mart: Close
[0m12:42:16.211775 [debug] [MainThread]: Connection 'model.dbt_first.mart_payments' was properly closed.
[0m12:42:16.211775 [debug] [MainThread]: Command end result
[0m12:42:16.319222 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:42:16.336820 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:42:16.344344 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:42:16.691338 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m12:42:16.691338 [info ] [MainThread]: Building catalog
[0m12:42:16.707250 [debug] [ThreadPool]: Acquiring new snowflake connection 'customer_orders.information_schema'
[0m12:42:16.728767 [debug] [ThreadPool]: Using snowflake connection "customer_orders.information_schema"
[0m12:42:16.729596 [debug] [ThreadPool]: On customer_orders.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "customer_orders.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from customer_orders.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_payments' and upper("table_name") = upper('stg_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'mart' and upper("table_schema") = upper('mart')

                    and 
    "table_name" ilike 'mart_payments' and upper("table_name") = upper('mart_payments')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from customer_orders.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_payments' and upper("table_name") = upper('stg_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'mart' and upper("table_schema") = upper('mart')

                    and 
    "table_name" ilike 'mart_payments' and upper("table_name") = upper('mart_payments')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m12:42:16.729596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:20.377844 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 3.647 seconds
[0m12:42:20.389892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly customer_orders.information_schema, now MYDB.information_schema)
[0m12:42:20.393653 [debug] [ThreadPool]: Using snowflake connection "MYDB.information_schema"
[0m12:42:20.393653 [debug] [ThreadPool]: On MYDB.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "MYDB.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from MYDB.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_ORDERS' and upper("table_name") = upper('STG_ORDERS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stripe_payments' and upper("table_name") = upper('stripe_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_CUSTOMERS' and upper("table_name") = upper('STG_CUSTOMERS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STRIPE_PAYMENTS' and upper("table_name") = upper('STRIPE_PAYMENTS')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from MYDB.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_ORDERS' and upper("table_name") = upper('STG_ORDERS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stripe_payments' and upper("table_name") = upper('stripe_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_CUSTOMERS' and upper("table_name") = upper('STG_CUSTOMERS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STRIPE_PAYMENTS' and upper("table_name") = upper('STRIPE_PAYMENTS')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m12:42:22.681311 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 2.298 seconds
[0m12:42:22.713548 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\VarshaS\dbt_first\target\catalog.json
[0m12:42:22.810668 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:42:22.810668 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:42:22.810668 [info ] [MainThread]: Catalog written to C:\Users\VarshaS\dbt_first\target\catalog.json
[0m12:42:22.815205 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:42:22.815205 after 10.79 seconds
[0m12:42:22.815205 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:42:22.815205 [debug] [MainThread]: Connection 'MYDB.information_schema' was left open.
[0m12:42:22.815205 [debug] [MainThread]: On MYDB.information_schema: Close
[0m12:42:23.371195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017497993F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001749CB65040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001749CDB7710>]}
[0m12:42:23.373221 [debug] [MainThread]: Flushing usage events
[0m12:42:24.390959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:35.958938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D946958C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9462B11C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D946958440>]}


============================== 12:42:35.958938 | d241f3e7-8a67-4c31-8395-5d621f91a71b ==============================
[0m12:42:35.958938 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:42:35.958938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m12:42:36.324475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd241f3e7-8a67-4c31-8395-5d621f91a71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D947227560>]}
[0m12:42:36.385373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd241f3e7-8a67-4c31-8395-5d621f91a71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D947345910>]}
[0m12:44:46.315550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002737B8ED9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002737DB87470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002737DB85C10>]}


============================== 12:44:46.315550 | c102a758-c908-4b9d-8ff9-19dff3d732da ==============================
[0m12:44:46.315550 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:44:46.315550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:44:46.853022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c102a758-c908-4b9d-8ff9-19dff3d732da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002737E5121E0>]}
[0m12:44:46.910953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c102a758-c908-4b9d-8ff9-19dff3d732da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002737F3A7A70>]}
[0m12:44:46.910953 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:44:47.327720 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:44:47.475942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:44:47.475942 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:44:47.538900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c102a758-c908-4b9d-8ff9-19dff3d732da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002737F3476B0>]}
[0m12:44:47.554326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c102a758-c908-4b9d-8ff9-19dff3d732da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002737F666690>]}
[0m12:44:47.570134 [info ] [MainThread]: Found 4 models, 1 seed, 4 data tests, 3 sources, 476 macros
[0m12:44:47.570134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c102a758-c908-4b9d-8ff9-19dff3d732da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002737F6FE300>]}
[0m12:44:47.570134 [info ] [MainThread]: 
[0m12:44:47.570134 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:47.570134 [info ] [MainThread]: 
[0m12:44:47.570134 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:44:47.570134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_staging'
[0m12:44:50.193683 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m12:44:50.202787 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m12:44:50.202787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:51.957133 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.755 seconds
[0m12:44:51.959143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_staging, now list_MYDB_PUBLIC)
[0m12:44:51.961149 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m12:44:51.963155 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m12:44:52.273104 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.314 seconds
[0m12:44:52.273104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MYDB_PUBLIC, now list_customer_orders_mart)
[0m12:44:52.273104 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m12:44:52.273104 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m12:44:52.694462 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.427 seconds
[0m12:44:52.710339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c102a758-c908-4b9d-8ff9-19dff3d732da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002737F813E30>]}
[0m12:44:52.726211 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m12:44:52.731035 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m12:44:52.733057 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m12:44:52.741081 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m12:44:52.742097 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m12:44:52.742097 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m12:44:52.742097 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_orders
[0m12:44:52.742097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_orders)
[0m12:44:52.744103 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_orders
[0m12:44:52.746109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_orders"
[0m12:44:52.746109 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_orders
[0m12:44:52.748116 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_orders
[0m12:44:52.748116 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_payments
[0m12:44:52.748116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_orders, now model.dbt_first.stg_payments)
[0m12:44:52.748116 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_payments
[0m12:44:52.750121 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_payments"
[0m12:44:52.752128 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_payments
[0m12:44:52.752128 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_payments
[0m12:44:52.752128 [debug] [Thread-1 (]: Began running node seed.dbt_first.stripe_payments
[0m12:44:52.754133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_payments, now seed.dbt_first.stripe_payments)
[0m12:44:52.754133 [debug] [Thread-1 (]: Began compiling node seed.dbt_first.stripe_payments
[0m12:44:52.756140 [debug] [Thread-1 (]: Began executing node seed.dbt_first.stripe_payments
[0m12:44:52.757888 [debug] [Thread-1 (]: Finished running node seed.dbt_first.stripe_payments
[0m12:44:52.757888 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m12:44:52.757888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_first.stripe_payments, now model.dbt_first.mart_payments)
[0m12:44:52.757888 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m12:44:52.762225 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m12:44:52.764231 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m12:44:52.764231 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m12:44:52.764231 [debug] [Thread-1 (]: Began running node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m12:44:52.764231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.mart_payments, now test.dbt_first.not_null_mart_payments_orderid.a332165774)
[0m12:44:52.764231 [debug] [Thread-1 (]: Began compiling node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m12:44:52.773821 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.not_null_mart_payments_orderid.a332165774"
[0m12:44:52.773821 [debug] [Thread-1 (]: Began executing node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m12:44:52.773821 [debug] [Thread-1 (]: Finished running node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m12:44:52.773821 [debug] [Thread-1 (]: Began running node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m12:44:52.773821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.not_null_mart_payments_orderid.a332165774, now test.dbt_first.not_null_mart_payments_user_id.63456e471a)
[0m12:44:52.773821 [debug] [Thread-1 (]: Began compiling node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m12:44:52.773821 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.not_null_mart_payments_user_id.63456e471a"
[0m12:44:52.773821 [debug] [Thread-1 (]: Began executing node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m12:44:52.773821 [debug] [Thread-1 (]: Finished running node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m12:44:52.773821 [debug] [Thread-1 (]: Began running node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m12:44:52.773821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.not_null_mart_payments_user_id.63456e471a, now test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6)
[0m12:44:52.773821 [debug] [Thread-1 (]: Began compiling node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m12:44:52.789952 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6"
[0m12:44:52.789952 [debug] [Thread-1 (]: Began executing node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m12:44:52.789952 [debug] [Thread-1 (]: Finished running node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m12:44:52.789952 [debug] [Thread-1 (]: Began running node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m12:44:52.795424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6, now test.dbt_first.unique_mart_payments_user_id.3f9a04b555)
[0m12:44:52.795424 [debug] [Thread-1 (]: Began compiling node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m12:44:52.797430 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.unique_mart_payments_user_id.3f9a04b555"
[0m12:44:52.799436 [debug] [Thread-1 (]: Began executing node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m12:44:52.799436 [debug] [Thread-1 (]: Finished running node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m12:44:52.801958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:52.801958 [debug] [MainThread]: Connection 'list_customer_orders_mart' was left open.
[0m12:44:52.801958 [debug] [MainThread]: On list_customer_orders_mart: Close
[0m12:44:53.339174 [debug] [MainThread]: Connection 'test.dbt_first.unique_mart_payments_user_id.3f9a04b555' was properly closed.
[0m12:44:53.339174 [debug] [MainThread]: Command end result
[0m12:44:53.450825 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:44:53.467919 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:44:53.474406 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:44:53.800996 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m12:44:53.800996 [info ] [MainThread]: Building catalog
[0m12:44:53.816816 [debug] [ThreadPool]: Acquiring new snowflake connection 'MYDB.information_schema'
[0m12:44:53.835729 [debug] [ThreadPool]: Using snowflake connection "MYDB.information_schema"
[0m12:44:53.836801 [debug] [ThreadPool]: On MYDB.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "MYDB.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from MYDB.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STRIPE_PAYMENTS' and upper("table_name") = upper('STRIPE_PAYMENTS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_ORDERS' and upper("table_name") = upper('STG_ORDERS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stripe_payments' and upper("table_name") = upper('stripe_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_CUSTOMERS' and upper("table_name") = upper('STG_CUSTOMERS')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from MYDB.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STRIPE_PAYMENTS' and upper("table_name") = upper('STRIPE_PAYMENTS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_ORDERS' and upper("table_name") = upper('STG_ORDERS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stripe_payments' and upper("table_name") = upper('stripe_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_CUSTOMERS' and upper("table_name") = upper('STG_CUSTOMERS')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m12:44:53.836801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:57.269884 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 3.437 seconds
[0m12:44:57.281051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly MYDB.information_schema, now customer_orders.information_schema)
[0m12:44:57.287071 [debug] [ThreadPool]: Using snowflake connection "customer_orders.information_schema"
[0m12:44:57.287071 [debug] [ThreadPool]: On customer_orders.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "customer_orders.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from customer_orders.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_payments' and upper("table_name") = upper('stg_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'mart' and upper("table_schema") = upper('mart')

                    and 
    "table_name" ilike 'mart_payments' and upper("table_name") = upper('mart_payments')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from customer_orders.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_payments' and upper("table_name") = upper('stg_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
             or 
                (
                    
    "table_schema" ilike 'mart' and upper("table_schema") = upper('mart')

                    and 
    "table_name" ilike 'mart_payments' and upper("table_name") = upper('mart_payments')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m12:44:59.746829 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 2.462 seconds
[0m12:44:59.810141 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\VarshaS\dbt_first\target\catalog.json
[0m12:44:59.826927 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:44:59.841804 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:44:59.841804 [info ] [MainThread]: Catalog written to C:\Users\VarshaS\dbt_first\target\catalog.json
[0m12:44:59.842813 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:44:59.842813 after 13.76 seconds
[0m12:44:59.842813 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:44:59.843844 [debug] [MainThread]: Connection 'customer_orders.information_schema' was left open.
[0m12:44:59.843844 [debug] [MainThread]: On customer_orders.information_schema: Close
[0m12:45:00.351529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002737DC2F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002737E0CCCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002737F805B20>]}
[0m12:45:00.351529 [debug] [MainThread]: Flushing usage events
[0m12:45:01.307967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:12.046491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D7D51F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D7CDE4EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D7CDE76B0>]}


============================== 12:45:12.050492 | 9553afd8-abc1-4060-a968-41b6007f8148 ==============================
[0m12:45:12.050492 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:45:12.051491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:12.344694 [error] [MainThread]: Encountered an error:

[0m12:45:12.421436 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 232, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\runtime.py", line 79, in load_profile
    profile = Profile.render(
              ^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 402, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 368, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 324, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\profile.py", line 150, in _credentials_from_profile
    cls.validate(data)
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\dataclass_schema.py", line 95, in validate
    json_schema = cls.json_schema()
                  ^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\dataclass_schema.py", line 89, in json_schema
    json_schema_obj = build_json_schema(cls)
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\jsonschema\builder.py", line 45, in build_json_schema
    schema = get_schema(instance, context, with_dialect_uri=with_dialect_uri)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\jsonschema\schema.py", line 268, in get_schema
    schema = schema_creator(instance, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\jsonschema\schema.py", line 353, in on_dataclass
    for f_name, f_type, has_default, f_default in instance.fields():
                                                  ^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\jsonschema\schema.py", line 188, in fields
    f_default = _default(f_type, f_default, self.get_self_config())
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\jsonschema\schema.py", line 296, in _default
    return CC(f_value).to_dict()["x"]
           ^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in __mashumaro_to_dict__
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\core\meta\code\builder.py", line 1142, in add_pack_method
    self.compile()
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\core\meta\code\builder.py", line 332, in compile
    exec(code, self.globals, self.__dict__)
  File "<string>", line 0, in <module>
KeyboardInterrupt

[0m12:45:12.421436 [debug] [MainThread]: Command `dbt docs generate` failed at 12:45:12.421436 after 0.54 seconds
[0m12:45:12.421436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D7D653830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D7DA55880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028D7E6948C0>]}
[0m12:45:12.421436 [debug] [MainThread]: Flushing usage events
[0m12:45:13.358683 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:17.572008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001904147CAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001904147CE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001904147CF80>]}


============================== 12:45:17.572008 | 4d07d5d6-61af-4a18-ac7c-1340660eeae3 ==============================
[0m12:45:17.572008 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:45:17.572008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:45:17.987812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d07d5d6-61af-4a18-ac7c-1340660eeae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190414C44A0>]}
[0m12:45:18.051228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d07d5d6-61af-4a18-ac7c-1340660eeae3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001904163E870>]}
[0m12:45:18.146323 [error] [MainThread]: Encountered an error:
[WinError 10048] Only one usage of each socket address (protocol/network address/port) is normally permitted
[0m12:45:18.194321 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 457, in __init__
    self.server_bind()
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 478, in server_bind
    self.socket.bind(self.server_address)
OSError: [WinError 10048] Only one usage of each socket address (protocol/network address/port) is normally permitted

[0m12:45:18.199181 [debug] [MainThread]: Command `dbt docs serve` failed at 12:45:18.199181 after 0.79 seconds
[0m12:45:18.199181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190432BEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019040FE7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019043324320>]}
[0m12:45:18.199181 [debug] [MainThread]: Flushing usage events
[0m12:45:18.237871 [error] [MainThread]: Encountered an error:

[0m12:45:18.294505 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 240, in serve_forever
    self._handle_request_noblock()
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 318, in _handle_request_noblock
    self.process_request(request, client_address)
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 349, in process_request
    self.finish_request(request, client_address)
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 672, in __init__
    super().__init__(*args, **kwargs)
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 766, in __init__
    self.handle()
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 720, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m12:45:18.294505 [debug] [MainThread]: Command `dbt docs serve` failed at 12:45:18.294505 after 162.50 seconds
[0m12:45:18.294505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D945DC5DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9487C6F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9487E90D0>]}
[0m12:45:18.294505 [debug] [MainThread]: Flushing usage events
[0m12:45:19.142653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:19.260312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:30.597901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236890839E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023688A39490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236890835F0>]}


============================== 12:45:30.606694 | 7a898dc6-d9c0-4883-8ac5-31b123683940 ==============================
[0m12:45:30.606694 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:45:30.606694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:45:31.040728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a898dc6-d9c0-4883-8ac5-31b123683940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023689E177D0>]}
[0m12:45:31.115840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a898dc6-d9c0-4883-8ac5-31b123683940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236885D23F0>]}
[0m12:48:10.383492 [error] [MainThread]: Encountered an error:

[0m12:48:10.407159 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m12:48:10.407159 [debug] [MainThread]: Command `dbt docs serve` failed at 12:48:10.407159 after 159.98 seconds
[0m12:48:10.414670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023688A39490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002368AF59910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002368AED4320>]}
[0m12:48:10.414670 [debug] [MainThread]: Flushing usage events
[0m12:48:11.435085 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:58:18.607971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7197D1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7197C440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7197C380>]}


============================== 12:58:18.620855 | 9010594e-0e65-446c-94ff-6af8229274f0 ==============================
[0m12:58:18.620855 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:58:18.620855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:58:19.004540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9010594e-0e65-446c-94ff-6af8229274f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E6ED5EB70>]}
[0m12:58:19.067347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9010594e-0e65-446c-94ff-6af8229274f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7276EAB0>]}
[0m12:58:19.067347 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:58:19.401801 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:58:19.579040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:58:19.579040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:58:19.632381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9010594e-0e65-446c-94ff-6af8229274f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E72814C20>]}
[0m12:58:19.737795 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:58:19.737795 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:58:19.769467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9010594e-0e65-446c-94ff-6af8229274f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E739A7140>]}
[0m12:58:19.769467 [info ] [MainThread]: Found 4 models, 1 seed, 5 data tests, 3 sources, 476 macros
[0m12:58:19.769467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9010594e-0e65-446c-94ff-6af8229274f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7270BF50>]}
[0m12:58:19.769467 [info ] [MainThread]: 
[0m12:58:19.769467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:58:19.769467 [info ] [MainThread]: 
[0m12:58:19.769467 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:58:19.782696 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders'
[0m12:58:19.872406 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m12:58:19.872406 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m12:58:19.872406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:21.512104 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.639 seconds
[0m12:58:21.516637 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m12:58:21.516637 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m12:58:21.892580 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.384 seconds
[0m12:58:21.904903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_mart'
[0m12:58:21.911803 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m12:58:21.911803 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m12:58:21.911803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:23.333318 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.427 seconds
[0m12:58:23.343141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_mart, now list_customer_orders_staging)
[0m12:58:23.345149 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m12:58:23.345149 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m12:58:23.706270 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.373 seconds
[0m12:58:23.706270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_staging, now list_MYDB_PUBLIC)
[0m12:58:23.721962 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m12:58:23.721962 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m12:58:24.073085 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.349 seconds
[0m12:58:24.075092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9010594e-0e65-446c-94ff-6af8229274f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E71957A40>]}
[0m12:58:24.075092 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m12:58:24.075092 [info ] [Thread-1 (]: 1 of 4 START sql view model customer_orders.staging.stg_customers .............. [RUN]
[0m12:58:24.075092 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m12:58:24.075092 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m12:58:24.092400 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m12:58:24.093410 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m12:58:24.124362 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_customers"
[0m12:58:24.126432 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_customers"
[0m12:58:24.126432 [debug] [Thread-1 (]: On model.dbt_first.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_customers"} */
create or replace   view customer_orders.staging.stg_customers
  
   as (
    

select * from MYDB.PUBLIC.STG_CUSTOMERS
  );
[0m12:58:24.126432 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:58:25.793211 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.679 seconds
[0m12:58:25.840804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9010594e-0e65-446c-94ff-6af8229274f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E70E608C0>]}
[0m12:58:25.840804 [info ] [Thread-1 (]: 1 of 4 OK created sql view model customer_orders.staging.stg_customers ......... [[32mSUCCESS 1[0m in 1.77s]
[0m12:58:25.840804 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m12:58:25.840804 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_orders
[0m12:58:25.840804 [info ] [Thread-1 (]: 2 of 4 START sql view model customer_orders.staging.stg_orders ................. [RUN]
[0m12:58:25.840804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_orders)
[0m12:58:25.840804 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_orders
[0m12:58:25.840804 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_orders"
[0m12:58:25.840804 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_orders
[0m12:58:25.840804 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_orders"
[0m12:58:25.840804 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_orders"
[0m12:58:25.840804 [debug] [Thread-1 (]: On model.dbt_first.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_orders"} */
create or replace   view customer_orders.staging.stg_orders
  
   as (
    

select * from MYDB.PUBLIC.STG_ORDERS
  );
[0m12:58:26.452886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m12:58:26.452886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9010594e-0e65-446c-94ff-6af8229274f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E74046C00>]}
[0m12:58:26.452886 [info ] [Thread-1 (]: 2 of 4 OK created sql view model customer_orders.staging.stg_orders ............ [[32mSUCCESS 1[0m in 0.61s]
[0m12:58:26.452886 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_orders
[0m12:58:26.452886 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_payments
[0m12:58:26.468859 [info ] [Thread-1 (]: 3 of 4 START sql view model customer_orders.staging.stg_payments ............... [RUN]
[0m12:58:26.468859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_orders, now model.dbt_first.stg_payments)
[0m12:58:26.468859 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_payments
[0m12:58:26.468859 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_payments"
[0m12:58:26.468859 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_payments
[0m12:58:26.468859 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_payments"
[0m12:58:26.478074 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_payments"
[0m12:58:26.478074 [debug] [Thread-1 (]: On model.dbt_first.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_payments"} */
create or replace   view customer_orders.staging.stg_payments
  
   as (
    

select * from MYDB.PUBLIC.STRIPE_PAYMENTS
  );
[0m12:58:27.020315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m12:58:27.022322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9010594e-0e65-446c-94ff-6af8229274f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7425F7A0>]}
[0m12:58:27.022322 [info ] [Thread-1 (]: 3 of 4 OK created sql view model customer_orders.staging.stg_payments .......... [[32mSUCCESS 1[0m in 0.55s]
[0m12:58:27.024330 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_payments
[0m12:58:27.024330 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m12:58:27.024330 [info ] [Thread-1 (]: 4 of 4 START sql table model customer_orders.mart.mart_payments ................ [RUN]
[0m12:58:27.026347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_payments, now model.dbt_first.mart_payments)
[0m12:58:27.026347 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m12:58:27.032360 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m12:58:27.032360 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m12:58:27.053149 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.mart_payments"
[0m12:58:27.061688 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.mart_payments"
[0m12:58:27.061688 [debug] [Thread-1 (]: On model.dbt_first.mart_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.mart_payments"} */
create or replace transient table customer_orders.mart.mart_payments
         as
        (
with total_orders as(
    select 
        user_id,
        count(id) as total_orders
        from customer_orders.staging.stg_orders
        group by user_id order by user_id
),
cust_ord_pay as(
    select 
        o.user_id,
        p.orderid,
        CONCAT(first_name, ' ', last_name) AS full_name,
        order_date, 
        paymentmethod, 
        
    (AMOUNT / 83)::numeric(16, 2)
 as amount_usd,
        p.status as payment_status
        from customer_orders.staging.stg_payments as p 
        join 
            customer_orders.staging.stg_orders as o 
            on p.orderid = o.id 
        join 
            customer_orders.staging.stg_customers as c 
            on o.user_id = c.id
),
final as(
    select 
        c.*,
        t.total_orders
        from 
        cust_ord_pay as c 
        join
        total_orders as t
        on c.user_id = t.user_id
)
select * from final
        );
[0m12:58:28.413747 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.357 seconds
[0m12:58:28.413747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9010594e-0e65-446c-94ff-6af8229274f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E741487D0>]}
[0m12:58:28.429013 [info ] [Thread-1 (]: 4 of 4 OK created sql table model customer_orders.mart.mart_payments ........... [[32mSUCCESS 1[0m in 1.39s]
[0m12:58:28.429013 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m12:58:28.429013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:28.429013 [debug] [MainThread]: Connection 'list_customer_orders' was left open.
[0m12:58:28.429013 [debug] [MainThread]: On list_customer_orders: Close
[0m12:58:28.961736 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m12:58:28.962742 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m12:58:29.493662 [debug] [MainThread]: Connection 'model.dbt_first.mart_payments' was left open.
[0m12:58:29.494668 [debug] [MainThread]: On model.dbt_first.mart_payments: Close
[0m12:58:30.006723 [info ] [MainThread]: 
[0m12:58:30.007726 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m12:58:30.011199 [debug] [MainThread]: Command end result
[0m12:58:30.097055 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:58:30.112490 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:58:30.115521 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:58:30.115521 [info ] [MainThread]: 
[0m12:58:30.115521 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:58:30.115521 [info ] [MainThread]: 
[0m12:58:30.115521 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:58:30.115521 [debug] [MainThread]: Command `dbt run` succeeded at 12:58:30.115521 after 11.67 seconds
[0m12:58:30.115521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E70E615B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E6F6C97F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E7276EF60>]}
[0m12:58:30.115521 [debug] [MainThread]: Flushing usage events
[0m12:58:31.131496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:09:45.612585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E1D3CF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E1D3C140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E1D3CB60>]}


============================== 13:09:45.612585 | 4c85463a-e114-4382-ac2f-61a4b7dc5c1e ==============================
[0m13:09:45.612585 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:09:45.612585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:09:46.146693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c85463a-e114-4382-ac2f-61a4b7dc5c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E1FFC2F0>]}
[0m13:09:46.194707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c85463a-e114-4382-ac2f-61a4b7dc5c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E2854FE0>]}
[0m13:09:46.194707 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:09:46.602066 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:09:46.776392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:09:46.776392 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\schema.yml
[0m13:09:47.034124 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\Mart\schema.yml @ models: {'name': 'mart_payments', 'description': 'shows description of users whose payments were successfull', 'columns': [{'name': 'user_id', 'description': 'Unique identifier for the customer', 'tests': ['unique', 'not_null']}, {'name': 'orderid', 'description': 'Unique identifier for the order', 'tests': ['unique', 'not_null']}, {'name': 'full_name', 'description': 'Name for the customer'}, {'name': 'amount_usd', 'description': 'Amount paid by the customer in dollars'}, {'name': 'amount_usd'}, {'tests': ['check_payment']}], 'original_file_path': 'models\\Mart\\schema.yml', 'yaml_key': 'models', 'package_name': 'dbt_first'} - at path ['columns'][5]: 'name' is a required property
[0m13:09:47.036130 [debug] [MainThread]: Command `dbt run` failed at 13:09:47.036130 after 1.60 seconds
[0m13:09:47.036130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E1206F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E3FF9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131E40A88C0>]}
[0m13:09:47.036130 [debug] [MainThread]: Flushing usage events
[0m13:09:48.043594 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:10:19.271708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015768A9C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015768A9C3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015768A9C1D0>]}


============================== 13:10:19.281791 | 71229047-aba2-4e4b-a680-881e406582a5 ==============================
[0m13:10:19.281791 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:10:19.281791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:10:19.709459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71229047-aba2-4e4b-a680-881e406582a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015768A9C110>]}
[0m13:10:19.773090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71229047-aba2-4e4b-a680-881e406582a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015768DA4530>]}
[0m13:10:19.773090 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:10:20.087994 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:10:20.265406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:10:20.265406 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:10:20.322748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71229047-aba2-4e4b-a680-881e406582a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001576A947CB0>]}
[0m13:10:20.418209 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m13:10:20.418209 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m13:10:20.456586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71229047-aba2-4e4b-a680-881e406582a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001576ACF78C0>]}
[0m13:10:20.456586 [info ] [MainThread]: Found 4 models, 1 seed, 6 data tests, 3 sources, 476 macros
[0m13:10:20.456586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71229047-aba2-4e4b-a680-881e406582a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001576A8F5430>]}
[0m13:10:20.461283 [info ] [MainThread]: 
[0m13:10:20.461283 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:10:20.461283 [info ] [MainThread]: 
[0m13:10:20.461283 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:10:20.468599 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders'
[0m13:10:23.170075 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m13:10:23.170075 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m13:10:23.170075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:24.943901 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.776 seconds
[0m13:10:24.943901 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders"
[0m13:10:24.943901 [debug] [ThreadPool]: On list_customer_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders"} */
show terse schemas in database customer_orders
    limit 10000
[0m13:10:25.232010 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.287 seconds
[0m13:10:25.232010 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_mart'
[0m13:10:25.248140 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m13:10:25.248140 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m13:10:25.248140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:26.670345 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.422 seconds
[0m13:10:26.670345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_mart, now list_customer_orders_staging)
[0m13:10:26.670345 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m13:10:26.670345 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m13:10:27.042523 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.375 seconds
[0m13:10:27.042523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_staging, now list_MYDB_PUBLIC)
[0m13:10:27.058471 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m13:10:27.060916 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m13:10:27.382317 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.330 seconds
[0m13:10:27.382317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71229047-aba2-4e4b-a680-881e406582a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015765F175C0>]}
[0m13:10:27.398118 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m13:10:27.398118 [info ] [Thread-1 (]: 1 of 4 START sql view model customer_orders.staging.stg_customers .............. [RUN]
[0m13:10:27.398118 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m13:10:27.398118 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m13:10:27.398118 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m13:10:27.398118 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m13:10:27.429545 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_customers"
[0m13:10:27.429545 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_customers"
[0m13:10:27.429545 [debug] [Thread-1 (]: On model.dbt_first.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_customers"} */
create or replace   view customer_orders.staging.stg_customers
  
   as (
    

select * from MYDB.PUBLIC.STG_CUSTOMERS
  );
[0m13:10:27.429545 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:10:28.952982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.514 seconds
[0m13:10:28.978736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71229047-aba2-4e4b-a680-881e406582a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015767F80B00>]}
[0m13:10:28.978736 [info ] [Thread-1 (]: 1 of 4 OK created sql view model customer_orders.staging.stg_customers ......... [[32mSUCCESS 1[0m in 1.58s]
[0m13:10:28.978736 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m13:10:28.978736 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_orders
[0m13:10:28.978736 [info ] [Thread-1 (]: 2 of 4 START sql view model customer_orders.staging.stg_orders ................. [RUN]
[0m13:10:28.978736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_orders)
[0m13:10:28.978736 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_orders
[0m13:10:28.984715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_orders"
[0m13:10:28.984715 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_orders
[0m13:10:28.984715 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_orders"
[0m13:10:28.984715 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_orders"
[0m13:10:28.984715 [debug] [Thread-1 (]: On model.dbt_first.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_orders"} */
create or replace   view customer_orders.staging.stg_orders
  
   as (
    

select * from MYDB.PUBLIC.STG_ORDERS
  );
[0m13:10:29.498374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m13:10:29.500102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71229047-aba2-4e4b-a680-881e406582a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001576B2C9430>]}
[0m13:10:29.500102 [info ] [Thread-1 (]: 2 of 4 OK created sql view model customer_orders.staging.stg_orders ............ [[32mSUCCESS 1[0m in 0.52s]
[0m13:10:29.500102 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_orders
[0m13:10:29.500102 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_payments
[0m13:10:29.500102 [info ] [Thread-1 (]: 3 of 4 START sql view model customer_orders.staging.stg_payments ............... [RUN]
[0m13:10:29.500102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_orders, now model.dbt_first.stg_payments)
[0m13:10:29.500102 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_payments
[0m13:10:29.500102 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_payments"
[0m13:10:29.500102 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_payments
[0m13:10:29.500102 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_payments"
[0m13:10:29.500102 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_payments"
[0m13:10:29.500102 [debug] [Thread-1 (]: On model.dbt_first.stg_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_payments"} */
create or replace   view customer_orders.staging.stg_payments
  
   as (
    

select * from MYDB.PUBLIC.STRIPE_PAYMENTS
  );
[0m13:10:30.021482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m13:10:30.031616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71229047-aba2-4e4b-a680-881e406582a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001576B2AAE70>]}
[0m13:10:30.033642 [info ] [Thread-1 (]: 3 of 4 OK created sql view model customer_orders.staging.stg_payments .......... [[32mSUCCESS 1[0m in 0.53s]
[0m13:10:30.036938 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_payments
[0m13:10:30.038959 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m13:10:30.038959 [info ] [Thread-1 (]: 4 of 4 START sql table model customer_orders.mart.mart_payments ................ [RUN]
[0m13:10:30.038959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_payments, now model.dbt_first.mart_payments)
[0m13:10:30.045487 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m13:10:30.051967 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m13:10:30.051967 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m13:10:30.070665 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.mart_payments"
[0m13:10:30.070665 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.mart_payments"
[0m13:10:30.070665 [debug] [Thread-1 (]: On model.dbt_first.mart_payments: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.mart_payments"} */
create or replace transient table customer_orders.mart.mart_payments
         as
        (
with total_orders as(
    select 
        user_id,
        count(id) as total_orders
        from customer_orders.staging.stg_orders
        group by user_id order by user_id
),
cust_ord_pay as(
    select 
        o.user_id,
        p.orderid,
        CONCAT(first_name, ' ', last_name) AS full_name,
        order_date, 
        paymentmethod, 
        
    (AMOUNT / 83)::numeric(16, 2)
 as amount_usd,
        p.status as payment_status
        from customer_orders.staging.stg_payments as p 
        join 
            customer_orders.staging.stg_orders as o 
            on p.orderid = o.id 
        join 
            customer_orders.staging.stg_customers as c 
            on o.user_id = c.id
),
final as(
    select 
        c.*,
        t.total_orders
        from 
        cust_ord_pay as c 
        join
        total_orders as t
        on c.user_id = t.user_id
)
select * from final
        );
[0m13:10:31.666477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.588 seconds
[0m13:10:31.670503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71229047-aba2-4e4b-a680-881e406582a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001576B399820>]}
[0m13:10:31.670503 [info ] [Thread-1 (]: 4 of 4 OK created sql table model customer_orders.mart.mart_payments ........... [[32mSUCCESS 1[0m in 1.63s]
[0m13:10:31.670503 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m13:10:31.670503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:31.670503 [debug] [MainThread]: Connection 'list_customer_orders' was left open.
[0m13:10:31.670503 [debug] [MainThread]: On list_customer_orders: Close
[0m13:10:32.198221 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m13:10:32.198221 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m13:10:32.699342 [debug] [MainThread]: Connection 'model.dbt_first.mart_payments' was left open.
[0m13:10:32.699342 [debug] [MainThread]: On model.dbt_first.mart_payments: Close
[0m13:10:33.228471 [info ] [MainThread]: 
[0m13:10:33.228471 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 12.77 seconds (12.77s).
[0m13:10:33.228471 [debug] [MainThread]: Command end result
[0m13:10:33.301145 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m13:10:33.301145 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m13:10:33.301145 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m13:10:33.301145 [info ] [MainThread]: 
[0m13:10:33.301145 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:10:33.301145 [info ] [MainThread]: 
[0m13:10:33.317032 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:10:33.317635 [debug] [MainThread]: Command `dbt run` succeeded at 13:10:33.317635 after 14.20 seconds
[0m13:10:33.318674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157697B15E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157697B0CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015768AE4560>]}
[0m13:10:33.318674 [debug] [MainThread]: Flushing usage events
[0m13:10:34.320102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:10:45.074638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAA28C590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAA28C530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAA28C3B0>]}


============================== 13:10:45.074638 | 47228ff2-6dc5-4f64-b1bd-9b1d6ec59815 ==============================
[0m13:10:45.074638 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:10:45.074638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:10:45.496264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47228ff2-6dc5-4f64-b1bd-9b1d6ec59815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAAF25580>]}
[0m13:10:45.563693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47228ff2-6dc5-4f64-b1bd-9b1d6ec59815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAAFFC080>]}
[0m13:10:45.563693 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:10:45.882861 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:10:46.052523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:10:46.053521 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:10:46.110212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47228ff2-6dc5-4f64-b1bd-9b1d6ec59815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAC0F5340>]}
[0m13:10:46.204647 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m13:10:46.204647 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m13:10:46.283757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47228ff2-6dc5-4f64-b1bd-9b1d6ec59815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAC6ACC20>]}
[0m13:10:46.285764 [info ] [MainThread]: Found 4 models, 1 seed, 6 data tests, 3 sources, 476 macros
[0m13:10:46.285764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47228ff2-6dc5-4f64-b1bd-9b1d6ec59815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAC1172C0>]}
[0m13:10:46.288366 [info ] [MainThread]: 
[0m13:10:46.288366 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:10:46.288366 [info ] [MainThread]: 
[0m13:10:46.288366 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:10:46.296225 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_staging'
[0m13:10:46.388305 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m13:10:46.388305 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m13:10:46.388305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:48.072006 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.693 seconds
[0m13:10:48.072006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_staging, now list_customer_orders_mart)
[0m13:10:48.072006 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m13:10:48.072006 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m13:10:48.423703 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.346 seconds
[0m13:10:48.423703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_mart, now list_MYDB_PUBLIC)
[0m13:10:48.423703 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m13:10:48.423703 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m13:10:48.733319 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.304 seconds
[0m13:10:48.744669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47228ff2-6dc5-4f64-b1bd-9b1d6ec59815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAAFD6930>]}
[0m13:10:48.748118 [debug] [Thread-1 (]: Began running node test.dbt_first.check_payment
[0m13:10:48.748118 [info ] [Thread-1 (]: 1 of 6 START test check_payment ................................................ [RUN]
[0m13:10:48.748118 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_first.check_payment'
[0m13:10:48.748118 [debug] [Thread-1 (]: Began compiling node test.dbt_first.check_payment
[0m13:10:48.748118 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.check_payment"
[0m13:10:48.748118 [debug] [Thread-1 (]: Began executing node test.dbt_first.check_payment
[0m13:10:48.779091 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_first.check_payment"
[0m13:10:48.781059 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_first.check_payment"
[0m13:10:48.782091 [debug] [Thread-1 (]: On test.dbt_first.check_payment: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "test.dbt_first.check_payment"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
      
    ) dbt_internal_test
[0m13:10:48.782091 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:10:50.390741 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bae8eb-0004-b885-0005-a3d30002a41e
[0m13:10:50.390741 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 4 unexpected ')'.
[0m13:10:50.405861 [debug] [Thread-1 (]: Database Error in test check_payment (tests\check_payment.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 4 unexpected ')'.
  compiled code at target\run\dbt_first\tests\check_payment.sql
[0m13:10:50.405861 [error] [Thread-1 (]: 1 of 6 ERROR check_payment ..................................................... [[31mERROR[0m in 1.66s]
[0m13:10:50.405861 [debug] [Thread-1 (]: Finished running node test.dbt_first.check_payment
[0m13:10:50.405861 [debug] [Thread-1 (]: Began running node test.dbt_first.check_payment_mart_payments_amount_usd.084835edc8
[0m13:10:50.405861 [debug] [Thread-4 (]: Marking all children of 'test.dbt_first.check_payment' to be skipped because of status 'error'.  Reason: Database Error in test check_payment (tests\check_payment.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 4 unexpected ')'.
  compiled code at target\run\dbt_first\tests\check_payment.sql.
[0m13:10:50.411104 [info ] [Thread-1 (]: 2 of 6 START test check_payment_mart_payments_amount_usd ....................... [RUN]
[0m13:10:50.411104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.check_payment, now test.dbt_first.check_payment_mart_payments_amount_usd.084835edc8)
[0m13:10:50.411104 [debug] [Thread-1 (]: Began compiling node test.dbt_first.check_payment_mart_payments_amount_usd.084835edc8
[0m13:10:50.454769 [debug] [Thread-1 (]: Compilation Error in test check_payment_mart_payments_amount_usd (models\Mart\schema.yml)
  'test_check_payment' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:50.454769 [error] [Thread-1 (]: 2 of 6 ERROR check_payment_mart_payments_amount_usd ............................ [[31mERROR[0m in 0.04s]
[0m13:10:50.454769 [debug] [Thread-1 (]: Finished running node test.dbt_first.check_payment_mart_payments_amount_usd.084835edc8
[0m13:10:50.454769 [debug] [Thread-1 (]: Began running node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m13:10:50.467928 [debug] [Thread-4 (]: Marking all children of 'test.dbt_first.check_payment_mart_payments_amount_usd.084835edc8' to be skipped because of status 'error'.  Reason: Compilation Error in test check_payment_mart_payments_amount_usd (models\Mart\schema.yml)
  'test_check_payment' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:10:50.467501 [info ] [Thread-1 (]: 3 of 6 START test not_null_mart_payments_orderid ............................... [RUN]
[0m13:10:50.469035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.check_payment_mart_payments_amount_usd.084835edc8, now test.dbt_first.not_null_mart_payments_orderid.a332165774)
[0m13:10:50.469035 [debug] [Thread-1 (]: Began compiling node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m13:10:50.475170 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.not_null_mart_payments_orderid.a332165774"
[0m13:10:50.476172 [debug] [Thread-1 (]: Began executing node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m13:10:50.478170 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_first.not_null_mart_payments_orderid.a332165774"
[0m13:10:50.480138 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_first.not_null_mart_payments_orderid.a332165774"
[0m13:10:50.480138 [debug] [Thread-1 (]: On test.dbt_first.not_null_mart_payments_orderid.a332165774: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "test.dbt_first.not_null_mart_payments_orderid.a332165774"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select orderid
from customer_orders.mart.mart_payments
where orderid is null



      
    ) dbt_internal_test
[0m13:10:51.030405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.554 seconds
[0m13:10:51.030405 [info ] [Thread-1 (]: 3 of 6 PASS not_null_mart_payments_orderid ..................................... [[32mPASS[0m in 0.56s]
[0m13:10:51.044723 [debug] [Thread-1 (]: Finished running node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m13:10:51.044723 [debug] [Thread-1 (]: Began running node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m13:10:51.044723 [info ] [Thread-1 (]: 4 of 6 START test not_null_mart_payments_user_id ............................... [RUN]
[0m13:10:51.044723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.not_null_mart_payments_orderid.a332165774, now test.dbt_first.not_null_mart_payments_user_id.63456e471a)
[0m13:10:51.044723 [debug] [Thread-1 (]: Began compiling node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m13:10:51.044723 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.not_null_mart_payments_user_id.63456e471a"
[0m13:10:51.044723 [debug] [Thread-1 (]: Began executing node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m13:10:51.044723 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_first.not_null_mart_payments_user_id.63456e471a"
[0m13:10:51.044723 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_first.not_null_mart_payments_user_id.63456e471a"
[0m13:10:51.044723 [debug] [Thread-1 (]: On test.dbt_first.not_null_mart_payments_user_id.63456e471a: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "test.dbt_first.not_null_mart_payments_user_id.63456e471a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from customer_orders.mart.mart_payments
where user_id is null



      
    ) dbt_internal_test
[0m13:10:51.569641 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.516 seconds
[0m13:10:51.569641 [info ] [Thread-1 (]: 4 of 6 PASS not_null_mart_payments_user_id ..................................... [[32mPASS[0m in 0.52s]
[0m13:10:51.569641 [debug] [Thread-1 (]: Finished running node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m13:10:51.569641 [debug] [Thread-1 (]: Began running node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m13:10:51.569641 [info ] [Thread-1 (]: 5 of 6 START test unique_mart_payments_orderid ................................. [RUN]
[0m13:10:51.569641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.not_null_mart_payments_user_id.63456e471a, now test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6)
[0m13:10:51.569641 [debug] [Thread-1 (]: Began compiling node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m13:10:51.586439 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6"
[0m13:10:51.586945 [debug] [Thread-1 (]: Began executing node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m13:10:51.637312 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6"
[0m13:10:51.639595 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6"
[0m13:10:51.639595 [debug] [Thread-1 (]: On test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    orderid as unique_field,
    count(*) as n_records

from customer_orders.mart.mart_payments
where orderid is not null
group by orderid
having count(*) > 1



      
    ) dbt_internal_test
[0m13:10:52.256143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m13:10:52.256143 [error] [Thread-1 (]: 5 of 6 FAIL 17 unique_mart_payments_orderid .................................... [[31mFAIL 17[0m in 0.69s]
[0m13:10:52.256143 [debug] [Thread-1 (]: Finished running node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m13:10:52.256143 [debug] [Thread-1 (]: Began running node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m13:10:52.256143 [info ] [Thread-1 (]: 6 of 6 START test unique_mart_payments_user_id ................................. [RUN]
[0m13:10:52.271811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6, now test.dbt_first.unique_mart_payments_user_id.3f9a04b555)
[0m13:10:52.271811 [debug] [Thread-1 (]: Began compiling node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m13:10:52.275327 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.unique_mart_payments_user_id.3f9a04b555"
[0m13:10:52.275327 [debug] [Thread-1 (]: Began executing node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m13:10:52.277334 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_first.unique_mart_payments_user_id.3f9a04b555"
[0m13:10:52.279340 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_first.unique_mart_payments_user_id.3f9a04b555"
[0m13:10:52.279340 [debug] [Thread-1 (]: On test.dbt_first.unique_mart_payments_user_id.3f9a04b555: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "test.dbt_first.unique_mart_payments_user_id.3f9a04b555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from customer_orders.mart.mart_payments
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:10:52.842133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m13:10:52.842133 [error] [Thread-1 (]: 6 of 6 FAIL 30 unique_mart_payments_user_id .................................... [[31mFAIL 30[0m in 0.59s]
[0m13:10:52.842133 [debug] [Thread-1 (]: Finished running node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m13:10:52.842133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:52.842133 [debug] [MainThread]: Connection 'list_MYDB_PUBLIC' was left open.
[0m13:10:52.842133 [debug] [MainThread]: On list_MYDB_PUBLIC: Close
[0m13:10:53.379927 [debug] [MainThread]: Connection 'test.dbt_first.unique_mart_payments_user_id.3f9a04b555' was left open.
[0m13:10:53.379927 [debug] [MainThread]: On test.dbt_first.unique_mart_payments_user_id.3f9a04b555: Close
[0m13:10:53.895017 [info ] [MainThread]: 
[0m13:10:53.897029 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m13:10:53.899896 [debug] [MainThread]: Command end result
[0m13:10:53.929371 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m13:10:53.929371 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m13:10:53.948673 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m13:10:53.948673 [info ] [MainThread]: 
[0m13:10:53.950764 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:10:53.950764 [info ] [MainThread]: 
[0m13:10:53.952775 [error] [MainThread]:   Database Error in test check_payment (tests\check_payment.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 4 unexpected ')'.
  compiled code at target\run\dbt_first\tests\check_payment.sql
[0m13:10:53.952775 [info ] [MainThread]: 
[0m13:10:53.955289 [error] [MainThread]:   Compilation Error in test check_payment_mart_payments_amount_usd (models\Mart\schema.yml)
  'test_check_payment' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:53.957270 [info ] [MainThread]: 
[0m13:10:53.959258 [error] [MainThread]: [31mFailure in test unique_mart_payments_orderid (models\Mart\schema.yml)[0m
[0m13:10:53.960271 [error] [MainThread]:   Got 17 results, configured to fail if != 0
[0m13:10:53.961270 [info ] [MainThread]: 
[0m13:10:53.962254 [info ] [MainThread]:   compiled code at target\compiled\dbt_first\models\Mart\schema.yml\unique_mart_payments_orderid.sql
[0m13:10:53.963255 [info ] [MainThread]: 
[0m13:10:53.964305 [error] [MainThread]: [31mFailure in test unique_mart_payments_user_id (models\Mart\schema.yml)[0m
[0m13:10:53.966110 [error] [MainThread]:   Got 30 results, configured to fail if != 0
[0m13:10:53.967120 [info ] [MainThread]: 
[0m13:10:53.967521 [info ] [MainThread]:   compiled code at target\compiled\dbt_first\models\Mart\schema.yml\unique_mart_payments_user_id.sql
[0m13:10:53.968528 [info ] [MainThread]: 
[0m13:10:53.968528 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m13:10:53.970100 [debug] [MainThread]: Command `dbt test` failed at 13:10:53.970100 after 9.05 seconds
[0m13:10:53.970946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAA267710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EA8055370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017EAA051CD0>]}
[0m13:10:53.972019 [debug] [MainThread]: Flushing usage events
[0m13:10:54.939579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:42.898245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D5B39BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D292DFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D598F0E0>]}


============================== 14:01:42.902800 | 8afb29ef-4fb7-4082-b58a-cf304c63c4ba ==============================
[0m14:01:42.902800 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:01:42.903791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:01:43.026844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8afb29ef-4fb7-4082-b58a-cf304c63c4ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D5FC9820>]}
[0m14:01:43.054411 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:01:43.055417 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:01:43.056417 [debug] [MainThread]: Command `cli deps` succeeded at 14:01:43.056417 after 0.35 seconds
[0m14:01:43.056417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D5B39BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1D6200740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1CFE270E0>]}
[0m14:01:43.057418 [debug] [MainThread]: Flushing usage events
[0m14:01:44.127002 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:25.518497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BD9916420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BD9916630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BD99163F0>]}


============================== 14:05:25.524622 | f1bdf0bf-9641-4050-840a-16779cb55c74 ==============================
[0m14:05:25.524622 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:05:25.526628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -m mart_payments', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:25.924643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1bdf0bf-9641-4050-840a-16779cb55c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDC887950>]}
[0m14:05:25.987464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1bdf0bf-9641-4050-840a-16779cb55c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDB5FCF20>]}
[0m14:05:25.987464 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:05:26.319953 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:05:26.509610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:05:26.509610 [debug] [MainThread]: Partial parsing: updated file: dbt_first://tests\generic\check_payment.sql
[0m14:05:26.608800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1bdf0bf-9641-4050-840a-16779cb55c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDDD3D1C0>]}
[0m14:05:26.694537 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:05:26.701098 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:05:26.726217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1bdf0bf-9641-4050-840a-16779cb55c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDDF40680>]}
[0m14:05:26.726217 [info ] [MainThread]: Found 4 models, 1 seed, 5 data tests, 3 sources, 477 macros
[0m14:05:26.726217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1bdf0bf-9641-4050-840a-16779cb55c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDDED4650>]}
[0m14:05:26.741872 [info ] [MainThread]: 
[0m14:05:26.741872 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:26.741872 [info ] [MainThread]: 
[0m14:05:26.741872 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:05:26.741872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_mart'
[0m14:05:26.864559 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m14:05:26.864559 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m14:05:26.864559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:28.831162 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.968 seconds
[0m14:05:28.831162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_mart, now list_MYDB_PUBLIC)
[0m14:05:28.831162 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m14:05:28.831162 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m14:05:29.195848 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.365 seconds
[0m14:05:29.195848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MYDB_PUBLIC, now list_customer_orders_staging)
[0m14:05:29.211591 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m14:05:29.211591 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m14:05:29.540644 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.343 seconds
[0m14:05:29.556317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1bdf0bf-9641-4050-840a-16779cb55c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDD977260>]}
[0m14:05:29.556317 [debug] [Thread-1 (]: Began running node test.dbt_first.check_payment_mart_payments_.8bbd1039a4
[0m14:05:29.556317 [info ] [Thread-1 (]: 1 of 5 START test check_payment_mart_payments_ ................................. [RUN]
[0m14:05:29.556317 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_first.check_payment_mart_payments_.8bbd1039a4'
[0m14:05:29.556317 [debug] [Thread-1 (]: Began compiling node test.dbt_first.check_payment_mart_payments_.8bbd1039a4
[0m14:05:29.581445 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.check_payment_mart_payments_.8bbd1039a4"
[0m14:05:29.584379 [debug] [Thread-1 (]: Began executing node test.dbt_first.check_payment_mart_payments_.8bbd1039a4
[0m14:05:29.606867 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_first.check_payment_mart_payments_.8bbd1039a4"
[0m14:05:29.608867 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_first.check_payment_mart_payments_.8bbd1039a4"
[0m14:05:29.608867 [debug] [Thread-1 (]: On test.dbt_first.check_payment_mart_payments_.8bbd1039a4: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "test.dbt_first.check_payment_mart_payments_.8bbd1039a4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select * from customer_orders.mart.mart_payments where AMOUNT_USD = 0

      
    ) dbt_internal_test
[0m14:05:29.608867 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:31.558109 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.949 seconds
[0m14:05:31.568849 [error] [Thread-1 (]: 1 of 5 FAIL 3 check_payment_mart_payments_ ..................................... [[31mFAIL 3[0m in 2.01s]
[0m14:05:31.568849 [debug] [Thread-1 (]: Finished running node test.dbt_first.check_payment_mart_payments_.8bbd1039a4
[0m14:05:31.570119 [debug] [Thread-1 (]: Began running node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m14:05:31.570119 [info ] [Thread-1 (]: 2 of 5 START test not_null_mart_payments_orderid ............................... [RUN]
[0m14:05:31.571119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.check_payment_mart_payments_.8bbd1039a4, now test.dbt_first.not_null_mart_payments_orderid.a332165774)
[0m14:05:31.571119 [debug] [Thread-1 (]: Began compiling node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m14:05:31.578118 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.not_null_mart_payments_orderid.a332165774"
[0m14:05:31.579115 [debug] [Thread-1 (]: Began executing node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m14:05:31.633826 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_first.not_null_mart_payments_orderid.a332165774"
[0m14:05:31.635922 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_first.not_null_mart_payments_orderid.a332165774"
[0m14:05:31.635922 [debug] [Thread-1 (]: On test.dbt_first.not_null_mart_payments_orderid.a332165774: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "test.dbt_first.not_null_mart_payments_orderid.a332165774"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select orderid
from customer_orders.mart.mart_payments
where orderid is null



      
    ) dbt_internal_test
[0m14:05:32.030344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m14:05:32.032345 [info ] [Thread-1 (]: 2 of 5 PASS not_null_mart_payments_orderid ..................................... [[32mPASS[0m in 0.46s]
[0m14:05:32.033347 [debug] [Thread-1 (]: Finished running node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m14:05:32.033347 [debug] [Thread-1 (]: Began running node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m14:05:32.034347 [info ] [Thread-1 (]: 3 of 5 START test not_null_mart_payments_user_id ............................... [RUN]
[0m14:05:32.034347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.not_null_mart_payments_orderid.a332165774, now test.dbt_first.not_null_mart_payments_user_id.63456e471a)
[0m14:05:32.035345 [debug] [Thread-1 (]: Began compiling node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m14:05:32.038365 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.not_null_mart_payments_user_id.63456e471a"
[0m14:05:32.039365 [debug] [Thread-1 (]: Began executing node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m14:05:32.042365 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_first.not_null_mart_payments_user_id.63456e471a"
[0m14:05:32.043363 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_first.not_null_mart_payments_user_id.63456e471a"
[0m14:05:32.043363 [debug] [Thread-1 (]: On test.dbt_first.not_null_mart_payments_user_id.63456e471a: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "test.dbt_first.not_null_mart_payments_user_id.63456e471a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from customer_orders.mart.mart_payments
where user_id is null



      
    ) dbt_internal_test
[0m14:05:32.353821 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.310 seconds
[0m14:05:32.360412 [info ] [Thread-1 (]: 3 of 5 PASS not_null_mart_payments_user_id ..................................... [[32mPASS[0m in 0.33s]
[0m14:05:32.362412 [debug] [Thread-1 (]: Finished running node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m14:05:32.363412 [debug] [Thread-1 (]: Began running node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m14:05:32.365372 [info ] [Thread-1 (]: 4 of 5 START test unique_mart_payments_orderid ................................. [RUN]
[0m14:05:32.366244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.not_null_mart_payments_user_id.63456e471a, now test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6)
[0m14:05:32.368534 [debug] [Thread-1 (]: Began compiling node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m14:05:32.383370 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6"
[0m14:05:32.384367 [debug] [Thread-1 (]: Began executing node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m14:05:32.388366 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6"
[0m14:05:32.389760 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6"
[0m14:05:32.390763 [debug] [Thread-1 (]: On test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    orderid as unique_field,
    count(*) as n_records

from customer_orders.mart.mart_payments
where orderid is not null
group by orderid
having count(*) > 1



      
    ) dbt_internal_test
[0m14:05:32.702466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.311 seconds
[0m14:05:32.704714 [error] [Thread-1 (]: 4 of 5 FAIL 17 unique_mart_payments_orderid .................................... [[31mFAIL 17[0m in 0.34s]
[0m14:05:32.704714 [debug] [Thread-1 (]: Finished running node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m14:05:32.705714 [debug] [Thread-1 (]: Began running node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m14:05:32.705714 [info ] [Thread-1 (]: 5 of 5 START test unique_mart_payments_user_id ................................. [RUN]
[0m14:05:32.706713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6, now test.dbt_first.unique_mart_payments_user_id.3f9a04b555)
[0m14:05:32.706713 [debug] [Thread-1 (]: Began compiling node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m14:05:32.710477 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.unique_mart_payments_user_id.3f9a04b555"
[0m14:05:32.711478 [debug] [Thread-1 (]: Began executing node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m14:05:32.713478 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_first.unique_mart_payments_user_id.3f9a04b555"
[0m14:05:32.714477 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_first.unique_mart_payments_user_id.3f9a04b555"
[0m14:05:32.715983 [debug] [Thread-1 (]: On test.dbt_first.unique_mart_payments_user_id.3f9a04b555: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "test.dbt_first.unique_mart_payments_user_id.3f9a04b555"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from customer_orders.mart.mart_payments
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:05:33.045630 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.329 seconds
[0m14:05:33.047627 [error] [Thread-1 (]: 5 of 5 FAIL 30 unique_mart_payments_user_id .................................... [[31mFAIL 30[0m in 0.34s]
[0m14:05:33.047918 [debug] [Thread-1 (]: Finished running node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m14:05:33.048956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:33.049956 [debug] [MainThread]: Connection 'list_customer_orders_staging' was left open.
[0m14:05:33.049956 [debug] [MainThread]: On list_customer_orders_staging: Close
[0m14:05:33.584526 [debug] [MainThread]: Connection 'test.dbt_first.unique_mart_payments_user_id.3f9a04b555' was left open.
[0m14:05:33.584526 [debug] [MainThread]: On test.dbt_first.unique_mart_payments_user_id.3f9a04b555: Close
[0m14:05:34.095610 [info ] [MainThread]: 
[0m14:05:34.097610 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 7.35 seconds (7.35s).
[0m14:05:34.099607 [debug] [MainThread]: Command end result
[0m14:05:34.133273 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:05:34.136276 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:05:34.143739 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:05:34.145316 [info ] [MainThread]: 
[0m14:05:34.145316 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m14:05:34.145316 [info ] [MainThread]: 
[0m14:05:34.148918 [error] [MainThread]: [31mFailure in test check_payment_mart_payments_ (models\Mart\schema.yml)[0m
[0m14:05:34.148918 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m14:05:34.148918 [info ] [MainThread]: 
[0m14:05:34.148918 [info ] [MainThread]:   compiled code at target\compiled\dbt_first\models\Mart\schema.yml\check_payment_mart_payments_.sql
[0m14:05:34.148918 [info ] [MainThread]: 
[0m14:05:34.148918 [error] [MainThread]: [31mFailure in test unique_mart_payments_orderid (models\Mart\schema.yml)[0m
[0m14:05:34.154315 [error] [MainThread]:   Got 17 results, configured to fail if != 0
[0m14:05:34.155322 [info ] [MainThread]: 
[0m14:05:34.155322 [info ] [MainThread]:   compiled code at target\compiled\dbt_first\models\Mart\schema.yml\unique_mart_payments_orderid.sql
[0m14:05:34.156324 [info ] [MainThread]: 
[0m14:05:34.157326 [error] [MainThread]: [31mFailure in test unique_mart_payments_user_id (models\Mart\schema.yml)[0m
[0m14:05:34.158324 [error] [MainThread]:   Got 30 results, configured to fail if != 0
[0m14:05:34.159322 [info ] [MainThread]: 
[0m14:05:34.160323 [info ] [MainThread]:   compiled code at target\compiled\dbt_first\models\Mart\schema.yml\unique_mart_payments_user_id.sql
[0m14:05:34.160323 [info ] [MainThread]: 
[0m14:05:34.161700 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 TOTAL=5
[0m14:05:34.163713 [debug] [MainThread]: Command `dbt test` failed at 14:05:34.161700 after 8.90 seconds
[0m14:05:34.165740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDE4CEF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDB6B38C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BDB6B3950>]}
[0m14:05:34.165740 [debug] [MainThread]: Flushing usage events
[0m14:05:35.124863 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:13.591468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B3C3B6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B3DB55EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B3DB55E20>]}


============================== 14:09:13.591468 | b1e47276-f5cb-49e1-87f2-2b27d11495d9 ==============================
[0m14:09:13.591468 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:09:13.591468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m14:09:14.125810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1e47276-f5cb-49e1-87f2-2b27d11495d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B3F294B00>]}
[0m14:09:14.180949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1e47276-f5cb-49e1-87f2-2b27d11495d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B3E753980>]}
[0m14:09:14.182954 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:09:14.592667 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:09:14.756088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:09:14.756088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:09:14.805447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1e47276-f5cb-49e1-87f2-2b27d11495d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B40405D60>]}
[0m14:09:14.829112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1e47276-f5cb-49e1-87f2-2b27d11495d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B407C2C00>]}
[0m14:09:14.829112 [info ] [MainThread]: Found 4 models, 1 seed, 5 data tests, 3 sources, 477 macros
[0m14:09:14.829112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e47276-f5cb-49e1-87f2-2b27d11495d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B3EF00EC0>]}
[0m14:09:14.836197 [info ] [MainThread]: 
[0m14:09:14.836197 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:09:14.836197 [info ] [MainThread]: 
[0m14:09:14.836197 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:09:14.841779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_customer_orders_staging'
[0m14:09:17.538583 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_staging"
[0m14:09:17.540652 [debug] [ThreadPool]: On list_customer_orders_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_staging"} */
show objects in customer_orders.staging limit 10000;
[0m14:09:17.540652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:19.374166 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.833 seconds
[0m14:09:19.376169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_customer_orders_staging, now list_MYDB_PUBLIC)
[0m14:09:19.379707 [debug] [ThreadPool]: Using snowflake connection "list_MYDB_PUBLIC"
[0m14:09:19.380705 [debug] [ThreadPool]: On list_MYDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_MYDB_PUBLIC"} */
show objects in MYDB.PUBLIC limit 10000;
[0m14:09:19.694615 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.316 seconds
[0m14:09:19.697882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MYDB_PUBLIC, now list_customer_orders_mart)
[0m14:09:19.702301 [debug] [ThreadPool]: Using snowflake connection "list_customer_orders_mart"
[0m14:09:19.702301 [debug] [ThreadPool]: On list_customer_orders_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_customer_orders_mart"} */
show objects in customer_orders.mart limit 10000;
[0m14:09:20.003512 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.302 seconds
[0m14:09:20.005562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1e47276-f5cb-49e1-87f2-2b27d11495d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B3F2E6810>]}
[0m14:09:20.005562 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m14:09:20.005562 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m14:09:20.005562 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m14:09:20.013499 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m14:09:20.013499 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m14:09:20.013499 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m14:09:20.013499 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_orders
[0m14:09:20.013499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_orders)
[0m14:09:20.013499 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_orders
[0m14:09:20.023257 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_orders"
[0m14:09:20.027455 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_orders
[0m14:09:20.028388 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_orders
[0m14:09:20.028388 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_payments
[0m14:09:20.029399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_orders, now model.dbt_first.stg_payments)
[0m14:09:20.029399 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_payments
[0m14:09:20.031450 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_payments"
[0m14:09:20.033500 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_payments
[0m14:09:20.035102 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_payments
[0m14:09:20.035102 [debug] [Thread-1 (]: Began running node seed.dbt_first.stripe_payments
[0m14:09:20.035102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_payments, now seed.dbt_first.stripe_payments)
[0m14:09:20.035102 [debug] [Thread-1 (]: Began compiling node seed.dbt_first.stripe_payments
[0m14:09:20.035102 [debug] [Thread-1 (]: Began executing node seed.dbt_first.stripe_payments
[0m14:09:20.035102 [debug] [Thread-1 (]: Finished running node seed.dbt_first.stripe_payments
[0m14:09:20.035102 [debug] [Thread-1 (]: Began running node model.dbt_first.mart_payments
[0m14:09:20.035102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_first.stripe_payments, now model.dbt_first.mart_payments)
[0m14:09:20.035102 [debug] [Thread-1 (]: Began compiling node model.dbt_first.mart_payments
[0m14:09:20.045241 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.mart_payments"
[0m14:09:20.045241 [debug] [Thread-1 (]: Began executing node model.dbt_first.mart_payments
[0m14:09:20.045241 [debug] [Thread-1 (]: Finished running node model.dbt_first.mart_payments
[0m14:09:20.045241 [debug] [Thread-1 (]: Began running node test.dbt_first.check_payment_mart_payments_.8bbd1039a4
[0m14:09:20.045241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.mart_payments, now test.dbt_first.check_payment_mart_payments_.8bbd1039a4)
[0m14:09:20.045241 [debug] [Thread-1 (]: Began compiling node test.dbt_first.check_payment_mart_payments_.8bbd1039a4
[0m14:09:20.057129 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.check_payment_mart_payments_.8bbd1039a4"
[0m14:09:20.057129 [debug] [Thread-1 (]: Began executing node test.dbt_first.check_payment_mart_payments_.8bbd1039a4
[0m14:09:20.059137 [debug] [Thread-1 (]: Finished running node test.dbt_first.check_payment_mart_payments_.8bbd1039a4
[0m14:09:20.059137 [debug] [Thread-1 (]: Began running node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m14:09:20.059137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.check_payment_mart_payments_.8bbd1039a4, now test.dbt_first.not_null_mart_payments_orderid.a332165774)
[0m14:09:20.059137 [debug] [Thread-1 (]: Began compiling node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m14:09:20.069215 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.not_null_mart_payments_orderid.a332165774"
[0m14:09:20.070216 [debug] [Thread-1 (]: Began executing node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m14:09:20.071184 [debug] [Thread-1 (]: Finished running node test.dbt_first.not_null_mart_payments_orderid.a332165774
[0m14:09:20.071184 [debug] [Thread-1 (]: Began running node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m14:09:20.072188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.not_null_mart_payments_orderid.a332165774, now test.dbt_first.not_null_mart_payments_user_id.63456e471a)
[0m14:09:20.072188 [debug] [Thread-1 (]: Began compiling node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m14:09:20.075793 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.not_null_mart_payments_user_id.63456e471a"
[0m14:09:20.076761 [debug] [Thread-1 (]: Began executing node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m14:09:20.077793 [debug] [Thread-1 (]: Finished running node test.dbt_first.not_null_mart_payments_user_id.63456e471a
[0m14:09:20.077793 [debug] [Thread-1 (]: Began running node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m14:09:20.078758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.not_null_mart_payments_user_id.63456e471a, now test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6)
[0m14:09:20.078758 [debug] [Thread-1 (]: Began compiling node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m14:09:20.083287 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6"
[0m14:09:20.083287 [debug] [Thread-1 (]: Began executing node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m14:09:20.083287 [debug] [Thread-1 (]: Finished running node test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6
[0m14:09:20.083287 [debug] [Thread-1 (]: Began running node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m14:09:20.083287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_first.unique_mart_payments_orderid.5e5dd4eea6, now test.dbt_first.unique_mart_payments_user_id.3f9a04b555)
[0m14:09:20.083287 [debug] [Thread-1 (]: Began compiling node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m14:09:20.083287 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_first.unique_mart_payments_user_id.3f9a04b555"
[0m14:09:20.083287 [debug] [Thread-1 (]: Began executing node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m14:09:20.083287 [debug] [Thread-1 (]: Finished running node test.dbt_first.unique_mart_payments_user_id.3f9a04b555
[0m14:09:20.093520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:20.093520 [debug] [MainThread]: Connection 'list_customer_orders_mart' was left open.
[0m14:09:20.094576 [debug] [MainThread]: On list_customer_orders_mart: Close
[0m14:09:20.609385 [debug] [MainThread]: Connection 'test.dbt_first.unique_mart_payments_user_id.3f9a04b555' was properly closed.
[0m14:09:20.613482 [debug] [MainThread]: Command end result
[0m14:09:20.713294 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:09:20.735501 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:09:20.742016 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:09:21.103391 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m14:09:21.103391 [info ] [MainThread]: Building catalog
[0m14:09:21.114840 [debug] [ThreadPool]: Acquiring new snowflake connection 'customer_orders.information_schema'
[0m14:09:21.131057 [debug] [ThreadPool]: Using snowflake connection "customer_orders.information_schema"
[0m14:09:21.131057 [debug] [ThreadPool]: On customer_orders.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "customer_orders.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from customer_orders.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'mart' and upper("table_schema") = upper('mart')

                    and 
    "table_name" ilike 'mart_payments' and upper("table_name") = upper('mart_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_payments' and upper("table_name") = upper('stg_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from customer_orders.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'mart' and upper("table_schema") = upper('mart')

                    and 
    "table_name" ilike 'mart_payments' and upper("table_name") = upper('mart_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_payments' and upper("table_name") = upper('stg_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_orders' and upper("table_name") = upper('stg_orders')

                )
             or 
                (
                    
    "table_schema" ilike 'staging' and upper("table_schema") = upper('staging')

                    and 
    "table_name" ilike 'stg_customers' and upper("table_name") = upper('stg_customers')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m14:09:21.131057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:25.103342 [debug] [ThreadPool]: SQL status: SUCCESS 21 in 3.974 seconds
[0m14:09:25.114828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly customer_orders.information_schema, now MYDB.information_schema)
[0m14:09:25.162677 [debug] [ThreadPool]: Using snowflake connection "MYDB.information_schema"
[0m14:09:25.162677 [debug] [ThreadPool]: On MYDB.information_schema: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "MYDB.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from MYDB.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stripe_payments' and upper("table_name") = upper('stripe_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_ORDERS' and upper("table_name") = upper('STG_ORDERS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STRIPE_PAYMENTS' and upper("table_name") = upper('STRIPE_PAYMENTS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_CUSTOMERS' and upper("table_name") = upper('STG_CUSTOMERS')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from MYDB.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'stripe_payments' and upper("table_name") = upper('stripe_payments')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_ORDERS' and upper("table_name") = upper('STG_ORDERS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STRIPE_PAYMENTS' and upper("table_name") = upper('STRIPE_PAYMENTS')

                )
             or 
                (
                    
    "table_schema" ilike 'PUBLIC' and upper("table_schema") = upper('PUBLIC')

                    and 
    "table_name" ilike 'STG_CUSTOMERS' and upper("table_name") = upper('STG_CUSTOMERS')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m14:09:27.593428 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 2.433 seconds
[0m14:09:27.621209 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\VarshaS\dbt_first\target\catalog.json
[0m14:09:27.647400 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:09:27.651418 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:09:27.651418 [info ] [MainThread]: Catalog written to C:\Users\VarshaS\dbt_first\target\catalog.json
[0m14:09:27.655498 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:09:27.655498 after 14.29 seconds
[0m14:09:27.655498 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:09:27.655498 [debug] [MainThread]: Connection 'MYDB.information_schema' was left open.
[0m14:09:27.657508 [debug] [MainThread]: On MYDB.information_schema: Close
[0m14:09:28.153925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B3E2EA030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B40A80680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B3E753980>]}
[0m14:09:28.161563 [debug] [MainThread]: Flushing usage events
[0m14:09:29.121187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:39.221098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935F430470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935F4305F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935F433800>]}


============================== 14:09:39.221098 | 9d0e4278-f78a-4227-9396-e8b77b2d5449 ==============================
[0m14:09:39.221098 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:09:39.236789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:39.660595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d0e4278-f78a-4227-9396-e8b77b2d5449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935E981CD0>]}
[0m14:09:39.710303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d0e4278-f78a-4227-9396-e8b77b2d5449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935F0FC200>]}
[0m14:15:39.851155 [error] [MainThread]: Encountered an error:

[0m14:15:39.908474 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m14:15:39.910495 [debug] [MainThread]: Command `dbt docs serve` failed at 14:15:39.910495 after 360.84 seconds
[0m14:15:39.910495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935EF739B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935F6FFEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001935F3E7A40>]}
[0m14:15:39.911512 [debug] [MainThread]: Flushing usage events
[0m09:47:36.846167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAEFE09B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAEFE08C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAEFE08D40>]}


============================== 09:47:36.862207 | 89b7491b-1fb7-4dc7-8cb8-c1fcde9e6c85 ==============================
[0m09:47:36.862207 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:47:36.862207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'c:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:47:36.983175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89b7491b-1fb7-4dc7-8cb8-c1fcde9e6c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAEF72B4A0>]}
[0m09:47:37.005052 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:47:37.005052 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:47:37.005052 [debug] [MainThread]: Command `cli deps` succeeded at 09:47:37.005052 after 0.34 seconds
[0m09:47:37.005052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF0321E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAF024FF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAEF7E23F0>]}
[0m09:47:37.005052 [debug] [MainThread]: Flushing usage events
[0m09:47:38.000070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:53:45.539259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DBF2D97C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DC2024890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DC2025E50>]}


============================== 09:53:45.539259 | ed90d2d8-c020-4a02-a2ad-c13b9ae16341 ==============================
[0m09:53:45.539259 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:53:45.539259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:53:45.550715 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'sample_dbt'
[0m09:53:45.550715 [debug] [MainThread]: Command `dbt seed` failed at 09:53:45.550715 after 0.27 seconds
[0m09:53:45.550715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DC1D73A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DC1EEBA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DC20259A0>]}
[0m09:53:45.550715 [debug] [MainThread]: Flushing usage events
[0m09:53:46.593485 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:54:26.235713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023581ADD1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023581ADF3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023581ADC170>]}


============================== 09:54:26.246230 | 3e21bbad-1df3-4eae-b593-474553d47064 ==============================
[0m09:54:26.246230 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:54:26.246230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:54:26.841395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e21bbad-1df3-4eae-b593-474553d47064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235828B7830>]}
[0m09:54:26.904473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e21bbad-1df3-4eae-b593-474553d47064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235816FB5F0>]}
[0m09:54:26.904473 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m09:54:27.330234 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:54:27.430608 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:54:27.430608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e21bbad-1df3-4eae-b593-474553d47064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023581643200>]}
[0m09:54:28.661120 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_first.highest_cross_sell' (models\Mart\highest_cross_sell.sql) depends on a node named 'transactions' which was not found
[0m09:54:28.661120 [debug] [MainThread]: Command `dbt seed` failed at 09:54:28.661120 after 2.59 seconds
[0m09:54:28.661120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023581AB7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023583B1ECF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023583DC7FB0>]}
[0m09:54:28.661120 [debug] [MainThread]: Flushing usage events
[0m09:54:29.697551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:33.459125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E6CA4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E6CA7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E6CA4380>]}


============================== 09:55:33.463275 | f2a5b9fb-acaf-49b2-bd38-89f3027fdbe9 ==============================
[0m09:55:33.463275 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:55:33.465450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:55:33.898807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2a5b9fb-acaf-49b2-bd38-89f3027fdbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E405E690>]}
[0m09:55:33.970991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2a5b9fb-acaf-49b2-bd38-89f3027fdbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E7A07F80>]}
[0m09:55:33.972497 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m09:55:34.284538 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:55:34.379121 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:55:34.379121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f2a5b9fb-acaf-49b2-bd38-89f3027fdbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E67E6FF0>]}
[0m09:55:35.668234 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_first.Mart
- seeds.healthcare.schema
[0m09:55:35.674056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2a5b9fb-acaf-49b2-bd38-89f3027fdbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E8F484A0>]}
[0m09:55:35.756662 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m09:55:35.781005 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m09:55:35.804064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2a5b9fb-acaf-49b2-bd38-89f3027fdbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E7A04770>]}
[0m09:55:35.804064 [info ] [MainThread]: Found 4 models, 1 seed, 4 sources, 474 macros
[0m09:55:35.805085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2a5b9fb-acaf-49b2-bd38-89f3027fdbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E8C7AF00>]}
[0m09:55:35.809089 [info ] [MainThread]: 
[0m09:55:35.809089 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:55:35.810055 [info ] [MainThread]: 
[0m09:55:35.811052 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:55:35.812081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m09:55:38.611691 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m09:55:38.611691 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m09:55:38.611691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:42.115235 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.500 seconds
[0m09:55:42.115235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE, now create_HEALTHCARE_PUBLIC_raw)
[0m09:55:42.115235 [debug] [ThreadPool]: Creating schema "database: "HEALTHCARE"
schema: "PUBLIC_raw"
"
[0m09:55:42.131074 [debug] [ThreadPool]: Using snowflake connection "create_HEALTHCARE_PUBLIC_raw"
[0m09:55:42.131074 [debug] [ThreadPool]: On create_HEALTHCARE_PUBLIC_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "create_HEALTHCARE_PUBLIC_raw"} */
create schema if not exists HEALTHCARE.PUBLIC_raw
[0m09:55:42.616076 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.481 seconds
[0m09:55:42.620129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_PUBLIC_stage'
[0m09:55:42.633986 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_PUBLIC_stage"
[0m09:55:42.633986 [debug] [ThreadPool]: On list_HEALTHCARE_PUBLIC_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_PUBLIC_stage"} */
show objects in HEALTHCARE.PUBLIC_stage limit 10000;
[0m09:55:42.633986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:44.232413 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bafea9-0004-bde4-0005-a3d300034c32
[0m09:55:44.232413 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m09:55:44.232413 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m09:55:44.232413 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m09:55:44.232413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_PUBLIC_stage, now list_HEALTHCARE_PUBLIC_raw)
[0m09:55:44.248524 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_PUBLIC_raw"
[0m09:55:44.248524 [debug] [ThreadPool]: On list_HEALTHCARE_PUBLIC_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_PUBLIC_raw"} */
show objects in HEALTHCARE.PUBLIC_raw limit 10000;
[0m09:55:44.622043 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.372 seconds
[0m09:55:44.622043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2a5b9fb-acaf-49b2-bd38-89f3027fdbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E9744E30>]}
[0m09:55:44.637815 [debug] [Thread-1 (]: Began running node seed.dbt_first.country_region
[0m09:55:44.637815 [info ] [Thread-1 (]: 1 of 1 START seed file PUBLIC_raw.country_region ............................... [RUN]
[0m09:55:44.637815 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.dbt_first.country_region'
[0m09:55:44.637815 [debug] [Thread-1 (]: Began compiling node seed.dbt_first.country_region
[0m09:55:44.637815 [debug] [Thread-1 (]: Began executing node seed.dbt_first.country_region
[0m09:55:44.690650 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.country_region"
[0m09:55:44.690650 [debug] [Thread-1 (]: On seed.dbt_first.country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.country_region"} */
create table HEALTHCARE.PUBLIC_raw.country_region (customer_id integer,country text,region text)
[0m09:55:44.691732 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:55:46.346228 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.656 seconds
[0m09:55:46.382299 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.country_region"
[0m09:55:46.384304 [debug] [Thread-1 (]: On seed.dbt_first.country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.country_region"} */
BEGIN
[0m09:55:46.897186 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m09:55:46.961624 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.country_region"
[0m09:55:46.961624 [debug] [Thread-1 (]: On seed.dbt_first.country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.country_region"} */
insert into HEALTHCARE.PUBLIC_raw.country_region (customer_id, country, region) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m09:55:48.687819 [debug] [Thread-1 (]: SQL status: SUCCESS 1760 in 1.726 seconds
[0m09:55:48.687819 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.country_region"
[0m09:55:48.689829 [debug] [Thread-1 (]: On seed.dbt_first.country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.country_region"} */
COMMIT
[0m09:55:49.344616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.667 seconds
[0m09:55:49.360567 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_first.country_region"
[0m09:55:49.376476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2a5b9fb-acaf-49b2-bd38-89f3027fdbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E405D850>]}
[0m09:55:49.376476 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file PUBLIC_raw.country_region ........................... [[32mINSERT 1760[0m in 4.74s]
[0m09:55:49.376476 [debug] [Thread-1 (]: Finished running node seed.dbt_first.country_region
[0m09:55:49.376476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:49.392233 [debug] [MainThread]: Connection 'create_HEALTHCARE_PUBLIC_raw' was left open.
[0m09:55:49.392233 [debug] [MainThread]: On create_HEALTHCARE_PUBLIC_raw: Close
[0m09:55:49.941444 [debug] [MainThread]: Connection 'list_HEALTHCARE_PUBLIC_raw' was left open.
[0m09:55:49.941444 [debug] [MainThread]: On list_HEALTHCARE_PUBLIC_raw: Close
[0m09:55:50.470825 [debug] [MainThread]: Connection 'seed.dbt_first.country_region' was left open.
[0m09:55:50.471827 [debug] [MainThread]: On seed.dbt_first.country_region: Close
[0m09:55:50.998306 [info ] [MainThread]: 
[0m09:55:51.000254 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 15.19 seconds (15.19s).
[0m09:55:51.003271 [debug] [MainThread]: Command end result
[0m09:55:51.031394 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m09:55:51.034470 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m09:55:51.040685 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m09:55:51.041652 [info ] [MainThread]: 
[0m09:55:51.041652 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:55:51.042652 [info ] [MainThread]: 
[0m09:55:51.043661 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:55:51.043661 [debug] [MainThread]: Command `dbt seed` succeeded at 09:55:51.043661 after 17.74 seconds
[0m09:55:51.043661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E6953A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E3549220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7E48490D0>]}
[0m09:55:51.043661 [debug] [MainThread]: Flushing usage events
[0m09:55:52.325261 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:56:03.700268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AF1095E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AF1087A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AF10B920>]}


============================== 09:56:03.700268 | 5f0b00aa-1327-4113-bde8-d5f1a94b0b6e ==============================
[0m09:56:03.700268 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:56:03.700268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:56:04.140048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f0b00aa-1327-4113-bde8-d5f1a94b0b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AFE96360>]}
[0m09:56:04.187863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f0b00aa-1327-4113-bde8-d5f1a94b0b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AFD79100>]}
[0m09:56:04.187863 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m09:56:04.499090 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:56:04.657931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:56:04.657931 [debug] [MainThread]: Partial parsing: added file: dbt_first://macros\generate_custom_schema.sql
[0m09:56:04.657931 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m09:56:05.850625 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_first.Mart
- seeds.healthcare.schema
[0m09:56:05.870485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f0b00aa-1327-4113-bde8-d5f1a94b0b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AFE16990>]}
[0m09:56:05.944952 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m09:56:05.961006 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m09:56:05.977157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f0b00aa-1327-4113-bde8-d5f1a94b0b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B121B0E0>]}
[0m09:56:05.977157 [info ] [MainThread]: Found 4 models, 1 seed, 4 sources, 475 macros
[0m09:56:05.977157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f0b00aa-1327-4113-bde8-d5f1a94b0b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B1251D00>]}
[0m09:56:05.986019 [info ] [MainThread]: 
[0m09:56:05.986019 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:56:05.986019 [info ] [MainThread]: 
[0m09:56:05.986019 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:56:05.986019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m09:56:06.071720 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m09:56:06.072720 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m09:56:06.072720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:08.231409 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.161 seconds
[0m09:56:08.231409 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m09:56:08.247063 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m09:56:08.247063 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m09:56:08.247063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:56:09.762014 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.515 seconds
[0m09:56:09.762014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m09:56:09.762014 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m09:56:09.762014 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m09:56:10.129506 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.359 seconds
[0m09:56:10.133066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f0b00aa-1327-4113-bde8-d5f1a94b0b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B185E900>]}
[0m09:56:10.133066 [debug] [Thread-1 (]: Began running node seed.dbt_first.country_region
[0m09:56:10.133066 [info ] [Thread-1 (]: 1 of 1 START seed file raw.country_region ...................................... [RUN]
[0m09:56:10.133066 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.dbt_first.country_region'
[0m09:56:10.133066 [debug] [Thread-1 (]: Began compiling node seed.dbt_first.country_region
[0m09:56:10.133066 [debug] [Thread-1 (]: Began executing node seed.dbt_first.country_region
[0m09:56:10.186988 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.country_region"
[0m09:56:10.187989 [debug] [Thread-1 (]: On seed.dbt_first.country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.country_region"} */
BEGIN
[0m09:56:10.187989 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:56:11.767684 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.591 seconds
[0m09:56:11.767684 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.country_region"
[0m09:56:11.780330 [debug] [Thread-1 (]: On seed.dbt_first.country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.country_region"} */
truncate table "HEALTHCARE"."RAW"."COUNTRY_REGION"
  ;
[0m09:56:12.411409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m09:56:12.411409 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.country_region"
[0m09:56:12.411409 [debug] [Thread-1 (]: On seed.dbt_first.country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.country_region"} */
COMMIT
[0m09:56:12.987562 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m09:56:13.030123 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.country_region"
[0m09:56:13.030123 [debug] [Thread-1 (]: On seed.dbt_first.country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.country_region"} */
BEGIN
[0m09:56:13.352869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.323 seconds
[0m09:56:13.391942 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.country_region"
[0m09:56:13.399708 [debug] [Thread-1 (]: On seed.dbt_first.country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.country_region"} */
insert into HEALTHCARE.raw.country_region (customer_id, country, region) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m09:56:14.156273 [debug] [Thread-1 (]: SQL status: SUCCESS 1760 in 0.762 seconds
[0m09:56:14.156273 [debug] [Thread-1 (]: Using snowflake connection "seed.dbt_first.country_region"
[0m09:56:14.156273 [debug] [Thread-1 (]: On seed.dbt_first.country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "seed.dbt_first.country_region"} */
COMMIT
[0m09:56:14.662893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m09:56:14.670667 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_first.country_region"
[0m09:56:14.700273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f0b00aa-1327-4113-bde8-d5f1a94b0b6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B1A75670>]}
[0m09:56:14.700273 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file raw.country_region .................................. [[32mINSERT 1760[0m in 4.57s]
[0m09:56:14.703294 [debug] [Thread-1 (]: Finished running node seed.dbt_first.country_region
[0m09:56:14.705303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:56:14.705303 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m09:56:14.705303 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m09:56:15.232136 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m09:56:15.232136 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m09:56:15.756479 [debug] [MainThread]: Connection 'seed.dbt_first.country_region' was left open.
[0m09:56:15.757483 [debug] [MainThread]: On seed.dbt_first.country_region: Close
[0m09:56:16.307209 [info ] [MainThread]: 
[0m09:56:16.307209 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m09:56:16.313305 [debug] [MainThread]: Command end result
[0m09:56:16.339065 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m09:56:16.342056 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m09:56:16.357881 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m09:56:16.358891 [info ] [MainThread]: 
[0m09:56:16.360881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:56:16.360881 [info ] [MainThread]: 
[0m09:56:16.361880 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:56:16.362882 [debug] [MainThread]: Command `dbt seed` succeeded at 09:56:16.362882 after 12.82 seconds
[0m09:56:16.363882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AE4E74A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223AF108140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223ACEB54C0>]}
[0m09:56:16.364881 [debug] [MainThread]: Flushing usage events
[0m09:56:17.398928 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:58:19.077107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828F7E7800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828CEC1EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828F75B6B0>]}


============================== 09:58:19.092884 | 674cf45c-a0b8-4d05-b42c-f1916fe8e9dd ==============================
[0m09:58:19.092884 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:58:19.092884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:stage', 'send_anonymous_usage_stats': 'True'}
[0m09:58:19.677967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '674cf45c-a0b8-4d05-b42c-f1916fe8e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018290A84470>]}
[0m09:58:19.748576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '674cf45c-a0b8-4d05-b42c-f1916fe8e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828FFE9280>]}
[0m09:58:19.748576 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m09:58:20.176972 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:58:21.429370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:58:21.429370 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:58:21.429370 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_first.Mart
- seeds.healthcare.schema
[0m09:58:21.464396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '674cf45c-a0b8-4d05-b42c-f1916fe8e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828FC7DA00>]}
[0m09:58:21.550441 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m09:58:21.560431 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m09:58:21.592046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '674cf45c-a0b8-4d05-b42c-f1916fe8e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018291EC0AD0>]}
[0m09:58:21.592046 [info ] [MainThread]: Found 4 models, 1 seed, 4 sources, 475 macros
[0m09:58:21.592046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '674cf45c-a0b8-4d05-b42c-f1916fe8e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018291B66C90>]}
[0m09:58:21.592046 [info ] [MainThread]: 
[0m09:58:21.607777 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:58:21.607777 [info ] [MainThread]: 
[0m09:58:21.607777 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:58:21.615161 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m09:58:24.113690 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m09:58:24.119437 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m09:58:24.119437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:26.136313 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.028 seconds
[0m09:58:26.136313 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m09:58:26.151985 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m09:58:26.151985 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m09:58:26.151985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:27.645533 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.484 seconds
[0m09:58:27.647542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m09:58:27.649548 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m09:58:27.649548 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m09:58:27.996694 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.355 seconds
[0m09:58:28.006934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '674cf45c-a0b8-4d05-b42c-f1916fe8e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018291B67CE0>]}
[0m09:58:28.012722 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_country_region
[0m09:58:28.012722 [info ] [Thread-1 (]: 1 of 4 START sql table model stage.stg_country_region .......................... [RUN]
[0m09:58:28.012722 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_country_region'
[0m09:58:28.012722 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_country_region
[0m09:58:28.125121 [debug] [Thread-1 (]: Compilation Error in model stg_country_region (models\Stage\stg_country_region.sql)
  'not_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:58:28.128170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674cf45c-a0b8-4d05-b42c-f1916fe8e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828FB721E0>]}
[0m09:58:28.128170 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model stage.stg_country_region ................. [[31mERROR[0m in 0.11s]
[0m09:58:28.128170 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_country_region
[0m09:58:28.128170 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m09:58:28.128170 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.stg_country_region' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_country_region (models\Stage\stg_country_region.sql)
  'not_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m09:58:28.128170 [info ] [Thread-1 (]: 2 of 4 START sql table model stage.stg_customers ............................... [RUN]
[0m09:58:28.132757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_country_region, now model.dbt_first.stg_customers)
[0m09:58:28.132757 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m09:58:28.132757 [debug] [Thread-1 (]: Compilation Error in model stg_customers (models\Stage\stg_customers.sql)
  'not_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:58:28.132757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674cf45c-a0b8-4d05-b42c-f1916fe8e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018292563770>]}
[0m09:58:28.132757 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model stage.stg_customers ...................... [[31mERROR[0m in 0.00s]
[0m09:58:28.132757 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m09:58:28.132757 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_products
[0m09:58:28.141494 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.stg_customers' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_customers (models\Stage\stg_customers.sql)
  'not_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m09:58:28.140615 [info ] [Thread-1 (]: 3 of 4 START sql table model stage.stg_products ................................ [RUN]
[0m09:58:28.141494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_products)
[0m09:58:28.142571 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_products
[0m09:58:28.146316 [debug] [Thread-1 (]: Compilation Error in model stg_products (models\Stage\stg_products.sql)
  'not_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:58:28.146316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674cf45c-a0b8-4d05-b42c-f1916fe8e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001829257AEA0>]}
[0m09:58:28.146316 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model stage.stg_products ....................... [[31mERROR[0m in 0.00s]
[0m09:58:28.146316 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_products
[0m09:58:28.146316 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_transactions
[0m09:58:28.151390 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.stg_products' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_products (models\Stage\stg_products.sql)
  'not_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m09:58:28.150797 [info ] [Thread-1 (]: 4 of 4 START sql table model stage.stg_transactions ............................ [RUN]
[0m09:58:28.151390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_products, now model.dbt_first.stg_transactions)
[0m09:58:28.152430 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_transactions
[0m09:58:28.159038 [debug] [Thread-1 (]: Compilation Error in model stg_transactions (models\Stage\stg_transactions.sql)
  'cast_cols' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:58:28.160047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '674cf45c-a0b8-4d05-b42c-f1916fe8e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001829258B3E0>]}
[0m09:58:28.160047 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model stage.stg_transactions ................... [[31mERROR[0m in 0.01s]
[0m09:58:28.161110 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_transactions
[0m09:58:28.162116 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.stg_transactions' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_transactions (models\Stage\stg_transactions.sql)
  'cast_cols' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m09:58:28.163116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:28.163116 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m09:58:28.163116 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m09:58:28.725358 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m09:58:28.725358 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m09:58:29.241139 [debug] [MainThread]: Connection 'model.dbt_first.stg_transactions' was properly closed.
[0m09:58:29.241139 [info ] [MainThread]: 
[0m09:58:29.241139 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.63 seconds (7.63s).
[0m09:58:29.256868 [debug] [MainThread]: Command end result
[0m09:58:29.292487 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m09:58:29.292487 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m09:58:29.292487 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m09:58:29.292487 [info ] [MainThread]: 
[0m09:58:29.292487 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m09:58:29.292487 [info ] [MainThread]: 
[0m09:58:29.303811 [error] [MainThread]:   Compilation Error in model stg_country_region (models\Stage\stg_country_region.sql)
  'not_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:58:29.305791 [info ] [MainThread]: 
[0m09:58:29.305791 [error] [MainThread]:   Compilation Error in model stg_customers (models\Stage\stg_customers.sql)
  'not_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:58:29.305791 [info ] [MainThread]: 
[0m09:58:29.305791 [error] [MainThread]:   Compilation Error in model stg_products (models\Stage\stg_products.sql)
  'not_null' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:58:29.308636 [info ] [MainThread]: 
[0m09:58:29.309349 [error] [MainThread]:   Compilation Error in model stg_transactions (models\Stage\stg_transactions.sql)
  'cast_cols' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:58:29.309349 [info ] [MainThread]: 
[0m09:58:29.310387 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m09:58:29.310387 [debug] [MainThread]: Command `dbt run` failed at 09:58:29.310387 after 10.45 seconds
[0m09:58:29.311924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828DA565A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001828F1F23F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182920E3F20>]}
[0m09:58:29.311924 [debug] [MainThread]: Flushing usage events
[0m09:58:30.584295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:58:58.219036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F19DFCB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F19DFC980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F19DFC9B0>]}


============================== 09:58:58.219036 | 37d27829-d243-4ab3-919e-9357282f1202 ==============================
[0m09:58:58.219036 [info ] [MainThread]: Running with dbt=1.9.3
[0m09:58:58.219036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:stage', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:58:58.673716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37d27829-d243-4ab3-919e-9357282f1202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F19E27950>]}
[0m09:58:58.737280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37d27829-d243-4ab3-919e-9357282f1202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F1AB67B90>]}
[0m09:58:58.737280 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m09:58:59.065218 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m09:58:59.223347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m09:58:59.223347 [debug] [MainThread]: Partial parsing: added file: dbt_first://macros\cast_cols.sql
[0m09:58:59.223347 [debug] [MainThread]: Partial parsing: added file: dbt_first://macros\not_null.sql
[0m09:58:59.301959 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_first.Mart
- seeds.healthcare.schema
[0m09:58:59.319652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37d27829-d243-4ab3-919e-9357282f1202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F1BC19670>]}
[0m09:58:59.404441 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m09:58:59.404441 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m09:58:59.432283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37d27829-d243-4ab3-919e-9357282f1202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F1BDF9370>]}
[0m09:58:59.432283 [info ] [MainThread]: Found 4 models, 1 seed, 4 sources, 477 macros
[0m09:58:59.432283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37d27829-d243-4ab3-919e-9357282f1202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F1BEB86B0>]}
[0m09:58:59.432283 [info ] [MainThread]: 
[0m09:58:59.432283 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:58:59.432283 [info ] [MainThread]: 
[0m09:58:59.432283 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:58:59.432283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m09:58:59.542235 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m09:58:59.543235 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m09:58:59.543235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:01.310714 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.770 seconds
[0m09:59:01.310714 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m09:59:01.325008 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m09:59:01.326747 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m09:59:01.326747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:02.838608 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.515 seconds
[0m09:59:02.843396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m09:59:02.847408 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m09:59:02.847408 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m09:59:03.164201 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.316 seconds
[0m09:59:03.166913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37d27829-d243-4ab3-919e-9357282f1202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F1BC45130>]}
[0m09:59:03.166913 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_country_region
[0m09:59:03.166913 [info ] [Thread-1 (]: 1 of 4 START sql table model stage.stg_country_region .......................... [RUN]
[0m09:59:03.166913 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_country_region'
[0m09:59:03.166913 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_country_region
[0m09:59:03.184885 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_country_region"
[0m09:59:03.185934 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_country_region
[0m09:59:03.222921 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_country_region"
[0m09:59:03.225924 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_country_region"
[0m09:59:03.225924 [debug] [Thread-1 (]: On model.dbt_first.stg_country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_country_region"} */
create or replace transient table HEALTHCARE.stage.stg_country_region
         as
        (

WITH cte_cleaned_data AS (
    SELECT 
        CAST(customer_id AS NUMBER(38,0)) AS customer_id,
        CAST(country AS VARCHAR(200)) AS country,
        CAST(region AS VARCHAR(200)) AS region,
        
        -- Standardizing country names
        UPPER(TRIM(country)) AS cleaned_country,

        -- Formatting region names properly
        INITCAP(TRIM(region)) AS cleaned_region

    FROM HEALTHCARE.RAW.COUNTRY_REGION

    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)

SELECT 
    customer_id,
    cleaned_country AS country,
    cleaned_region AS region
FROM cte_cleaned_data
        );
[0m09:59:03.226922 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:59:05.647458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.431 seconds
[0m09:59:05.681515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37d27829-d243-4ab3-919e-9357282f1202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F192E0350>]}
[0m09:59:05.681515 [info ] [Thread-1 (]: 1 of 4 OK created sql table model stage.stg_country_region ..................... [[32mSUCCESS 1[0m in 2.51s]
[0m09:59:05.681515 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_country_region
[0m09:59:05.681515 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m09:59:05.681515 [info ] [Thread-1 (]: 2 of 4 START sql table model stage.stg_customers ............................... [RUN]
[0m09:59:05.681515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_country_region, now model.dbt_first.stg_customers)
[0m09:59:05.681515 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m09:59:05.681515 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m09:59:05.681515 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m09:59:05.681515 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_customers"
[0m09:59:05.696509 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_customers"
[0m09:59:05.696509 [debug] [Thread-1 (]: On model.dbt_first.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_customers"} */
create or replace transient table HEALTHCARE.stage.stg_customers
         as
        (

WITH cte_handle_null AS (
    SELECT 
        customer_id,
        TRIM(customer_name) AS customer_name,
        TRIM(company) AS company
    FROM HEALTHCARE.RAW.CUSTOMERS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    
  -- Using macro for NULL check
),

cte_final AS (
    SELECT 
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(customer_name AS VARCHAR(300)) AS customer_name,
    
        CAST(company AS VARCHAR(100)) AS company,
    

    FROM cte_handle_null
)

SELECT * FROM cte_final
        );
[0m09:59:06.901732 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.207 seconds
[0m09:59:06.901732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37d27829-d243-4ab3-919e-9357282f1202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F1A83F830>]}
[0m09:59:06.901732 [info ] [Thread-1 (]: 2 of 4 OK created sql table model stage.stg_customers .......................... [[32mSUCCESS 1[0m in 1.22s]
[0m09:59:06.901732 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m09:59:06.901732 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_products
[0m09:59:06.901732 [info ] [Thread-1 (]: 3 of 4 START sql table model stage.stg_products ................................ [RUN]
[0m09:59:06.901732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_products)
[0m09:59:06.901732 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_products
[0m09:59:06.901732 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_products"
[0m09:59:06.901732 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_products
[0m09:59:06.918577 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_products"
[0m09:59:06.921818 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_products"
[0m09:59:06.921818 [debug] [Thread-1 (]: On model.dbt_first.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_products"} */
create or replace transient table HEALTHCARE.stage.stg_products
         as
        (

WITH cte_not_null AS (
    SELECT 
        TRIM(product_id) AS product_id, 
        TRIM(product_family) AS product_family, 
        TRIM(product_sub_family) AS product_sub_family
    FROM HEALTHCARE.RAW.PRODUCTS
    WHERE 
    
        product_id IS NOT NULL
         AND 
    
        product_family IS NOT NULL
         AND 
    
        product_sub_family IS NOT NULL
        
    

),

cte_final AS (
    SELECT 
        
    
        CAST(product_id AS VARCHAR(500)) AS product_id,
    
        CAST(product_family AS VARCHAR(500)) AS product_family,
    
        CAST(product_sub_family AS VARCHAR(500)) AS product_sub_family,
    

    FROM cte_not_null
)

SELECT * FROM cte_final
        );
[0m09:59:08.257587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.342 seconds
[0m09:59:08.265708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37d27829-d243-4ab3-919e-9357282f1202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F1C5642F0>]}
[0m09:59:08.265708 [info ] [Thread-1 (]: 3 of 4 OK created sql table model stage.stg_products ........................... [[32mSUCCESS 1[0m in 1.36s]
[0m09:59:08.265708 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_products
[0m09:59:08.265708 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_transactions
[0m09:59:08.265708 [info ] [Thread-1 (]: 4 of 4 START sql table model stage.stg_transactions ............................ [RUN]
[0m09:59:08.265708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_products, now model.dbt_first.stg_transactions)
[0m09:59:08.265708 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_transactions
[0m09:59:08.275505 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_transactions"
[0m09:59:08.275505 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_transactions
[0m09:59:08.284281 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_transactions"
[0m09:59:08.289661 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_transactions"
[0m09:59:08.290709 [debug] [Thread-1 (]: On model.dbt_first.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_transactions"} */
create or replace transient table HEALTHCARE.stage.stg_transactions
         as
        (

WITH cte_cleaned_data AS (
    SELECT  
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(revenue AS DECIMAL(10,3)) AS revenue,
    
        CAST(quantity AS INT) AS quantity,
    
        CAST(product_id AS VARCHAR(200)) AS product_id,
    
        CAST(payment_mode AS TIMESTAMP) AS payment_mode,
    
        CAST(companies AS VARCHAR(100)) AS companies,
    


        CASE 
            WHEN revenue_type = 'True' THEN 1
            WHEN revenue_type = 'False' THEN 0
            ELSE NULL 
        END AS revenue_type,

        CAST(dimension_1 AS VARCHAR(10)) AS dim_1,
        CAST(dimension_2 AS VARCHAR(10)) AS dim_2,
        CAST(dimension_3 AS VARCHAR(10)) AS dim_3,
        CAST(dimension_4 AS VARCHAR(10)) AS dim_4,
        CAST(dimension_5 AS VARCHAR(10)) AS dim_5,
        CAST(dimension_6 AS VARCHAR(10)) AS dim_6,
        CAST(dimension_7 AS VARCHAR(10)) AS dim_7,
        CAST(dimension_8 AS VARCHAR(10)) AS dim_8,
        CAST(dimension_9 AS VARCHAR(10)) AS dim_9,
        CAST(dimension_10 AS VARCHAR(10)) AS dim_10
    FROM HEALTHCARE.RAW.TRANSACTIONS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        product_id IS NOT NULL
         AND 
    
        payment_mode IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        dimension_1 IS NOT NULL
         AND 
    
        dimension_2 IS NOT NULL
         AND 
    
        dimension_3 IS NOT NULL
         AND 
    
        dimension_4 IS NOT NULL
         AND 
    
        dimension_5 IS NOT NULL
         AND 
    
        dimension_6 IS NOT NULL
         AND 
    
        dimension_7 IS NOT NULL
         AND 
    
        dimension_8 IS NOT NULL
         AND 
    
        dimension_9 IS NOT NULL
         AND 
    
        dimension_10 IS NOT NULL
         AND 
    
        companies IS NOT NULL
        
    

),
cte_name_change AS(
    SELECT 
        customer_id,
        revenue,
        quantity,
        product_id,
        payment_mode,
        companies       AS company_name,
        revenue_type,
        dim_1,
        dim_2,
        dim_3,
        dim_4,
        dim_5,
        dim_6,
        dim_7,
        dim_8,
        dim_9,
        dim_10
    FROM 
        cte_cleaned_data
)

SELECT * FROM cte_name_change
        );
[0m09:59:09.463009 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.184 seconds
[0m09:59:09.479124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37d27829-d243-4ab3-919e-9357282f1202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F1C565130>]}
[0m09:59:09.479124 [info ] [Thread-1 (]: 4 of 4 OK created sql table model stage.stg_transactions ....................... [[32mSUCCESS 1[0m in 1.21s]
[0m09:59:09.479124 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_transactions
[0m09:59:09.479124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:09.479124 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m09:59:09.479124 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m09:59:09.994482 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m09:59:09.996492 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m09:59:10.528608 [debug] [MainThread]: Connection 'model.dbt_first.stg_transactions' was left open.
[0m09:59:10.528608 [debug] [MainThread]: On model.dbt_first.stg_transactions: Close
[0m09:59:11.044510 [info ] [MainThread]: 
[0m09:59:11.044510 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 11.61 seconds (11.61s).
[0m09:59:11.060564 [debug] [MainThread]: Command end result
[0m09:59:11.148032 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m09:59:11.150034 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m09:59:11.156033 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m09:59:11.157002 [info ] [MainThread]: 
[0m09:59:11.157002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:11.158358 [info ] [MainThread]: 
[0m09:59:11.159364 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:59:11.160396 [debug] [MainThread]: Command `dbt run` succeeded at 09:59:11.159364 after 13.11 seconds
[0m09:59:11.160396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F192E16A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F19B727E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F1BFC7980>]}
[0m09:59:11.160396 [debug] [MainThread]: Flushing usage events
[0m09:59:12.130928 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:08:36.622094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1CBEA2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1CBE9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1CBE8470>]}


============================== 10:08:36.637776 | a30e2155-8be7-4f18-bc3e-b77871e7ea80 ==============================
[0m10:08:36.637776 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:08:36.637776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:product_churn', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:08:37.404142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a30e2155-8be7-4f18-bc3e-b77871e7ea80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1C3D18E0>]}
[0m10:08:37.469950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a30e2155-8be7-4f18-bc3e-b77871e7ea80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1CD9E270>]}
[0m10:08:37.471955 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:08:37.985102 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:08:38.243393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m10:08:38.243393 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Mart\highest_cross_sell.sql
[0m10:08:38.243393 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Mart\schema.yml
[0m10:08:38.243393 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Mart\churned_new_customers.sql
[0m10:08:38.243393 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Mart\product_churn.sql
[0m10:08:38.519143 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:08:38.534877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a30e2155-8be7-4f18-bc3e-b77871e7ea80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1EDF8CB0>]}
[0m10:08:38.627395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:08:38.627395 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:08:38.674465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a30e2155-8be7-4f18-bc3e-b77871e7ea80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1EC609E0>]}
[0m10:08:38.674465 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:08:38.674465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a30e2155-8be7-4f18-bc3e-b77871e7ea80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1EE764E0>]}
[0m10:08:38.674465 [info ] [MainThread]: 
[0m10:08:38.674465 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:08:38.674465 [info ] [MainThread]: 
[0m10:08:38.674465 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:08:38.674465 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:08:38.832827 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:08:38.835976 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:08:38.835976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:40.889365 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.062 seconds
[0m10:08:40.899982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE, now create_HEALTHCARE_mart)
[0m10:08:40.899982 [debug] [ThreadPool]: Creating schema "database: "HEALTHCARE"
schema: "mart"
"
[0m10:08:40.905008 [debug] [ThreadPool]: Using snowflake connection "create_HEALTHCARE_mart"
[0m10:08:40.907015 [debug] [ThreadPool]: On create_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "create_HEALTHCARE_mart"} */
create schema if not exists HEALTHCARE.mart
[0m10:08:41.271647 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.370 seconds
[0m10:08:41.271647 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m10:08:41.285831 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:08:41.285831 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:08:41.285831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:42.881914 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.603 seconds
[0m10:08:42.897647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m10:08:42.897647 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:08:42.897647 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:08:43.258406 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.358 seconds
[0m10:08:43.258406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m10:08:43.258406 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:08:43.258406 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:08:43.652553 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.387 seconds
[0m10:08:43.653621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a30e2155-8be7-4f18-bc3e-b77871e7ea80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1EDA98E0>]}
[0m10:08:43.653621 [debug] [Thread-1 (]: Began running node model.dbt_first.product_churn
[0m10:08:43.653621 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.product_churn ................................ [RUN]
[0m10:08:43.653621 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.product_churn'
[0m10:08:43.665846 [debug] [Thread-1 (]: Began compiling node model.dbt_first.product_churn
[0m10:08:43.672851 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.product_churn"
[0m10:08:43.673851 [debug] [Thread-1 (]: Began executing node model.dbt_first.product_churn
[0m10:08:43.704283 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.product_churn"
[0m10:08:43.709514 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.product_churn"
[0m10:08:43.709514 [debug] [Thread-1 (]: On model.dbt_first.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.product_churn"} */
create or replace transient table HEALTHCARE.mart.product_churn
         as
        (
WITH last_purchase AS (
    SELECT
        product_id,
        MAX(transaction_date) AS last_transaction_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY product_id
),

churned_products AS (
    SELECT
        p.product_id,
        p.product_name,
        lp.last_transaction_date
    FROM last_purchase lp
    JOIN HEALTHCARE.stage.stg_products p ON lp.product_id = p.product_id
    WHERE lp.last_transaction_date < DATEADD(MONTH, -6, CURRENT_DATE)  -- Products not sold in last 6 months
)

SELECT * FROM churned_products;
[0m10:08:43.715852 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:08:45.332932 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeb6-0004-bb9d-0005-a3d30003ac9e
[0m10:08:45.332932 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 22 at position 30 unexpected ';'.
[0m10:08:45.332932 [debug] [Thread-1 (]: Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 30 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m10:08:45.346612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a30e2155-8be7-4f18-bc3e-b77871e7ea80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1F4E3170>]}
[0m10:08:45.346612 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.product_churn ....................... [[31mERROR[0m in 1.68s]
[0m10:08:45.346612 [debug] [Thread-1 (]: Finished running node model.dbt_first.product_churn
[0m10:08:45.346612 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.product_churn' to be skipped because of status 'error'.  Reason: Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 30 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql.
[0m10:08:45.346612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:45.346612 [debug] [MainThread]: Connection 'create_HEALTHCARE_mart' was left open.
[0m10:08:45.346612 [debug] [MainThread]: On create_HEALTHCARE_mart: Close
[0m10:08:45.918517 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m10:08:45.932088 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m10:08:46.514036 [debug] [MainThread]: Connection 'model.dbt_first.product_churn' was left open.
[0m10:08:46.514036 [debug] [MainThread]: On model.dbt_first.product_churn: Close
[0m10:08:47.029513 [info ] [MainThread]: 
[0m10:08:47.029513 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.36 seconds (8.36s).
[0m10:08:47.029513 [debug] [MainThread]: Command end result
[0m10:08:47.062507 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:08:47.062507 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:08:47.201825 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:08:47.202612 [info ] [MainThread]: 
[0m10:08:47.203684 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:08:47.203684 [info ] [MainThread]: 
[0m10:08:47.204798 [error] [MainThread]:   Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 22 at position 30 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m10:08:47.204798 [info ] [MainThread]: 
[0m10:08:47.204798 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:08:47.204798 [debug] [MainThread]: Command `dbt run` failed at 10:08:47.204798 after 10.80 seconds
[0m10:08:47.204798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1CAAB1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1C0550A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1C21B830>]}
[0m10:08:47.204798 [debug] [MainThread]: Flushing usage events
[0m10:08:48.187277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:08:59.725024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB50F0A690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4F1B97F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB517A65A0>]}


============================== 10:08:59.735533 | c14d5cb8-22bb-4060-b559-5d38f0f8a671 ==============================
[0m10:08:59.735533 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:08:59.735533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:product_churn', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:09:00.191561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c14d5cb8-22bb-4060-b559-5d38f0f8a671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB52AF7890>]}
[0m10:09:00.255186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c14d5cb8-22bb-4060-b559-5d38f0f8a671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB52BAC410>]}
[0m10:09:00.255186 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:09:00.607934 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:09:00.773016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:09:00.773016 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\product_churn.sql
[0m10:09:01.027894 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:09:01.041588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c14d5cb8-22bb-4060-b559-5d38f0f8a671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB54180980>]}
[0m10:09:01.116457 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:09:01.116457 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:09:01.149388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c14d5cb8-22bb-4060-b559-5d38f0f8a671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB54120560>]}
[0m10:09:01.149388 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:09:01.149388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c14d5cb8-22bb-4060-b559-5d38f0f8a671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB5419EEA0>]}
[0m10:09:01.149388 [info ] [MainThread]: 
[0m10:09:01.149388 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:09:01.149388 [info ] [MainThread]: 
[0m10:09:01.149388 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:09:01.149388 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:09:01.251303 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:09:01.251303 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:09:01.252299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:03.225239 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.973 seconds
[0m10:09:03.231719 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m10:09:03.241376 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:09:03.241376 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:09:03.241376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:09:04.761507 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.534 seconds
[0m10:09:04.777314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m10:09:04.777314 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:09:04.777314 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:09:05.167512 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.395 seconds
[0m10:09:05.167512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m10:09:05.214934 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:09:05.214934 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:09:05.542438 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.329 seconds
[0m10:09:05.558320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c14d5cb8-22bb-4060-b559-5d38f0f8a671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB541F0440>]}
[0m10:09:05.558320 [debug] [Thread-1 (]: Began running node model.dbt_first.product_churn
[0m10:09:05.558320 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.product_churn ................................ [RUN]
[0m10:09:05.558320 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.product_churn'
[0m10:09:05.558320 [debug] [Thread-1 (]: Began compiling node model.dbt_first.product_churn
[0m10:09:05.558320 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.product_churn"
[0m10:09:05.573986 [debug] [Thread-1 (]: Began executing node model.dbt_first.product_churn
[0m10:09:05.607272 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.product_churn"
[0m10:09:05.609273 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.product_churn"
[0m10:09:05.609273 [debug] [Thread-1 (]: On model.dbt_first.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.product_churn"} */
create or replace transient table HEALTHCARE.mart.product_churn
         as
        (
WITH last_purchase AS (
    SELECT
        product_id,
        MAX(transaction_date) AS last_transaction_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY product_id
),

churned_products AS (
    SELECT
        p.product_id,
        p.product_name,
        lp.last_transaction_date
    FROM last_purchase lp
    JOIN HEALTHCARE.stage.stg_products p ON lp.product_id = p.product_id
    WHERE lp.last_transaction_date < DATEADD(MONTH, -6, CURRENT_DATE)  -- Products not sold in last 6 months
)

SELECT * FROM churned_products
        );
[0m10:09:05.610273 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:09:07.135951 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeb7-0004-bb9d-0005-a3d30003aca6
[0m10:09:07.135951 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 12
invalid identifier 'TRANSACTION_DATE'
[0m10:09:07.139959 [debug] [Thread-1 (]: Database Error in model product_churn (models\Mart\product_churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'TRANSACTION_DATE'
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m10:09:07.139959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c14d5cb8-22bb-4060-b559-5d38f0f8a671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB51360800>]}
[0m10:09:07.139959 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.product_churn ....................... [[31mERROR[0m in 1.58s]
[0m10:09:07.139959 [debug] [Thread-1 (]: Finished running node model.dbt_first.product_churn
[0m10:09:07.139959 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.product_churn' to be skipped because of status 'error'.  Reason: Database Error in model product_churn (models\Mart\product_churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'TRANSACTION_DATE'
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql.
[0m10:09:07.145847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:09:07.145847 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m10:09:07.145847 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m10:09:07.661044 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m10:09:07.661044 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m10:09:08.211166 [debug] [MainThread]: Connection 'model.dbt_first.product_churn' was left open.
[0m10:09:08.211166 [debug] [MainThread]: On model.dbt_first.product_churn: Close
[0m10:09:09.340872 [info ] [MainThread]: 
[0m10:09:09.340872 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.19 seconds (8.19s).
[0m10:09:09.340872 [debug] [MainThread]: Command end result
[0m10:09:09.375761 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:09:09.375761 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:09:09.375761 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:09:09.375761 [info ] [MainThread]: 
[0m10:09:09.375761 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:09:09.388432 [info ] [MainThread]: 
[0m10:09:09.389462 [error] [MainThread]:   Database Error in model product_churn (models\Mart\product_churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'TRANSACTION_DATE'
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m10:09:09.389462 [info ] [MainThread]: 
[0m10:09:09.390466 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:09:09.391962 [debug] [MainThread]: Command `dbt run` failed at 10:09:09.391439 after 9.83 seconds
[0m10:09:09.391962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB51340500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB51554CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB51ECE030>]}
[0m10:09:09.391962 [debug] [MainThread]: Flushing usage events
[0m10:09:10.424765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:10:32.336964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226D6385B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226D6384980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226D63852B0>]}


============================== 10:10:32.336964 | c564770b-e872-4a7c-a0e5-23c726b91a3c ==============================
[0m10:10:32.336964 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:10:32.351388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:product_churn', 'send_anonymous_usage_stats': 'True'}
[0m10:10:32.805187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c564770b-e872-4a7c-a0e5-23c726b91a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226D376E9C0>]}
[0m10:10:32.866846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c564770b-e872-4a7c-a0e5-23c726b91a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226D70E7890>]}
[0m10:10:32.868852 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:10:33.208356 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:10:33.387367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:10:33.387367 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\product_churn.sql
[0m10:10:33.652168 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:10:33.665722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c564770b-e872-4a7c-a0e5-23c726b91a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226D8660830>]}
[0m10:10:33.754157 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:10:33.756163 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:10:33.783981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c564770b-e872-4a7c-a0e5-23c726b91a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226D85F0890>]}
[0m10:10:33.785988 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:10:33.785988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c564770b-e872-4a7c-a0e5-23c726b91a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226D8623710>]}
[0m10:10:33.787994 [info ] [MainThread]: 
[0m10:10:33.787994 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:10:33.789743 [info ] [MainThread]: 
[0m10:10:33.789743 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:10:33.791753 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:10:33.885496 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:10:33.885496 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:10:33.886495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:35.777454 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.898 seconds
[0m10:10:35.793267 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m10:10:35.803729 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:10:35.805736 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:10:35.805736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:37.394497 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.601 seconds
[0m10:10:37.394497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m10:10:37.410198 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:10:37.410198 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:10:37.763885 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.352 seconds
[0m10:10:37.763885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m10:10:37.819944 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:10:37.819944 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:10:38.144954 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.329 seconds
[0m10:10:38.144954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c564770b-e872-4a7c-a0e5-23c726b91a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226D38037A0>]}
[0m10:10:38.158604 [debug] [Thread-1 (]: Began running node model.dbt_first.product_churn
[0m10:10:38.158604 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.product_churn ................................ [RUN]
[0m10:10:38.160611 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.product_churn'
[0m10:10:38.160611 [debug] [Thread-1 (]: Began compiling node model.dbt_first.product_churn
[0m10:10:38.160611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.product_churn"
[0m10:10:38.160611 [debug] [Thread-1 (]: Began executing node model.dbt_first.product_churn
[0m10:10:38.197058 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.product_churn"
[0m10:10:38.197058 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.product_churn"
[0m10:10:38.197058 [debug] [Thread-1 (]: On model.dbt_first.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.product_churn"} */
create or replace transient table HEALTHCARE.mart.product_churn
         as
        (
WITH last_purchase AS (
    SELECT
        product_id,
        MAX(payment_mode) AS last_transaction_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY product_id
),

churned_products AS (
    SELECT
        p.product_id,
        p.product_name,
        lp.last_transaction_date
    FROM last_purchase lp
    JOIN HEALTHCARE.stage.stg_products p ON lp.product_id = p.product_id
    WHERE lp.last_transaction_date < DATEADD(MONTH, -6, CURRENT_DATE)  -- Products not sold in last 6 months
)

SELECT * FROM churned_products
        );
[0m10:10:38.197058 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:10:39.776958 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeb8-0004-bded-0005-a3d300030cb6
[0m10:10:39.776958 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 8
invalid identifier 'P.PRODUCT_NAME'
[0m10:10:39.776958 [debug] [Thread-1 (]: Database Error in model product_churn (models\Mart\product_churn.sql)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'P.PRODUCT_NAME'
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m10:10:39.783276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c564770b-e872-4a7c-a0e5-23c726b91a3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226D5840BC0>]}
[0m10:10:39.786110 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.product_churn ....................... [[31mERROR[0m in 1.62s]
[0m10:10:39.786110 [debug] [Thread-1 (]: Finished running node model.dbt_first.product_churn
[0m10:10:39.786110 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.product_churn' to be skipped because of status 'error'.  Reason: Database Error in model product_churn (models\Mart\product_churn.sql)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'P.PRODUCT_NAME'
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql.
[0m10:10:39.786110 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:39.786110 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m10:10:39.786110 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m10:10:40.309773 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m10:10:40.309773 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m10:10:40.850947 [debug] [MainThread]: Connection 'model.dbt_first.product_churn' was left open.
[0m10:10:40.851945 [debug] [MainThread]: On model.dbt_first.product_churn: Close
[0m10:10:41.394787 [info ] [MainThread]: 
[0m10:10:41.394787 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m10:10:41.394787 [debug] [MainThread]: Command end result
[0m10:10:41.419609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:10:41.422610 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:10:41.427689 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:10:41.427689 [info ] [MainThread]: 
[0m10:10:41.427689 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:10:41.427689 [info ] [MainThread]: 
[0m10:10:41.427689 [error] [MainThread]:   Database Error in model product_churn (models\Mart\product_churn.sql)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'P.PRODUCT_NAME'
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m10:10:41.427689 [info ] [MainThread]: 
[0m10:10:41.433016 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:10:41.434030 [debug] [MainThread]: Command `dbt run` failed at 10:10:41.434030 after 9.31 seconds
[0m10:10:41.435022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226D5EC2BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226D5EC3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226D835B440>]}
[0m10:10:41.435022 [debug] [MainThread]: Flushing usage events
[0m10:10:42.446307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:11:28.807731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BB34D940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BDD44F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BDD45BE0>]}


============================== 10:11:28.819765 | b8daa3ac-42bb-48cb-85a5-40ae19617c93 ==============================
[0m10:11:28.819765 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:11:28.819765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:product_churn', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:11:29.274788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8daa3ac-42bb-48cb-85a5-40ae19617c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BF5F7890>]}
[0m10:11:29.338028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8daa3ac-42bb-48cb-85a5-40ae19617c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BF292360>]}
[0m10:11:29.338028 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:11:29.716108 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:11:29.894786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:11:29.894786 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\product_churn.sql
[0m10:11:30.169296 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:11:30.187865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8daa3ac-42bb-48cb-85a5-40ae19617c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0C0AF3CB0>]}
[0m10:11:30.266744 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:11:30.266744 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:11:30.296191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8daa3ac-42bb-48cb-85a5-40ae19617c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0C0B80830>]}
[0m10:11:30.296191 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:11:30.296191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8daa3ac-42bb-48cb-85a5-40ae19617c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0C0714CE0>]}
[0m10:11:30.296191 [info ] [MainThread]: 
[0m10:11:30.296191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:11:30.296191 [info ] [MainThread]: 
[0m10:11:30.296191 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:11:30.312204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:11:30.450302 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:11:30.452308 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:11:30.452308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:32.418942 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.968 seconds
[0m10:11:32.430731 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m10:11:32.442787 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:11:32.442787 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:11:32.442787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:33.903971 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.459 seconds
[0m10:11:33.903971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m10:11:33.907723 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:11:33.907723 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:11:34.217647 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.317 seconds
[0m10:11:34.217647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m10:11:34.280780 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:11:34.280780 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:11:34.681595 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.396 seconds
[0m10:11:34.683601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8daa3ac-42bb-48cb-85a5-40ae19617c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BBD23620>]}
[0m10:11:34.687612 [debug] [Thread-1 (]: Began running node model.dbt_first.product_churn
[0m10:11:34.689620 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.product_churn ................................ [RUN]
[0m10:11:34.689620 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.product_churn'
[0m10:11:34.689620 [debug] [Thread-1 (]: Began compiling node model.dbt_first.product_churn
[0m10:11:34.691365 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.product_churn"
[0m10:11:34.691365 [debug] [Thread-1 (]: Began executing node model.dbt_first.product_churn
[0m10:11:34.725039 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.product_churn"
[0m10:11:34.738153 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.product_churn"
[0m10:11:34.740402 [debug] [Thread-1 (]: On model.dbt_first.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.product_churn"} */
create or replace transient table HEALTHCARE.mart.product_churn
         as
        (
WITH last_purchase AS (
    SELECT
        product_id,
        MAX(payment_mode) AS last_transaction_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY product_id
),

churned_products AS (
    SELECT
        p.product_id,
        p.product_name,
        lp.last_transaction_date
    FROM last_purchase AS lp
    JOIN HEALTHCARE.stage.stg_products  AS p ON lp.product_id = p.product_id
    WHERE lp.last_transaction_date < DATEADD(MONTH, -6, CURRENT_DATE)  -- Products not sold in last 6 months
)

SELECT * FROM churned_products
        );
[0m10:11:34.740402 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:11:36.237813 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeb9-0004-bded-0005-a3d300030cbe
[0m10:11:36.237813 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 8
invalid identifier 'P.PRODUCT_NAME'
[0m10:11:36.241823 [debug] [Thread-1 (]: Database Error in model product_churn (models\Mart\product_churn.sql)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'P.PRODUCT_NAME'
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m10:11:36.243828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8daa3ac-42bb-48cb-85a5-40ae19617c93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BE416F00>]}
[0m10:11:36.243828 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.product_churn ....................... [[31mERROR[0m in 1.55s]
[0m10:11:36.243828 [debug] [Thread-1 (]: Finished running node model.dbt_first.product_churn
[0m10:11:36.245833 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.product_churn' to be skipped because of status 'error'.  Reason: Database Error in model product_churn (models\Mart\product_churn.sql)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'P.PRODUCT_NAME'
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql.
[0m10:11:36.247581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:36.247581 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m10:11:36.247581 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m10:11:36.780042 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m10:11:36.780042 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m10:11:37.295534 [debug] [MainThread]: Connection 'model.dbt_first.product_churn' was left open.
[0m10:11:37.295534 [debug] [MainThread]: On model.dbt_first.product_churn: Close
[0m10:11:37.831892 [info ] [MainThread]: 
[0m10:11:37.831892 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.54 seconds (7.54s).
[0m10:11:37.831892 [debug] [MainThread]: Command end result
[0m10:11:37.863996 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:11:37.863996 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:11:37.873656 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:11:37.874598 [info ] [MainThread]: 
[0m10:11:37.875597 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:11:37.875597 [info ] [MainThread]: 
[0m10:11:37.877148 [error] [MainThread]:   Database Error in model product_churn (models\Mart\product_churn.sql)
  000904 (42000): SQL compilation error: error line 15 at position 8
  invalid identifier 'P.PRODUCT_NAME'
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m10:11:37.878105 [info ] [MainThread]: 
[0m10:11:37.878767 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:11:37.878767 [debug] [MainThread]: Command `dbt run` failed at 10:11:37.878767 after 9.24 seconds
[0m10:11:37.878767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BE3EC710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BE4ECCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0BE926FC0>]}
[0m10:11:37.878767 [debug] [MainThread]: Flushing usage events
[0m10:11:39.176928 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:12:31.050367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA87F4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA7EC5BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA7BF97C0>]}


============================== 10:12:31.083964 | 556c36c3-8fe9-4621-9a55-c0476e3e6e60 ==============================
[0m10:12:31.083964 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:12:31.083964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:product_churn', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:12:33.119190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '556c36c3-8fe9-4621-9a55-c0476e3e6e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA87F6000>]}
[0m10:12:33.182354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '556c36c3-8fe9-4621-9a55-c0476e3e6e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA5EFD580>]}
[0m10:12:33.182354 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:12:34.212396 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:12:34.592028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:12:34.592028 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\product_churn.sql
[0m10:12:34.854056 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:12:34.861741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '556c36c3-8fe9-4621-9a55-c0476e3e6e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAAA83410>]}
[0m10:12:34.946716 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:12:34.946716 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:12:35.094152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '556c36c3-8fe9-4621-9a55-c0476e3e6e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAAB10770>]}
[0m10:12:35.094152 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:12:35.094152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '556c36c3-8fe9-4621-9a55-c0476e3e6e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAAB80A70>]}
[0m10:12:35.094152 [info ] [MainThread]: 
[0m10:12:35.094152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:12:35.094152 [info ] [MainThread]: 
[0m10:12:35.094152 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:12:35.106786 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:12:35.457923 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:12:35.465744 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:12:35.465744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:38.157777 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.694 seconds
[0m10:12:38.172249 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m10:12:38.183199 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:12:38.183199 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:12:38.183199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:39.649227 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.465 seconds
[0m10:12:39.649227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m10:12:39.649227 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:12:39.649227 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:12:39.968056 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.316 seconds
[0m10:12:39.974471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m10:12:40.023711 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:12:40.023711 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:12:40.372286 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.360 seconds
[0m10:12:40.387988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '556c36c3-8fe9-4621-9a55-c0476e3e6e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAAABF0440>]}
[0m10:12:40.668509 [debug] [Thread-1 (]: Began running node model.dbt_first.product_churn
[0m10:12:40.668509 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.product_churn ................................ [RUN]
[0m10:12:40.668509 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.product_churn'
[0m10:12:40.668509 [debug] [Thread-1 (]: Began compiling node model.dbt_first.product_churn
[0m10:12:40.679914 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.product_churn"
[0m10:12:40.679914 [debug] [Thread-1 (]: Began executing node model.dbt_first.product_churn
[0m10:12:40.726488 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.product_churn"
[0m10:12:40.728495 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.product_churn"
[0m10:12:40.728495 [debug] [Thread-1 (]: On model.dbt_first.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.product_churn"} */
create or replace transient table HEALTHCARE.mart.product_churn
         as
        (
WITH last_purchase AS (
    SELECT
        product_id,
        MAX(payment_mode) AS last_transaction_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY product_id
),

churned_products AS (
    SELECT
        p.product_id,
        p.product_family,
        lp.last_transaction_date
    FROM last_purchase AS lp
    JOIN HEALTHCARE.stage.stg_products  AS p ON lp.product_id = p.product_id
    WHERE lp.last_transaction_date < DATEADD(MONTH, -6, CURRENT_DATE)  -- Products not sold in last 6 months
)

SELECT * FROM churned_products
        );
[0m10:12:40.728495 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:12:43.417772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.689 seconds
[0m10:12:43.444646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '556c36c3-8fe9-4621-9a55-c0476e3e6e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA5B99CD0>]}
[0m10:12:43.444646 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.product_churn ........................... [[32mSUCCESS 1[0m in 2.77s]
[0m10:12:43.446651 [debug] [Thread-1 (]: Finished running node model.dbt_first.product_churn
[0m10:12:43.447659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:43.447659 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m10:12:43.447659 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m10:12:43.973542 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m10:12:43.973542 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m10:12:44.501298 [debug] [MainThread]: Connection 'model.dbt_first.product_churn' was left open.
[0m10:12:44.503307 [debug] [MainThread]: On model.dbt_first.product_churn: Close
[0m10:12:45.022579 [info ] [MainThread]: 
[0m10:12:45.024587 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.93 seconds (9.93s).
[0m10:12:45.028606 [debug] [MainThread]: Command end result
[0m10:12:45.067288 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:12:45.071344 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:12:45.087691 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:12:45.088699 [info ] [MainThread]: 
[0m10:12:45.094424 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:12:45.094424 [info ] [MainThread]: 
[0m10:12:45.096436 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:12:45.098447 [debug] [MainThread]: Command `dbt run` succeeded at 10:12:45.098447 after 14.39 seconds
[0m10:12:45.102468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA7EC5BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA5A95CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAA8545F70>]}
[0m10:12:45.102468 [debug] [MainThread]: Flushing usage events
[0m10:12:46.807694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:03.494514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A307B1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A32D577A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A330B2570>]}


============================== 10:19:03.503062 | fbb1548e-721f-43be-a394-9d2c49a77ba5 ==============================
[0m10:19:03.503062 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:19:03.504062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:transactions', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:19:04.421481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbb1548e-721f-43be-a394-9d2c49a77ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A3366FA10>]}
[0m10:19:04.478283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbb1548e-721f-43be-a394-9d2c49a77ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A34297C50>]}
[0m10:19:04.478283 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:19:04.962489 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:19:06.548003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:19:06.548003 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_transactions.sql
[0m10:19:06.797218 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:19:06.823625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbb1548e-721f-43be-a394-9d2c49a77ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A356B7800>]}
[0m10:19:06.887122 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:19:06.923951 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:19:06.982719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbb1548e-721f-43be-a394-9d2c49a77ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A35815010>]}
[0m10:19:06.982719 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:19:06.982719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbb1548e-721f-43be-a394-9d2c49a77ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A35877B00>]}
[0m10:19:06.982719 [info ] [MainThread]: 
[0m10:19:06.982719 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:19:06.998611 [info ] [MainThread]: 
[0m10:19:06.998611 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:19:06.998611 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:19:10.330154 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:19:10.332164 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:19:10.332164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:12.540948 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.211 seconds
[0m10:19:12.557043 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m10:19:12.572940 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:19:12.572940 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:19:12.572940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:14.091459 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.511 seconds
[0m10:19:14.092458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m10:19:14.141175 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:19:14.141175 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:19:14.474113 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.334 seconds
[0m10:19:14.479088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m10:19:14.481096 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:19:14.481096 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:19:14.852211 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.371 seconds
[0m10:19:14.852211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbb1548e-721f-43be-a394-9d2c49a77ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A35B4E000>]}
[0m10:19:14.852211 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_transactions
[0m10:19:14.852211 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_transactions ............................ [RUN]
[0m10:19:14.852211 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_transactions'
[0m10:19:14.852211 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_transactions
[0m10:19:14.872641 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_transactions"
[0m10:19:14.872641 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_transactions
[0m10:19:14.896398 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_transactions"
[0m10:19:14.912138 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_transactions"
[0m10:19:14.912138 [debug] [Thread-1 (]: On model.dbt_first.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_transactions"} */
create or replace transient table HEALTHCARE.stage.stg_transactions
         as
        (

WITH cte_cleaned_data AS (
    SELECT  
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(revenue AS DECIMAL(10,3)) AS revenue,
    
        CAST(quantity AS INT) AS quantity,
    
        CAST(product_id AS VARCHAR(200)) AS product_id,
    
        CAST(companies AS VARCHAR(100)) AS companies,
    


        CASE 
            WHEN revenue_type = 'True' THEN 1
            WHEN revenue_type = 'False' THEN 0
            ELSE NULL 
        END AS revenue_type,
        CAST(payment_mode AS DATE) AS payment_date,
        CAST(dimension_1 AS VARCHAR(10)) AS dim_1,
        CAST(dimension_2 AS VARCHAR(10)) AS dim_2,
        CAST(dimension_3 AS VARCHAR(10)) AS dim_3,
        CAST(dimension_4 AS VARCHAR(10)) AS dim_4,
        CAST(dimension_5 AS VARCHAR(10)) AS dim_5,
        CAST(dimension_6 AS VARCHAR(10)) AS dim_6,
        CAST(dimension_7 AS VARCHAR(10)) AS dim_7,
        CAST(dimension_8 AS VARCHAR(10)) AS dim_8,
        CAST(dimension_9 AS VARCHAR(10)) AS dim_9,
        CAST(dimension_10 AS VARCHAR(10)) AS dim_10
    FROM HEALTHCARE.RAW.TRANSACTIONS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        product_id IS NOT NULL
         AND 
    
        payment_mode IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        dimension_1 IS NOT NULL
         AND 
    
        dimension_2 IS NOT NULL
         AND 
    
        dimension_3 IS NOT NULL
         AND 
    
        dimension_4 IS NOT NULL
         AND 
    
        dimension_5 IS NOT NULL
         AND 
    
        dimension_6 IS NOT NULL
         AND 
    
        dimension_7 IS NOT NULL
         AND 
    
        dimension_8 IS NOT NULL
         AND 
    
        dimension_9 IS NOT NULL
         AND 
    
        dimension_10 IS NOT NULL
         AND 
    
        companies IS NOT NULL
        
    

),
cte_name_change AS(
    SELECT 
        customer_id,
        revenue,
        quantity,
        product_id,
        payment_mode,
        companies       AS company_name,
        revenue_type,
        dim_1,
        dim_2,
        dim_3,
        dim_4,
        dim_5,
        dim_6,
        dim_7,
        dim_8,
        dim_9,
        dim_10
    FROM 
        cte_cleaned_data
)

SELECT * FROM cte_name_change
        );
[0m10:19:14.913174 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:19:16.735866 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafec1-0004-bb9d-0005-a3d30003acfa
[0m10:19:16.735866 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 96 at position 8
invalid identifier 'PAYMENT_MODE'
[0m10:19:16.751952 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\Stage\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 96 at position 8
  invalid identifier 'PAYMENT_MODE'
  compiled code at target\run\dbt_first\models\Stage\stg_transactions.sql
[0m10:19:16.751952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbb1548e-721f-43be-a394-9d2c49a77ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A35327920>]}
[0m10:19:16.751952 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.stg_transactions ................... [[31mERROR[0m in 1.90s]
[0m10:19:16.751952 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_transactions
[0m10:19:16.751952 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\Stage\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 96 at position 8
  invalid identifier 'PAYMENT_MODE'
  compiled code at target\run\dbt_first\models\Stage\stg_transactions.sql.
[0m10:19:16.751952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:16.751952 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m10:19:16.751952 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m10:19:17.318197 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m10:19:17.318197 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m10:19:17.813400 [debug] [MainThread]: Connection 'model.dbt_first.stg_transactions' was left open.
[0m10:19:17.829297 [debug] [MainThread]: On model.dbt_first.stg_transactions: Close
[0m10:19:18.615423 [info ] [MainThread]: 
[0m10:19:18.615423 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.62 seconds (11.62s).
[0m10:19:18.615423 [debug] [MainThread]: Command end result
[0m10:19:18.648651 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:19:18.648651 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:19:18.648651 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:19:18.662104 [info ] [MainThread]: 
[0m10:19:18.662104 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:19:18.662104 [info ] [MainThread]: 
[0m10:19:18.663842 [error] [MainThread]:   Database Error in model stg_transactions (models\Stage\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 96 at position 8
  invalid identifier 'PAYMENT_MODE'
  compiled code at target\run\dbt_first\models\Stage\stg_transactions.sql
[0m10:19:18.663842 [info ] [MainThread]: 
[0m10:19:18.665438 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:19:18.667447 [debug] [MainThread]: Command `dbt run` failed at 10:19:18.667447 after 15.41 seconds
[0m10:19:18.669455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A329DB1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A332E31A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A307B1E80>]}
[0m10:19:18.669455 [debug] [MainThread]: Flushing usage events
[0m10:19:19.723716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:24:13.446925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE216B6F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE1F3C1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE216B7F20>]}


============================== 10:24:13.462731 | dcb867b9-a62b-48d3-b6bc-67d793371a13 ==============================
[0m10:24:13.462731 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:24:13.462731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:transactions', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:24:14.493302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcb867b9-a62b-48d3-b6bc-67d793371a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE221C3020>]}
[0m10:24:14.559999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcb867b9-a62b-48d3-b6bc-67d793371a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE20ABA000>]}
[0m10:24:14.559999 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:24:14.933731 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:24:15.193899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:15.193899 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:15.193899 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:24:15.231060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcb867b9-a62b-48d3-b6bc-67d793371a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE236E41D0>]}
[0m10:24:15.308414 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:24:15.324204 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:24:15.355613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcb867b9-a62b-48d3-b6bc-67d793371a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE238FA330>]}
[0m10:24:15.355613 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:24:15.355613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb867b9-a62b-48d3-b6bc-67d793371a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE236E63C0>]}
[0m10:24:15.371546 [info ] [MainThread]: 
[0m10:24:15.371546 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:15.371546 [info ] [MainThread]: 
[0m10:24:15.375162 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:24:15.375162 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:24:15.562972 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:24:15.562972 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:24:15.562972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:17.681129 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.117 seconds
[0m10:24:17.681129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m10:24:17.697074 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:24:17.697074 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:24:17.697074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:19.274135 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.585 seconds
[0m10:24:19.274135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m10:24:19.290283 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:24:19.290283 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:24:19.624773 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.338 seconds
[0m10:24:19.624773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m10:24:19.624773 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:24:19.624773 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:24:19.974392 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.347 seconds
[0m10:24:19.974392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcb867b9-a62b-48d3-b6bc-67d793371a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE23C8AC90>]}
[0m10:24:19.990147 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_transactions
[0m10:24:19.990147 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_transactions ............................ [RUN]
[0m10:24:19.990147 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_transactions'
[0m10:24:19.990147 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_transactions
[0m10:24:20.009940 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_transactions"
[0m10:24:20.009940 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_transactions
[0m10:24:20.036776 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_transactions"
[0m10:24:20.036776 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_transactions"
[0m10:24:20.036776 [debug] [Thread-1 (]: On model.dbt_first.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_transactions"} */
create or replace transient table HEALTHCARE.stage.stg_transactions
         as
        (

WITH cte_cleaned_data AS (
    SELECT  
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(revenue AS DECIMAL(10,3)) AS revenue,
    
        CAST(quantity AS INT) AS quantity,
    
        CAST(product_id AS VARCHAR(200)) AS product_id,
    
        CAST(companies AS VARCHAR(100)) AS companies,
    


        CASE 
            WHEN revenue_type = 'True' THEN 1
            WHEN revenue_type = 'False' THEN 0
            ELSE NULL 
        END AS revenue_type,
        CAST(payment_mode AS DATE) AS payment_date,
        CAST(dimension_1 AS VARCHAR(10)) AS dim_1,
        CAST(dimension_2 AS VARCHAR(10)) AS dim_2,
        CAST(dimension_3 AS VARCHAR(10)) AS dim_3,
        CAST(dimension_4 AS VARCHAR(10)) AS dim_4,
        CAST(dimension_5 AS VARCHAR(10)) AS dim_5,
        CAST(dimension_6 AS VARCHAR(10)) AS dim_6,
        CAST(dimension_7 AS VARCHAR(10)) AS dim_7,
        CAST(dimension_8 AS VARCHAR(10)) AS dim_8,
        CAST(dimension_9 AS VARCHAR(10)) AS dim_9,
        CAST(dimension_10 AS VARCHAR(10)) AS dim_10
    FROM HEALTHCARE.RAW.TRANSACTIONS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        product_id IS NOT NULL
         AND 
    
        payment_mode IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        dimension_1 IS NOT NULL
         AND 
    
        dimension_2 IS NOT NULL
         AND 
    
        dimension_3 IS NOT NULL
         AND 
    
        dimension_4 IS NOT NULL
         AND 
    
        dimension_5 IS NOT NULL
         AND 
    
        dimension_6 IS NOT NULL
         AND 
    
        dimension_7 IS NOT NULL
         AND 
    
        dimension_8 IS NOT NULL
         AND 
    
        dimension_9 IS NOT NULL
         AND 
    
        dimension_10 IS NOT NULL
         AND 
    
        companies IS NOT NULL
        
    

),
cte_name_change AS(
    SELECT 
        customer_id,
        revenue,
        quantity,
        product_id,
        payment_mode,
        companies       AS company_name,
        revenue_type,
        dim_1,
        dim_2,
        dim_3,
        dim_4,
        dim_5,
        dim_6,
        dim_7,
        dim_8,
        dim_9,
        dim_10
    FROM 
        cte_cleaned_data
)

SELECT * FROM cte_name_change
        );
[0m10:24:20.036776 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:24:21.487829 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafec6-0004-bb9d-0005-a3d30003ad12
[0m10:24:21.487829 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 96 at position 8
invalid identifier 'PAYMENT_MODE'
[0m10:24:21.491830 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\Stage\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 96 at position 8
  invalid identifier 'PAYMENT_MODE'
  compiled code at target\run\dbt_first\models\Stage\stg_transactions.sql
[0m10:24:21.494734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcb867b9-a62b-48d3-b6bc-67d793371a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE23EABB90>]}
[0m10:24:21.494734 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.stg_transactions ................... [[31mERROR[0m in 1.50s]
[0m10:24:21.496114 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_transactions
[0m10:24:21.497120 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\Stage\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 96 at position 8
  invalid identifier 'PAYMENT_MODE'
  compiled code at target\run\dbt_first\models\Stage\stg_transactions.sql.
[0m10:24:21.499119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:21.499119 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m10:24:21.499119 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m10:24:22.026862 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m10:24:22.026862 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m10:24:22.551859 [debug] [MainThread]: Connection 'model.dbt_first.stg_transactions' was left open.
[0m10:24:22.552857 [debug] [MainThread]: On model.dbt_first.stg_transactions: Close
[0m10:24:23.103914 [info ] [MainThread]: 
[0m10:24:23.104913 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.73 seconds (7.73s).
[0m10:24:23.105913 [debug] [MainThread]: Command end result
[0m10:24:23.139030 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:24:23.141104 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:24:23.154415 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:24:23.156424 [info ] [MainThread]: 
[0m10:24:23.156424 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:24:23.156424 [info ] [MainThread]: 
[0m10:24:23.156424 [error] [MainThread]:   Database Error in model stg_transactions (models\Stage\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 96 at position 8
  invalid identifier 'PAYMENT_MODE'
  compiled code at target\run\dbt_first\models\Stage\stg_transactions.sql
[0m10:24:23.161713 [info ] [MainThread]: 
[0m10:24:23.161713 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:24:23.161713 [debug] [MainThread]: Command `dbt run` failed at 10:24:23.161713 after 10.01 seconds
[0m10:24:23.161713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE212CCCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE1E85B3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE211CE0F0>]}
[0m10:24:23.161713 [debug] [MainThread]: Flushing usage events
[0m10:24:24.161131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:26:14.998674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001844C5D5C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001844C5D5A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001844C5D7770>]}


============================== 10:26:15.009208 | 4809000a-a1e8-418e-a00e-78891ec21e7e ==============================
[0m10:26:15.009208 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:26:15.009208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:transactions', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:26:15.513748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4809000a-a1e8-418e-a00e-78891ec21e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001844D2D0440>]}
[0m10:26:15.560594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4809000a-a1e8-418e-a00e-78891ec21e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001844BDE9760>]}
[0m10:26:15.560594 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:26:15.932778 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:26:16.128281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:26:16.128281 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_transactions.sql
[0m10:26:16.399453 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:26:16.416386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4809000a-a1e8-418e-a00e-78891ec21e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001844E3E3770>]}
[0m10:26:16.493852 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:26:16.497885 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:26:16.515784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4809000a-a1e8-418e-a00e-78891ec21e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001844E888FE0>]}
[0m10:26:16.515784 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:26:16.515784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4809000a-a1e8-418e-a00e-78891ec21e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001844E3E3E60>]}
[0m10:26:16.532273 [info ] [MainThread]: 
[0m10:26:16.532273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:16.533488 [info ] [MainThread]: 
[0m10:26:16.534494 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:26:16.535461 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:26:16.664269 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:26:16.664269 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:26:16.664269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:18.550685 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.882 seconds
[0m10:26:18.550685 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m10:26:18.567185 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:26:18.567185 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:26:18.567185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:20.034876 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.468 seconds
[0m10:26:20.036881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m10:26:20.091490 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:26:20.092490 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:26:20.446223 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.354 seconds
[0m10:26:20.448223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m10:26:20.450221 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:26:20.450221 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:26:20.769146 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.319 seconds
[0m10:26:20.769146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4809000a-a1e8-418e-a00e-78891ec21e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018449A135F0>]}
[0m10:26:20.769146 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_transactions
[0m10:26:20.769146 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_transactions ............................ [RUN]
[0m10:26:20.769146 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_transactions'
[0m10:26:20.769146 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_transactions
[0m10:26:20.790233 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_transactions"
[0m10:26:20.791297 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_transactions
[0m10:26:20.824691 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_transactions"
[0m10:26:20.828716 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_transactions"
[0m10:26:20.828716 [debug] [Thread-1 (]: On model.dbt_first.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_transactions"} */
create or replace transient table HEALTHCARE.stage.stg_transactions
         as
        (

WITH cte_cleaned_data AS (
    SELECT  
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(revenue AS DECIMAL(10,3)) AS revenue,
    
        CAST(quantity AS INT) AS quantity,
    
        CAST(product_id AS VARCHAR(200)) AS product_id,
    
        CAST(companies AS VARCHAR(100)) AS companies,
    


        CASE 
            WHEN revenue_type = 'True' THEN 1
            WHEN revenue_type = 'False' THEN 0
            ELSE NULL 
        END AS revenue_type,
        CAST(payment_date AS DATE) AS payment_date,
        CAST(dimension_1 AS VARCHAR(10)) AS dim_1,
        CAST(dimension_2 AS VARCHAR(10)) AS dim_2,
        CAST(dimension_3 AS VARCHAR(10)) AS dim_3,
        CAST(dimension_4 AS VARCHAR(10)) AS dim_4,
        CAST(dimension_5 AS VARCHAR(10)) AS dim_5,
        CAST(dimension_6 AS VARCHAR(10)) AS dim_6,
        CAST(dimension_7 AS VARCHAR(10)) AS dim_7,
        CAST(dimension_8 AS VARCHAR(10)) AS dim_8,
        CAST(dimension_9 AS VARCHAR(10)) AS dim_9,
        CAST(dimension_10 AS VARCHAR(10)) AS dim_10
    FROM HEALTHCARE.RAW.TRANSACTIONS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        product_id IS NOT NULL
         AND 
    
        payment_mode IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        dimension_1 IS NOT NULL
         AND 
    
        dimension_2 IS NOT NULL
         AND 
    
        dimension_3 IS NOT NULL
         AND 
    
        dimension_4 IS NOT NULL
         AND 
    
        dimension_5 IS NOT NULL
         AND 
    
        dimension_6 IS NOT NULL
         AND 
    
        dimension_7 IS NOT NULL
         AND 
    
        dimension_8 IS NOT NULL
         AND 
    
        dimension_9 IS NOT NULL
         AND 
    
        dimension_10 IS NOT NULL
         AND 
    
        companies IS NOT NULL
        
    

),
cte_name_change AS(
    SELECT 
        customer_id,
        revenue,
        quantity,
        product_id,
        payment_mode,
        companies       AS company_name,
        revenue_type,
        dim_1,
        dim_2,
        dim_3,
        dim_4,
        dim_5,
        dim_6,
        dim_7,
        dim_8,
        dim_9,
        dim_10
    FROM 
        cte_cleaned_data
)

SELECT * FROM cte_name_change
        );
[0m10:26:20.829691 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:26:22.248365 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafec8-0004-bb9f-0005-a3d300038e6a
[0m10:26:22.248365 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 26 at position 13
invalid identifier 'PAYMENT_DATE'
[0m10:26:22.248365 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\Stage\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 26 at position 13
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\dbt_first\models\Stage\stg_transactions.sql
[0m10:26:22.248365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4809000a-a1e8-418e-a00e-78891ec21e7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001844BA907D0>]}
[0m10:26:22.248365 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.stg_transactions ................... [[31mERROR[0m in 1.48s]
[0m10:26:22.248365 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_transactions
[0m10:26:22.248365 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\Stage\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 26 at position 13
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\dbt_first\models\Stage\stg_transactions.sql.
[0m10:26:22.248365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:22.248365 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m10:26:22.248365 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m10:26:22.766300 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m10:26:22.766300 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m10:26:23.298636 [debug] [MainThread]: Connection 'model.dbt_first.stg_transactions' was left open.
[0m10:26:23.298636 [debug] [MainThread]: On model.dbt_first.stg_transactions: Close
[0m10:26:23.821862 [info ] [MainThread]: 
[0m10:26:23.821862 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.29 seconds (7.29s).
[0m10:26:23.823870 [debug] [MainThread]: Command end result
[0m10:26:23.848983 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:26:23.848983 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:26:23.859577 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:26:23.861589 [info ] [MainThread]: 
[0m10:26:23.861589 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:26:23.861589 [info ] [MainThread]: 
[0m10:26:23.861589 [error] [MainThread]:   Database Error in model stg_transactions (models\Stage\stg_transactions.sql)
  000904 (42000): SQL compilation error: error line 26 at position 13
  invalid identifier 'PAYMENT_DATE'
  compiled code at target\run\dbt_first\models\Stage\stg_transactions.sql
[0m10:26:23.861589 [info ] [MainThread]: 
[0m10:26:23.861589 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:26:23.861589 [debug] [MainThread]: Command `dbt run` failed at 10:26:23.861589 after 9.11 seconds
[0m10:26:23.861589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001844D2A7EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001844BE74CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001844E6E11F0>]}
[0m10:26:23.861589 [debug] [MainThread]: Flushing usage events
[0m10:26:24.836497 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:26:53.945040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B77EE246E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B77EE24D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B77EE25220>]}


============================== 10:26:53.950059 | 02f858e9-ceb4-4d3a-814a-7f1c99beb7e1 ==============================
[0m10:26:53.950059 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:26:53.952067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:26:54.433708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02f858e9-ceb4-4d3a-814a-7f1c99beb7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B77FC42E40>]}
[0m10:26:54.495695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02f858e9-ceb4-4d3a-814a-7f1c99beb7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B77EDD7A10>]}
[0m10:26:54.495695 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:26:54.841134 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:26:55.035257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:26:55.035257 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_transactions.sql
[0m10:26:55.288248 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:26:55.316579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02f858e9-ceb4-4d3a-814a-7f1c99beb7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B701197200>]}
[0m10:26:55.387605 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:26:55.387605 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:26:55.419156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02f858e9-ceb4-4d3a-814a-7f1c99beb7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B701250C20>]}
[0m10:26:55.419156 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:26:55.419156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02f858e9-ceb4-4d3a-814a-7f1c99beb7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B701173440>]}
[0m10:26:55.419156 [info ] [MainThread]: 
[0m10:26:55.419156 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:55.419156 [info ] [MainThread]: 
[0m10:26:55.419156 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:26:55.419156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:26:55.532961 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:26:55.533959 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:26:55.533959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:57.328395 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.801 seconds
[0m10:26:57.328395 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m10:26:57.342024 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:26:57.342024 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:26:57.342024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:58.800415 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.453 seconds
[0m10:26:58.800415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m10:26:58.847815 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:26:58.847815 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:26:59.148422 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.302 seconds
[0m10:26:59.148422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m10:26:59.162991 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:26:59.162991 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:26:59.493685 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.337 seconds
[0m10:26:59.493685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02f858e9-ceb4-4d3a-814a-7f1c99beb7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B70172F080>]}
[0m10:26:59.493685 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_transactions
[0m10:26:59.509392 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_transactions ............................ [RUN]
[0m10:26:59.509392 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_transactions'
[0m10:26:59.509392 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_transactions
[0m10:26:59.509392 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_transactions"
[0m10:26:59.509392 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_transactions
[0m10:26:59.542432 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_transactions"
[0m10:26:59.557277 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_transactions"
[0m10:26:59.557277 [debug] [Thread-1 (]: On model.dbt_first.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_transactions"} */
create or replace transient table HEALTHCARE.stage.stg_transactions
         as
        (

WITH cte_cleaned_data AS (
    SELECT  
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(revenue AS DECIMAL(10,3)) AS revenue,
    
        CAST(quantity AS INT) AS quantity,
    
        CAST(product_id AS VARCHAR(200)) AS product_id,
    
        CAST(payment_mode AS DATE) AS payment_mode,
    
        CAST(companies AS VARCHAR(100)) AS companies,
    


        CASE 
            WHEN revenue_type = 'True' THEN 1
            WHEN revenue_type = 'False' THEN 0
            ELSE NULL 
        END AS revenue_type,
        CAST(payment_mode AS DATE) AS payment_date,
        CAST(dimension_1 AS VARCHAR(10)) AS dim_1,
        CAST(dimension_2 AS VARCHAR(10)) AS dim_2,
        CAST(dimension_3 AS VARCHAR(10)) AS dim_3,
        CAST(dimension_4 AS VARCHAR(10)) AS dim_4,
        CAST(dimension_5 AS VARCHAR(10)) AS dim_5,
        CAST(dimension_6 AS VARCHAR(10)) AS dim_6,
        CAST(dimension_7 AS VARCHAR(10)) AS dim_7,
        CAST(dimension_8 AS VARCHAR(10)) AS dim_8,
        CAST(dimension_9 AS VARCHAR(10)) AS dim_9,
        CAST(dimension_10 AS VARCHAR(10)) AS dim_10
    FROM HEALTHCARE.RAW.TRANSACTIONS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        product_id IS NOT NULL
         AND 
    
        payment_mode IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        dimension_1 IS NOT NULL
         AND 
    
        dimension_2 IS NOT NULL
         AND 
    
        dimension_3 IS NOT NULL
         AND 
    
        dimension_4 IS NOT NULL
         AND 
    
        dimension_5 IS NOT NULL
         AND 
    
        dimension_6 IS NOT NULL
         AND 
    
        dimension_7 IS NOT NULL
         AND 
    
        dimension_8 IS NOT NULL
         AND 
    
        dimension_9 IS NOT NULL
         AND 
    
        dimension_10 IS NOT NULL
         AND 
    
        companies IS NOT NULL
        
    

),
cte_name_change AS(
    SELECT 
        customer_id,
        revenue,
        quantity,
        product_id,
        payment_mode,
        companies       AS company_name,
        revenue_type,
        dim_1,
        dim_2,
        dim_3,
        dim_4,
        dim_5,
        dim_6,
        dim_7,
        dim_8,
        dim_9,
        dim_10
    FROM 
        cte_cleaned_data
)

SELECT * FROM cte_name_change
        );
[0m10:26:59.558288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:27:02.320604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.772 seconds
[0m10:27:02.352039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02f858e9-ceb4-4d3a-814a-7f1c99beb7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B77E2E0800>]}
[0m10:27:02.352039 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.stg_transactions ....................... [[32mSUCCESS 1[0m in 2.83s]
[0m10:27:02.352039 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_transactions
[0m10:27:02.352039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:02.352039 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m10:27:02.352039 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m10:27:02.853547 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m10:27:02.869529 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m10:27:03.370497 [debug] [MainThread]: Connection 'model.dbt_first.stg_transactions' was left open.
[0m10:27:03.370497 [debug] [MainThread]: On model.dbt_first.stg_transactions: Close
[0m10:27:03.910111 [info ] [MainThread]: 
[0m10:27:03.910111 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m10:27:03.912116 [debug] [MainThread]: Command end result
[0m10:27:03.937932 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:27:03.941945 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:27:03.949938 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:27:03.950937 [info ] [MainThread]: 
[0m10:27:03.951941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:27:03.952836 [info ] [MainThread]: 
[0m10:27:03.952836 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:27:03.954849 [debug] [MainThread]: Command `dbt run` succeeded at 10:27:03.954849 after 10.19 seconds
[0m10:27:03.954849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B77E67C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7010EB590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7010EB290>]}
[0m10:27:03.956859 [debug] [MainThread]: Flushing usage events
[0m10:27:04.924345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:29:28.059907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019588D046E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019588D057C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019588D04E60>]}


============================== 10:29:28.059907 | 2bda7637-176b-490e-b756-b4dc3f884f48 ==============================
[0m10:29:28.059907 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:29:28.059907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:transactions', 'send_anonymous_usage_stats': 'True'}
[0m10:29:28.589047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bda7637-176b-490e-b756-b4dc3f884f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019589B37B90>]}
[0m10:29:28.651887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bda7637-176b-490e-b756-b4dc3f884f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019588245E80>]}
[0m10:29:28.651887 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:29:29.171613 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:29:30.603393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:30.603393 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_transactions.sql
[0m10:29:30.854561 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:29:30.869553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bda7637-176b-490e-b756-b4dc3f884f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958AF3A660>]}
[0m10:29:30.941450 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:29:31.028554 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:29:31.067827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bda7637-176b-490e-b756-b4dc3f884f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958B094E60>]}
[0m10:29:31.067827 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:29:31.067827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bda7637-176b-490e-b756-b4dc3f884f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958AFAF740>]}
[0m10:29:31.067827 [info ] [MainThread]: 
[0m10:29:31.083495 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:31.083495 [info ] [MainThread]: 
[0m10:29:31.083495 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:29:31.086299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:29:33.973245 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:29:33.973245 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:29:33.973245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:36.171196 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.201 seconds
[0m10:29:36.178813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m10:29:36.186423 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:29:36.186423 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:29:36.186423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:37.740018 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.555 seconds
[0m10:29:37.740018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m10:29:37.787641 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:29:37.787641 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:29:38.125077 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.325 seconds
[0m10:29:38.127074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m10:29:38.129074 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:29:38.130074 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:29:38.447044 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.327 seconds
[0m10:29:38.447044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bda7637-176b-490e-b756-b4dc3f884f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958B544440>]}
[0m10:29:38.462961 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_transactions
[0m10:29:38.462961 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_transactions ............................ [RUN]
[0m10:29:38.462961 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_transactions'
[0m10:29:38.462961 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_transactions
[0m10:29:38.473143 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_transactions"
[0m10:29:38.473143 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_transactions
[0m10:29:38.499536 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_transactions"
[0m10:29:38.499536 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_transactions"
[0m10:29:38.499536 [debug] [Thread-1 (]: On model.dbt_first.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_transactions"} */
create or replace transient table HEALTHCARE.stage.stg_transactions
         as
        (

WITH cte_cleaned_data AS (
    SELECT  
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(revenue AS DECIMAL(10,3)) AS revenue,
    
        CAST(quantity AS INT) AS quantity,
    
        CAST(product_id AS VARCHAR(200)) AS product_id,
    
        CAST(payment_mode AS DATE) AS payment_mode,
    
        CAST(companies AS VARCHAR(100)) AS companies,
    


        CASE 
            WHEN revenue_type = 'True' THEN 1
            WHEN revenue_type = 'False' THEN 0
            ELSE NULL 
        END AS revenue_type,
        CAST(payment_mode AS DATE) AS payment_date,
        CAST(dimension_1 AS VARCHAR(10)) AS dim_1,
        CAST(dimension_2 AS VARCHAR(10)) AS dim_2,
        CAST(dimension_3 AS VARCHAR(10)) AS dim_3,
        CAST(dimension_4 AS VARCHAR(10)) AS dim_4,
        CAST(dimension_5 AS VARCHAR(10)) AS dim_5,
        CAST(dimension_6 AS VARCHAR(10)) AS dim_6,
        CAST(dimension_7 AS VARCHAR(10)) AS dim_7,
        CAST(dimension_8 AS VARCHAR(10)) AS dim_8,
        CAST(dimension_9 AS VARCHAR(10)) AS dim_9,
        CAST(dimension_10 AS VARCHAR(10)) AS dim_10
    FROM HEALTHCARE.RAW.TRANSACTIONS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        product_id IS NOT NULL
         AND 
    
        payment_mode IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        dimension_1 IS NOT NULL
         AND 
    
        dimension_2 IS NOT NULL
         AND 
    
        dimension_3 IS NOT NULL
         AND 
    
        dimension_4 IS NOT NULL
         AND 
    
        dimension_5 IS NOT NULL
         AND 
    
        dimension_6 IS NOT NULL
         AND 
    
        dimension_7 IS NOT NULL
         AND 
    
        dimension_8 IS NOT NULL
         AND 
    
        dimension_9 IS NOT NULL
         AND 
    
        dimension_10 IS NOT NULL
         AND 
    
        companies IS NOT NULL
        
    

),
cte_name_change AS(
    SELECT 
        customer_id,
        revenue,
        quantity,
        product_id,
        payment_mode AS payment_date,
        companies       AS company_name,
        revenue_type,
        dim_1,
        dim_2,
        dim_3,
        dim_4,
        dim_5,
        dim_6,
        dim_7,
        dim_8,
        dim_9,
        dim_10
    FROM 
        cte_cleaned_data
)

SELECT * FROM cte_name_change
        );
[0m10:29:38.499536 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:29:40.815336 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.308 seconds
[0m10:29:40.831206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bda7637-176b-490e-b756-b4dc3f884f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195881B0830>]}
[0m10:29:40.831206 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.stg_transactions ....................... [[32mSUCCESS 1[0m in 2.37s]
[0m10:29:40.831206 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_transactions
[0m10:29:40.847271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:40.847271 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m10:29:40.847271 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m10:29:41.348098 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m10:29:41.356977 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m10:29:41.876113 [debug] [MainThread]: Connection 'model.dbt_first.stg_transactions' was left open.
[0m10:29:41.876113 [debug] [MainThread]: On model.dbt_first.stg_transactions: Close
[0m10:29:42.384401 [info ] [MainThread]: 
[0m10:29:42.384401 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.30 seconds (11.30s).
[0m10:29:42.384401 [debug] [MainThread]: Command end result
[0m10:29:42.427327 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:29:42.427327 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:29:42.436133 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:29:42.437143 [info ] [MainThread]: 
[0m10:29:42.438142 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:42.439145 [info ] [MainThread]: 
[0m10:29:42.439145 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:42.440141 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:42.440141 after 15.24 seconds
[0m10:29:42.441176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958640F560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958640FE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019585FA8F50>]}
[0m10:29:42.441176 [debug] [MainThread]: Flushing usage events
[0m10:29:43.735756 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:32:54.245422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C186CD4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C186193CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C18611A480>]}


============================== 10:32:54.245422 | 0b03864a-7ea0-468e-a524-8aefb113f0c6 ==============================
[0m10:32:54.245422 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:32:54.258633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:product_churn', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:32:54.744401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b03864a-7ea0-468e-a524-8aefb113f0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1840DABA0>]}
[0m10:32:54.810644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b03864a-7ea0-468e-a524-8aefb113f0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C187A27920>]}
[0m10:32:54.810644 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:32:55.181465 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:32:55.358847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:32:55.358847 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:32:55.374816 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:32:55.412323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b03864a-7ea0-468e-a524-8aefb113f0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C187551DC0>]}
[0m10:32:55.494308 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:32:55.494308 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:32:55.530978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b03864a-7ea0-468e-a524-8aefb113f0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C188E6A210>]}
[0m10:32:55.530978 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:32:55.533553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b03864a-7ea0-468e-a524-8aefb113f0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C188B06ED0>]}
[0m10:32:55.533553 [info ] [MainThread]: 
[0m10:32:55.533553 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:32:55.533553 [info ] [MainThread]: 
[0m10:32:55.533553 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:32:55.541454 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:32:55.645928 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:32:55.645928 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:32:55.645928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:57.649797 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.997 seconds
[0m10:32:57.649797 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m10:32:57.665516 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:32:57.665516 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:32:57.665516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:59.187006 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.522 seconds
[0m10:32:59.187006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m10:32:59.187006 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:32:59.187006 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:32:59.579945 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.386 seconds
[0m10:32:59.579945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m10:32:59.579945 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:32:59.579945 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:32:59.958500 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.368 seconds
[0m10:32:59.958500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b03864a-7ea0-468e-a524-8aefb113f0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1890A7980>]}
[0m10:32:59.965320 [debug] [Thread-1 (]: Began running node model.dbt_first.product_churn
[0m10:32:59.965320 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.product_churn ................................ [RUN]
[0m10:32:59.967324 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.product_churn'
[0m10:32:59.967324 [debug] [Thread-1 (]: Began compiling node model.dbt_first.product_churn
[0m10:32:59.976287 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.product_churn"
[0m10:32:59.978021 [debug] [Thread-1 (]: Began executing node model.dbt_first.product_churn
[0m10:33:00.009626 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.product_churn"
[0m10:33:00.012130 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.product_churn"
[0m10:33:00.012130 [debug] [Thread-1 (]: On model.dbt_first.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.product_churn"} */
create or replace transient table HEALTHCARE.mart.product_churn
         as
        (
WITH last_purchase AS (
    SELECT
        product_id,
        MAX(payment_mode) AS last_transaction_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY product_id
),

churned_products AS (
    SELECT
        p.product_id,
        p.product_family,
        lp.last_transaction_date
    FROM last_purchase AS lp
    JOIN HEALTHCARE.stage.stg_products  AS p ON lp.product_id = p.product_id
    WHERE lp.last_transaction_date < DATEADD(MONTH, -6, CURRENT_DATE)  -- Products not sold in last 6 months
)

SELECT * FROM churned_products
        );
[0m10:33:00.013136 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:33:01.705902 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafece-0004-bded-0005-a3d300030d6a
[0m10:33:01.705902 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 12
invalid identifier 'PAYMENT_MODE'
[0m10:33:01.721085 [debug] [Thread-1 (]: Database Error in model product_churn (models\Mart\product_churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'PAYMENT_MODE'
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m10:33:01.721085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b03864a-7ea0-468e-a524-8aefb113f0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C189447A70>]}
[0m10:33:01.721085 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.product_churn ....................... [[31mERROR[0m in 1.75s]
[0m10:33:01.721085 [debug] [Thread-1 (]: Finished running node model.dbt_first.product_churn
[0m10:33:01.728806 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.product_churn' to be skipped because of status 'error'.  Reason: Database Error in model product_churn (models\Mart\product_churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'PAYMENT_MODE'
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql.
[0m10:33:01.728806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:01.728806 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m10:33:01.728806 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m10:33:02.253753 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m10:33:02.253753 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m10:33:02.765303 [debug] [MainThread]: Connection 'model.dbt_first.product_churn' was left open.
[0m10:33:02.781045 [debug] [MainThread]: On model.dbt_first.product_churn: Close
[0m10:33:03.304996 [info ] [MainThread]: 
[0m10:33:03.304996 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.77 seconds (7.77s).
[0m10:33:03.304996 [debug] [MainThread]: Command end result
[0m10:33:03.320575 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:33:03.336227 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:33:03.343507 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:33:03.343507 [info ] [MainThread]: 
[0m10:33:03.345587 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:33:03.345587 [info ] [MainThread]: 
[0m10:33:03.345587 [error] [MainThread]:   Database Error in model product_churn (models\Mart\product_churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'PAYMENT_MODE'
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m10:33:03.345587 [info ] [MainThread]: 
[0m10:33:03.345587 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:33:03.345587 [debug] [MainThread]: Command `dbt run` failed at 10:33:03.345587 after 9.29 seconds
[0m10:33:03.345587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1860E8AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C18652F620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C18652CB60>]}
[0m10:33:03.345587 [debug] [MainThread]: Flushing usage events
[0m10:33:04.764370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:33:30.486706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E12255910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E12254680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E12255BB0>]}


============================== 10:33:30.496635 | 1ca96f4b-261f-4dfc-8fc2-8f3dfeb61e5c ==============================
[0m10:33:30.496635 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:33:30.497081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:product_churn', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:33:30.985742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ca96f4b-261f-4dfc-8fc2-8f3dfeb61e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E11D97920>]}
[0m10:33:31.051798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ca96f4b-261f-4dfc-8fc2-8f3dfeb61e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E1301CE60>]}
[0m10:33:31.053811 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:33:31.422937 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:33:31.597432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:33:31.597432 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\product_churn.sql
[0m10:33:31.863363 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:33:31.884893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ca96f4b-261f-4dfc-8fc2-8f3dfeb61e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E145F0B60>]}
[0m10:33:31.965092 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:33:31.968124 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:33:31.995673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ca96f4b-261f-4dfc-8fc2-8f3dfeb61e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E145A0D40>]}
[0m10:33:31.995673 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:33:31.996674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ca96f4b-261f-4dfc-8fc2-8f3dfeb61e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E14086CF0>]}
[0m10:33:31.997700 [info ] [MainThread]: 
[0m10:33:31.998698 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:33:31.998698 [info ] [MainThread]: 
[0m10:33:31.998698 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:33:31.998698 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:33:32.098797 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:33:32.098797 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:33:32.098797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:34.071080 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.971 seconds
[0m10:33:34.071080 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m10:33:34.086847 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:33:34.086847 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:33:34.086847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:35.624396 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.549 seconds
[0m10:33:35.640268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m10:33:35.640268 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:33:35.640268 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:33:35.985454 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.352 seconds
[0m10:33:35.985454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m10:33:36.032249 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:33:36.048372 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:33:36.382022 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.343 seconds
[0m10:33:36.382022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ca96f4b-261f-4dfc-8fc2-8f3dfeb61e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0F6A36E0>]}
[0m10:33:36.397691 [debug] [Thread-1 (]: Began running node model.dbt_first.product_churn
[0m10:33:36.397691 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.product_churn ................................ [RUN]
[0m10:33:36.397691 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.product_churn'
[0m10:33:36.397691 [debug] [Thread-1 (]: Began compiling node model.dbt_first.product_churn
[0m10:33:36.397691 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.product_churn"
[0m10:33:36.397691 [debug] [Thread-1 (]: Began executing node model.dbt_first.product_churn
[0m10:33:36.436648 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.product_churn"
[0m10:33:36.436648 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.product_churn"
[0m10:33:36.436648 [debug] [Thread-1 (]: On model.dbt_first.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.product_churn"} */
create or replace transient table HEALTHCARE.mart.product_churn
         as
        (
WITH last_purchase AS (
    SELECT
        product_id,
        MAX(payment_date) AS last_transaction_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY product_id
),

churned_products AS (
    SELECT
        p.product_id,
        p.product_family,
        lp.last_transaction_date
    FROM last_purchase AS lp
    JOIN HEALTHCARE.stage.stg_products  AS p ON lp.product_id = p.product_id
    WHERE lp.last_transaction_date < DATEADD(MONTH, -6, CURRENT_DATE)  -- Products not sold in last 6 months
)

SELECT * FROM churned_products
        );
[0m10:33:36.436648 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:33:38.748303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.306 seconds
[0m10:33:38.779728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ca96f4b-261f-4dfc-8fc2-8f3dfeb61e5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E11710380>]}
[0m10:33:38.779728 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.product_churn ........................... [[32mSUCCESS 1[0m in 2.37s]
[0m10:33:38.779728 [debug] [Thread-1 (]: Finished running node model.dbt_first.product_churn
[0m10:33:38.779728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:38.779728 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m10:33:38.779728 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m10:33:39.314965 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m10:33:39.322135 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m10:33:39.845190 [debug] [MainThread]: Connection 'model.dbt_first.product_churn' was left open.
[0m10:33:39.845190 [debug] [MainThread]: On model.dbt_first.product_churn: Close
[0m10:33:40.365076 [info ] [MainThread]: 
[0m10:33:40.365076 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.37 seconds (8.37s).
[0m10:33:40.365076 [debug] [MainThread]: Command end result
[0m10:33:40.396302 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:33:40.397301 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:33:40.407604 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:33:40.408312 [info ] [MainThread]: 
[0m10:33:40.410319 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:33:40.410319 [info ] [MainThread]: 
[0m10:33:40.410319 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:33:40.410319 [debug] [MainThread]: Command `dbt run` succeeded at 10:33:40.410319 after 10.12 seconds
[0m10:33:40.410319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E11AF4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E140A9C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E140ABE60>]}
[0m10:33:40.410319 [debug] [MainThread]: Flushing usage events
[0m10:33:41.395274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:39:51.545484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C54242D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C54240470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C54242300>]}


============================== 10:39:51.552913 | 46d7dc7d-1ce7-42c8-9a42-bee3ca014709 ==============================
[0m10:39:51.552913 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:39:51.552913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:product_churn', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:39:52.236795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46d7dc7d-1ce7-42c8-9a42-bee3ca014709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C53869340>]}
[0m10:39:52.299931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46d7dc7d-1ce7-42c8-9a42-bee3ca014709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C5457C350>]}
[0m10:39:52.299931 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:39:52.670158 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:39:52.908525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:39:52.910531 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\product_churn.sql
[0m10:39:52.910531 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\highest_cross_sell.sql
[0m10:39:53.161620 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:39:53.176339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46d7dc7d-1ce7-42c8-9a42-bee3ca014709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C561B52B0>]}
[0m10:39:53.245162 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:39:53.255494 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:39:53.310403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46d7dc7d-1ce7-42c8-9a42-bee3ca014709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C566409E0>]}
[0m10:39:53.310403 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:39:53.310403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46d7dc7d-1ce7-42c8-9a42-bee3ca014709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C561B74D0>]}
[0m10:39:53.310403 [info ] [MainThread]: 
[0m10:39:53.310403 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:39:53.310403 [info ] [MainThread]: 
[0m10:39:53.310403 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:39:53.310403 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:39:53.463221 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:39:53.463221 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:39:53.463221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:55.498350 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.047 seconds
[0m10:39:55.514204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m10:39:55.532695 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:39:55.532695 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:39:55.534701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:39:57.210649 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.676 seconds
[0m10:39:57.213685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m10:39:57.215696 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:39:57.217705 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:39:57.549838 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.339 seconds
[0m10:39:57.549838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m10:39:57.600012 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:39:57.600012 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:39:57.951388 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.341 seconds
[0m10:39:57.951388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46d7dc7d-1ce7-42c8-9a42-bee3ca014709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C564261E0>]}
[0m10:39:57.951388 [debug] [Thread-1 (]: Began running node model.dbt_first.product_churn
[0m10:39:57.965897 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.product_churn ................................ [RUN]
[0m10:39:57.966392 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.product_churn'
[0m10:39:57.966392 [debug] [Thread-1 (]: Began compiling node model.dbt_first.product_churn
[0m10:39:57.966392 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.product_churn"
[0m10:39:57.966392 [debug] [Thread-1 (]: Began executing node model.dbt_first.product_churn
[0m10:39:58.005326 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.product_churn"
[0m10:39:58.005326 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.product_churn"
[0m10:39:58.005326 [debug] [Thread-1 (]: On model.dbt_first.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.product_churn"} */
create or replace transient table HEALTHCARE.mart.product_churn
         as
        (
WITH last_purchase AS (
    SELECT
        product_id,
        MAX(payment_date) OVER(
            PARTITION BY product_id
        ) AS last_transaction_date
    FROM HEALTHCARE.stage.stg_transactions

),

-- churned_products AS (
--     SELECT
--         p.product_id,
--         p.product_family,
--         lp.last_transaction_date
--     FROM last_purchase AS lp
--     JOIN HEALTHCARE.stage.stg_products  AS p ON lp.product_id = p.product_id
--     WHERE lp.last_transaction_date < DATEADD(MONTH, -6, CURRENT_DATE)  -- Products not sold in last 6 months
-- )

SELECT * FROM last_purchase
        );
[0m10:39:58.005326 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:39:59.573073 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafed5-0004-c0bd-0005-a3d30003b27a
[0m10:39:59.573073 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 24 at position 0 unexpected 'SELECT'.
[0m10:39:59.590830 [debug] [Thread-1 (]: Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 0 unexpected 'SELECT'.
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m10:39:59.592840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46d7dc7d-1ce7-42c8-9a42-bee3ca014709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C53830B30>]}
[0m10:39:59.592840 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.product_churn ....................... [[31mERROR[0m in 1.62s]
[0m10:39:59.592840 [debug] [Thread-1 (]: Finished running node model.dbt_first.product_churn
[0m10:39:59.592840 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.product_churn' to be skipped because of status 'error'.  Reason: Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 0 unexpected 'SELECT'.
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql.
[0m10:39:59.592840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:39:59.592840 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m10:39:59.592840 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m10:40:00.123779 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m10:40:00.123779 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m10:40:00.656816 [debug] [MainThread]: Connection 'model.dbt_first.product_churn' was left open.
[0m10:40:00.672865 [debug] [MainThread]: On model.dbt_first.product_churn: Close
[0m10:40:01.191462 [info ] [MainThread]: 
[0m10:40:01.191462 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m10:40:01.191462 [debug] [MainThread]: Command end result
[0m10:40:01.221113 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:40:01.224482 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:40:01.227479 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:40:01.227479 [info ] [MainThread]: 
[0m10:40:01.227479 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:40:01.227479 [info ] [MainThread]: 
[0m10:40:01.227479 [error] [MainThread]:   Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 0 unexpected 'SELECT'.
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m10:40:01.227479 [info ] [MainThread]: 
[0m10:40:01.227479 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:40:01.235901 [debug] [MainThread]: Command `dbt run` failed at 10:40:01.235901 after 9.98 seconds
[0m10:40:01.235901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C53DDCF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C5341A9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C53EB6840>]}
[0m10:40:01.236965 [debug] [MainThread]: Flushing usage events
[0m10:40:02.258877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:56.455712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E3661DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E5364530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E53677A0>]}


============================== 10:44:56.459345 | c62476f5-c9c7-4764-bd62-ac0048ff6226 ==============================
[0m10:44:56.459345 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:44:56.461523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:product_churn', 'send_anonymous_usage_stats': 'True'}
[0m10:44:56.974094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c62476f5-c9c7-4764-bd62-ac0048ff6226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E6283500>]}
[0m10:44:57.021600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c62476f5-c9c7-4764-bd62-ac0048ff6226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E5C54B30>]}
[0m10:44:57.021600 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:44:57.507078 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:44:58.799535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m10:44:58.799535 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_customers.sql
[0m10:44:58.799535 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\product_churn.sql
[0m10:44:58.799535 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_country_region.sql
[0m10:44:59.054635 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:44:59.067408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c62476f5-c9c7-4764-bd62-ac0048ff6226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E8674E30>]}
[0m10:44:59.145878 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:44:59.161466 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:44:59.182268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c62476f5-c9c7-4764-bd62-ac0048ff6226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E86C8D40>]}
[0m10:44:59.182268 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:44:59.182268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62476f5-c9c7-4764-bd62-ac0048ff6226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E8643DA0>]}
[0m10:44:59.182268 [info ] [MainThread]: 
[0m10:44:59.182268 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:44:59.182268 [info ] [MainThread]: 
[0m10:44:59.182268 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:44:59.198208 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:45:01.840048 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:45:01.840048 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:45:01.840048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:03.899086 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.060 seconds
[0m10:45:03.915098 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m10:45:03.977882 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:45:03.977882 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:45:03.977882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:45:05.903421 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.927 seconds
[0m10:45:05.903421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m10:45:05.903421 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:45:05.903421 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:45:06.238456 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.342 seconds
[0m10:45:06.254373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m10:45:06.256382 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:45:06.258388 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:45:06.673636 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.415 seconds
[0m10:45:06.676005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c62476f5-c9c7-4764-bd62-ac0048ff6226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E8594800>]}
[0m10:45:06.676005 [debug] [Thread-1 (]: Began running node model.dbt_first.product_churn
[0m10:45:06.676005 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.product_churn ................................ [RUN]
[0m10:45:06.676005 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.product_churn'
[0m10:45:06.676005 [debug] [Thread-1 (]: Began compiling node model.dbt_first.product_churn
[0m10:45:06.685619 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.product_churn"
[0m10:45:06.685619 [debug] [Thread-1 (]: Began executing node model.dbt_first.product_churn
[0m10:45:06.708810 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.product_churn"
[0m10:45:06.723484 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.product_churn"
[0m10:45:06.724528 [debug] [Thread-1 (]: On model.dbt_first.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.product_churn"} */
create or replace transient table HEALTHCARE.mart.product_churn
         as
        (
WITH last_purchase AS (
    SELECT
        product_id,
        MAX(payment_date) OVER(
            PARTITION BY product_id
        ) AS last_transaction_date
    FROM HEALTHCARE.stage.stg_transactions

)

-- churned_products AS (
--     SELECT
--         p.product_id,
--         p.product_family,
--         lp.last_transaction_date
--     FROM last_purchase AS lp
--     JOIN HEALTHCARE.stage.stg_products  AS p ON lp.product_id = p.product_id
--     WHERE lp.last_transaction_date < DATEADD(MONTH, -6, CURRENT_DATE)  -- Products not sold in last 6 months
-- )

SELECT * FROM last_purchase
        );
[0m10:45:06.725492 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:45:09.848091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.131 seconds
[0m10:45:09.879915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c62476f5-c9c7-4764-bd62-ac0048ff6226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E3769DF0>]}
[0m10:45:09.879915 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.product_churn ........................... [[32mSUCCESS 1[0m in 3.19s]
[0m10:45:09.879915 [debug] [Thread-1 (]: Finished running node model.dbt_first.product_churn
[0m10:45:09.879915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:45:09.879915 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m10:45:09.879915 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m10:45:10.448687 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m10:45:10.448687 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m10:45:10.996380 [debug] [MainThread]: Connection 'model.dbt_first.product_churn' was left open.
[0m10:45:10.997375 [debug] [MainThread]: On model.dbt_first.product_churn: Close
[0m10:45:11.528698 [info ] [MainThread]: 
[0m10:45:11.530705 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.35 seconds (12.35s).
[0m10:45:11.530705 [debug] [MainThread]: Command end result
[0m10:45:11.550954 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:45:11.550954 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:45:11.563082 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:45:11.564049 [info ] [MainThread]: 
[0m10:45:11.565051 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:45:11.565051 [info ] [MainThread]: 
[0m10:45:11.566049 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:45:11.567048 [debug] [MainThread]: Command `dbt run` succeeded at 10:45:11.567048 after 15.30 seconds
[0m10:45:11.568049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E5F2E1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E3ACB4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E8680860>]}
[0m10:45:11.568916 [debug] [MainThread]: Flushing usage events
[0m10:45:12.880597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:57:07.190325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865C4B85C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865BAEF7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865C4B9640>]}


============================== 10:57:07.195293 | ab2dda35-7cf1-4c11-9297-064de60791e9 ==============================
[0m10:57:07.195293 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:57:07.196275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:country_region', 'send_anonymous_usage_stats': 'True'}
[0m10:57:07.672317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab2dda35-7cf1-4c11-9297-064de60791e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865D0C4830>]}
[0m10:57:07.734351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab2dda35-7cf1-4c11-9297-064de60791e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865B954E60>]}
[0m10:57:07.734351 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:57:08.086648 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:57:08.289652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:57:08.290650 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_country_region.sql
[0m10:57:08.535056 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m10:57:08.552704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab2dda35-7cf1-4c11-9297-064de60791e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865E7A0830>]}
[0m10:57:08.626697 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:57:08.626697 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:57:08.659206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab2dda35-7cf1-4c11-9297-064de60791e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865E750860>]}
[0m10:57:08.659206 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m10:57:08.659206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab2dda35-7cf1-4c11-9297-064de60791e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865E7A1910>]}
[0m10:57:08.659206 [info ] [MainThread]: 
[0m10:57:08.659206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:08.659206 [info ] [MainThread]: 
[0m10:57:08.659206 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:57:08.659206 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m10:57:08.759802 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m10:57:08.759802 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m10:57:08.759802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:10.693110 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.930 seconds
[0m10:57:10.703100 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m10:57:10.708968 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m10:57:10.708968 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m10:57:10.708968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:12.197237 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.492 seconds
[0m10:57:12.197237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m10:57:12.197237 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m10:57:12.197237 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m10:57:12.585592 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.380 seconds
[0m10:57:12.592920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m10:57:12.640548 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m10:57:12.640548 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m10:57:12.975730 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.349 seconds
[0m10:57:12.991502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab2dda35-7cf1-4c11-9297-064de60791e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286599074D0>]}
[0m10:57:12.993509 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_country_region
[0m10:57:12.993509 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_country_region .......................... [RUN]
[0m10:57:12.993509 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_country_region'
[0m10:57:12.993509 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_country_region
[0m10:57:12.993509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_country_region"
[0m10:57:13.007645 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_country_region
[0m10:57:13.036355 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_country_region"
[0m10:57:13.036355 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_country_region"
[0m10:57:13.036355 [debug] [Thread-1 (]: On model.dbt_first.stg_country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_country_region"} */
create or replace transient table HEALTHCARE.stage.stg_country_region
         as
        (

WITH removing_null_rows AS (
    SELECT
        *
    FROM
        HEALTHCARE.RAW.COUNTRY_REGION
    WHERE
        customer_id IS NOT NULL AND
        country     IS NOT NULL AND
        region      IS NOT NULL
),
removing_duplicates AS (
    SELECT
        *
        , ROW_NUMBER() OVER (PARTITION BY customer_id,country,region ORDER BY customer_id ASC) AS row_number
    FROM
        removing_null_rows
),
changing_cases AS (
    SELECT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        removing_duplicates
    WHERE
        row_number = 1
)
SELECT
    *
FROM
    changing_cases
        );
[0m10:57:13.036355 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:57:15.760341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.718 seconds
[0m10:57:15.784432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2dda35-7cf1-4c11-9297-064de60791e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865986D760>]}
[0m10:57:15.784432 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.stg_country_region ..................... [[32mSUCCESS 1[0m in 2.79s]
[0m10:57:15.784432 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_country_region
[0m10:57:15.788235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:15.788235 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m10:57:15.788235 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m10:57:16.300326 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m10:57:16.300326 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m10:57:16.834284 [debug] [MainThread]: Connection 'model.dbt_first.stg_country_region' was left open.
[0m10:57:16.834284 [debug] [MainThread]: On model.dbt_first.stg_country_region: Close
[0m10:57:17.352617 [info ] [MainThread]: 
[0m10:57:17.352617 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.69 seconds (8.69s).
[0m10:57:17.369098 [debug] [MainThread]: Command end result
[0m10:57:17.408101 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m10:57:17.408101 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m10:57:17.418930 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m10:57:17.419490 [info ] [MainThread]: 
[0m10:57:17.419490 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:17.419490 [info ] [MainThread]: 
[0m10:57:17.419490 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:57:17.419490 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:17.419490 after 10.50 seconds
[0m10:57:17.419490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865B897110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865BEC4E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002865C2C31A0>]}
[0m10:57:17.419490 [debug] [MainThread]: Flushing usage events
[0m10:57:18.486626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:00:56.949743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225EF958BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225EF9584A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225EF9593A0>]}


============================== 11:00:56.949743 | c89a4b32-1e01-4114-84bb-88254b537186 ==============================
[0m11:00:56.949743 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:00:56.964533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:country_region', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:00:57.467311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c89a4b32-1e01-4114-84bb-88254b537186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225F0655970>]}
[0m11:00:57.530600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c89a4b32-1e01-4114-84bb-88254b537186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225F0714440>]}
[0m11:00:57.530600 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:00:57.986550 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:00:59.268090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:00:59.268090 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_country_region.sql
[0m11:00:59.512985 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m11:00:59.530727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c89a4b32-1e01-4114-84bb-88254b537186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225F1B67E60>]}
[0m11:00:59.605636 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:00:59.621557 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:00:59.637476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c89a4b32-1e01-4114-84bb-88254b537186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225F1CB4C50>]}
[0m11:00:59.637476 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m11:00:59.653231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c89a4b32-1e01-4114-84bb-88254b537186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225F18070E0>]}
[0m11:00:59.653231 [info ] [MainThread]: 
[0m11:00:59.653231 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:00:59.653231 [info ] [MainThread]: 
[0m11:00:59.653231 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:00:59.653231 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m11:01:02.286360 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m11:01:02.286360 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m11:01:02.286360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:04.281196 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.989 seconds
[0m11:01:04.288196 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m11:01:04.293894 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m11:01:04.293894 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m11:01:04.293894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:05.883196 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.584 seconds
[0m11:01:05.887188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m11:01:05.926885 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m11:01:05.926885 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m11:01:06.281909 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.354 seconds
[0m11:01:06.281909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m11:01:06.281909 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m11:01:06.281909 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m11:01:06.641005 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.349 seconds
[0m11:01:06.641005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c89a4b32-1e01-4114-84bb-88254b537186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225ECDA7590>]}
[0m11:01:06.641005 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_country_region
[0m11:01:06.641005 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_country_region .......................... [RUN]
[0m11:01:06.641005 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_country_region'
[0m11:01:06.641005 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_country_region
[0m11:01:06.656680 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_country_region"
[0m11:01:06.656680 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_country_region
[0m11:01:06.696274 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_country_region"
[0m11:01:06.697024 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_country_region"
[0m11:01:06.697024 [debug] [Thread-1 (]: On model.dbt_first.stg_country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_country_region"} */
create or replace transient table HEALTHCARE.stage.stg_country_region
         as
        (

WITH cte_removing_null_rows AS (
    SELECT
        *
    FROM
        HEALTHCARE.RAW.COUNTRY_REGION
    WHERE 
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    
  
),
cte_removing_duplicates AS (
    SELECT
        *
        , ROW_NUMBER() OVER (
            PARTITION BY   
                customer_id,
                country,region
            ORDER BY 
                customer_id ASC) AS row_number
    FROM
        cte_removing_null_rows
),
cte_changing_cases AS (
    SELECT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        removing_duplicates
    WHERE
        row_number = 1
)
SELECT
    *
FROM
    cte_changing_cases
        );
[0m11:01:06.699949 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:01:08.366793 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafeeb-0004-bb9d-0005-a3d30003add2
[0m11:01:08.366793 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'REMOVING_DUPLICATES' does not exist or not authorized.
[0m11:01:08.382465 [debug] [Thread-1 (]: Database Error in model stg_country_region (models\Stage\stg_country_region.sql)
  002003 (42S02): SQL compilation error:
  Object 'REMOVING_DUPLICATES' does not exist or not authorized.
  compiled code at target\run\dbt_first\models\Stage\stg_country_region.sql
[0m11:01:08.382465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c89a4b32-1e01-4114-84bb-88254b537186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225F19E21B0>]}
[0m11:01:08.382465 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.stg_country_region ................. [[31mERROR[0m in 1.74s]
[0m11:01:08.389420 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_country_region
[0m11:01:08.389420 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.stg_country_region' to be skipped because of status 'error'.  Reason: Database Error in model stg_country_region (models\Stage\stg_country_region.sql)
  002003 (42S02): SQL compilation error:
  Object 'REMOVING_DUPLICATES' does not exist or not authorized.
  compiled code at target\run\dbt_first\models\Stage\stg_country_region.sql.
[0m11:01:08.389420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:08.389420 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m11:01:08.389420 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m11:01:08.915184 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m11:01:08.915184 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m11:01:09.447515 [debug] [MainThread]: Connection 'model.dbt_first.stg_country_region' was left open.
[0m11:01:09.447515 [debug] [MainThread]: On model.dbt_first.stg_country_region: Close
[0m11:01:09.981548 [info ] [MainThread]: 
[0m11:01:09.983559 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.33 seconds (10.33s).
[0m11:01:09.983559 [debug] [MainThread]: Command end result
[0m11:01:10.009200 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:01:10.010200 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:01:10.016740 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:01:10.016740 [info ] [MainThread]: 
[0m11:01:10.019753 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:01:10.019753 [info ] [MainThread]: 
[0m11:01:10.021764 [error] [MainThread]:   Database Error in model stg_country_region (models\Stage\stg_country_region.sql)
  002003 (42S02): SQL compilation error:
  Object 'REMOVING_DUPLICATES' does not exist or not authorized.
  compiled code at target\run\dbt_first\models\Stage\stg_country_region.sql
[0m11:01:10.021764 [info ] [MainThread]: 
[0m11:01:10.021764 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:01:10.021764 [debug] [MainThread]: Command `dbt run` failed at 11:01:10.021764 after 13.31 seconds
[0m11:01:10.024930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225EF2B3920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225EF1431A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225EF1206B0>]}
[0m11:01:10.024930 [debug] [MainThread]: Flushing usage events
[0m11:01:10.969611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:01:38.105746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD888EC6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD888EC620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD888EC350>]}


============================== 11:01:38.105746 | bd52b97e-c003-401f-86e6-32381d1060b0 ==============================
[0m11:01:38.105746 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:01:38.105746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:country_region', 'send_anonymous_usage_stats': 'True'}
[0m11:01:38.572665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd52b97e-c003-401f-86e6-32381d1060b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD892C3A10>]}
[0m11:01:38.634743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd52b97e-c003-401f-86e6-32381d1060b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD892392B0>]}
[0m11:01:38.636715 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:01:38.982865 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:01:39.173826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:01:39.173826 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_country_region.sql
[0m11:01:39.426977 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m11:01:39.426977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd52b97e-c003-401f-86e6-32381d1060b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8AB41040>]}
[0m11:01:39.512998 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:01:39.512998 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:01:39.545002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd52b97e-c003-401f-86e6-32381d1060b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8ABFCCB0>]}
[0m11:01:39.545002 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m11:01:39.545002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd52b97e-c003-401f-86e6-32381d1060b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8A8B5AC0>]}
[0m11:01:39.545002 [info ] [MainThread]: 
[0m11:01:39.545002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:39.545002 [info ] [MainThread]: 
[0m11:01:39.545002 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:01:39.560645 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m11:01:39.646218 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m11:01:39.646218 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m11:01:39.661383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:41.573479 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.912 seconds
[0m11:01:41.575491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m11:01:41.586865 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m11:01:41.586865 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m11:01:41.586865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:43.127434 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.538 seconds
[0m11:01:43.132059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m11:01:43.196086 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m11:01:43.197128 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m11:01:43.541094 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.344 seconds
[0m11:01:43.544054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m11:01:43.546056 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m11:01:43.546056 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m11:01:43.866042 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.332 seconds
[0m11:01:43.881892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd52b97e-c003-401f-86e6-32381d1060b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8AAE50D0>]}
[0m11:01:43.881892 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_country_region
[0m11:01:43.881892 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_country_region .......................... [RUN]
[0m11:01:43.881892 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_country_region'
[0m11:01:43.881892 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_country_region
[0m11:01:43.881892 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_country_region"
[0m11:01:43.897954 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_country_region
[0m11:01:43.928446 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_country_region"
[0m11:01:43.930452 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_country_region"
[0m11:01:43.930452 [debug] [Thread-1 (]: On model.dbt_first.stg_country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_country_region"} */
create or replace transient table HEALTHCARE.stage.stg_country_region
         as
        (

WITH cte_removing_null_rows AS (
    SELECT
        *
    FROM
        HEALTHCARE.RAW.COUNTRY_REGION
    WHERE 
        
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    
  
),
cte_removing_duplicates AS (
    SELECT
        *
        , ROW_NUMBER() OVER (
            PARTITION BY   
                customer_id,
                country,region
            ORDER BY 
                customer_id ASC) AS row_number
    FROM
        cte_removing_null_rows
),
cte_changing_cases AS (
    SELECT
        CAST(customer_id AS INT) AS customer_id
        , LOWER(country)         AS country
        , LOWER(region)          AS region
    FROM
        cte_removing_duplicates
    WHERE
        row_number = 1
)
SELECT
    *
FROM
    cte_changing_cases
        );
[0m11:01:43.930452 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:01:47.005086 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.074 seconds
[0m11:01:47.030861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd52b97e-c003-401f-86e6-32381d1060b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8B072960>]}
[0m11:01:47.031860 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.stg_country_region ..................... [[32mSUCCESS 1[0m in 3.15s]
[0m11:01:47.032831 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_country_region
[0m11:01:47.033827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:47.033827 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m11:01:47.034859 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m11:01:47.565467 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m11:01:47.565467 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m11:01:48.114737 [debug] [MainThread]: Connection 'model.dbt_first.stg_country_region' was left open.
[0m11:01:48.115724 [debug] [MainThread]: On model.dbt_first.stg_country_region: Close
[0m11:01:48.637328 [info ] [MainThread]: 
[0m11:01:48.637328 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.09 seconds (9.09s).
[0m11:01:48.637328 [debug] [MainThread]: Command end result
[0m11:01:48.665379 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:01:48.668346 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:01:48.674758 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:01:48.674758 [info ] [MainThread]: 
[0m11:01:48.676785 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:01:48.676785 [info ] [MainThread]: 
[0m11:01:48.676785 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:01:48.678792 [debug] [MainThread]: Command `dbt run` succeeded at 11:01:48.678792 after 10.75 seconds
[0m11:01:48.678792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8A9F6E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8A9F7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8930BCE0>]}
[0m11:01:48.678792 [debug] [MainThread]: Flushing usage events
[0m11:01:50.056841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:45:58.213723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126F95C1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126F95C2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126F95C710>]}


============================== 11:45:58.213723 | c085dab8-68e5-43f3-9cc9-df81b5855afd ==============================
[0m11:45:58.213723 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:45:58.229325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:45:59.014414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c085dab8-68e5-43f3-9cc9-df81b5855afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212706E4440>]}
[0m11:45:59.080856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c085dab8-68e5-43f3-9cc9-df81b5855afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126F985C70>]}
[0m11:45:59.080856 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:45:59.575965 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:46:00.935370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:46:00.935370 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\product_churn.sql
[0m11:46:00.936369 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m11:46:01.238055 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m11:46:01.253553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c085dab8-68e5-43f3-9cc9-df81b5855afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021271CC0C50>]}
[0m11:46:01.335116 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:46:01.365639 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:46:01.413324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c085dab8-68e5-43f3-9cc9-df81b5855afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021271C64A70>]}
[0m11:46:01.413324 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m11:46:01.413324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c085dab8-68e5-43f3-9cc9-df81b5855afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021271C98350>]}
[0m11:46:01.415334 [info ] [MainThread]: 
[0m11:46:01.415334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:01.415334 [info ] [MainThread]: 
[0m11:46:01.420665 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:46:01.423837 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m11:46:04.299104 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m11:46:04.303246 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m11:46:04.303246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:06.448168 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.155 seconds
[0m11:46:06.464075 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m11:46:06.473593 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m11:46:06.475132 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m11:46:06.475132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:08.112890 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.648 seconds
[0m11:46:08.112890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m11:46:08.112890 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m11:46:08.112890 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m11:46:08.477313 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.349 seconds
[0m11:46:08.481831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m11:46:08.526917 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m11:46:08.526917 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m11:46:08.863138 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.326 seconds
[0m11:46:08.866174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c085dab8-68e5-43f3-9cc9-df81b5855afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127223F1A0>]}
[0m11:46:08.872546 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m11:46:08.873062 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m11:46:08.873633 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m11:46:08.873633 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m11:46:08.883314 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m11:46:08.884315 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m11:46:08.909714 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m11:46:08.909714 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m11:46:08.909714 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (
WITH first_purchase AS (
    SELECT
        customer_id,
        MIN(transaction_date) AS first_purchase_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY customer_id
),

last_purchase AS (
    SELECT
        customer_id,
        MAX(transaction_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY customer_id
),

churned_customers AS (
    SELECT
        customer_id,
        last_purchase_date
    FROM last_purchase
    WHERE last_purchase_date < DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who haven’t purchased in the last 6 months
),

new_customers AS (
    SELECT
        customer_id,
        first_purchase_date
    FROM first_purchase
    WHERE first_purchase_date >= DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who first purchased in the last 6 months
)


SELECT
    'churned' AS customer_status,
    COUNT(*) AS customer_count
FROM churned_customers

UNION ALL

SELECT
    'new' AS customer_status,
    COUNT(*) AS customer_count
FROM new_customers;
[0m11:46:08.909714 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:46:10.559674 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff18-0004-c0bd-0005-a3d30003b41a
[0m11:46:10.559674 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 47 at position 18 unexpected ';'.
[0m11:46:10.575496 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 47 at position 18 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m11:46:10.575496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c085dab8-68e5-43f3-9cc9-df81b5855afd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021271AF4BC0>]}
[0m11:46:10.575496 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.churned_new_customers ............... [[31mERROR[0m in 1.70s]
[0m11:46:10.575496 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m11:46:10.575496 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 47 at position 18 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql.
[0m11:46:10.585348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:10.585348 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m11:46:10.585348 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m11:46:11.109762 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m11:46:11.109762 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m11:46:11.626997 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m11:46:11.626997 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m11:46:12.152590 [info ] [MainThread]: 
[0m11:46:12.168245 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.73 seconds (10.73s).
[0m11:46:12.168245 [debug] [MainThread]: Command end result
[0m11:46:12.191883 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:46:12.196526 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:46:12.200085 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:46:12.200085 [info ] [MainThread]: 
[0m11:46:12.200085 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:46:12.200085 [info ] [MainThread]: 
[0m11:46:12.200085 [error] [MainThread]:   Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 47 at position 18 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m11:46:12.200085 [info ] [MainThread]: 
[0m11:46:12.200085 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:46:12.209246 [debug] [MainThread]: Command `dbt run` failed at 11:46:12.209246 after 14.26 seconds
[0m11:46:12.209246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126F9A26F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002126EDF7B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021271BD4680>]}
[0m11:46:12.210303 [debug] [MainThread]: Flushing usage events
[0m11:46:13.256038 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:08.336118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A90CA7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A918D88C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A918D88F0>]}


============================== 11:47:08.336118 | dbcc93eb-61c6-4107-96a1-8881a11ce24b ==============================
[0m11:47:08.336118 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:47:08.336118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m11:47:08.805212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbcc93eb-61c6-4107-96a1-8881a11ce24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A90E123C0>]}
[0m11:47:08.867508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbcc93eb-61c6-4107-96a1-8881a11ce24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A935D7C20>]}
[0m11:47:08.867508 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:47:09.228411 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:47:09.405569 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:47:09.405569 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m11:47:09.666929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m11:47:09.682589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbcc93eb-61c6-4107-96a1-8881a11ce24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A93C00980>]}
[0m11:47:09.753754 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:47:09.768546 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:47:09.797672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbcc93eb-61c6-4107-96a1-8881a11ce24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A93B9C7A0>]}
[0m11:47:09.798672 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m11:47:09.799673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbcc93eb-61c6-4107-96a1-8881a11ce24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A93BCF3E0>]}
[0m11:47:09.799673 [info ] [MainThread]: 
[0m11:47:09.799673 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:47:09.799673 [info ] [MainThread]: 
[0m11:47:09.799673 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:47:09.799673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m11:47:09.900590 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m11:47:09.900590 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m11:47:09.900590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:11.881363 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.980 seconds
[0m11:47:11.887837 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m11:47:11.896684 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m11:47:11.896684 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m11:47:11.896684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:13.450774 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.557 seconds
[0m11:47:13.450774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m11:47:13.450774 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m11:47:13.450774 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m11:47:13.786610 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.333 seconds
[0m11:47:13.786610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m11:47:13.834800 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m11:47:13.834800 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m11:47:14.190466 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.345 seconds
[0m11:47:14.190466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbcc93eb-61c6-4107-96a1-8881a11ce24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A93C71520>]}
[0m11:47:14.190466 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m11:47:14.190466 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m11:47:14.190466 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m11:47:14.190466 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m11:47:14.208243 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m11:47:14.209274 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m11:47:14.238241 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m11:47:14.238241 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m11:47:14.238241 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (
WITH first_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY customer_id
),

last_purchase AS (
    SELECT
        customer_id,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY customer_id
),

churned_customers AS (
    SELECT
        customer_id,
        last_purchase_date
    FROM last_purchase
    WHERE last_purchase_date < DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who haven’t purchased in the last 6 months
),

new_customers AS (
    SELECT
        customer_id,
        first_purchase_date
    FROM first_purchase
    WHERE first_purchase_date >= DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who first purchased in the last 6 months
)


SELECT
    'churned' AS customer_status,
    COUNT(*) AS customer_count
FROM churned_customers

UNION ALL

SELECT
    'new' AS customer_status,
    COUNT(*) AS customer_count
FROM new_customers
        );
[0m11:47:14.238241 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:47:16.942563 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.701 seconds
[0m11:47:16.958557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbcc93eb-61c6-4107-96a1-8881a11ce24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A8EC79E50>]}
[0m11:47:16.958557 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 2.77s]
[0m11:47:16.958557 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m11:47:16.958557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:16.958557 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m11:47:16.958557 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m11:47:17.504782 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m11:47:17.504782 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m11:47:18.047125 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m11:47:18.047125 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m11:47:18.577371 [info ] [MainThread]: 
[0m11:47:18.577371 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.78 seconds (8.78s).
[0m11:47:18.577371 [debug] [MainThread]: Command end result
[0m11:47:18.609724 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:47:18.611755 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:47:18.618279 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:47:18.619279 [info ] [MainThread]: 
[0m11:47:18.620248 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:47:18.620248 [info ] [MainThread]: 
[0m11:47:18.621282 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:47:18.621282 [debug] [MainThread]: Command `dbt run` succeeded at 11:47:18.621282 after 10.44 seconds
[0m11:47:18.621282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A916DF770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A8F06E150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014A9144A600>]}
[0m11:47:18.621282 [debug] [MainThread]: Flushing usage events
[0m11:47:19.694142 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:09.983978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BCF67A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BCF655E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BCF67650>]}


============================== 11:49:09.983978 | 690ce1c3-b935-40dd-9aa4-62d202797eb8 ==============================
[0m11:49:09.983978 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:49:09.983978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:49:10.447969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '690ce1c3-b935-40dd-9aa4-62d202797eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BA30E870>]}
[0m11:49:10.513503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '690ce1c3-b935-40dd-9aa4-62d202797eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BC92C170>]}
[0m11:49:10.515064 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:49:10.858091 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:49:11.055924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:49:11.055924 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m11:49:11.304720 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m11:49:11.324543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '690ce1c3-b935-40dd-9aa4-62d202797eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BF163410>]}
[0m11:49:11.406382 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:49:11.410320 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:49:11.437807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '690ce1c3-b935-40dd-9aa4-62d202797eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BF208770>]}
[0m11:49:11.437807 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m11:49:11.437807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '690ce1c3-b935-40dd-9aa4-62d202797eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BEEF7E30>]}
[0m11:49:11.437807 [info ] [MainThread]: 
[0m11:49:11.437807 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:49:11.437807 [info ] [MainThread]: 
[0m11:49:11.437807 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:49:11.437807 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m11:49:11.538430 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m11:49:11.538430 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m11:49:11.538430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:13.511601 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.979 seconds
[0m11:49:13.527223 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m11:49:13.536255 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m11:49:13.537255 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m11:49:13.537255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:15.032614 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.498 seconds
[0m11:49:15.032614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m11:49:15.032614 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m11:49:15.032614 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m11:49:15.368288 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.330 seconds
[0m11:49:15.368288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m11:49:15.419758 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m11:49:15.419758 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m11:49:15.739859 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.320 seconds
[0m11:49:15.739859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '690ce1c3-b935-40dd-9aa4-62d202797eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BF8164E0>]}
[0m11:49:15.755544 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m11:49:15.755544 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m11:49:15.755544 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m11:49:15.755544 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m11:49:15.755544 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m11:49:15.755544 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m11:49:15.792938 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m11:49:15.792938 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m11:49:15.792938 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY customer_id
)
SELECT * FROM first_purchase

-- last_purchase AS (
--     SELECT
--         customer_id,
--         MAX(payment_date) AS last_purchase_date
--     FROM HEALTHCARE.stage.stg_transactions
--     GROUP BY customer_id
-- )


-- churned_customers AS (
--     SELECT
--         customer_id,
--         last_purchase_date
--     FROM last_purchase
--     WHERE last_purchase_date < DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who haven’t purchased in the last 6 months
-- ),

-- new_customers AS (
--     SELECT
--         customer_id,
--         first_purchase_date
--     FROM first_purchase
--     WHERE first_purchase_date >= DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who first purchased in the last 6 months
-- )
        );
[0m11:49:15.792938 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:49:18.359653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.560 seconds
[0m11:49:18.383631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '690ce1c3-b935-40dd-9aa4-62d202797eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BA30D820>]}
[0m11:49:18.383631 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 2.63s]
[0m11:49:18.383631 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m11:49:18.383631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:18.383631 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m11:49:18.383631 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m11:49:18.929610 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m11:49:18.929610 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m11:49:19.441413 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m11:49:19.441413 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m11:49:19.972799 [info ] [MainThread]: 
[0m11:49:19.973745 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.53 seconds (8.53s).
[0m11:49:19.974105 [debug] [MainThread]: Command end result
[0m11:49:20.003214 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:49:20.007781 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:49:20.014917 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:49:20.015904 [info ] [MainThread]: 
[0m11:49:20.016905 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:49:20.016905 [info ] [MainThread]: 
[0m11:49:20.017900 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:49:20.018900 [debug] [MainThread]: Command `dbt run` succeeded at 11:49:20.018900 after 10.21 seconds
[0m11:49:20.019900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BC974E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BC37ADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BC37ACC0>]}
[0m11:49:20.019900 [debug] [MainThread]: Flushing usage events
[0m11:49:21.552941 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:55.421634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204652346B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020465235700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020465234980>]}


============================== 11:49:55.425658 | c7c74068-0b2e-4082-8810-2f582f03c92f ==============================
[0m11:49:55.425658 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:49:55.427661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:49:55.884060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7c74068-0b2e-4082-8810-2f582f03c92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020465252060>]}
[0m11:49:55.950956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7c74068-0b2e-4082-8810-2f582f03c92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020465FA17F0>]}
[0m11:49:55.952423 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:49:56.305437 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:49:56.483247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:49:56.498661 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m11:49:56.749992 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m11:49:56.749992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7c74068-0b2e-4082-8810-2f582f03c92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204675F09B0>]}
[0m11:49:56.848026 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:49:56.851545 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:49:56.866447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7c74068-0b2e-4082-8810-2f582f03c92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204675906E0>]}
[0m11:49:56.881717 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m11:49:56.881717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c74068-0b2e-4082-8810-2f582f03c92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204675BA900>]}
[0m11:49:56.881717 [info ] [MainThread]: 
[0m11:49:56.881717 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:49:56.881717 [info ] [MainThread]: 
[0m11:49:56.881717 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:49:56.881717 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m11:49:56.983209 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m11:49:56.983209 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m11:49:56.983209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:58.753023 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.780 seconds
[0m11:49:58.784914 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m11:49:58.784914 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m11:49:58.784914 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m11:49:58.784914 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:00.244574 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.454 seconds
[0m11:50:00.250249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m11:50:00.250249 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m11:50:00.250249 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m11:50:00.580692 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.340 seconds
[0m11:50:00.596661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m11:50:00.644114 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m11:50:00.644114 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m11:50:00.974440 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.327 seconds
[0m11:50:00.974440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c74068-0b2e-4082-8810-2f582f03c92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002046785C830>]}
[0m11:50:00.974440 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m11:50:00.974440 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m11:50:00.984137 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m11:50:00.984137 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m11:50:00.992206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m11:50:00.992206 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m11:50:01.021284 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m11:50:01.021284 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m11:50:01.021284 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY customer_id 
    order by customer_id
)
SELECT * FROM first_purchase

-- last_purchase AS (
--     SELECT
--         customer_id,
--         MAX(payment_date) AS last_purchase_date
--     FROM HEALTHCARE.stage.stg_transactions
--     GROUP BY customer_id
-- )


-- churned_customers AS (
--     SELECT
--         customer_id,
--         last_purchase_date
--     FROM last_purchase
--     WHERE last_purchase_date < DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who haven’t purchased in the last 6 months
-- ),

-- new_customers AS (
--     SELECT
--         customer_id,
--         first_purchase_date
--     FROM first_purchase
--     WHERE first_purchase_date >= DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who first purchased in the last 6 months
-- )
        );
[0m11:50:01.021284 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:50:03.022935 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.995 seconds
[0m11:50:03.038383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c74068-0b2e-4082-8810-2f582f03c92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204625ED970>]}
[0m11:50:03.038383 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 2.05s]
[0m11:50:03.038383 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m11:50:03.038383 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:03.038383 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m11:50:03.038383 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m11:50:03.584257 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m11:50:03.584257 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m11:50:04.108237 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m11:50:04.108237 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m11:50:04.625851 [info ] [MainThread]: 
[0m11:50:04.625851 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.74 seconds (7.74s).
[0m11:50:04.625851 [debug] [MainThread]: Command end result
[0m11:50:04.653532 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:50:04.659525 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:50:04.664554 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:50:04.664554 [info ] [MainThread]: 
[0m11:50:04.664554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:50:04.664554 [info ] [MainThread]: 
[0m11:50:04.664554 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:50:04.664554 [debug] [MainThread]: Command `dbt run` succeeded at 11:50:04.664554 after 9.41 seconds
[0m11:50:04.664554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204649B7EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020462FB5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204642DA270>]}
[0m11:50:04.664554 [debug] [MainThread]: Flushing usage events
[0m11:50:05.610383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:52:52.346259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC3450710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC3450770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC34523C0>]}


============================== 11:52:52.346259 | 73356122-30e8-4b1c-83cb-bda99057682a ==============================
[0m11:52:52.346259 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:52:52.346259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m11:52:52.810689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73356122-30e8-4b1c-83cb-bda99057682a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC5327AD0>]}
[0m11:52:52.864023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73356122-30e8-4b1c-83cb-bda99057682a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC4316690>]}
[0m11:52:52.864023 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:52:53.222317 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:52:53.397007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:52:53.397007 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m11:52:53.650432 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m11:52:53.666120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73356122-30e8-4b1c-83cb-bda99057682a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC58905F0>]}
[0m11:52:53.742931 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:52:53.745943 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:52:53.774938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73356122-30e8-4b1c-83cb-bda99057682a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC58306B0>]}
[0m11:52:53.774938 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m11:52:53.777448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73356122-30e8-4b1c-83cb-bda99057682a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC5891400>]}
[0m11:52:53.777448 [info ] [MainThread]: 
[0m11:52:53.777448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:52:53.777448 [info ] [MainThread]: 
[0m11:52:53.777448 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:52:53.777448 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m11:52:53.878381 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m11:52:53.879384 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m11:52:53.879384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:56.491499 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.619 seconds
[0m11:52:56.504707 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m11:52:56.507625 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m11:52:56.507625 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m11:52:56.507625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:58.141961 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.627 seconds
[0m11:52:58.141961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m11:52:58.141961 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m11:52:58.141961 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m11:52:58.481374 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.345 seconds
[0m11:52:58.496438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m11:52:58.544464 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m11:52:58.544464 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m11:52:58.874991 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.334 seconds
[0m11:52:58.874991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73356122-30e8-4b1c-83cb-bda99057682a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC5CDF050>]}
[0m11:52:58.883344 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m11:52:58.883344 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m11:52:58.883344 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m11:52:58.883344 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m11:52:58.883344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m11:52:58.883344 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m11:52:58.916224 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m11:52:58.931017 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m11:52:58.931017 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY customer_id 
)
SELECT * FROM first_purchase

-- last_purchase AS (
--     SELECT
--         customer_id,
--         MAX(payment_date) AS last_purchase_date
--     FROM HEALTHCARE.stage.stg_transactions
--     GROUP BY customer_id
-- )


-- churned_customers AS (
--     SELECT
--         customer_id,
--         last_purchase_date
--     FROM last_purchase
--     WHERE last_purchase_date < DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who haven’t purchased in the last 6 months
-- ),

-- new_customers AS (
--     SELECT
--         customer_id,
--         first_purchase_date
--     FROM first_purchase
--     WHERE first_purchase_date >= DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who first purchased in the last 6 months
-- )
        );
[0m11:52:58.932093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:53:01.366849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.435 seconds
[0m11:53:01.391385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73356122-30e8-4b1c-83cb-bda99057682a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC0929CA0>]}
[0m11:53:01.392384 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 2.51s]
[0m11:53:01.393352 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m11:53:01.394349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:01.394349 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m11:53:01.395383 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m11:53:01.935942 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m11:53:01.937256 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m11:53:02.469317 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m11:53:02.469317 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m11:53:03.001511 [info ] [MainThread]: 
[0m11:53:03.001511 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.22 seconds (9.22s).
[0m11:53:03.001511 [debug] [MainThread]: Command end result
[0m11:53:03.049770 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:53:03.053769 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:53:03.070774 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:53:03.072787 [info ] [MainThread]: 
[0m11:53:03.109665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:03.111673 [info ] [MainThread]: 
[0m11:53:03.113679 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:53:03.116726 [debug] [MainThread]: Command `dbt run` succeeded at 11:53:03.116726 after 10.99 seconds
[0m11:53:03.121033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC234FC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC1326540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC32D4CE0>]}
[0m11:53:03.125027 [debug] [MainThread]: Flushing usage events
[0m11:53:04.172510 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:20.630152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DA1ECAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9D9ADA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DA1EC830>]}


============================== 11:56:20.630152 | 2a3c4d02-8dee-4f9d-8146-8fe68b1f5c71 ==============================
[0m11:56:20.630152 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:56:20.630152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:56:21.103155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a3c4d02-8dee-4f9d-8146-8fe68b1f5c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DBF95EB0>]}
[0m11:56:21.165745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a3c4d02-8dee-4f9d-8146-8fe68b1f5c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DAF67D70>]}
[0m11:56:21.166287 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:56:21.518553 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:56:21.714895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:56:21.714895 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m11:56:21.967051 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m11:56:21.987290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a3c4d02-8dee-4f9d-8146-8fe68b1f5c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DC500920>]}
[0m11:56:22.068601 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:56:22.071599 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:56:22.098736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a3c4d02-8dee-4f9d-8146-8fe68b1f5c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DC490980>]}
[0m11:56:22.098736 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m11:56:22.099736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a3c4d02-8dee-4f9d-8146-8fe68b1f5c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DC500530>]}
[0m11:56:22.099736 [info ] [MainThread]: 
[0m11:56:22.099736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:56:22.099736 [info ] [MainThread]: 
[0m11:56:22.099736 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:56:22.099736 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m11:56:22.199875 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m11:56:22.202129 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m11:56:22.202129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:24.732782 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.543 seconds
[0m11:56:24.748681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m11:56:24.748681 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m11:56:24.748681 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m11:56:24.748681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:26.353744 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.604 seconds
[0m11:56:26.353744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m11:56:26.369858 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m11:56:26.369858 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m11:56:26.715956 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.346 seconds
[0m11:56:26.718998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m11:56:26.766671 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m11:56:26.766671 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m11:56:27.120077 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.349 seconds
[0m11:56:27.120077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a3c4d02-8dee-4f9d-8146-8fe68b1f5c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DC4C7230>]}
[0m11:56:27.120077 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m11:56:27.120077 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m11:56:27.120077 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m11:56:27.120077 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m11:56:27.132727 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m11:56:27.132727 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m11:56:27.171771 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m11:56:27.172659 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m11:56:27.176893 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
   SELECT
        MAX(last_purchase_date) AS max_date,
        MIN(first_purchase_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions 
-- ),
-- max_min_overall AS(
--     SELECT
--         MAX(last_purchase_date) AS max_date,
--         MIN(first_purchase_date) AS min_date
--     FROM HEALTHCARE.stage.stg_transactions
-- )
SELECT * FROM first_purchase

-- last_purchase AS (
--     SELECT
--         customer_id,
--         MAX(payment_date) AS last_purchase_date
--     FROM HEALTHCARE.stage.stg_transactions
--     GROUP BY customer_id
-- )


-- churned_customers AS (
--     SELECT
--         customer_id,
--         last_purchase_date
--     FROM last_purchase
--     WHERE last_purchase_date < DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who haven’t purchased in the last 6 months
-- ),

-- new_customers AS (
--     SELECT
--         customer_id,
--         first_purchase_date
--     FROM first_purchase
--     WHERE first_purchase_date >= DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who first purchased in the last 6 months
-- )
        );
[0m11:56:27.176893 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:56:28.635188 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff22-0004-bde4-0005-a3d300034f8a
[0m11:56:28.635188 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 0 unexpected 'SELECT'.
[0m11:56:28.635188 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 0 unexpected 'SELECT'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m11:56:28.635188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3c4d02-8dee-4f9d-8146-8fe68b1f5c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DC570560>]}
[0m11:56:28.635188 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.churned_new_customers ............... [[31mERROR[0m in 1.52s]
[0m11:56:28.635188 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m11:56:28.635188 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 0 unexpected 'SELECT'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql.
[0m11:56:28.635188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:28.635188 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m11:56:28.635188 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m11:56:29.181568 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m11:56:29.181568 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m11:56:29.691563 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m11:56:29.691563 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m11:56:30.250187 [info ] [MainThread]: 
[0m11:56:30.250187 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.15 seconds (8.15s).
[0m11:56:30.250187 [debug] [MainThread]: Command end result
[0m11:56:30.281731 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:56:30.281731 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:56:30.292290 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:56:30.292290 [info ] [MainThread]: 
[0m11:56:30.292290 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:56:30.292290 [info ] [MainThread]: 
[0m11:56:30.292290 [error] [MainThread]:   Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 0 unexpected 'SELECT'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m11:56:30.292290 [info ] [MainThread]: 
[0m11:56:30.292290 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:56:30.292290 [debug] [MainThread]: Command `dbt run` failed at 11:56:30.292290 after 9.91 seconds
[0m11:56:30.292290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DBFBA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DBFB8AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DBFB9CD0>]}
[0m11:56:30.292290 [debug] [MainThread]: Flushing usage events
[0m11:56:31.277977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:45.357915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96D3FF8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96D3FC7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96D3FC8C0>]}


============================== 11:56:45.357915 | 8e631b4f-87a1-4f9e-affa-e17febdb06e0 ==============================
[0m11:56:45.357915 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:56:45.373734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:56:45.841136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e631b4f-87a1-4f9e-affa-e17febdb06e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96E270EC0>]}
[0m11:56:45.908185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e631b4f-87a1-4f9e-affa-e17febdb06e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96CB69940>]}
[0m11:56:45.908185 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:56:46.268380 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:56:46.465386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:56:46.466385 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m11:56:46.725003 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m11:56:46.737257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e631b4f-87a1-4f9e-affa-e17febdb06e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96F8909E0>]}
[0m11:56:46.816699 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:56:46.820960 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:56:46.839726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e631b4f-87a1-4f9e-affa-e17febdb06e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96F8309B0>]}
[0m11:56:46.839726 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m11:56:46.839726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e631b4f-87a1-4f9e-affa-e17febdb06e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96F588230>]}
[0m11:56:46.839726 [info ] [MainThread]: 
[0m11:56:46.839726 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:56:46.839726 [info ] [MainThread]: 
[0m11:56:46.839726 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:56:46.839726 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m11:56:46.949584 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m11:56:46.949584 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m11:56:46.950583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:48.854658 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.905 seconds
[0m11:56:48.860084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m11:56:48.860084 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m11:56:48.860084 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m11:56:48.860084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:51.169745 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.301 seconds
[0m11:56:51.169745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m11:56:51.169745 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m11:56:51.169745 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m11:56:51.528776 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.348 seconds
[0m11:56:51.528776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m11:56:51.592778 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m11:56:51.592778 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m11:56:51.945356 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.344 seconds
[0m11:56:51.947276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e631b4f-87a1-4f9e-affa-e17febdb06e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96D4E7B00>]}
[0m11:56:51.952334 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m11:56:51.952334 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m11:56:51.952334 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m11:56:51.952334 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m11:56:51.964056 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m11:56:51.964793 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m11:56:51.997051 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m11:56:51.997051 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m11:56:51.997051 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
   SELECT
        MAX(last_purchase_date) AS max_date,
        MIN(first_purchase_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions 
)
-- max_min_overall AS(
--     SELECT
--         MAX(last_purchase_date) AS max_date,
--         MIN(first_purchase_date) AS min_date
--     FROM HEALTHCARE.stage.stg_transactions
-- )
SELECT * FROM first_purchase

-- last_purchase AS (
--     SELECT
--         customer_id,
--         MAX(payment_date) AS last_purchase_date
--     FROM HEALTHCARE.stage.stg_transactions
--     GROUP BY customer_id
-- )


-- churned_customers AS (
--     SELECT
--         customer_id,
--         last_purchase_date
--     FROM last_purchase
--     WHERE last_purchase_date < DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who haven’t purchased in the last 6 months
-- ),

-- new_customers AS (
--     SELECT
--         customer_id,
--         first_purchase_date
--     FROM first_purchase
--     WHERE first_purchase_date >= DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who first purchased in the last 6 months
-- )
        );
[0m11:56:51.997051 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:56:53.395529 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff22-0004-bb9f-0005-a3d30003c0ce
[0m11:56:53.395529 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FIRST_PURCHASE' does not exist or not authorized.
[0m11:56:53.395529 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FIRST_PURCHASE' does not exist or not authorized.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m11:56:53.411306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e631b4f-87a1-4f9e-affa-e17febdb06e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96FC643B0>]}
[0m11:56:53.411306 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.churned_new_customers ............... [[31mERROR[0m in 1.44s]
[0m11:56:53.411306 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m11:56:53.411306 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FIRST_PURCHASE' does not exist or not authorized.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql.
[0m11:56:53.411306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:53.411306 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m11:56:53.411306 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m11:56:53.927594 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m11:56:53.927594 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m11:56:54.445522 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m11:56:54.445522 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m11:56:54.952642 [info ] [MainThread]: 
[0m11:56:54.952642 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.11 seconds (8.11s).
[0m11:56:54.952642 [debug] [MainThread]: Command end result
[0m11:56:54.985758 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:56:54.988792 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:56:54.995757 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:56:54.995757 [info ] [MainThread]: 
[0m11:56:55.016570 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:56:55.020638 [info ] [MainThread]: 
[0m11:56:55.020638 [error] [MainThread]:   Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FIRST_PURCHASE' does not exist or not authorized.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m11:56:55.024245 [info ] [MainThread]: 
[0m11:56:55.032792 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:56:55.039527 [debug] [MainThread]: Command `dbt run` failed at 11:56:55.039527 after 9.83 seconds
[0m11:56:55.041535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96CC7A480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96CA81F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96AB7DAC0>]}
[0m11:56:55.041535 [debug] [MainThread]: Flushing usage events
[0m11:56:56.057854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:22.739793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAC0E04320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DABEB86480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAC0E042C0>]}


============================== 11:58:22.739793 | e57a9e5d-a168-441e-847d-1aed9fc33453 ==============================
[0m11:58:22.739793 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:58:22.739793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:58:23.291385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e57a9e5d-a168-441e-847d-1aed9fc33453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAC1BDCB00>]}
[0m11:58:23.350042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e57a9e5d-a168-441e-847d-1aed9fc33453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAC1B97110>]}
[0m11:58:23.353054 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:58:23.811575 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:58:25.133130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:58:25.133130 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m11:58:25.379937 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m11:58:25.385653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e57a9e5d-a168-441e-847d-1aed9fc33453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAC31B09B0>]}
[0m11:58:25.470307 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:58:25.485532 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:58:25.506313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e57a9e5d-a168-441e-847d-1aed9fc33453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAC3150860>]}
[0m11:58:25.506313 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m11:58:25.506313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e57a9e5d-a168-441e-847d-1aed9fc33453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAC1B61460>]}
[0m11:58:25.520845 [info ] [MainThread]: 
[0m11:58:25.520845 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:58:25.520845 [info ] [MainThread]: 
[0m11:58:25.522351 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:58:25.522351 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m11:58:28.166203 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m11:58:28.168209 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m11:58:28.168209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:30.285024 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.118 seconds
[0m11:58:30.291617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m11:58:30.293400 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m11:58:30.293400 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m11:58:30.293400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:31.854588 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.554 seconds
[0m11:58:31.856426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m11:58:31.860440 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m11:58:31.860440 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m11:58:32.198591 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.353 seconds
[0m11:58:32.214387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m11:58:32.261708 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m11:58:32.261708 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m11:58:32.607857 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.347 seconds
[0m11:58:32.607857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e57a9e5d-a168-441e-847d-1aed9fc33453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAC3644830>]}
[0m11:58:32.607857 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m11:58:32.607857 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m11:58:32.607857 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m11:58:32.607857 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m11:58:32.628175 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m11:58:32.629211 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m11:58:32.647856 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m11:58:32.647856 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m11:58:32.647856 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
   SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions 
)
-- max_min_overall AS(
--     SELECT
--         MAX(last_purchase_date) AS max_date,
--         MIN(first_purchase_date) AS min_date
--     FROM HEALTHCARE.stage.stg_transactions
-- )
SELECT * FROM first_purchase

-- last_purchase AS (
--     SELECT
--         customer_id,
--         MAX(payment_date) AS last_purchase_date
--     FROM HEALTHCARE.stage.stg_transactions
--     GROUP BY customer_id
-- )


-- churned_customers AS (
--     SELECT
--         customer_id,
--         last_purchase_date
--     FROM last_purchase
--     WHERE last_purchase_date < DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who haven’t purchased in the last 6 months
-- ),

-- new_customers AS (
--     SELECT
--         customer_id,
--         first_purchase_date
--     FROM first_purchase
--     WHERE first_purchase_date >= DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who first purchased in the last 6 months
-- )
        );
[0m11:58:32.647856 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:58:34.382149 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff24-0004-bded-0005-a3d300030f82
[0m11:58:34.382149 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FIRST_PURCHASE' does not exist or not authorized.
[0m11:58:34.398527 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FIRST_PURCHASE' does not exist or not authorized.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m11:58:34.398527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e57a9e5d-a168-441e-847d-1aed9fc33453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAC02C0890>]}
[0m11:58:34.398527 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.churned_new_customers ............... [[31mERROR[0m in 1.79s]
[0m11:58:34.398527 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m11:58:34.398527 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FIRST_PURCHASE' does not exist or not authorized.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql.
[0m11:58:34.398527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:34.398527 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m11:58:34.398527 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m11:58:34.947890 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m11:58:34.947890 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m11:58:35.478732 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m11:58:35.478732 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m11:58:36.001274 [info ] [MainThread]: 
[0m11:58:36.001274 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.48 seconds (10.48s).
[0m11:58:36.001274 [debug] [MainThread]: Command end result
[0m11:58:36.025159 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:58:36.028153 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:58:36.034356 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:58:36.035355 [info ] [MainThread]: 
[0m11:58:36.035355 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:58:36.036353 [info ] [MainThread]: 
[0m11:58:36.037352 [error] [MainThread]:   Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'FIRST_PURCHASE' does not exist or not authorized.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m11:58:36.037352 [info ] [MainThread]: 
[0m11:58:36.038351 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:58:36.039775 [debug] [MainThread]: Command `dbt run` failed at 11:58:36.039775 after 13.54 seconds
[0m11:58:36.039775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAC0ADA120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAC07B9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAC07BA480>]}
[0m11:58:36.039775 [debug] [MainThread]: Flushing usage events
[0m11:58:37.401926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:55.206077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74D554BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74D554EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74D557470>]}


============================== 11:58:55.221784 | 7686cb8b-2392-4cbc-870d-03e9d9cf6ad1 ==============================
[0m11:58:55.221784 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:58:55.221784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:58:55.677265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7686cb8b-2392-4cbc-870d-03e9d9cf6ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74CC4B230>]}
[0m11:58:55.740336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7686cb8b-2392-4cbc-870d-03e9d9cf6ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74E05A420>]}
[0m11:58:55.740336 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:58:56.092455 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:58:56.271954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:58:56.271954 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m11:58:56.509320 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m11:58:56.526392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7686cb8b-2392-4cbc-870d-03e9d9cf6ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74F820890>]}
[0m11:58:56.605058 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:58:56.605058 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:58:56.636948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7686cb8b-2392-4cbc-870d-03e9d9cf6ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74F7D0D40>]}
[0m11:58:56.636948 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m11:58:56.636948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7686cb8b-2392-4cbc-870d-03e9d9cf6ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74F5AFF20>]}
[0m11:58:56.636948 [info ] [MainThread]: 
[0m11:58:56.636948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:58:56.636948 [info ] [MainThread]: 
[0m11:58:56.636948 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:58:56.636948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m11:58:56.747343 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m11:58:56.747343 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m11:58:56.747343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:58.750661 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.004 seconds
[0m11:58:58.758248 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m11:58:58.770231 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m11:58:58.770231 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m11:58:58.770231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:00.310066 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.535 seconds
[0m11:59:00.310066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m11:59:00.310066 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m11:59:00.310066 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m11:59:00.744251 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.426 seconds
[0m11:59:00.744251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m11:59:00.796883 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m11:59:00.796883 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m11:59:01.163339 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.367 seconds
[0m11:59:01.163339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7686cb8b-2392-4cbc-870d-03e9d9cf6ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74FB4CB60>]}
[0m11:59:01.163339 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m11:59:01.179162 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m11:59:01.179162 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m11:59:01.179162 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m11:59:01.188036 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m11:59:01.188036 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m11:59:01.213139 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m11:59:01.213139 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m11:59:01.213139 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
   SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions 
)
-- max_min_overall AS(
--     SELECT
--         MAX(last_purchase_date) AS max_date,
--         MIN(first_purchase_date) AS min_date
--     FROM HEALTHCARE.stage.stg_transactions
-- )
SELECT * FROM first_last_purchase

-- last_purchase AS (
--     SELECT
--         customer_id,
--         MAX(payment_date) AS last_purchase_date
--     FROM HEALTHCARE.stage.stg_transactions
--     GROUP BY customer_id
-- )


-- churned_customers AS (
--     SELECT
--         customer_id,
--         last_purchase_date
--     FROM last_purchase
--     WHERE last_purchase_date < DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who haven’t purchased in the last 6 months
-- ),

-- new_customers AS (
--     SELECT
--         customer_id,
--         first_purchase_date
--     FROM first_purchase
--     WHERE first_purchase_date >= DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who first purchased in the last 6 months
-- )
        );
[0m11:59:01.213139 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:59:03.315837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.100 seconds
[0m11:59:03.347698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7686cb8b-2392-4cbc-870d-03e9d9cf6ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74A8FD940>]}
[0m11:59:03.347698 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 2.15s]
[0m11:59:03.347698 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m11:59:03.347698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:03.347698 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m11:59:03.347698 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m11:59:03.884952 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m11:59:03.884952 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m11:59:04.429369 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m11:59:04.429369 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m11:59:04.964856 [info ] [MainThread]: 
[0m11:59:04.965825 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.33 seconds (8.33s).
[0m11:59:04.965825 [debug] [MainThread]: Command end result
[0m11:59:04.988443 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m11:59:04.991364 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m11:59:04.997370 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m11:59:04.998374 [info ] [MainThread]: 
[0m11:59:04.999372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:59:04.999372 [info ] [MainThread]: 
[0m11:59:05.000370 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:59:05.001370 [debug] [MainThread]: Command `dbt run` succeeded at 11:59:05.001370 after 9.94 seconds
[0m11:59:05.002722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74F7EBFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74F7E9C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E74F83F170>]}
[0m11:59:05.003160 [debug] [MainThread]: Flushing usage events
[0m11:59:06.013936 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:24.538982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC7725490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC70DA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC7727F80>]}


============================== 12:02:24.554755 | 96861dd3-f37b-4863-ae1d-f04afe649a2b ==============================
[0m12:02:24.554755 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:02:24.554755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:02:25.012732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96861dd3-f37b-4863-ae1d-f04afe649a2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC4ACAC60>]}
[0m12:02:25.062499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96861dd3-f37b-4863-ae1d-f04afe649a2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC6EF0980>]}
[0m12:02:25.076514 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:02:25.433556 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:02:25.629251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:02:25.629251 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m12:02:25.879377 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:02:25.902327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96861dd3-f37b-4863-ae1d-f04afe649a2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC990B410>]}
[0m12:02:25.983103 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:02:25.986956 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:02:26.012466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96861dd3-f37b-4863-ae1d-f04afe649a2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC99E0800>]}
[0m12:02:26.012466 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m12:02:26.012466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96861dd3-f37b-4863-ae1d-f04afe649a2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC8139940>]}
[0m12:02:26.012466 [info ] [MainThread]: 
[0m12:02:26.012466 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:02:26.012466 [info ] [MainThread]: 
[0m12:02:26.012466 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:02:26.012466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:02:26.113070 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:02:26.113070 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:02:26.113070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:28.155223 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.040 seconds
[0m12:02:28.155223 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m12:02:28.171060 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:02:28.171060 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:02:28.171060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:29.784762 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.609 seconds
[0m12:02:29.784762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m12:02:29.789331 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:02:29.789331 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:02:30.176619 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.379 seconds
[0m12:02:30.176619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m12:02:30.224651 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:02:30.224651 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:02:30.549437 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.334 seconds
[0m12:02:30.565483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96861dd3-f37b-4863-ae1d-f04afe649a2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC99F05C0>]}
[0m12:02:30.565483 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m12:02:30.565483 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m12:02:30.565483 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m12:02:30.565483 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m12:02:30.587738 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m12:02:30.588491 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m12:02:30.617975 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m12:02:30.617975 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m12:02:30.617975 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY customer_id 
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers;
[0m12:02:30.617975 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:02:32.133041 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff28-0004-c0bd-0005-a3d30003b4ca
[0m12:02:32.133041 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 31 unexpected ';'.
[0m12:02:32.133041 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 31 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m12:02:32.133041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96861dd3-f37b-4863-ae1d-f04afe649a2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC6BE0920>]}
[0m12:02:32.133041 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.churned_new_customers ............... [[31mERROR[0m in 1.57s]
[0m12:02:32.148719 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m12:02:32.148719 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 31 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql.
[0m12:02:32.148719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:32.148719 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:02:32.148719 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:02:32.703317 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m12:02:32.703317 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m12:02:33.228681 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m12:02:33.228681 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m12:02:33.743479 [info ] [MainThread]: 
[0m12:02:33.743479 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.73 seconds (7.73s).
[0m12:02:33.743479 [debug] [MainThread]: Command end result
[0m12:02:33.774797 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:02:33.776231 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:02:33.780561 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:02:33.780561 [info ] [MainThread]: 
[0m12:02:33.780561 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:02:33.785930 [info ] [MainThread]: 
[0m12:02:33.786940 [error] [MainThread]:   Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 31 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m12:02:33.787948 [info ] [MainThread]: 
[0m12:02:33.787948 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:02:33.788979 [debug] [MainThread]: Command `dbt run` failed at 12:02:33.788979 after 9.46 seconds
[0m12:02:33.789949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC76D7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC80D3EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFC54CA4E0>]}
[0m12:02:33.789949 [debug] [MainThread]: Flushing usage events
[0m12:02:35.044864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:42.546142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024450367DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244500B2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024450364830>]}


============================== 12:02:42.546142 | 8e67aa96-b6ff-40e5-b779-01aadc7260c8 ==============================
[0m12:02:42.546142 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:02:42.546142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m12:02:43.004445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e67aa96-b6ff-40e5-b779-01aadc7260c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002445053C350>]}
[0m12:02:43.061841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e67aa96-b6ff-40e5-b779-01aadc7260c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024450317DA0>]}
[0m12:02:43.061841 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:02:43.406608 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:02:43.594685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:02:43.594685 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m12:02:43.828197 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:02:43.849830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e67aa96-b6ff-40e5-b779-01aadc7260c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024452650890>]}
[0m12:02:43.922645 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:02:43.930189 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:02:43.961959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e67aa96-b6ff-40e5-b779-01aadc7260c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244526047D0>]}
[0m12:02:43.961959 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m12:02:43.962960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e67aa96-b6ff-40e5-b779-01aadc7260c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244523E7110>]}
[0m12:02:43.964891 [info ] [MainThread]: 
[0m12:02:43.965864 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:02:43.965864 [info ] [MainThread]: 
[0m12:02:43.966862 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:02:43.967863 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:02:44.065048 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:02:44.066052 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:02:44.066052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:46.069053 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.002 seconds
[0m12:02:46.069053 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m12:02:46.081382 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:02:46.081382 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:02:46.081382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:47.581411 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.510 seconds
[0m12:02:47.597175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m12:02:47.597175 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:02:47.597175 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:02:47.967918 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.373 seconds
[0m12:02:47.967918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m12:02:48.023832 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:02:48.024832 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:02:48.374788 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.352 seconds
[0m12:02:48.374788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e67aa96-b6ff-40e5-b779-01aadc7260c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024452B5CA40>]}
[0m12:02:48.374788 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m12:02:48.374788 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m12:02:48.374788 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m12:02:48.374788 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m12:02:48.390768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m12:02:48.390768 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m12:02:48.420140 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m12:02:48.420140 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m12:02:48.420140 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY customer_id 
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
-- last_purchase AS (
--     SELECT
--         customer_id,
--         MAX(payment_date) AS last_purchase_date
--     FROM HEALTHCARE.stage.stg_transactions
--     GROUP BY customer_id
-- )


-- churned_customers AS (
--     SELECT
--         customer_id,
--         last_purchase_date
--     FROM last_purchase
--     WHERE last_purchase_date < DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who haven’t purchased in the last 6 months
-- ),

-- new_customers AS (
--     SELECT
--         customer_id,
--         first_purchase_date
--     FROM first_purchase
--     WHERE first_purchase_date >= DATEADD(MONTH, -6, CURRENT_DATE) -- Customers who first purchased in the last 6 months
-- )
        );
[0m12:02:48.420140 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:02:50.720088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.293 seconds
[0m12:02:50.736061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e67aa96-b6ff-40e5-b779-01aadc7260c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002444D71D760>]}
[0m12:02:50.736061 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 2.36s]
[0m12:02:50.736061 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m12:02:50.736061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:50.751753 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:02:50.751753 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:02:51.285253 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m12:02:51.285253 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m12:02:51.805533 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m12:02:51.805533 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m12:02:52.357061 [info ] [MainThread]: 
[0m12:02:52.357061 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.39 seconds (8.39s).
[0m12:02:52.357061 [debug] [MainThread]: Command end result
[0m12:02:52.412674 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:02:52.412674 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:02:52.424141 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:02:52.424141 [info ] [MainThread]: 
[0m12:02:52.424141 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:02:52.424141 [info ] [MainThread]: 
[0m12:02:52.424141 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:02:52.424141 [debug] [MainThread]: Command `dbt run` succeeded at 12:02:52.424141 after 10.04 seconds
[0m12:02:52.424141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244503808C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244500B2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024451053EF0>]}
[0m12:02:52.424141 [debug] [MainThread]: Flushing usage events
[0m12:02:53.408380 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:50.295088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1776040E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E177604590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E177605940>]}


============================== 12:08:50.295088 | 488d93e1-b560-45c2-bf61-6cbb67e8aaeb ==============================
[0m12:08:50.295088 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:08:50.295088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:08:50.767099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '488d93e1-b560-45c2-bf61-6cbb67e8aaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1775DEF00>]}
[0m12:08:50.830596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '488d93e1-b560-45c2-bf61-6cbb67e8aaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E176A75CA0>]}
[0m12:08:50.830596 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:08:51.171506 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:08:51.362237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:08:51.362237 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m12:08:51.611368 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:08:51.611368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '488d93e1-b560-45c2-bf61-6cbb67e8aaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1798F09B0>]}
[0m12:08:51.696936 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:08:51.696936 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:08:51.728510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '488d93e1-b560-45c2-bf61-6cbb67e8aaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1799288C0>]}
[0m12:08:51.728510 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m12:08:51.728510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '488d93e1-b560-45c2-bf61-6cbb67e8aaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1795883E0>]}
[0m12:08:51.728510 [info ] [MainThread]: 
[0m12:08:51.728510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:08:51.728510 [info ] [MainThread]: 
[0m12:08:51.728510 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:08:51.728510 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:08:51.837150 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:08:51.838116 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:08:51.838116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:53.833539 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.997 seconds
[0m12:08:53.835548 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m12:08:53.849487 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:08:53.849487 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:08:53.849487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:55.363456 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.513 seconds
[0m12:08:55.363456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m12:08:55.370133 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:08:55.370133 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:08:55.753476 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.387 seconds
[0m12:08:55.753476 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m12:08:55.809925 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:08:55.810926 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:08:56.156652 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.358 seconds
[0m12:08:56.172831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '488d93e1-b560-45c2-bf61-6cbb67e8aaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E179C1F7A0>]}
[0m12:08:56.188619 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m12:08:56.188619 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m12:08:56.188619 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m12:08:56.204415 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m12:08:56.223321 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m12:08:56.226583 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m12:08:56.259107 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m12:08:56.261106 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m12:08:56.261106 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        c.customer_id,
        t.customer_name,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    LEFT JOIN HEALTHCARE.stage.stg_customers AS c 
    ON c.customer_id = t.customer_id
    GROUP BY customer_id 
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:08:56.262104 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:08:57.807165 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff2e-0004-bb9f-0005-a3d30003c112
[0m12:08:57.807165 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 8
invalid identifier 'T.CUSTOMER_NAME'
[0m12:08:57.823194 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'T.CUSTOMER_NAME'
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m12:08:57.823194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '488d93e1-b560-45c2-bf61-6cbb67e8aaeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1796A7E00>]}
[0m12:08:57.823194 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.churned_new_customers ............... [[31mERROR[0m in 1.63s]
[0m12:08:57.823194 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m12:08:57.823194 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'T.CUSTOMER_NAME'
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql.
[0m12:08:57.823194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:57.823194 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:08:57.823194 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:08:58.365017 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m12:08:58.365017 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m12:08:58.875655 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m12:08:58.875655 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m12:08:59.416429 [info ] [MainThread]: 
[0m12:08:59.416429 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.68 seconds (7.68s).
[0m12:08:59.416429 [debug] [MainThread]: Command end result
[0m12:08:59.445248 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:08:59.445248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:08:59.455387 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:08:59.456399 [info ] [MainThread]: 
[0m12:08:59.456720 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:08:59.456720 [info ] [MainThread]: 
[0m12:08:59.456720 [error] [MainThread]:   Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 8 at position 8
  invalid identifier 'T.CUSTOMER_NAME'
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m12:08:59.456720 [info ] [MainThread]: 
[0m12:08:59.456720 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:08:59.456720 [debug] [MainThread]: Command `dbt run` failed at 12:08:59.456720 after 9.34 seconds
[0m12:08:59.456720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1747B9C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E17990F1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E177621AF0>]}
[0m12:08:59.456720 [debug] [MainThread]: Flushing usage events
[0m12:09:00.575910 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:22.502250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F6471F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F8CB7EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F8CB5970>]}


============================== 12:10:22.502250 | 7688c897-d20a-4f4c-89a4-39764ed7a287 ==============================
[0m12:10:22.502250 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:10:22.502250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:10:22.971729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7688c897-d20a-4f4c-89a4-39764ed7a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FAFBBFB0>]}
[0m12:10:23.054614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7688c897-d20a-4f4c-89a4-39764ed7a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F656AF00>]}
[0m12:10:23.054614 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:10:23.655610 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:10:23.855078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:10:23.855579 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m12:10:24.127830 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:10:24.143548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7688c897-d20a-4f4c-89a4-39764ed7a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FAFBBD70>]}
[0m12:10:24.232734 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:10:24.241826 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:10:24.278079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7688c897-d20a-4f4c-89a4-39764ed7a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FB4908F0>]}
[0m12:10:24.278079 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m12:10:24.278079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7688c897-d20a-4f4c-89a4-39764ed7a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FB3C6BA0>]}
[0m12:10:24.280089 [info ] [MainThread]: 
[0m12:10:24.280089 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:10:24.282100 [info ] [MainThread]: 
[0m12:10:24.282100 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:10:24.282100 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:10:24.391875 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:10:24.391875 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:10:24.391875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:26.556883 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.168 seconds
[0m12:10:26.556883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m12:10:26.572791 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:10:26.572791 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:10:26.572791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:28.116673 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.537 seconds
[0m12:10:28.120702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m12:10:28.128750 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:10:28.128750 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:10:28.527139 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.396 seconds
[0m12:10:28.529137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m12:10:28.582950 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:10:28.582950 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:10:28.987813 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.404 seconds
[0m12:10:28.998005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7688c897-d20a-4f4c-89a4-39764ed7a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FB9BAF00>]}
[0m12:10:29.014152 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m12:10:29.016149 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m12:10:29.017585 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m12:10:29.018682 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m12:10:29.033334 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m12:10:29.034401 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m12:10:29.068297 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m12:10:29.070294 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m12:10:29.071295 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        c.customer_id,
        c.customer_name,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    LEFT JOIN HEALTHCARE.stage.stg_customers AS c 
    ON c.customer_id = t.customer_id
    GROUP BY customer_id 
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:10:29.071295 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:10:30.631563 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff30-0004-bb9f-0005-a3d30003c11e
[0m12:10:30.631563 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'CUSTOMER_ID'
[0m12:10:30.631563 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_ID'
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m12:10:30.631563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7688c897-d20a-4f4c-89a4-39764ed7a287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FB9443B0>]}
[0m12:10:30.631563 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.churned_new_customers ............... [[31mERROR[0m in 1.61s]
[0m12:10:30.631563 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m12:10:30.631563 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_ID'
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql.
[0m12:10:30.631563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:30.631563 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:10:30.631563 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:10:31.150624 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m12:10:31.164334 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m12:10:31.681378 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m12:10:31.697042 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m12:10:32.230916 [info ] [MainThread]: 
[0m12:10:32.230916 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.95 seconds (7.95s).
[0m12:10:32.230916 [debug] [MainThread]: Command end result
[0m12:10:32.246595 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:10:32.246595 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:10:32.267037 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:10:32.267037 [info ] [MainThread]: 
[0m12:10:32.267037 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:10:32.267037 [info ] [MainThread]: 
[0m12:10:32.267037 [error] [MainThread]:   Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'CUSTOMER_ID'
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m12:10:32.267037 [info ] [MainThread]: 
[0m12:10:32.267037 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:10:32.267037 [debug] [MainThread]: Command `dbt run` failed at 12:10:32.267037 after 9.93 seconds
[0m12:10:32.267037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FB86A960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F85E4FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F85E7440>]}
[0m12:10:32.267037 [debug] [MainThread]: Flushing usage events
[0m12:10:33.598079 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:03.877539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEBF46570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEDD09BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BED239400>]}


============================== 12:11:03.877539 | 425743eb-0856-45c0-984e-893b45c91ee9 ==============================
[0m12:11:03.877539 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:11:03.877539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:11:04.347133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '425743eb-0856-45c0-984e-893b45c91ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEFF770B0>]}
[0m12:11:04.413311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '425743eb-0856-45c0-984e-893b45c91ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEB4B83B0>]}
[0m12:11:04.413311 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:11:04.768861 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:11:04.945791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:11:04.945791 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m12:11:05.196782 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:11:05.214017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '425743eb-0856-45c0-984e-893b45c91ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF04E0BC0>]}
[0m12:11:05.299720 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:11:05.299720 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:11:05.336373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '425743eb-0856-45c0-984e-893b45c91ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF0490C50>]}
[0m12:11:05.337393 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m12:11:05.338373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '425743eb-0856-45c0-984e-893b45c91ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF04E16D0>]}
[0m12:11:05.339405 [info ] [MainThread]: 
[0m12:11:05.340373 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:11:05.340373 [info ] [MainThread]: 
[0m12:11:05.341375 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:11:05.342402 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:11:05.436839 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:11:05.437839 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:11:05.437839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:07.296509 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.861 seconds
[0m12:11:07.296509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m12:11:07.312457 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:11:07.312457 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:11:07.312457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:08.777898 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.463 seconds
[0m12:11:08.780893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m12:11:08.784487 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:11:08.784487 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:11:09.139065 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.359 seconds
[0m12:11:09.146081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m12:11:09.186972 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:11:09.186972 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:11:09.528367 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.340 seconds
[0m12:11:09.540441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '425743eb-0856-45c0-984e-893b45c91ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BF03DE780>]}
[0m12:11:09.544150 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m12:11:09.544150 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m12:11:09.544150 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m12:11:09.544150 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m12:11:09.544150 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m12:11:09.544150 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m12:11:09.584523 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m12:11:09.584523 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m12:11:09.584523 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        c.customer_id,
        c.customer_name,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    LEFT JOIN HEALTHCARE.stage.stg_customers AS c 
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id 
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:11:09.584523 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:11:11.163136 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff31-0004-bde4-0005-a3d300034fca
[0m12:11:11.163136 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 7 at position 8
'C.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
[0m12:11:11.163136 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001104 (42601): SQL compilation error: error line 7 at position 8
  'C.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m12:11:11.163136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '425743eb-0856-45c0-984e-893b45c91ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BED6504A0>]}
[0m12:11:11.163136 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.churned_new_customers ............... [[31mERROR[0m in 1.62s]
[0m12:11:11.163136 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m12:11:11.163136 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001104 (42601): SQL compilation error: error line 7 at position 8
  'C.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql.
[0m12:11:11.163136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:11.163136 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:11:11.163136 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:11:11.699994 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m12:11:11.700298 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m12:11:12.204021 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m12:11:12.204021 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m12:11:12.754529 [info ] [MainThread]: 
[0m12:11:12.754529 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.41 seconds (7.41s).
[0m12:11:12.754529 [debug] [MainThread]: Command end result
[0m12:11:12.788560 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:11:12.791285 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:11:12.793457 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:11:12.793457 [info ] [MainThread]: 
[0m12:11:12.793457 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:11:12.793457 [info ] [MainThread]: 
[0m12:11:12.793457 [error] [MainThread]:   Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001104 (42601): SQL compilation error: error line 7 at position 8
  'C.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m12:11:12.793457 [info ] [MainThread]: 
[0m12:11:12.793457 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:11:12.793457 [debug] [MainThread]: Command `dbt run` failed at 12:11:12.793457 after 9.08 seconds
[0m12:11:12.793457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BEDC6A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BED6050A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024BED607E00>]}
[0m12:11:12.803802 [debug] [MainThread]: Flushing usage events
[0m12:11:13.722049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:10.311828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BFC525100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BFA2C63C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF9D04500>]}


============================== 12:12:10.311828 | b30bf276-a63b-434e-99f0-ef94e3204f0c ==============================
[0m12:12:10.311828 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:12:10.311828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:12:10.769845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b30bf276-a63b-434e-99f0-ef94e3204f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BFE2BAD50>]}
[0m12:12:10.837116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b30bf276-a63b-434e-99f0-ef94e3204f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BFC7D92B0>]}
[0m12:12:10.837116 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:12:11.176699 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:12:11.370970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:12:11.370970 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m12:12:11.613364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:12:11.629998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b30bf276-a63b-434e-99f0-ef94e3204f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BFE800A10>]}
[0m12:12:11.716901 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:12:11.716901 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:12:11.753260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b30bf276-a63b-434e-99f0-ef94e3204f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BFE7A8890>]}
[0m12:12:11.753260 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m12:12:11.754261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b30bf276-a63b-434e-99f0-ef94e3204f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BFE8005C0>]}
[0m12:12:11.755291 [info ] [MainThread]: 
[0m12:12:11.756315 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:12:11.756315 [info ] [MainThread]: 
[0m12:12:11.757353 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:12:11.758355 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:12:11.852752 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:12:11.853756 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:12:11.853756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:13.745319 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.892 seconds
[0m12:12:13.752110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m12:12:13.752110 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:12:13.752110 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:12:13.752110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:15.254951 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.494 seconds
[0m12:12:15.257694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m12:12:15.257694 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:12:15.270974 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:12:15.593012 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.330 seconds
[0m12:12:15.593012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m12:12:15.640562 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:12:15.640562 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:12:15.999999 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.362 seconds
[0m12:12:16.016109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b30bf276-a63b-434e-99f0-ef94e3204f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BFED0F1A0>]}
[0m12:12:16.016109 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m12:12:16.016109 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m12:12:16.016109 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m12:12:16.016109 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m12:12:16.032137 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m12:12:16.032137 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m12:12:16.060180 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m12:12:16.060180 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m12:12:16.060180 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    LEFT JOIN HEALTHCARE.stage.stg_customers AS c 
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id 
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:12:16.066865 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:12:17.614335 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff32-0004-c0bd-0005-a3d30003b502
[0m12:12:17.614335 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 8
invalid identifier 'FLP.CUSTOMER_NAME'
[0m12:12:17.614335 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'FLP.CUSTOMER_NAME'
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m12:12:17.614335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b30bf276-a63b-434e-99f0-ef94e3204f0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BFE686BA0>]}
[0m12:12:17.614335 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.churned_new_customers ............... [[31mERROR[0m in 1.60s]
[0m12:12:17.614335 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m12:12:17.614335 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'FLP.CUSTOMER_NAME'
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql.
[0m12:12:17.614335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:17.614335 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:12:17.614335 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:12:18.169792 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m12:12:18.169792 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m12:12:18.671630 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m12:12:18.671630 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m12:12:19.221444 [info ] [MainThread]: 
[0m12:12:19.221444 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.46 seconds (7.46s).
[0m12:12:19.221444 [debug] [MainThread]: Command end result
[0m12:12:19.272931 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:12:19.272931 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:12:19.272931 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:12:19.272931 [info ] [MainThread]: 
[0m12:12:19.286676 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:12:19.287186 [info ] [MainThread]: 
[0m12:12:19.287186 [error] [MainThread]:   Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'FLP.CUSTOMER_NAME'
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m12:12:19.287186 [info ] [MainThread]: 
[0m12:12:19.287186 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:12:19.287186 [debug] [MainThread]: Command `dbt run` failed at 12:12:19.287186 after 9.15 seconds
[0m12:12:19.287186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BFA2C63C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BFB8FF980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016BF9C2F800>]}
[0m12:12:19.287186 [debug] [MainThread]: Flushing usage events
[0m12:12:20.352126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:01.207532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F45E4DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F45E5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F45E4EF0>]}


============================== 12:14:01.207532 | 6b25450f-eb19-4ea7-82e5-0aa698047d48 ==============================
[0m12:14:01.207532 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:14:01.207532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:14:01.732775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b25450f-eb19-4ea7-82e5-0aa698047d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F4333D70>]}
[0m12:14:01.789500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b25450f-eb19-4ea7-82e5-0aa698047d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F39FB860>]}
[0m12:14:01.789500 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:14:02.257163 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:14:03.632485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:14:03.632485 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m12:14:03.877127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:14:03.892416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b25450f-eb19-4ea7-82e5-0aa698047d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F69905C0>]}
[0m12:14:03.959985 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:14:03.976182 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:14:04.016443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b25450f-eb19-4ea7-82e5-0aa698047d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F69306E0>]}
[0m12:14:04.017444 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m12:14:04.017444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b25450f-eb19-4ea7-82e5-0aa698047d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F67269C0>]}
[0m12:14:04.019475 [info ] [MainThread]: 
[0m12:14:04.020444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:14:04.020444 [info ] [MainThread]: 
[0m12:14:04.021443 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:14:04.022478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:14:06.730894 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:14:06.730894 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:14:06.730894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:08.787716 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.062 seconds
[0m12:14:08.787716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m12:14:08.803492 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:14:08.803492 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:14:08.803492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:10.327105 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.528 seconds
[0m12:14:10.342864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m12:14:10.342864 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:14:10.342864 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:14:10.667445 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.334 seconds
[0m12:14:10.683135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m12:14:10.731130 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:14:10.731130 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:14:11.086631 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.354 seconds
[0m12:14:11.086631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b25450f-eb19-4ea7-82e5-0aa698047d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F6DDF230>]}
[0m12:14:11.086631 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m12:14:11.086631 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m12:14:11.086631 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m12:14:11.086631 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m12:14:11.102414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m12:14:11.104472 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m12:14:11.132056 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m12:14:11.132056 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m12:14:11.132056 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    LEFT JOIN HEALTHCARE.stage.stg_customers AS c 
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:14:11.132056 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:14:13.726319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.587 seconds
[0m12:14:13.740799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b25450f-eb19-4ea7-82e5-0aa698047d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F19ED880>]}
[0m12:14:13.740799 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 2.65s]
[0m12:14:13.740799 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m12:14:13.740799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:13.740799 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:14:13.740799 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:14:14.272762 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m12:14:14.272762 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m12:14:14.802557 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m12:14:14.802557 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m12:14:15.344937 [info ] [MainThread]: 
[0m12:14:15.344937 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.32 seconds (11.32s).
[0m12:14:15.344937 [debug] [MainThread]: Command end result
[0m12:14:15.371031 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:14:15.374320 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:14:15.379507 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:14:15.379507 [info ] [MainThread]: 
[0m12:14:15.379507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:15.379507 [info ] [MainThread]: 
[0m12:14:15.379507 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:14:15.379507 [debug] [MainThread]: Command `dbt run` succeeded at 12:14:15.379507 after 14.36 seconds
[0m12:14:15.379507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F3A84440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F3B84CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223F41229C0>]}
[0m12:14:15.385672 [debug] [MainThread]: Flushing usage events
[0m12:14:16.370686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:46.400418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E63FD20F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E645624B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E64562360>]}


============================== 12:14:46.416482 | d4ff2535-aee4-47ad-8573-dceaca691534 ==============================
[0m12:14:46.416482 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:14:46.416482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:14:46.870407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4ff2535-aee4-47ad-8573-dceaca691534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E646B2990>]}
[0m12:14:46.933920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4ff2535-aee4-47ad-8573-dceaca691534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E61A4EA80>]}
[0m12:14:46.933920 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:14:47.297270 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:14:47.486316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:14:47.486316 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m12:14:47.751706 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:14:47.768745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4ff2535-aee4-47ad-8573-dceaca691534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E66990890>]}
[0m12:14:47.839124 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:14:47.851363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:14:47.879310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4ff2535-aee4-47ad-8573-dceaca691534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E66934950>]}
[0m12:14:47.879310 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m12:14:47.880313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4ff2535-aee4-47ad-8573-dceaca691534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E6695F830>]}
[0m12:14:47.881349 [info ] [MainThread]: 
[0m12:14:47.882577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:14:47.882577 [info ] [MainThread]: 
[0m12:14:47.883605 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:14:47.884618 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:14:47.981722 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:14:47.982726 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:14:47.982726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:49.935196 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.954 seconds
[0m12:14:49.937206 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m12:14:49.948898 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:14:49.948898 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:14:49.948898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:51.501945 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.562 seconds
[0m12:14:51.517589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m12:14:51.517589 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:14:51.517589 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:14:51.832251 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.311 seconds
[0m12:14:51.832251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m12:14:51.871998 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:14:51.871998 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:14:52.214925 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.333 seconds
[0m12:14:52.214925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4ff2535-aee4-47ad-8573-dceaca691534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E66723140>]}
[0m12:14:52.230654 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m12:14:52.230654 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m12:14:52.230654 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m12:14:52.230654 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m12:14:52.230654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m12:14:52.230654 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m12:14:52.273069 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m12:14:52.273069 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m12:14:52.273069 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    LEFT JOIN HEALTHCARE.stage.stg_customers AS c 
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:14:52.273069 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:14:54.623805 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.347 seconds
[0m12:14:54.639867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4ff2535-aee4-47ad-8573-dceaca691534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E66CFA2D0>]}
[0m12:14:54.639867 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 2.41s]
[0m12:14:54.639867 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m12:14:54.639867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:54.639867 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:14:54.639867 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:14:55.173709 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m12:14:55.174706 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m12:14:55.677570 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m12:14:55.677570 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m12:14:56.246134 [info ] [MainThread]: 
[0m12:14:56.248149 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.36 seconds (8.36s).
[0m12:14:56.248149 [debug] [MainThread]: Command end result
[0m12:14:56.266258 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:14:56.278453 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:14:56.285275 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:14:56.285275 [info ] [MainThread]: 
[0m12:14:56.286243 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:56.287278 [info ] [MainThread]: 
[0m12:14:56.287278 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:14:56.287278 [debug] [MainThread]: Command `dbt run` succeeded at 12:14:56.287278 after 10.04 seconds
[0m12:14:56.287278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E61E3DF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E60CB92B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E63AFDD00>]}
[0m12:14:56.287278 [debug] [MainThread]: Flushing usage events
[0m12:14:57.271583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:24.271922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD96D54C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD96D4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD96D4230>]}


============================== 12:35:24.271922 | bbae428d-ced4-4a85-9e72-8401420f5505 ==============================
[0m12:35:24.271922 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:35:24.271922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:35:25.006245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbae428d-ced4-4a85-9e72-8401420f5505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD6A8AED0>]}
[0m12:35:25.070327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbae428d-ced4-4a85-9e72-8401420f5505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD5DE4590>]}
[0m12:35:25.070327 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:35:25.538653 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:35:26.916953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:35:26.916953 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_customers.sql
[0m12:35:27.184455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:35:27.184957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbae428d-ced4-4a85-9e72-8401420f5505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ADB8D4AA0>]}
[0m12:35:27.271454 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:35:27.292560 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:35:27.350497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbae428d-ced4-4a85-9e72-8401420f5505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ADB994E00>]}
[0m12:35:27.350497 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m12:35:27.350497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbae428d-ced4-4a85-9e72-8401420f5505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025ADB9279E0>]}
[0m12:35:27.350497 [info ] [MainThread]: 
[0m12:35:27.350497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:27.350497 [info ] [MainThread]: 
[0m12:35:27.350497 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:35:27.358711 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:35:30.041563 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:35:30.041563 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:35:30.041563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:32.194653 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.154 seconds
[0m12:35:32.201469 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m12:35:32.209452 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:35:32.209452 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:35:32.209452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:33.869473 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.657 seconds
[0m12:35:33.869473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m12:35:33.923279 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:35:33.923279 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:35:34.256161 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.330 seconds
[0m12:35:34.264394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m12:35:34.272140 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:35:34.272140 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:35:34.619148 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.341 seconds
[0m12:35:34.621939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbae428d-ced4-4a85-9e72-8401420f5505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD6B1FAA0>]}
[0m12:35:34.629237 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m12:35:34.629237 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_customers ............................... [RUN]
[0m12:35:34.629237 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m12:35:34.629237 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m12:35:34.643392 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m12:35:34.643392 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m12:35:34.679372 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_customers"
[0m12:35:34.681425 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_customers"
[0m12:35:34.681425 [debug] [Thread-1 (]: On model.dbt_first.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_customers"} */
create or replace transient table HEALTHCARE.stage.stg_customers
         as
        (

WITH cte_handle_null AS (
    SELECT 
        customer_id,
        TRIM(customer_name) AS customer_name,
        TRIM(company) AS company
    FROM HEALTHCARE.RAW.CUSTOMERS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    
  
),

cte_final AS (
    SELECT 
    DISTINCT
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(customer_name AS VARCHAR(300)) AS customer_name,
    
        CAST(company AS VARCHAR(100)) AS company,
    

    FROM cte_handle_null
)

SELECT * FROM cte_final
        );
[0m12:35:34.683431 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:35:37.659156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.981 seconds
[0m12:35:37.689259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbae428d-ced4-4a85-9e72-8401420f5505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD8B90A70>]}
[0m12:35:37.689259 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.stg_customers .......................... [[32mSUCCESS 1[0m in 3.06s]
[0m12:35:37.689259 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m12:35:37.689259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:37.689259 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:35:37.689259 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:35:38.210913 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m12:35:38.212577 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m12:35:38.757032 [debug] [MainThread]: Connection 'model.dbt_first.stg_customers' was left open.
[0m12:35:38.758072 [debug] [MainThread]: On model.dbt_first.stg_customers: Close
[0m12:35:39.332318 [info ] [MainThread]: 
[0m12:35:39.332318 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.98 seconds (11.98s).
[0m12:35:39.332318 [debug] [MainThread]: Command end result
[0m12:35:39.411402 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:35:39.417397 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:35:39.425734 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:35:39.426733 [info ] [MainThread]: 
[0m12:35:39.427735 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:39.439018 [info ] [MainThread]: 
[0m12:35:39.440026 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:35:39.441025 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:39.441025 after 15.42 seconds
[0m12:35:39.441025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD8F2CCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD74865D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025AD74866F0>]}
[0m12:35:39.441025 [debug] [MainThread]: Flushing usage events
[0m12:35:40.539297 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:34.482173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76F258470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76F259130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76F25B230>]}


============================== 12:36:34.489232 | 93feb609-8341-455b-b61e-ac6d4877d273 ==============================
[0m12:36:34.489232 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:36:34.489232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:36:34.951312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93feb609-8341-455b-b61e-ac6d4877d273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76FF86750>]}
[0m12:36:35.018125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93feb609-8341-455b-b61e-ac6d4877d273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76ED6E630>]}
[0m12:36:35.018125 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:36:35.507587 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:36:35.702100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:36:35.702100 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_customers.sql
[0m12:36:35.991784 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:36:36.009241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93feb609-8341-455b-b61e-ac6d4877d273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F77143E2A0>]}
[0m12:36:36.087348 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:36:36.091901 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:36:36.118793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93feb609-8341-455b-b61e-ac6d4877d273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F771508EC0>]}
[0m12:36:36.118793 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m12:36:36.118793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93feb609-8341-455b-b61e-ac6d4877d273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7713F8B90>]}
[0m12:36:36.118793 [info ] [MainThread]: 
[0m12:36:36.118793 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:36:36.118793 [info ] [MainThread]: 
[0m12:36:36.118793 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:36:36.118793 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:36:36.222157 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:36:36.222157 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:36:36.223158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:38.152448 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.930 seconds
[0m12:36:38.154456 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m12:36:38.166338 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:36:38.166338 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:36:38.166338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:39.640738 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.469 seconds
[0m12:36:39.643759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m12:36:39.691545 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:36:39.692509 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:36:40.010646 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.317 seconds
[0m12:36:40.012607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m12:36:40.014610 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:36:40.015606 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:36:40.331099 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.315 seconds
[0m12:36:40.333100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93feb609-8341-455b-b61e-ac6d4877d273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76C693770>]}
[0m12:36:40.337068 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m12:36:40.338067 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_customers ............................... [RUN]
[0m12:36:40.339067 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m12:36:40.339067 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m12:36:40.348070 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m12:36:40.349101 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m12:36:40.382604 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_customers"
[0m12:36:40.383601 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_customers"
[0m12:36:40.384604 [debug] [Thread-1 (]: On model.dbt_first.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_customers"} */
create or replace transient table HEALTHCARE.stage.stg_customers
         as
        (

WITH cte_handle_null AS (
    SELECT 
        customer_id,
        TRIM(customer_name) AS customer_name,
        TRIM(company) AS company
    FROM HEALTHCARE.RAW.CUSTOMERS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    
  
),

cte_final AS (
    SELECT 

        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(customer_name AS VARCHAR(300)) AS customer_name,
    
        CAST(company AS VARCHAR(100)) AS company,
    

    FROM cte_handle_null
)

SELECT * FROM cte_final
        );
[0m12:36:40.384604 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:36:42.828948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.444 seconds
[0m12:36:42.862856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93feb609-8341-455b-b61e-ac6d4877d273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76C5FD880>]}
[0m12:36:42.862856 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.stg_customers .......................... [[32mSUCCESS 1[0m in 2.52s]
[0m12:36:42.864037 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m12:36:42.866077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:42.866077 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:36:42.866077 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:36:43.421764 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m12:36:43.421764 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m12:36:43.938273 [debug] [MainThread]: Connection 'model.dbt_first.stg_customers' was left open.
[0m12:36:43.939243 [debug] [MainThread]: On model.dbt_first.stg_customers: Close
[0m12:36:44.479110 [info ] [MainThread]: 
[0m12:36:44.480455 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.36 seconds (8.36s).
[0m12:36:44.481465 [debug] [MainThread]: Command end result
[0m12:36:44.510736 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:36:44.514243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:36:44.521255 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:36:44.521255 [info ] [MainThread]: 
[0m12:36:44.522242 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:44.522242 [info ] [MainThread]: 
[0m12:36:44.523509 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:36:44.524516 [debug] [MainThread]: Command `dbt run` succeeded at 12:36:44.524516 after 10.26 seconds
[0m12:36:44.524516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76E76B380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7712B4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F76E7F4EC0>]}
[0m12:36:44.525548 [debug] [MainThread]: Flushing usage events
[0m12:36:45.510774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:04.297123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F14E4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F14E7E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F14E54F0>]}


============================== 12:37:04.299224 | a1ce6e9e-01fc-4d30-a7cd-4bc42b801c17 ==============================
[0m12:37:04.299224 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:37:04.299224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:customers', 'send_anonymous_usage_stats': 'True'}
[0m12:37:04.764457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1ce6e9e-01fc-4d30-a7cd-4bc42b801c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F14E4320>]}
[0m12:37:04.821282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1ce6e9e-01fc-4d30-a7cd-4bc42b801c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F1027AA0>]}
[0m12:37:04.821282 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:37:05.199399 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:37:05.381684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:37:05.381684 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:05.381684 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:37:05.433270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1ce6e9e-01fc-4d30-a7cd-4bc42b801c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F34941D0>]}
[0m12:37:05.513263 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:37:05.513263 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:37:05.528912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1ce6e9e-01fc-4d30-a7cd-4bc42b801c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F36AA360>]}
[0m12:37:05.528912 [info ] [MainThread]: Found 7 models, 1 seed, 4 sources, 477 macros
[0m12:37:05.544656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1ce6e9e-01fc-4d30-a7cd-4bc42b801c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F36A1AC0>]}
[0m12:37:05.544656 [info ] [MainThread]: 
[0m12:37:05.544656 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:05.544656 [info ] [MainThread]: 
[0m12:37:05.544656 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:37:05.544656 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:37:05.647810 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:37:05.648810 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:37:05.648810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:07.523504 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.874 seconds
[0m12:37:07.533841 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m12:37:07.549330 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:37:07.549330 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:37:07.549330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:09.133583 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.586 seconds
[0m12:37:09.133583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m12:37:09.133583 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:37:09.133583 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:37:09.485540 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.346 seconds
[0m12:37:09.485540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m12:37:09.485540 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:37:09.485540 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:37:09.806056 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.314 seconds
[0m12:37:09.806056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1ce6e9e-01fc-4d30-a7cd-4bc42b801c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F3A20EC0>]}
[0m12:37:09.813660 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m12:37:09.813660 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_customers ............................... [RUN]
[0m12:37:09.813660 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m12:37:09.813660 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m12:37:09.813660 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m12:37:09.813660 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m12:37:09.852514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_customers"
[0m12:37:09.852514 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_customers"
[0m12:37:09.852514 [debug] [Thread-1 (]: On model.dbt_first.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_customers"} */
create or replace transient table HEALTHCARE.stage.stg_customers
         as
        (

WITH cte_handle_null AS (
    SELECT 
        customer_id,
        TRIM(customer_name) AS customer_name,
        TRIM(company) AS company
    FROM HEALTHCARE.RAW.CUSTOMERS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    
  
),

cte_final AS (
    SELECT 

        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(customer_name AS VARCHAR(300)) AS customer_name,
    
        CAST(company AS VARCHAR(100)) AS company,
    

    FROM cte_handle_null
)

SELECT * FROM cte_final
        );
[0m12:37:09.852514 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:37:12.013035 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.161 seconds
[0m12:37:12.044949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1ce6e9e-01fc-4d30-a7cd-4bc42b801c17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EE89D8E0>]}
[0m12:37:12.044949 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.stg_customers .......................... [[32mSUCCESS 1[0m in 2.23s]
[0m12:37:12.044949 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m12:37:12.044949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:12.044949 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:37:12.044949 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:37:12.594187 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m12:37:12.606460 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m12:37:13.142265 [debug] [MainThread]: Connection 'model.dbt_first.stg_customers' was left open.
[0m12:37:13.142265 [debug] [MainThread]: On model.dbt_first.stg_customers: Close
[0m12:37:13.658527 [info ] [MainThread]: 
[0m12:37:13.658527 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.11 seconds (8.11s).
[0m12:37:13.658527 [debug] [MainThread]: Command end result
[0m12:37:13.691646 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:37:13.691646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:37:13.691646 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:37:13.691646 [info ] [MainThread]: 
[0m12:37:13.691646 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:13.691646 [info ] [MainThread]: 
[0m12:37:13.691646 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:37:13.707223 [debug] [MainThread]: Command `dbt run` succeeded at 12:37:13.706184 after 9.57 seconds
[0m12:37:13.707826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EEAB17C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EF295520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EF296540>]}
[0m12:37:13.707826 [debug] [MainThread]: Flushing usage events
[0m12:37:14.685806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:07.815391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CB3456D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CAFF2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294C9088530>]}


============================== 12:39:07.815391 | a0f02f18-b445-4ed6-8697-7469f6a13ffd ==============================
[0m12:39:07.815391 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:39:07.815391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:products', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:39:08.270360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0f02f18-b445-4ed6-8697-7469f6a13ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CBFB56A0>]}
[0m12:39:08.339878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0f02f18-b445-4ed6-8697-7469f6a13ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294C8FC2270>]}
[0m12:39:08.339878 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:39:08.691719 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:39:08.867553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:39:08.867553 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_customers.sql
[0m12:39:08.867553 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_products.sql
[0m12:39:09.125458 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:39:09.138369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0f02f18-b445-4ed6-8697-7469f6a13ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CD5E4500>]}
[0m12:39:09.205146 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:39:09.205146 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:39:09.241071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0f02f18-b445-4ed6-8697-7469f6a13ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CD63CEC0>]}
[0m12:39:09.241071 [info ] [MainThread]: Found 1 seed, 7 models, 4 sources, 477 macros
[0m12:39:09.241071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0f02f18-b445-4ed6-8697-7469f6a13ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CA2E9760>]}
[0m12:39:09.241071 [info ] [MainThread]: 
[0m12:39:09.250561 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:09.250561 [info ] [MainThread]: 
[0m12:39:09.252298 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:39:09.252298 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:39:09.349808 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:39:09.349808 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:39:09.350809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:11.279099 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.942 seconds
[0m12:39:11.297216 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m12:39:11.342780 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:39:11.342780 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:39:11.342780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:12.911363 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.567 seconds
[0m12:39:12.911363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m12:39:12.911363 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:39:12.911363 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:39:13.284965 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.361 seconds
[0m12:39:13.284965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m12:39:13.284965 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:39:13.284965 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:39:13.677346 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.390 seconds
[0m12:39:13.677346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0f02f18-b445-4ed6-8697-7469f6a13ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CD504770>]}
[0m12:39:13.687346 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_products
[0m12:39:13.687346 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_products ................................ [RUN]
[0m12:39:13.687346 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_products'
[0m12:39:13.687346 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_products
[0m12:39:13.687346 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_products"
[0m12:39:13.687346 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_products
[0m12:39:13.732698 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_products"
[0m12:39:13.734701 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_products"
[0m12:39:13.734701 [debug] [Thread-1 (]: On model.dbt_first.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_products"} */
create or replace transient table HEALTHCARE.stage.stg_products
         as
        (

WITH cte_not_null AS (
    SELECT 
        TRIM(product_id) AS product_id, 
        TRIM(product_family) AS product_family, 
        TRIM(product_sub_family) AS product_sub_family
    FROM HEALTHCARE.RAW.PRODUCTS
    WHERE 
    
        product_id IS NOT NULL
         AND 
    
        product_family IS NOT NULL
         AND 
    
        product_sub_family IS NOT NULL
        
    

),

cte_final AS (
    SELECT 
    DISTINCT
        
    
        CAST(product_id AS VARCHAR(500)) AS product_id,
    
        CAST(product_family AS VARCHAR(500)) AS product_family,
    
        CAST(product_sub_family AS VARCHAR(500)) AS product_sub_family,
    

    FROM cte_not_null
)

SELECT * FROM cte_final
        );
[0m12:39:13.735701 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:39:16.212029 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.478 seconds
[0m12:39:16.243392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0f02f18-b445-4ed6-8697-7469f6a13ffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294C86ED8B0>]}
[0m12:39:16.243392 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.stg_products ........................... [[32mSUCCESS 1[0m in 2.54s]
[0m12:39:16.243392 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_products
[0m12:39:16.243392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:16.243392 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:39:16.243392 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:39:16.780106 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m12:39:16.780106 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m12:39:17.313585 [debug] [MainThread]: Connection 'model.dbt_first.stg_products' was left open.
[0m12:39:17.313585 [debug] [MainThread]: On model.dbt_first.stg_products: Close
[0m12:39:17.856145 [info ] [MainThread]: 
[0m12:39:17.857522 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.60 seconds (8.60s).
[0m12:39:17.859572 [debug] [MainThread]: Command end result
[0m12:39:17.897479 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:39:17.902531 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:39:17.908549 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:39:17.910555 [info ] [MainThread]: 
[0m12:39:17.910555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:17.910555 [info ] [MainThread]: 
[0m12:39:17.910555 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:17.913139 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:17.913139 after 10.27 seconds
[0m12:39:17.913139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CA7A5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CAEC5F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294CAEC7470>]}
[0m12:39:17.914187 [debug] [MainThread]: Flushing usage events
[0m12:39:18.942343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:01.505839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDB444D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD8A7DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDB446BA0>]}


============================== 12:40:01.509848 | b94ea8f8-1263-49bc-b98b-fee701e682ba ==============================
[0m12:40:01.509848 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:40:01.509848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:transactions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:40:01.972174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b94ea8f8-1263-49bc-b98b-fee701e682ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD87EEA50>]}
[0m12:40:02.040272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b94ea8f8-1263-49bc-b98b-fee701e682ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD7AF5730>]}
[0m12:40:02.040272 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:40:02.394983 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:40:02.591607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:02.591607 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_transactions.sql
[0m12:40:02.875205 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:40:02.890868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b94ea8f8-1263-49bc-b98b-fee701e682ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDD6E8A70>]}
[0m12:40:02.961727 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:40:02.961727 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:40:02.999794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b94ea8f8-1263-49bc-b98b-fee701e682ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDD754FB0>]}
[0m12:40:03.000803 [info ] [MainThread]: Found 1 seed, 7 models, 4 sources, 477 macros
[0m12:40:03.001801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b94ea8f8-1263-49bc-b98b-fee701e682ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDD6E9CA0>]}
[0m12:40:03.002801 [info ] [MainThread]: 
[0m12:40:03.003784 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:40:03.003784 [info ] [MainThread]: 
[0m12:40:03.004791 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:40:03.005821 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:40:03.104775 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:40:03.105775 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:40:03.105775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:05.029062 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.923 seconds
[0m12:40:05.033919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m12:40:05.044939 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:40:05.044939 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:40:05.044939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:06.629014 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.580 seconds
[0m12:40:06.631023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m12:40:06.675672 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:40:06.675672 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:40:07.014263 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.337 seconds
[0m12:40:07.014263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m12:40:07.014263 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:40:07.014263 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:40:07.348657 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.324 seconds
[0m12:40:07.348657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b94ea8f8-1263-49bc-b98b-fee701e682ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDD64B2C0>]}
[0m12:40:07.348657 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_transactions
[0m12:40:07.348657 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_transactions ............................ [RUN]
[0m12:40:07.348657 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_transactions'
[0m12:40:07.348657 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_transactions
[0m12:40:07.360354 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_transactions"
[0m12:40:07.360354 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_transactions
[0m12:40:07.397694 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_transactions"
[0m12:40:07.397694 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_transactions"
[0m12:40:07.397694 [debug] [Thread-1 (]: On model.dbt_first.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_transactions"} */
create or replace transient table HEALTHCARE.stage.stg_transactions
         as
        (

WITH cte_cleaned_data AS (
    SELECT  
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(revenue AS DECIMAL(10,3)) AS revenue,
    
        CAST(quantity AS INT) AS quantity,
    
        CAST(product_id AS VARCHAR(200)) AS product_id,
    
        CAST(payment_mode AS DATE) AS payment_mode,
    
        CAST(companies AS VARCHAR(100)) AS companies,
    


        CASE 
            WHEN revenue_type = 'True' THEN 1
            WHEN revenue_type = 'False' THEN 0
            ELSE NULL 
        END AS revenue_type,
        CAST(payment_mode AS DATE) AS payment_date,
        CAST(dimension_1 AS VARCHAR(10)) AS dim_1,
        CAST(dimension_2 AS VARCHAR(10)) AS dim_2,
        CAST(dimension_3 AS VARCHAR(10)) AS dim_3,
        CAST(dimension_4 AS VARCHAR(10)) AS dim_4,
        CAST(dimension_5 AS VARCHAR(10)) AS dim_5,
        CAST(dimension_6 AS VARCHAR(10)) AS dim_6,
        CAST(dimension_7 AS VARCHAR(10)) AS dim_7,
        CAST(dimension_8 AS VARCHAR(10)) AS dim_8,
        CAST(dimension_9 AS VARCHAR(10)) AS dim_9,
        CAST(dimension_10 AS VARCHAR(10)) AS dim_10
    FROM HEALTHCARE.RAW.TRANSACTIONS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        product_id IS NOT NULL
         AND 
    
        payment_mode IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        dimension_1 IS NOT NULL
         AND 
    
        dimension_2 IS NOT NULL
         AND 
    
        dimension_3 IS NOT NULL
         AND 
    
        dimension_4 IS NOT NULL
         AND 
    
        dimension_5 IS NOT NULL
         AND 
    
        dimension_6 IS NOT NULL
         AND 
    
        dimension_7 IS NOT NULL
         AND 
    
        dimension_8 IS NOT NULL
         AND 
    
        dimension_9 IS NOT NULL
         AND 
    
        dimension_10 IS NOT NULL
         AND 
    
        companies IS NOT NULL
        
    

),
cte_name_change AS(
    SELECT 
    DISTINCT
        customer_id,
        revenue,
        quantity,
        product_id,
        payment_mode AS payment_date,
        companies       AS company_name,
        revenue_type,
        dim_1,
        dim_2,
        dim_3,
        dim_4,
        dim_5,
        dim_6,
        dim_7,
        dim_8,
        dim_9,
        dim_10
    FROM 
        cte_cleaned_data
)

SELECT * FROM cte_name_change
        );
[0m12:40:07.397694 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:09.857133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.456 seconds
[0m12:40:09.882691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b94ea8f8-1263-49bc-b98b-fee701e682ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DD87ED9A0>]}
[0m12:40:09.882691 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.stg_transactions ....................... [[32mSUCCESS 1[0m in 2.53s]
[0m12:40:09.882691 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_transactions
[0m12:40:09.882691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:09.882691 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:40:09.891585 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:40:10.417179 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m12:40:10.417179 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m12:40:10.942232 [debug] [MainThread]: Connection 'model.dbt_first.stg_transactions' was left open.
[0m12:40:10.944246 [debug] [MainThread]: On model.dbt_first.stg_transactions: Close
[0m12:40:11.483799 [info ] [MainThread]: 
[0m12:40:11.483799 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m12:40:11.483799 [debug] [MainThread]: Command end result
[0m12:40:11.512102 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:40:11.512102 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:40:11.520191 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:40:11.520191 [info ] [MainThread]: 
[0m12:40:11.520191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:11.520191 [info ] [MainThread]: 
[0m12:40:11.520191 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:40:11.520191 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:11.520191 after 10.20 seconds
[0m12:40:11.520191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDB278770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDBEE3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDA958F80>]}
[0m12:40:11.520191 [debug] [MainThread]: Flushing usage events
[0m12:40:12.518254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:44:28.900586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADE5BCC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADE0BA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADE5BCB00>]}


============================== 12:44:28.900586 | 4d2be4fc-5e71-476a-b99b-289499ddf09f ==============================
[0m12:44:28.900586 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:44:28.900586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:44:29.423898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d2be4fc-5e71-476a-b99b-289499ddf09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADF2B73B0>]}
[0m12:44:29.474500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d2be4fc-5e71-476a-b99b-289499ddf09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADF247F50>]}
[0m12:44:29.491198 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:44:29.959106 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:44:31.346005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:44:31.346005 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m12:44:31.517944 [error] [MainThread]: Encountered an error:
Compilation Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  expected token ',', got '='
    line 2
      --     tags=['mart', 'churn_new_cust']
[0m12:44:31.533721 [debug] [MainThread]: Command `dbt run` failed at 12:44:31.533721 after 2.89 seconds
[0m12:44:31.534262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADE5BC290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADF3B8C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AE073F080>]}
[0m12:44:31.534262 [debug] [MainThread]: Flushing usage events
[0m12:44:32.578566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:37.709402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001762E6507A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001762E071640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001762BE9EFC0>]}


============================== 12:45:37.727855 | fe11a0f3-51b5-4ffc-9779-4bea45700a73 ==============================
[0m12:45:37.727855 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:45:37.728475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:45:38.200540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe11a0f3-51b5-4ffc-9779-4bea45700a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001762F477EC0>]}
[0m12:45:38.263555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe11a0f3-51b5-4ffc-9779-4bea45700a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001762F3E7A70>]}
[0m12:45:38.263555 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:45:38.626970 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:45:38.811490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:45:38.811490 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m12:45:39.049177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:45:39.074926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe11a0f3-51b5-4ffc-9779-4bea45700a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017630973410>]}
[0m12:45:39.151199 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:45:39.160166 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:45:39.191702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe11a0f3-51b5-4ffc-9779-4bea45700a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017630A24A10>]}
[0m12:45:39.191702 [info ] [MainThread]: Found 1 seed, 7 models, 4 sources, 477 macros
[0m12:45:39.191702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe11a0f3-51b5-4ffc-9779-4bea45700a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017630A631A0>]}
[0m12:45:39.199996 [info ] [MainThread]: 
[0m12:45:39.199996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:39.199996 [info ] [MainThread]: 
[0m12:45:39.199996 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:45:39.199996 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:45:41.825200 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:45:41.828729 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:45:41.828729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:43.801709 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.981 seconds
[0m12:45:43.801709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m12:45:43.824200 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:45:43.824200 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:45:43.824200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:45.316058 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.490 seconds
[0m12:45:45.317006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m12:45:45.321178 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:45:45.322208 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:45:45.684139 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.374 seconds
[0m12:45:45.684139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m12:45:45.750462 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:45:45.750462 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:45:46.084823 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.334 seconds
[0m12:45:46.084823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe11a0f3-51b5-4ffc-9779-4bea45700a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017630E12F30>]}
[0m12:45:46.084823 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m12:45:46.084823 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m12:45:46.084823 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m12:45:46.084823 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m12:45:46.100457 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m12:45:46.100457 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m12:45:46.141279 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m12:45:46.144213 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m12:45:46.144213 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    LEFT JOIN HEALTHCARE.stage.stg_customers AS c 
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase AS flp
    CROSS JOIN max_min_overall AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
),
new_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase AS flp
    CROSS JOIN max_min_overall AS mmo
    WHERE flp.first_purchase_date >= DATEADD(month, -3, mmo.max_date)
),
churned_customers_over_time AS (
    SELECT
        DATE_TRUNC('month', flp.last_purchase_date) AS month,
        COUNT(flp.customer_id) AS churned_customers
    FROM first_last_purchase AS flp
    WHERE flp.last_purchase_date < DATEADD(month, -3, (SELECT MAX(max_date) FROM max_min_overall))
    GROUP BY month
),
new_customers_over_time AS (
    SELECT
        DATE_TRUNC('month', flp.first_purchase_date) AS month,
        COUNT(flp.customer_id) AS new_customers
    FROM first_last_purchase AS flp
    WHERE flp.first_purchase_date >= DATEADD(month, -3, (SELECT MAX(max_date) FROM max_min_overall))
    GROUP BY month
)
SELECT 
    cot.month,
    cot.churned_customers,
    not.new_customers
FROM 
    churned_customers_over_time AS cot
FULL OUTER JOIN 
    new_customers_over_time AS not
ON 
    cot.month = not.month
ORDER BY 
    cot.month
        );
[0m12:45:46.144213 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:45:47.809455 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff53-0004-bded-0005-a3d30003f06e
[0m12:45:47.809455 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 63 at position 7 unexpected '.'.
syntax error line 67 at position 31 unexpected 'not'.
syntax error line 69 at position 4 unexpected 'cot'.
[0m12:45:47.835646 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 63 at position 7 unexpected '.'.
  syntax error line 67 at position 31 unexpected 'not'.
  syntax error line 69 at position 4 unexpected 'cot'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m12:45:47.835646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe11a0f3-51b5-4ffc-9779-4bea45700a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017630FD6C90>]}
[0m12:45:47.841562 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.churned_new_customers ............... [[31mERROR[0m in 1.75s]
[0m12:45:47.841562 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m12:45:47.841562 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 63 at position 7 unexpected '.'.
  syntax error line 67 at position 31 unexpected 'not'.
  syntax error line 69 at position 4 unexpected 'cot'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql.
[0m12:45:47.841562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:47.841562 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:45:47.841562 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:45:48.366109 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m12:45:48.366109 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m12:45:48.919984 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m12:45:48.919984 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m12:45:49.476913 [info ] [MainThread]: 
[0m12:45:49.476913 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.28 seconds (10.28s).
[0m12:45:49.478922 [debug] [MainThread]: Command end result
[0m12:45:49.506266 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:45:49.509118 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:45:49.514210 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:45:49.514210 [info ] [MainThread]: 
[0m12:45:49.514210 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:45:49.514210 [info ] [MainThread]: 
[0m12:45:49.514210 [error] [MainThread]:   Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 63 at position 7 unexpected '.'.
  syntax error line 67 at position 31 unexpected 'not'.
  syntax error line 69 at position 4 unexpected 'cot'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m12:45:49.521019 [info ] [MainThread]: 
[0m12:45:49.523033 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:45:49.524579 [debug] [MainThread]: Command `dbt run` failed at 12:45:49.524579 after 12.00 seconds
[0m12:45:49.524579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001762E10A480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001762BA39790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001762BA39730>]}
[0m12:45:49.526585 [debug] [MainThread]: Flushing usage events
[0m12:45:50.552299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:21.475549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002815C5A4E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002815B97F980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002815C5A5FA0>]}


============================== 12:46:21.475549 | 0a354429-4b58-4f48-b1dd-16d5f4dd031e ==============================
[0m12:46:21.475549 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:46:21.475549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:46:21.930114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a354429-4b58-4f48-b1dd-16d5f4dd031e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002815C5A4920>]}
[0m12:46:21.993889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a354429-4b58-4f48-b1dd-16d5f4dd031e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002815B4BCE60>]}
[0m12:46:21.993889 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:46:22.355665 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:46:22.540769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:46:22.540769 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m12:46:22.772412 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:46:22.782631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a354429-4b58-4f48-b1dd-16d5f4dd031e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002815E833410>]}
[0m12:46:22.870218 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:46:22.870218 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:46:22.903016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a354429-4b58-4f48-b1dd-16d5f4dd031e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002815E8E4980>]}
[0m12:46:22.903016 [info ] [MainThread]: Found 1 seed, 7 models, 4 sources, 477 macros
[0m12:46:22.903016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a354429-4b58-4f48-b1dd-16d5f4dd031e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002815E8094C0>]}
[0m12:46:22.903016 [info ] [MainThread]: 
[0m12:46:22.903016 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:46:22.903016 [info ] [MainThread]: 
[0m12:46:22.903016 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:46:22.903016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:46:23.006670 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:46:23.007671 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:46:23.007671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:24.953093 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.947 seconds
[0m12:46:24.957852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m12:46:24.970207 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:46:24.970207 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:46:24.970207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:26.430280 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.465 seconds
[0m12:46:26.430280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m12:46:26.430280 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:46:26.430280 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:46:26.818466 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.378 seconds
[0m12:46:26.818466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m12:46:26.866330 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:46:26.866330 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:46:27.189461 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.318 seconds
[0m12:46:27.194396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a354429-4b58-4f48-b1dd-16d5f4dd031e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281599F3980>]}
[0m12:46:27.194396 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m12:46:27.194396 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m12:46:27.194396 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m12:46:27.194396 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m12:46:27.209110 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m12:46:27.210111 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m12:46:27.225110 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m12:46:27.241905 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m12:46:27.241905 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    LEFT JOIN HEALTHCARE.stage.stg_customers AS c 
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase AS flp
    CROSS JOIN max_min_overall AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
),
new_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase AS flp
    CROSS JOIN max_min_overall AS mmo
    WHERE flp.first_purchase_date >= DATEADD(month, -3, mmo.max_date)
),
churned_customers_over_time AS (
    SELECT
        DATE_TRUNC('month', flp.last_purchase_date) AS month,
        COUNT(flp.customer_id) AS churned_customers
    FROM first_last_purchase AS flp
    WHERE flp.last_purchase_date < DATEADD(month, -3, (SELECT MAX(max_date) FROM max_min_overall))
    GROUP BY month
),
new_customers_over_time AS (
    SELECT
        DATE_TRUNC('month', flp.first_purchase_date) AS month,
        COUNT(flp.customer_id) AS new_customers
    FROM first_last_purchase AS flp
    WHERE flp.first_purchase_date >= DATEADD(month, -3, (SELECT MAX(max_date) FROM max_min_overall))
    GROUP BY month
)
SELECT 
    cot.month,
    cot.churned_customers,
    ncot.new_customers
FROM 
    churned_customers_over_time AS cot
FULL OUTER JOIN 
    new_customers_over_time AS ncot
ON 
    cot.month = ncot.month
ORDER BY 
    cot.month
        );
[0m12:46:27.241905 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:46:29.815329 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.577 seconds
[0m12:46:29.841551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a354429-4b58-4f48-b1dd-16d5f4dd031e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002815E8E73E0>]}
[0m12:46:29.841551 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 2.65s]
[0m12:46:29.841551 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m12:46:29.841551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:29.841551 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:46:29.841551 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:46:30.375855 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m12:46:30.375855 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m12:46:30.910179 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m12:46:30.910179 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m12:46:31.458220 [info ] [MainThread]: 
[0m12:46:31.458220 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.56 seconds (8.56s).
[0m12:46:31.458220 [debug] [MainThread]: Command end result
[0m12:46:31.485892 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:46:31.485892 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:46:31.485892 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:46:31.496109 [info ] [MainThread]: 
[0m12:46:31.497121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:46:31.497121 [info ] [MainThread]: 
[0m12:46:31.497121 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:46:31.499158 [debug] [MainThread]: Command `dbt run` succeeded at 12:46:31.499158 after 10.18 seconds
[0m12:46:31.499158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002815C2BA240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028156540F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002815E833290>]}
[0m12:46:31.499158 [debug] [MainThread]: Flushing usage events
[0m12:46:32.550694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:09.071332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020112904CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020112904980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020112904260>]}


============================== 12:48:09.071332 | cea17629-4b17-4c3e-94b9-57e0395c7600 ==============================
[0m12:48:09.071332 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:48:09.071332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m12:48:09.574217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cea17629-4b17-4c3e-94b9-57e0395c7600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201134CFA10>]}
[0m12:48:09.621527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cea17629-4b17-4c3e-94b9-57e0395c7600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020111E51FD0>]}
[0m12:48:09.637664 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:48:09.995069 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:48:10.182033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:48:10.182033 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m12:48:10.440083 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:48:10.455985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cea17629-4b17-4c3e-94b9-57e0395c7600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020114C60B00>]}
[0m12:48:10.527601 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:48:10.527601 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:48:10.567519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cea17629-4b17-4c3e-94b9-57e0395c7600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020114C148C0>]}
[0m12:48:10.567519 [info ] [MainThread]: Found 1 seed, 7 models, 4 sources, 477 macros
[0m12:48:10.568521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cea17629-4b17-4c3e-94b9-57e0395c7600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020114C5B710>]}
[0m12:48:10.569554 [info ] [MainThread]: 
[0m12:48:10.570780 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:10.571347 [info ] [MainThread]: 
[0m12:48:10.572355 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:48:10.573378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:48:10.661063 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:48:10.661063 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:48:10.661063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:12.528323 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.866 seconds
[0m12:48:12.544149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m12:48:12.544149 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:48:12.544149 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:48:12.544149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:14.073020 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.520 seconds
[0m12:48:14.073020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m12:48:14.073020 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:48:14.073020 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:48:14.443474 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.366 seconds
[0m12:48:14.443474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m12:48:14.490967 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:48:14.490967 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:48:14.846953 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.348 seconds
[0m12:48:14.846953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cea17629-4b17-4c3e-94b9-57e0395c7600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020110621490>]}
[0m12:48:14.846953 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m12:48:14.846953 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m12:48:14.846953 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m12:48:14.846953 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m12:48:14.862831 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m12:48:14.862831 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m12:48:14.900655 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m12:48:14.900655 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m12:48:14.900655 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    LEFT JOIN HEALTHCARE.stage.stg_customers AS c 
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date,
        mmo.max_date
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
    WHERE flp.last_purchase_date < DATEADD(month, -3, mmo.max_date)
)
SELECT * FROM churned_customers
        );
[0m12:48:14.900655 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:48:17.362225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.458 seconds
[0m12:48:17.387028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cea17629-4b17-4c3e-94b9-57e0395c7600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020114AE47D0>]}
[0m12:48:17.387417 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 2.54s]
[0m12:48:17.388461 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m12:48:17.389601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:17.390635 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:48:17.390635 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:48:17.962923 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m12:48:17.962923 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m12:48:18.469677 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m12:48:18.469677 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m12:48:19.015847 [info ] [MainThread]: 
[0m12:48:19.015847 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.44 seconds (8.44s).
[0m12:48:19.015847 [debug] [MainThread]: Command end result
[0m12:48:19.053308 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:48:19.053308 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:48:19.069483 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:48:19.069483 [info ] [MainThread]: 
[0m12:48:19.069483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:48:19.069483 [info ] [MainThread]: 
[0m12:48:19.069483 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:48:19.069483 [debug] [MainThread]: Command `dbt run` succeeded at 12:48:19.069483 after 10.17 seconds
[0m12:48:19.069483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020112447020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020112447D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201124469F0>]}
[0m12:48:19.069483 [debug] [MainThread]: Flushing usage events
[0m12:48:20.476168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:32.407740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CAE5D4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CAE5D7FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CAE5D4AD0>]}


============================== 12:49:32.407740 | 0f38fed1-b1af-4c50-8f56-dccbe33faf83 ==============================
[0m12:49:32.407740 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:49:32.407740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:customers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:49:32.878988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f38fed1-b1af-4c50-8f56-dccbe33faf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CAE9285F0>]}
[0m12:49:32.938895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f38fed1-b1af-4c50-8f56-dccbe33faf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CAE5D4410>]}
[0m12:49:32.938895 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:49:33.295167 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:49:33.479490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:49:33.479490 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_customers.sql
[0m12:49:33.727050 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:49:33.743596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f38fed1-b1af-4c50-8f56-dccbe33faf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CAF4372C0>]}
[0m12:49:33.832656 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:49:33.836626 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:49:33.860077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f38fed1-b1af-4c50-8f56-dccbe33faf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB08E0EC0>]}
[0m12:49:33.860077 [info ] [MainThread]: Found 1 seed, 7 models, 4 sources, 477 macros
[0m12:49:33.860077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f38fed1-b1af-4c50-8f56-dccbe33faf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB0927DD0>]}
[0m12:49:33.860077 [info ] [MainThread]: 
[0m12:49:33.860077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:33.860077 [info ] [MainThread]: 
[0m12:49:33.860077 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:49:33.860077 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:49:33.965508 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:49:33.966508 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:49:33.966508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:35.824474 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.859 seconds
[0m12:49:35.831884 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m12:49:35.840305 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:49:35.840305 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:49:35.840305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:37.553599 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.723 seconds
[0m12:49:37.553599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m12:49:37.614474 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:49:37.614474 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:49:38.007541 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.405 seconds
[0m12:49:38.023419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m12:49:38.023419 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:49:38.023419 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:49:39.400037 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.372 seconds
[0m12:49:39.400037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f38fed1-b1af-4c50-8f56-dccbe33faf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB0DF38C0>]}
[0m12:49:39.400037 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m12:49:39.400037 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_customers ............................... [RUN]
[0m12:49:39.400037 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m12:49:39.400037 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m12:49:39.414236 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m12:49:39.414236 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m12:49:39.449832 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_customers"
[0m12:49:39.449832 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_customers"
[0m12:49:39.449832 [debug] [Thread-1 (]: On model.dbt_first.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_customers"} */
create or replace transient table HEALTHCARE.stage.stg_customers
         as
        (

WITH cte_handle_null AS (
    SELECT 
        customer_id,
        INIT(TRIM(customer_name)) AS customer_name,
        TRIM(company) AS company
    FROM HEALTHCARE.RAW.CUSTOMERS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    
  
),

cte_final AS (
    SELECT 
    DISTINCT
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(customer_name AS VARCHAR(300)) AS customer_name,
    
        CAST(company AS VARCHAR(100)) AS company,
    

    FROM cte_handle_null
)

SELECT * FROM cte_final
        );
[0m12:49:39.449832 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:40.982903 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff57-0004-bded-0005-a3d30003f08a
[0m12:49:40.982903 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function INIT
[0m12:49:40.982903 [debug] [Thread-1 (]: Database Error in model stg_customers (models\Stage\stg_customers.sql)
  002140 (42601): SQL compilation error:
  Unknown function INIT
  compiled code at target\run\dbt_first\models\Stage\stg_customers.sql
[0m12:49:40.982903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f38fed1-b1af-4c50-8f56-dccbe33faf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CADA90350>]}
[0m12:49:40.982903 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model stage.stg_customers ...................... [[31mERROR[0m in 1.58s]
[0m12:49:40.998857 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m12:49:40.998857 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\Stage\stg_customers.sql)
  002140 (42601): SQL compilation error:
  Unknown function INIT
  compiled code at target\run\dbt_first\models\Stage\stg_customers.sql.
[0m12:49:41.002373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:41.002373 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:49:41.002373 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:49:41.540741 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m12:49:41.540741 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m12:49:42.069524 [debug] [MainThread]: Connection 'model.dbt_first.stg_customers' was left open.
[0m12:49:42.069524 [debug] [MainThread]: On model.dbt_first.stg_customers: Close
[0m12:49:42.617524 [info ] [MainThread]: 
[0m12:49:42.617524 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.76 seconds (8.76s).
[0m12:49:42.617524 [debug] [MainThread]: Command end result
[0m12:49:42.653691 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:49:42.658230 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:49:42.662270 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:49:42.662270 [info ] [MainThread]: 
[0m12:49:42.662270 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:49:42.662270 [info ] [MainThread]: 
[0m12:49:42.662270 [error] [MainThread]:   Database Error in model stg_customers (models\Stage\stg_customers.sql)
  002140 (42601): SQL compilation error:
  Unknown function INIT
  compiled code at target\run\dbt_first\models\Stage\stg_customers.sql
[0m12:49:42.662270 [info ] [MainThread]: 
[0m12:49:42.662270 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:49:42.669522 [debug] [MainThread]: Command `dbt run` failed at 12:49:42.669522 after 10.42 seconds
[0m12:49:42.669522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CADFCA5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CAE05FB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CB0B768D0>]}
[0m12:49:42.673421 [debug] [MainThread]: Flushing usage events
[0m12:49:43.587725 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:51:56.404807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA568D4260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA52F59E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA568D5790>]}


============================== 12:51:56.404807 | 8ab93019-6e36-4f33-bee7-d72734e5cb71 ==============================
[0m12:51:56.404807 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:51:56.404807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:51:56.874873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ab93019-6e36-4f33-bee7-d72734e5cb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA568F21E0>]}
[0m12:51:56.922403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ab93019-6e36-4f33-bee7-d72734e5cb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA563EDE80>]}
[0m12:51:56.922403 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:51:57.281882 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:51:57.457360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:51:57.473510 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_customers.sql
[0m12:51:57.473510 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Stage\stg_country_region.sql
[0m12:51:57.725769 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m12:51:57.738473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ab93019-6e36-4f33-bee7-d72734e5cb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA58B99640>]}
[0m12:51:57.804020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:51:57.804020 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:51:57.838530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ab93019-6e36-4f33-bee7-d72734e5cb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA58BA9610>]}
[0m12:51:57.851401 [info ] [MainThread]: Found 1 seed, 7 models, 4 sources, 477 macros
[0m12:51:57.851401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ab93019-6e36-4f33-bee7-d72734e5cb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA58BF3EF0>]}
[0m12:51:57.851401 [info ] [MainThread]: 
[0m12:51:57.851401 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:51:57.851401 [info ] [MainThread]: 
[0m12:51:57.851401 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:51:57.851401 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m12:51:57.951787 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m12:51:57.952786 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m12:51:57.953504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:59.984947 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.033 seconds
[0m12:51:59.984947 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m12:52:00.048345 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m12:52:00.054207 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m12:52:00.054207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:01.582597 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.540 seconds
[0m12:52:01.582597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m12:52:01.598463 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m12:52:01.598463 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m12:52:01.930109 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.330 seconds
[0m12:52:01.932111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m12:52:01.935884 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m12:52:01.935884 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m12:52:02.492260 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.559 seconds
[0m12:52:02.492260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ab93019-6e36-4f33-bee7-d72734e5cb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA58B9B020>]}
[0m12:52:02.492260 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m12:52:02.492260 [info ] [Thread-1 (]: 1 of 1 START sql table model stage.stg_customers ............................... [RUN]
[0m12:52:02.492260 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_customers'
[0m12:52:02.492260 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m12:52:02.507293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m12:52:02.507293 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m12:52:02.529925 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_customers"
[0m12:52:02.529925 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_customers"
[0m12:52:02.529925 [debug] [Thread-1 (]: On model.dbt_first.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_customers"} */
create or replace transient table HEALTHCARE.stage.stg_customers
         as
        (

WITH cte_handle_null AS (
    SELECT 
        customer_id,
        INITCAP(TRIM(customer_name)) AS customer_name,
        TRIM(company) AS company
    FROM HEALTHCARE.RAW.CUSTOMERS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    
  
),

cte_final AS (
    SELECT 
    DISTINCT
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(customer_name AS VARCHAR(300)) AS customer_name,
    
        CAST(company AS VARCHAR(100)) AS company,
    

    FROM cte_handle_null
)

SELECT * FROM cte_final
        );
[0m12:52:02.545594 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:52:04.915863 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.382 seconds
[0m12:52:04.947758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ab93019-6e36-4f33-bee7-d72734e5cb71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA53CD9DC0>]}
[0m12:52:04.947758 [info ] [Thread-1 (]: 1 of 1 OK created sql table model stage.stg_customers .......................... [[32mSUCCESS 1[0m in 2.46s]
[0m12:52:04.947758 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m12:52:04.947758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:04.947758 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m12:52:04.947758 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m12:52:05.467718 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m12:52:05.467718 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m12:52:06.012961 [debug] [MainThread]: Connection 'model.dbt_first.stg_customers' was left open.
[0m12:52:06.012961 [debug] [MainThread]: On model.dbt_first.stg_customers: Close
[0m12:52:06.546902 [info ] [MainThread]: 
[0m12:52:06.562460 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.70 seconds (8.70s).
[0m12:52:06.563842 [debug] [MainThread]: Command end result
[0m12:52:06.604986 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m12:52:06.605987 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m12:52:06.615224 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m12:52:06.615760 [info ] [MainThread]: 
[0m12:52:06.615760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:06.615760 [info ] [MainThread]: 
[0m12:52:06.615760 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:52:06.615760 [debug] [MainThread]: Command `dbt run` succeeded at 12:52:06.615760 after 10.38 seconds
[0m12:52:06.615760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5629D940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA575B7E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA58BF3FE0>]}
[0m12:52:06.615760 [debug] [MainThread]: Flushing usage events
[0m12:52:07.980521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:02:33.069248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08B748110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08EFD4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08EFD57C0>]}


============================== 13:02:33.069248 | 1d80f22f-2909-420a-beaf-d8de9adbd145 ==============================
[0m13:02:33.069248 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:02:33.069248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m13:02:33.601218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d80f22f-2909-420a-beaf-d8de9adbd145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08EFD5FD0>]}
[0m13:02:33.648719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d80f22f-2909-420a-beaf-d8de9adbd145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08FD93A70>]}
[0m13:02:33.648719 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:02:34.129327 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:02:35.432987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:02:35.432987 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m13:02:35.671474 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m13:02:35.671474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d80f22f-2909-420a-beaf-d8de9adbd145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E09126B410>]}
[0m13:02:35.756154 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m13:02:35.771911 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m13:02:35.806255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d80f22f-2909-420a-beaf-d8de9adbd145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E091334C50>]}
[0m13:02:35.806255 [info ] [MainThread]: Found 1 seed, 7 models, 4 sources, 477 macros
[0m13:02:35.806255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d80f22f-2909-420a-beaf-d8de9adbd145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E091293AD0>]}
[0m13:02:35.809909 [info ] [MainThread]: 
[0m13:02:35.809909 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:02:35.809909 [info ] [MainThread]: 
[0m13:02:35.809909 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:02:35.809909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m13:02:38.412771 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m13:02:38.420817 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m13:02:38.420817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:40.469086 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.060 seconds
[0m13:02:40.484936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m13:02:40.484936 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m13:02:40.484936 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m13:02:40.484936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:42.003011 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.507 seconds
[0m13:02:42.003011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m13:02:42.003011 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m13:02:42.003011 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m13:02:42.407789 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.400 seconds
[0m13:02:42.407789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m13:02:42.471849 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m13:02:42.471849 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m13:02:42.830568 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.359 seconds
[0m13:02:42.845155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d80f22f-2909-420a-beaf-d8de9adbd145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E091390680>]}
[0m13:02:42.845155 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m13:02:42.845155 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m13:02:42.845155 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m13:02:42.845155 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m13:02:42.860869 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m13:02:42.862756 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m13:02:42.879786 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m13:02:42.879786 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m13:02:42.879786 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    LEFT JOIN HEALTHCARE.stage.stg_customers AS c 
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
churned_customers AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date, 
        CASE
            WHEN flp.last_purchase_date < DATEADD(month, -3, mmo.max_date) THEN '1'
            ELSE '0'
        END AS churned_customer,
        CASE
            WHEN flp.first_purchase_date > DATEADD(month, -3, mmo.max_date) THEN '1'
            ELSE '0'
        END AS new_customer
    FROM first_last_purchase    AS flp
    CROSS JOIN max_min_overall  AS mmo
   
)
SELECT * FROM churned_customers
        );
[0m13:02:42.879786 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:02:46.306587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.412 seconds
[0m13:02:46.333168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d80f22f-2909-420a-beaf-d8de9adbd145', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E09172F710>]}
[0m13:02:46.334180 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 3.49s]
[0m13:02:46.336175 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m13:02:46.337711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:46.337711 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m13:02:46.337711 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m13:02:46.877319 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m13:02:46.877319 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m13:02:47.454236 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m13:02:47.454236 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m13:02:47.986029 [info ] [MainThread]: 
[0m13:02:47.986029 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.18 seconds (12.18s).
[0m13:02:48.002114 [debug] [MainThread]: Command end result
[0m13:02:48.024376 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m13:02:48.037427 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m13:02:48.045005 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m13:02:48.045005 [info ] [MainThread]: 
[0m13:02:48.045005 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:02:48.045005 [info ] [MainThread]: 
[0m13:02:48.045005 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:02:48.045005 [debug] [MainThread]: Command `dbt run` succeeded at 13:02:48.045005 after 15.22 seconds
[0m13:02:48.045005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08E678860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08ED23E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08B748110>]}
[0m13:02:48.045005 [debug] [MainThread]: Flushing usage events
[0m13:02:49.567409 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:04:57.210033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B45E45F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B42AD880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B40BA570>]}


============================== 13:04:57.218784 | 992ff1bf-4e40-4ca8-ac9e-6a6cb8ec1e49 ==============================
[0m13:04:57.218784 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:04:57.218784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:04:57.698204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '992ff1bf-4e40-4ca8-ac9e-6a6cb8ec1e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B198ADE0>]}
[0m13:04:57.763562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '992ff1bf-4e40-4ca8-ac9e-6a6cb8ec1e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B5127020>]}
[0m13:04:57.764599 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:04:58.136487 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:04:58.315751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:04:58.315751 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m13:04:58.581711 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m13:04:58.585725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '992ff1bf-4e40-4ca8-ac9e-6a6cb8ec1e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B67C9910>]}
[0m13:04:58.667540 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m13:04:58.667540 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m13:04:58.706999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '992ff1bf-4e40-4ca8-ac9e-6a6cb8ec1e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B68A4C20>]}
[0m13:04:58.707999 [info ] [MainThread]: Found 1 seed, 7 models, 4 sources, 477 macros
[0m13:04:58.707999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '992ff1bf-4e40-4ca8-ac9e-6a6cb8ec1e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B68F16A0>]}
[0m13:04:58.710030 [info ] [MainThread]: 
[0m13:04:58.711000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:04:58.711000 [info ] [MainThread]: 
[0m13:04:58.712012 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:04:58.713025 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m13:04:58.809281 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m13:04:58.809281 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m13:04:58.809281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:00.908235 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.114 seconds
[0m13:05:00.930402 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m13:05:00.930402 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m13:05:00.940304 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m13:05:00.940304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:02.434646 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.502 seconds
[0m13:05:02.434646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m13:05:02.434646 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m13:05:02.434646 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m13:05:02.796483 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.348 seconds
[0m13:05:02.799494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m13:05:02.851411 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m13:05:02.852450 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m13:05:03.220524 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.368 seconds
[0m13:05:03.223669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '992ff1bf-4e40-4ca8-ac9e-6a6cb8ec1e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B6BF4530>]}
[0m13:05:03.228215 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m13:05:03.228215 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m13:05:03.229215 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m13:05:03.229215 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m13:05:03.237240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m13:05:03.239245 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m13:05:03.271993 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m13:05:03.271993 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m13:05:03.271993 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    LEFT JOIN HEALTHCARE.stage.stg_customers AS c 
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
customer_status AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date, 
        CASE
            WHEN flp.last_purchase_date < DATEADD(month, -3, mmo.max_date) THEN 1
            ELSE 0
        END AS churned_customer,
        CASE
            WHEN flp.first_purchase_date > DATEADD(month, -3, mmo.max_date) THEN 1
            ELSE 0
        END AS new_customer
    FROM first_last_purchase AS flp
    CROSS JOIN max_min_overall AS mmo
),
customer_status_over_time AS (
    SELECT
        DATE_TRUNC('month', flp.first_purchase_date) AS month,
        SUM(cs.churned_customer) AS churned_customers,
        SUM(cs.new_customer) AS new_customers
    FROM customer_status AS cs
    JOIN first_last_purchase AS flp ON cs.customer_id = flp.customer_id
    GROUP BY month
)
SELECT 
    month,
    churned_customers,
    new_customers
FROM 
    customer_status_over_time
ORDER BY 
    month;
[0m13:05:03.271993 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:05:04.977419 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff67-0004-bde4-0005-a3d30003e0aa
[0m13:05:04.977419 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 55 at position 9 unexpected ';'.
[0m13:05:04.993306 [debug] [Thread-1 (]: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 9 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m13:05:04.993306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '992ff1bf-4e40-4ca8-ac9e-6a6cb8ec1e49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B3A90860>]}
[0m13:05:04.993306 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.churned_new_customers ............... [[31mERROR[0m in 1.76s]
[0m13:05:04.993306 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m13:05:04.993306 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.churned_new_customers' to be skipped because of status 'error'.  Reason: Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 9 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql.
[0m13:05:04.993306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:04.993306 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m13:05:04.993306 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m13:05:05.539101 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m13:05:05.539101 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m13:05:06.089486 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m13:05:06.089486 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m13:05:06.628817 [info ] [MainThread]: 
[0m13:05:06.628817 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.92 seconds (7.92s).
[0m13:05:06.628817 [debug] [MainThread]: Command end result
[0m13:05:06.665911 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m13:05:06.669910 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m13:05:06.676982 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m13:05:06.677981 [info ] [MainThread]: 
[0m13:05:06.679417 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:05:06.679417 [info ] [MainThread]: 
[0m13:05:06.679417 [error] [MainThread]:   Database Error in model churned_new_customers (models\Mart\churned_new_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 55 at position 9 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\churned_new_customers.sql
[0m13:05:06.679417 [info ] [MainThread]: 
[0m13:05:06.679417 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:05:06.679417 [debug] [MainThread]: Command `dbt run` failed at 13:05:06.679417 after 9.69 seconds
[0m13:05:06.685148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B3C66330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B39AF770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265B444F200>]}
[0m13:05:06.685148 [debug] [MainThread]: Flushing usage events
[0m13:05:08.011661 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:16.082991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7B878320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7B878650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7B87B7D0>]}


============================== 13:05:16.089376 | 083071f7-2b82-4f2a-8160-42a6b1e065e9 ==============================
[0m13:05:16.089376 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:05:16.089376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:05:16.557938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '083071f7-2b82-4f2a-8160-42a6b1e065e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7B87AA20>]}
[0m13:05:16.623707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '083071f7-2b82-4f2a-8160-42a6b1e065e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD78DCC830>]}
[0m13:05:16.625089 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:05:16.993968 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:05:17.183409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:05:17.183409 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m13:05:17.450371 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m13:05:17.467301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '083071f7-2b82-4f2a-8160-42a6b1e065e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7D99A3F0>]}
[0m13:05:17.566704 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m13:05:17.570716 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m13:05:17.597863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '083071f7-2b82-4f2a-8160-42a6b1e065e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7DC18AD0>]}
[0m13:05:17.597863 [info ] [MainThread]: Found 1 seed, 7 models, 4 sources, 477 macros
[0m13:05:17.599370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '083071f7-2b82-4f2a-8160-42a6b1e065e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7D6E6A80>]}
[0m13:05:17.599370 [info ] [MainThread]: 
[0m13:05:17.599370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:17.599370 [info ] [MainThread]: 
[0m13:05:17.599370 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:05:17.599370 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m13:05:17.700457 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m13:05:17.700457 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m13:05:17.701539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:19.523974 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.830 seconds
[0m13:05:19.523974 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m13:05:19.539817 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m13:05:19.539817 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m13:05:19.539817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:21.057301 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.522 seconds
[0m13:05:21.057301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m13:05:21.073385 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m13:05:21.073385 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m13:05:21.398734 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.328 seconds
[0m13:05:21.398734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m13:05:21.446453 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m13:05:21.446453 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m13:05:21.851327 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.408 seconds
[0m13:05:21.851327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '083071f7-2b82-4f2a-8160-42a6b1e065e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7DADE480>]}
[0m13:05:21.867324 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m13:05:21.867324 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m13:05:21.867324 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m13:05:21.867324 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m13:05:21.867324 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m13:05:21.867324 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m13:05:21.913979 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m13:05:21.913979 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m13:05:21.913979 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        t.customer_id,
        c.customer_name,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    LEFT JOIN HEALTHCARE.stage.stg_customers AS c 
    ON c.customer_id = t.customer_id
    GROUP BY t.customer_id, c.customer_name
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
customer_status AS (
    SELECT
        flp.customer_id,
        flp.customer_name,
        flp.first_purchase_date,
        flp.last_purchase_date, 
        CASE
            WHEN flp.last_purchase_date < DATEADD(month, -3, mmo.max_date) THEN 1
            ELSE 0
        END AS churned_customer,
        CASE
            WHEN flp.first_purchase_date > DATEADD(month, -3, mmo.max_date) THEN 1
            ELSE 0
        END AS new_customer
    FROM first_last_purchase AS flp
    CROSS JOIN max_min_overall AS mmo
),
customer_status_over_time AS (
    SELECT
        DATE_TRUNC('month', flp.first_purchase_date) AS month,
        SUM(cs.churned_customer) AS churned_customers,
        SUM(cs.new_customer) AS new_customers
    FROM customer_status AS cs
    JOIN first_last_purchase AS flp ON cs.customer_id = flp.customer_id
    GROUP BY month
)
SELECT 
    month,
    churned_customers,
    new_customers
FROM 
    customer_status_over_time
ORDER BY 
    month
        );
[0m13:05:21.913979 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:05:24.581110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.669 seconds
[0m13:05:24.609193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '083071f7-2b82-4f2a-8160-42a6b1e065e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7DC1A780>]}
[0m13:05:24.609193 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 2.74s]
[0m13:05:24.609193 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m13:05:24.612885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:24.612885 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m13:05:24.612885 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m13:05:25.140925 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m13:05:25.140925 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m13:05:25.665219 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m13:05:25.665219 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m13:05:26.653829 [info ] [MainThread]: 
[0m13:05:26.653829 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.05 seconds (9.05s).
[0m13:05:26.653829 [debug] [MainThread]: Command end result
[0m13:05:26.684360 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m13:05:26.684360 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m13:05:26.697360 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m13:05:26.697360 [info ] [MainThread]: 
[0m13:05:26.697360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:05:26.697360 [info ] [MainThread]: 
[0m13:05:26.697360 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:05:26.697360 [debug] [MainThread]: Command `dbt run` succeeded at 13:05:26.697360 after 10.78 seconds
[0m13:05:26.697360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7B4F7EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7B5DC3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD7B0CCCE0>]}
[0m13:05:26.697360 [debug] [MainThread]: Flushing usage events
[0m13:05:27.661339 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:09.085565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B6B12780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B6B12300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B6B12330>]}


============================== 14:04:09.092612 | 8986109d-bc06-492f-b8fb-d48a970e2f6e ==============================
[0m14:04:09.092612 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:04:09.092612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:09.838410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8986109d-bc06-492f-b8fb-d48a970e2f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B7964B00>]}
[0m14:04:09.897760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8986109d-bc06-492f-b8fb-d48a970e2f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B675F110>]}
[0m14:04:09.897760 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:04:10.370358 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:04:11.791861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:11.791861 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m14:04:12.033351 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:04:12.049038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8986109d-bc06-492f-b8fb-d48a970e2f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B8F30680>]}
[0m14:04:12.126757 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:04:12.148652 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:04:12.192298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8986109d-bc06-492f-b8fb-d48a970e2f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B8ED0950>]}
[0m14:04:12.192298 [info ] [MainThread]: Found 1 seed, 7 models, 4 sources, 477 macros
[0m14:04:12.192298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8986109d-bc06-492f-b8fb-d48a970e2f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B8A36CF0>]}
[0m14:04:12.192298 [info ] [MainThread]: 
[0m14:04:12.192298 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:12.192298 [info ] [MainThread]: 
[0m14:04:12.205783 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:04:12.206744 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:04:15.538447 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:04:15.541394 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:04:15.541394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:17.829186 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.292 seconds
[0m14:04:17.829186 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m14:04:17.845247 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:04:17.845247 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:04:17.845247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:19.299058 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.460 seconds
[0m14:04:19.314869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m14:04:19.318168 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:04:19.318168 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:04:19.702541 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.383 seconds
[0m14:04:19.702541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m14:04:19.750147 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:04:19.750147 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:04:20.126842 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.375 seconds
[0m14:04:20.126842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8986109d-bc06-492f-b8fb-d48a970e2f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B941AC90>]}
[0m14:04:20.142493 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m14:04:20.142493 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m14:04:20.142493 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m14:04:20.142493 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m14:04:20.142493 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m14:04:20.142493 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m14:04:20.184224 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m14:04:20.188405 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m14:04:20.188405 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    GROUP BY customer_id
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
customer_status AS (
    SELECT
        flp.customer_id,
        flp.first_purchase_date,
        flp.last_purchase_date, 
        CASE
            WHEN flp.last_purchase_date < DATEADD(month, -3, mmo.max_date) THEN 1
            ELSE 0
        END AS churned_customer,
        CASE
            WHEN flp.first_purchase_date > DATEADD(month, -3, mmo.max_date) THEN 1
            ELSE 0
        END AS new_customer
    FROM first_last_purchase AS flp
    CROSS JOIN max_min_overall AS mmo
),
customer_status_over_time AS (
    SELECT
        DATE_TRUNC('month', flp.first_purchase_date) AS month,
        SUM(cs.churned_customer) AS churned_customers,
        SUM(cs.new_customer) AS new_customers
    FROM customer_status AS cs
    JOIN first_last_purchase AS flp ON cs.customer_id = flp.customer_id
    GROUP BY month
)
SELECT 
    month,
    churned_customers,
    new_customers
FROM 
    customer_status_over_time
ORDER BY 
    month
        );
[0m14:04:20.189400 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:23.116424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.938 seconds
[0m14:04:23.149790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8986109d-bc06-492f-b8fb-d48a970e2f6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B8BD0230>]}
[0m14:04:23.149790 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 3.01s]
[0m14:04:23.149790 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m14:04:23.149790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:23.149790 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:04:23.149790 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:04:23.698403 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m14:04:23.709352 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m14:04:24.233562 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m14:04:24.245054 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m14:04:24.799288 [info ] [MainThread]: 
[0m14:04:24.799288 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.59 seconds (12.59s).
[0m14:04:24.799288 [debug] [MainThread]: Command end result
[0m14:04:24.834377 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:04:24.837098 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:04:24.844693 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:04:24.844693 [info ] [MainThread]: 
[0m14:04:24.844693 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:24.848029 [info ] [MainThread]: 
[0m14:04:24.848029 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:04:24.848029 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:24.848029 after 16.03 seconds
[0m14:04:24.848029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B60B5CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B65560F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7B93F3A40>]}
[0m14:04:24.848029 [debug] [MainThread]: Flushing usage events
[0m14:04:25.883816 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:28.923656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A148778EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A148778680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A148778380>]}


============================== 14:09:28.929209 | 120f6032-4288-4e8a-9ecb-5206e57f8171 ==============================
[0m14:09:28.929209 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:09:28.929209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:rank_product_revenue', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:09:29.474006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '120f6032-4288-4e8a-9ecb-5206e57f8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A147CC2570>]}
[0m14:09:29.537440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '120f6032-4288-4e8a-9ecb-5206e57f8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1493B8740>]}
[0m14:09:29.537440 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:09:30.010267 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:09:31.400403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m14:09:31.400403 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Mart\rank_product_revenue.sql
[0m14:09:31.400403 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m14:09:31.658550 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:09:31.673456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '120f6032-4288-4e8a-9ecb-5206e57f8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A14A9F9A00>]}
[0m14:09:31.745082 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:09:31.773830 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:09:31.809488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '120f6032-4288-4e8a-9ecb-5206e57f8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A14AB02030>]}
[0m14:09:31.810489 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:09:31.811256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '120f6032-4288-4e8a-9ecb-5206e57f8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A14A64B140>]}
[0m14:09:31.812823 [info ] [MainThread]: 
[0m14:09:31.812823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:09:31.814026 [info ] [MainThread]: 
[0m14:09:31.815025 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:09:31.816023 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:09:35.065241 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:09:35.066250 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:09:35.066250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:36.992426 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.927 seconds
[0m14:09:37.000447 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m14:09:37.008210 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:09:37.008210 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:09:37.008210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:38.531028 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.524 seconds
[0m14:09:38.531028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m14:09:38.578984 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:09:38.578984 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:09:38.976647 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.388 seconds
[0m14:09:38.978813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m14:09:38.980819 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:09:38.980819 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:09:39.320881 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.339 seconds
[0m14:09:39.321931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '120f6032-4288-4e8a-9ecb-5206e57f8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A14AD6D5E0>]}
[0m14:09:39.321931 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m14:09:39.321931 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_product_revenue ......................... [RUN]
[0m14:09:39.321931 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_product_revenue'
[0m14:09:39.321931 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m14:09:39.337706 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m14:09:39.339736 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m14:09:39.369373 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m14:09:39.369373 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m14:09:39.369373 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

WITH cte_product_revenue AS (
    SELECT 
        product_id,
        SUM(revenue) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions 
    INNER JOIN HEALTHCARE.stage.stg_products 
    ON product_id
    GROUP BY product_id
)
SELECT 
    product_id,
    total_revenue,
    RANK() OVER(ORDER BY total_revenue DESC) AS product_rank
FROM cte_product_revenue
        );
[0m14:09:39.369373 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:09:41.021247 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa7-0004-c0bd-0005-a3d30003b606
[0m14:09:41.021247 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'PRODUCT_ID'
[0m14:09:41.037301 [debug] [Thread-1 (]: Database Error in model rank_product_revenue (models\Mart\rank_product_revenue.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'PRODUCT_ID'
  compiled code at target\run\dbt_first\models\Mart\rank_product_revenue.sql
[0m14:09:41.037301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '120f6032-4288-4e8a-9ecb-5206e57f8171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A147C30AA0>]}
[0m14:09:41.037301 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.rank_product_revenue ................ [[31mERROR[0m in 1.72s]
[0m14:09:41.037301 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m14:09:41.037301 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.rank_product_revenue' to be skipped because of status 'error'.  Reason: Database Error in model rank_product_revenue (models\Mart\rank_product_revenue.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'PRODUCT_ID'
  compiled code at target\run\dbt_first\models\Mart\rank_product_revenue.sql.
[0m14:09:41.037301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:41.037301 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:09:41.037301 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:09:41.586791 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m14:09:41.586791 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m14:09:42.107038 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was left open.
[0m14:09:42.107038 [debug] [MainThread]: On model.dbt_first.rank_product_revenue: Close
[0m14:09:42.624816 [info ] [MainThread]: 
[0m14:09:42.624816 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.81 seconds (10.81s).
[0m14:09:42.624816 [debug] [MainThread]: Command end result
[0m14:09:42.655360 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:09:42.658368 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:09:42.666566 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:09:42.667540 [info ] [MainThread]: 
[0m14:09:42.668505 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:09:42.668505 [info ] [MainThread]: 
[0m14:09:42.669518 [error] [MainThread]:   Database Error in model rank_product_revenue (models\Mart\rank_product_revenue.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'PRODUCT_ID'
  compiled code at target\run\dbt_first\models\Mart\rank_product_revenue.sql
[0m14:09:42.669518 [info ] [MainThread]: 
[0m14:09:42.669518 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:09:42.669518 [debug] [MainThread]: Command `dbt run` failed at 14:09:42.669518 after 13.94 seconds
[0m14:09:42.672795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A147CC2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A14AE6AF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A145E8F290>]}
[0m14:09:42.673861 [debug] [MainThread]: Flushing usage events
[0m14:09:44.028247 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:38.965542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6600E1E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F66593B440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F663151190>]}


============================== 14:12:38.965542 | 586e625b-0d83-4f0d-921a-7077b16d3c71 ==============================
[0m14:12:38.965542 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:12:38.965542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:rank_product_revenue', 'send_anonymous_usage_stats': 'True'}
[0m14:12:39.455313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '586e625b-0d83-4f0d-921a-7077b16d3c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F66322AE10>]}
[0m14:12:39.514456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '586e625b-0d83-4f0d-921a-7077b16d3c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6653C6300>]}
[0m14:12:39.516463 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:12:39.885732 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:12:40.080164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:12:40.080164 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m14:12:40.332419 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:12:40.347886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '586e625b-0d83-4f0d-921a-7077b16d3c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F668179490>]}
[0m14:12:40.417201 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:12:40.417201 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:12:40.450474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '586e625b-0d83-4f0d-921a-7077b16d3c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F668109220>]}
[0m14:12:40.464167 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:12:40.464167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '586e625b-0d83-4f0d-921a-7077b16d3c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F667F048C0>]}
[0m14:12:40.464167 [info ] [MainThread]: 
[0m14:12:40.464167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:40.464167 [info ] [MainThread]: 
[0m14:12:40.464167 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:12:40.464167 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:12:40.574935 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:12:40.574935 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:12:40.575935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:42.727045 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.153 seconds
[0m14:12:42.732694 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m14:12:42.742666 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:12:42.744723 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:12:42.744723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:44.242472 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.500 seconds
[0m14:12:44.242472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m14:12:44.242472 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:12:44.242472 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:12:44.595880 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.345 seconds
[0m14:12:44.602478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m14:12:44.662604 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:12:44.662604 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:12:45.035011 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.365 seconds
[0m14:12:45.037527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '586e625b-0d83-4f0d-921a-7077b16d3c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6669D8920>]}
[0m14:12:45.042581 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m14:12:45.042581 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_product_revenue ......................... [RUN]
[0m14:12:45.042581 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_product_revenue'
[0m14:12:45.042581 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m14:12:45.053298 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m14:12:45.054836 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m14:12:45.082379 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m14:12:45.087127 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m14:12:45.088135 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

WITH cte_product_revenue AS (
    SELECT 
        t.product_id,
        SUM(revenue) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions  AS t
    INNER JOIN HEALTHCARE.stage.stg_products AS p
    ON t.product_id = p.product_id
    GROUP BY t.product_id
)
SELECT 
    product_id,
    total_revenue,
    RANK() OVER(ORDER BY total_revenue DESC) AS product_rank
FROM cte_product_revenue
        );
[0m14:12:45.088135 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:12:47.462950 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.380 seconds
[0m14:12:47.487577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '586e625b-0d83-4f0d-921a-7077b16d3c71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F663229E50>]}
[0m14:12:47.487577 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_product_revenue .................... [[32mSUCCESS 1[0m in 2.44s]
[0m14:12:47.487577 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m14:12:47.492640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:47.492640 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:12:47.492640 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:12:48.029086 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m14:12:48.029086 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m14:12:48.552883 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was left open.
[0m14:12:48.552883 [debug] [MainThread]: On model.dbt_first.rank_product_revenue: Close
[0m14:12:49.074624 [info ] [MainThread]: 
[0m14:12:49.076646 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.61 seconds (8.61s).
[0m14:12:49.082847 [debug] [MainThread]: Command end result
[0m14:12:49.107580 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:12:49.110810 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:12:49.116895 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:12:49.116895 [info ] [MainThread]: 
[0m14:12:49.116895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:49.116895 [info ] [MainThread]: 
[0m14:12:49.116895 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:12:49.116895 [debug] [MainThread]: Command `dbt run` succeeded at 14:12:49.116895 after 10.31 seconds
[0m14:12:49.116895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6600E1E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F66599CF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F66599E0F0>]}
[0m14:12:49.122573 [debug] [MainThread]: Flushing usage events
[0m14:12:50.462606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:18.809462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EF715940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EF7144D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EF714980>]}


============================== 14:17:18.815481 | 4a716841-5f10-4775-ab4c-ac62b0f17160 ==============================
[0m14:17:18.815481 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:17:18.817229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:rank_product_revenue', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:17:19.288029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a716841-5f10-4775-ab4c-ac62b0f17160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EF731FD0>]}
[0m14:17:19.360168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a716841-5f10-4775-ab4c-ac62b0f17160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F0447C80>]}
[0m14:17:19.362173 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:17:19.726958 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:17:19.915639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:17:19.915639 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m14:17:20.166241 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:17:20.188206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a716841-5f10-4775-ab4c-ac62b0f17160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F1A09280>]}
[0m14:17:20.261449 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:17:20.261449 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:17:20.298381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a716841-5f10-4775-ab4c-ac62b0f17160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F19951C0>]}
[0m14:17:20.300389 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:17:20.300389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a716841-5f10-4775-ab4c-ac62b0f17160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F18D9AF0>]}
[0m14:17:20.302396 [info ] [MainThread]: 
[0m14:17:20.302396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:17:20.302396 [info ] [MainThread]: 
[0m14:17:20.302396 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:17:20.302396 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:17:20.408134 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:17:20.408134 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:17:20.409132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:22.378078 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.969 seconds
[0m14:17:22.382130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m14:17:22.382130 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:17:22.382130 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:17:22.382130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:23.923769 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.536 seconds
[0m14:17:23.923769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m14:17:23.923769 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:17:23.923769 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:17:24.265026 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.333 seconds
[0m14:17:24.265026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m14:17:24.312647 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:17:24.312647 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:17:24.668110 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.354 seconds
[0m14:17:24.668110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a716841-5f10-4775-ab4c-ac62b0f17160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F1FBB170>]}
[0m14:17:24.683955 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m14:17:24.683955 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_product_revenue ......................... [RUN]
[0m14:17:24.683955 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_product_revenue'
[0m14:17:24.683955 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m14:17:24.693161 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m14:17:24.693161 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m14:17:24.717716 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m14:17:24.717716 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m14:17:24.717716 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

WITH cte_product_revenue AS (
    SELECT 
        product_id
        SUM(revenue) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions 
    GROUP BY 
        product_id
)
SELECT 
    pr.product_id,
    p.product_family,
    p.product_sub_family,
    pr.total_revenue,
    DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS product_rank
FROM cte_product_revenue AS pr
INNER JOIN HEALTHCARE.stage.stg_products AS p
ON pr.product_id = p.product_id
        );
[0m14:17:24.717716 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:17:26.172692 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffaf-0004-c0bd-0005-a3d30003b65a
[0m14:17:26.172692 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 11 unexpected '('.
syntax error line 8 at position 12 unexpected 'revenue'.
syntax error line 8 at position 21 unexpected 'AS'.
syntax error line 18 at position 49 unexpected ')'.
[0m14:17:26.172692 [debug] [Thread-1 (]: Database Error in model rank_product_revenue (models\Mart\rank_product_revenue.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 11 unexpected '('.
  syntax error line 8 at position 12 unexpected 'revenue'.
  syntax error line 8 at position 21 unexpected 'AS'.
  syntax error line 18 at position 49 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\rank_product_revenue.sql
[0m14:17:26.172692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a716841-5f10-4775-ab4c-ac62b0f17160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190EEBC0770>]}
[0m14:17:26.172692 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.rank_product_revenue ................ [[31mERROR[0m in 1.49s]
[0m14:17:26.172692 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m14:17:26.172692 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.rank_product_revenue' to be skipped because of status 'error'.  Reason: Database Error in model rank_product_revenue (models\Mart\rank_product_revenue.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 11 unexpected '('.
  syntax error line 8 at position 12 unexpected 'revenue'.
  syntax error line 8 at position 21 unexpected 'AS'.
  syntax error line 18 at position 49 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\rank_product_revenue.sql.
[0m14:17:26.172692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:26.188626 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:17:26.188626 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:17:26.720165 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m14:17:26.720165 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m14:17:27.247173 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was left open.
[0m14:17:27.247173 [debug] [MainThread]: On model.dbt_first.rank_product_revenue: Close
[0m14:17:27.774900 [info ] [MainThread]: 
[0m14:17:27.774900 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.47 seconds (7.47s).
[0m14:17:27.774900 [debug] [MainThread]: Command end result
[0m14:17:27.808961 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:17:27.810341 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:17:27.821638 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:17:27.822815 [info ] [MainThread]: 
[0m14:17:27.824602 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:17:27.824602 [info ] [MainThread]: 
[0m14:17:27.825774 [error] [MainThread]:   Database Error in model rank_product_revenue (models\Mart\rank_product_revenue.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 11 unexpected '('.
  syntax error line 8 at position 12 unexpected 'revenue'.
  syntax error line 8 at position 21 unexpected 'AS'.
  syntax error line 18 at position 49 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\rank_product_revenue.sql
[0m14:17:27.826782 [info ] [MainThread]: 
[0m14:17:27.826782 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:17:27.827781 [debug] [MainThread]: Command `dbt run` failed at 14:17:27.827781 after 9.25 seconds
[0m14:17:27.828812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F1A09910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190F026BB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190ECA68890>]}
[0m14:17:27.828812 [debug] [MainThread]: Flushing usage events
[0m14:17:28.880407 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:42.829148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015830DEE360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158347DE420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001583486F560>]}


============================== 14:18:42.829148 | 4558854e-a90a-44d0-8188-413aff38e743 ==============================
[0m14:18:42.829148 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:18:42.829148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:rank_product_revenue', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:43.351627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4558854e-a90a-44d0-8188-413aff38e743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015835AC4B00>]}
[0m14:18:43.425275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4558854e-a90a-44d0-8188-413aff38e743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015835852780>]}
[0m14:18:43.427314 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:18:43.995089 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:18:44.199832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:18:44.201837 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m14:18:44.462209 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:18:44.474237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4558854e-a90a-44d0-8188-413aff38e743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015837109640>]}
[0m14:18:44.562763 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:18:44.564892 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:18:44.604025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4558854e-a90a-44d0-8188-413aff38e743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158370951C0>]}
[0m14:18:44.604025 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:18:44.605027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4558854e-a90a-44d0-8188-413aff38e743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158370E7D10>]}
[0m14:18:44.606068 [info ] [MainThread]: 
[0m14:18:44.607058 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:18:44.608027 [info ] [MainThread]: 
[0m14:18:44.608027 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:18:44.609057 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:18:44.697857 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:18:44.697857 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:18:44.697857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:46.613107 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.904 seconds
[0m14:18:46.618868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m14:18:46.618868 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:18:46.618868 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:18:46.618868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:48.162369 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.541 seconds
[0m14:18:48.162369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m14:18:48.162369 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:18:48.162369 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:18:48.502469 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.326 seconds
[0m14:18:48.509825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m14:18:48.603172 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:18:48.603172 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:18:48.966564 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.366 seconds
[0m14:18:48.966564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4558854e-a90a-44d0-8188-413aff38e743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158374B5730>]}
[0m14:18:48.966564 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m14:18:48.966564 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_product_revenue ......................... [RUN]
[0m14:18:48.966564 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_product_revenue'
[0m14:18:48.966564 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m14:18:48.983292 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m14:18:48.983292 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m14:18:49.017766 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m14:18:49.017766 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m14:18:49.017766 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

WITH cte_product_revenue AS (
    SELECT 
        product_id,
        SUM(revenue) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions 
    GROUP BY 
        product_id
)
SELECT 
    pr.product_id,
    p.product_family,
    p.product_sub_family,
    pr.total_revenue,
    DENSE_RANK() OVER(ORDER BY pr.total_revenue DESC) AS product_rank
FROM cte_product_revenue AS pr
INNER JOIN HEALTHCARE.stage.stg_products AS p
ON pr.product_id = p.product_id
        );
[0m14:18:49.017766 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:18:51.301783 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.279 seconds
[0m14:18:51.316785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4558854e-a90a-44d0-8188-413aff38e743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001583210DA30>]}
[0m14:18:51.316785 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_product_revenue .................... [[32mSUCCESS 1[0m in 2.35s]
[0m14:18:51.316785 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m14:18:51.316785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:51.330385 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:18:51.330385 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:18:51.845668 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m14:18:51.845668 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m14:18:52.365975 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was left open.
[0m14:18:52.367996 [debug] [MainThread]: On model.dbt_first.rank_product_revenue: Close
[0m14:18:52.938807 [info ] [MainThread]: 
[0m14:18:52.938807 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.33 seconds (8.33s).
[0m14:18:52.938807 [debug] [MainThread]: Command end result
[0m14:18:52.973135 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:18:52.976135 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:18:52.984144 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:18:52.984144 [info ] [MainThread]: 
[0m14:18:52.984144 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:52.984144 [info ] [MainThread]: 
[0m14:18:52.986727 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:18:52.989742 [debug] [MainThread]: Command `dbt run` succeeded at 14:18:52.988751 after 10.36 seconds
[0m14:18:52.990772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158357A0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015834BF87D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158348D5A90>]}
[0m14:18:52.990772 [debug] [MainThread]: Flushing usage events
[0m14:18:54.009420 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:41.630918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166BE9447A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166BD930A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166BE944EF0>]}


============================== 14:21:41.638670 | 8980b354-0152-46fb-95b5-5f8408e96085 ==============================
[0m14:21:41.638670 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:21:41.638670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:rank_product_revenue', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:21:42.223457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8980b354-0152-46fb-95b5-5f8408e96085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166BF360500>]}
[0m14:21:42.290379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8980b354-0152-46fb-95b5-5f8408e96085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166BDDBDEE0>]}
[0m14:21:42.292385 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:21:42.772923 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:21:44.167016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:21:44.167016 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m14:21:44.416033 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:21:44.429612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8980b354-0152-46fb-95b5-5f8408e96085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166C0B5D760>]}
[0m14:21:44.508558 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:21:44.525359 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:21:44.556668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8980b354-0152-46fb-95b5-5f8408e96085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166C0B13F80>]}
[0m14:21:44.556668 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:21:44.557667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8980b354-0152-46fb-95b5-5f8408e96085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166C0B9B140>]}
[0m14:21:44.558698 [info ] [MainThread]: 
[0m14:21:44.559693 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:21:44.560667 [info ] [MainThread]: 
[0m14:21:44.560667 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:21:44.561681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:21:47.428751 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:21:47.428751 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:21:47.428751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:49.607923 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.190 seconds
[0m14:21:49.623722 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m14:21:49.633618 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:21:49.633618 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:21:49.635624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:51.726533 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.097 seconds
[0m14:21:51.733748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m14:21:51.735756 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:21:51.735756 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:21:52.047804 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.321 seconds
[0m14:21:52.062183 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m14:21:52.113352 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:21:52.113352 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:21:52.433880 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.331 seconds
[0m14:21:52.449655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8980b354-0152-46fb-95b5-5f8408e96085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166C10EA000>]}
[0m14:21:52.449655 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m14:21:52.449655 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_product_revenue ......................... [RUN]
[0m14:21:52.449655 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_product_revenue'
[0m14:21:52.465340 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m14:21:52.473375 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m14:21:52.475381 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m14:21:52.504526 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m14:21:52.504526 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m14:21:52.504526 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

WITH cte_product_revenue AS (
    SELECT 
        product_id,
        SUM(revenue) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions 
    GROUP BY 
        product_id
)
SELECT 
    pr.product_id,
    p.product_family,
    pr.total_revenue,
    DENSE_RANK() OVER(ORDER BY pr.total_revenue DESC) AS product_rank
FROM cte_product_revenue AS pr
INNER JOIN HEALTHCARE.stage.stg_products AS p
ON pr.product_id = p.product_id
group by pr.product_id, p.product_family, pr.total_revenue
        );
[0m14:21:52.504526 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:21:55.008786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.508 seconds
[0m14:21:55.040661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8980b354-0152-46fb-95b5-5f8408e96085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166BBCFDB20>]}
[0m14:21:55.042672 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_product_revenue .................... [[32mSUCCESS 1[0m in 2.57s]
[0m14:21:55.042672 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m14:21:55.042672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:55.042672 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:21:55.042672 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:21:55.602769 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m14:21:55.602769 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m14:21:56.136291 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was left open.
[0m14:21:56.136291 [debug] [MainThread]: On model.dbt_first.rank_product_revenue: Close
[0m14:21:56.676693 [info ] [MainThread]: 
[0m14:21:56.676693 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.12 seconds (12.12s).
[0m14:21:56.676693 [debug] [MainThread]: Command end result
[0m14:21:56.709772 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:21:56.712760 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:21:56.713761 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:21:56.713761 [info ] [MainThread]: 
[0m14:21:56.720864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:56.722863 [info ] [MainThread]: 
[0m14:21:56.723861 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:21:56.724857 [debug] [MainThread]: Command `dbt run` succeeded at 14:21:56.724857 after 15.30 seconds
[0m14:21:56.725857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166BD9E5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166C0A5DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166C0A7E090>]}
[0m14:21:56.726810 [debug] [MainThread]: Flushing usage events
[0m14:21:57.765717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:50.986841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E6C8CE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E6C8D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E6C8CDD0>]}


============================== 14:23:51.000517 | 7142471b-6665-48d4-888e-cabc5464eb20 ==============================
[0m14:23:51.000517 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:23:51.001566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:rank_product_revenue', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:51.449576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7142471b-6665-48d4-888e-cabc5464eb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E406EF00>]}
[0m14:23:51.497491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7142471b-6665-48d4-888e-cabc5464eb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E6CD1D30>]}
[0m14:23:51.497491 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:23:51.854446 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:23:52.053517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:52.054516 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m14:23:52.288929 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:23:52.305817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7142471b-6665-48d4-888e-cabc5464eb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E8FB92B0>]}
[0m14:23:52.378275 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:23:52.384839 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:23:52.416795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7142471b-6665-48d4-888e-cabc5464eb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E8F97E90>]}
[0m14:23:52.416795 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:23:52.416795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7142471b-6665-48d4-888e-cabc5464eb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E8AD3260>]}
[0m14:23:52.416795 [info ] [MainThread]: 
[0m14:23:52.416795 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:52.416795 [info ] [MainThread]: 
[0m14:23:52.416795 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:23:52.416795 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:23:52.517805 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:23:52.517805 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:23:52.518730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:54.632326 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.113 seconds
[0m14:23:54.632326 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m14:23:54.648424 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:23:54.648424 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:23:54.648424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:56.150956 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.502 seconds
[0m14:23:56.150956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m14:23:56.150956 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:23:56.150956 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:23:56.492968 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.337 seconds
[0m14:23:56.492968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m14:23:56.540328 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:23:56.540328 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:23:56.906209 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.363 seconds
[0m14:23:56.908214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7142471b-6665-48d4-888e-cabc5464eb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E8FF4890>]}
[0m14:23:56.908214 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m14:23:56.908214 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_product_revenue ......................... [RUN]
[0m14:23:56.908214 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_product_revenue'
[0m14:23:56.908214 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m14:23:56.922858 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m14:23:56.924633 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m14:23:56.955199 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m14:23:56.957215 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m14:23:56.958214 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

WITH product_revenue AS (
   
    SELECT
        p.product_id,
        COALESCE(SUM(t.revenue),0) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions t
    RIGHT JOIN HEALTHCARE.stage.stg_products p ON t.product_id = p.product_id
    GROUP BY p.product_id
),
 
ranked_products AS (
   
    SELECT
        product_id,
        total_revenue,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM product_revenue
)
 
SELECT * FROM ranked_products
        );
[0m14:23:56.958214 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:23:59.071760 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.119 seconds
[0m14:23:59.092746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7142471b-6665-48d4-888e-cabc5464eb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E406DF40>]}
[0m14:23:59.092746 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_product_revenue .................... [[32mSUCCESS 1[0m in 2.18s]
[0m14:23:59.103263 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m14:23:59.103263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:59.103263 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:23:59.103263 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:23:59.624178 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m14:23:59.624178 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m14:24:00.144489 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was left open.
[0m14:24:00.144489 [debug] [MainThread]: On model.dbt_first.rank_product_revenue: Close
[0m14:24:00.689334 [info ] [MainThread]: 
[0m14:24:00.691344 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.27 seconds (8.27s).
[0m14:24:00.691344 [debug] [MainThread]: Command end result
[0m14:24:00.715590 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:24:00.717590 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:24:00.717590 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:24:00.717590 [info ] [MainThread]: 
[0m14:24:00.717590 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:00.717590 [info ] [MainThread]: 
[0m14:24:00.727282 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:24:00.727282 [debug] [MainThread]: Command `dbt run` succeeded at 14:24:00.727282 after 9.97 seconds
[0m14:24:00.729289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E6D3AF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E8818740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E8D6E8A0>]}
[0m14:24:00.731305 [debug] [MainThread]: Flushing usage events
[0m14:24:01.702637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:25.940344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7710966C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C772FCB770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7710967B0>]}


============================== 14:25:25.953571 | 35d04cb6-ccf8-43e9-b9ff-28925b483c00 ==============================
[0m14:25:25.953571 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:25:25.956090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:rank_product_revenue', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:25:26.410586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35d04cb6-ccf8-43e9-b9ff-28925b483c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C774097B60>]}
[0m14:25:26.458654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35d04cb6-ccf8-43e9-b9ff-28925b483c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C774117BC0>]}
[0m14:25:26.458654 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:25:26.831303 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:25:27.009289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:25:27.009289 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m14:25:27.246617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:25:27.262363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35d04cb6-ccf8-43e9-b9ff-28925b483c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C772757B90>]}
[0m14:25:27.346942 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:25:27.346942 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:25:27.378801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35d04cb6-ccf8-43e9-b9ff-28925b483c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77544D160>]}
[0m14:25:27.378801 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:25:27.378801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35d04cb6-ccf8-43e9-b9ff-28925b483c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7756A3FE0>]}
[0m14:25:27.383221 [info ] [MainThread]: 
[0m14:25:27.383221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:27.383221 [info ] [MainThread]: 
[0m14:25:27.383221 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:25:27.383221 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:25:27.482133 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:25:27.482133 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:25:27.483133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:29.500286 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.018 seconds
[0m14:25:29.500286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m14:25:29.516433 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:25:29.516433 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:25:29.516433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:31.053705 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.549 seconds
[0m14:25:31.069631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m14:25:31.069631 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:25:31.069631 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:25:31.412839 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.343 seconds
[0m14:25:31.412839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m14:25:31.458275 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:25:31.458275 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:25:31.830481 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.364 seconds
[0m14:25:31.830481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35d04cb6-ccf8-43e9-b9ff-28925b483c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C770733740>]}
[0m14:25:31.830481 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m14:25:31.830481 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_product_revenue ......................... [RUN]
[0m14:25:31.830481 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_product_revenue'
[0m14:25:31.830481 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m14:25:31.847739 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m14:25:31.847739 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m14:25:31.884190 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m14:25:31.885060 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m14:25:31.885060 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

WITH cte_product_revenue AS (
    SELECT 
        product_id
        SUM(revenue) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions 
    GROUP BY product_id
)
SELECT 
    product_id,
    total_revenue,
    DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS product_rank
FROM cte_product_revenue
        );
[0m14:25:31.885060 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:25:33.509279 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffb7-0004-bb9f-0005-a3d30003c2ea
[0m14:25:33.509279 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 11 unexpected '('.
syntax error line 8 at position 12 unexpected 'revenue'.
syntax error line 8 at position 21 unexpected 'AS'.
syntax error line 15 at position 49 unexpected ')'.
[0m14:25:33.524972 [debug] [Thread-1 (]: Database Error in model rank_product_revenue (models\Mart\rank_product_revenue.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 11 unexpected '('.
  syntax error line 8 at position 12 unexpected 'revenue'.
  syntax error line 8 at position 21 unexpected 'AS'.
  syntax error line 15 at position 49 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\rank_product_revenue.sql
[0m14:25:33.524972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35d04cb6-ccf8-43e9-b9ff-28925b483c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7727A0B00>]}
[0m14:25:33.540980 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.rank_product_revenue ................ [[31mERROR[0m in 1.69s]
[0m14:25:33.540980 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m14:25:33.540980 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.rank_product_revenue' to be skipped because of status 'error'.  Reason: Database Error in model rank_product_revenue (models\Mart\rank_product_revenue.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 11 unexpected '('.
  syntax error line 8 at position 12 unexpected 'revenue'.
  syntax error line 8 at position 21 unexpected 'AS'.
  syntax error line 15 at position 49 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\rank_product_revenue.sql.
[0m14:25:33.540980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:33.540980 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:25:33.540980 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:25:34.062401 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m14:25:34.062401 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m14:25:34.581575 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was left open.
[0m14:25:34.581575 [debug] [MainThread]: On model.dbt_first.rank_product_revenue: Close
[0m14:25:35.113518 [info ] [MainThread]: 
[0m14:25:35.113518 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.73 seconds (7.73s).
[0m14:25:35.113518 [debug] [MainThread]: Command end result
[0m14:25:35.145175 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:25:35.145175 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:25:35.156371 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:25:35.156371 [info ] [MainThread]: 
[0m14:25:35.157371 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:25:35.158369 [info ] [MainThread]: 
[0m14:25:35.159369 [error] [MainThread]:   Database Error in model rank_product_revenue (models\Mart\rank_product_revenue.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 11 unexpected '('.
  syntax error line 8 at position 12 unexpected 'revenue'.
  syntax error line 8 at position 21 unexpected 'AS'.
  syntax error line 15 at position 49 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\rank_product_revenue.sql
[0m14:25:35.159876 [info ] [MainThread]: 
[0m14:25:35.159876 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:25:35.164005 [debug] [MainThread]: Command `dbt run` failed at 14:25:35.159876 after 9.43 seconds
[0m14:25:35.164005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7709FF560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77558BA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C773E77110>]}
[0m14:25:35.164005 [debug] [MainThread]: Flushing usage events
[0m14:25:36.212279 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:27:10.302277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACFB7C7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACFB7CDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACFB7C800>]}


============================== 14:27:10.302277 | 5a6b3176-43e6-4769-bf7c-bb6bfa015e6d ==============================
[0m14:27:10.302277 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:27:10.302277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:rank_product_revenue', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:10.757006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a6b3176-43e6-4769-bf7c-bb6bfa015e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AD1887140>]}
[0m14:27:10.820354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a6b3176-43e6-4769-bf7c-bb6bfa015e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACF044410>]}
[0m14:27:10.820354 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:27:11.164300 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:27:11.354836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:27:11.354836 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m14:27:11.592892 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:27:11.608826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a6b3176-43e6-4769-bf7c-bb6bfa015e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AD1ED9610>]}
[0m14:27:11.692879 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:27:11.692879 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:27:11.716213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a6b3176-43e6-4769-bf7c-bb6bfa015e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AD1E711C0>]}
[0m14:27:11.716213 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:27:11.716213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a6b3176-43e6-4769-bf7c-bb6bfa015e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AD1ED9820>]}
[0m14:27:11.716213 [info ] [MainThread]: 
[0m14:27:11.716213 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:11.716213 [info ] [MainThread]: 
[0m14:27:11.732050 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:27:11.732050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:27:11.832044 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:27:11.832044 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:27:11.832044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:13.769138 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.936 seconds
[0m14:27:13.776728 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m14:27:13.785730 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:27:13.785730 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:27:13.785730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:15.315287 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.537 seconds
[0m14:27:15.315287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m14:27:15.328794 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:27:15.328794 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:27:15.652899 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.333 seconds
[0m14:27:15.652899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m14:27:15.704353 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:27:15.704353 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:27:16.029947 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.327 seconds
[0m14:27:16.029947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a6b3176-43e6-4769-bf7c-bb6bfa015e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AD2357AA0>]}
[0m14:27:16.045719 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m14:27:16.045719 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_product_revenue ......................... [RUN]
[0m14:27:16.045719 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_product_revenue'
[0m14:27:16.045719 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m14:27:16.055829 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m14:27:16.055829 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m14:27:16.089882 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m14:27:16.091052 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m14:27:16.092060 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

WITH cte_product_revenue AS (
    SELECT 
        product_id,
        SUM(revenue) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions 
    GROUP BY 
        product_id
)
SELECT 
    product_id,
    total_revenue,
    DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS product_rank
FROM cte_product_revenue
        );
[0m14:27:16.092060 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:27:18.616278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.523 seconds
[0m14:27:18.663847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a6b3176-43e6-4769-bf7c-bb6bfa015e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACF060740>]}
[0m14:27:18.663847 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_product_revenue .................... [[32mSUCCESS 1[0m in 2.62s]
[0m14:27:18.663847 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m14:27:18.663847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:18.663847 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:27:18.663847 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:27:19.188051 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m14:27:19.188051 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m14:27:19.743413 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was left open.
[0m14:27:19.743413 [debug] [MainThread]: On model.dbt_first.rank_product_revenue: Close
[0m14:27:20.304825 [info ] [MainThread]: 
[0m14:27:20.305825 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.57 seconds (8.57s).
[0m14:27:20.306824 [debug] [MainThread]: Command end result
[0m14:27:20.332359 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:27:20.338295 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:27:20.346296 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:27:20.346296 [info ] [MainThread]: 
[0m14:27:20.347297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:20.348298 [info ] [MainThread]: 
[0m14:27:20.348858 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:27:20.348858 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:20.348858 after 10.22 seconds
[0m14:27:20.348858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019ACF044410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AD1BAA060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AD1D2EFF0>]}
[0m14:27:20.351897 [debug] [MainThread]: Flushing usage events
[0m14:27:21.321043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:35.617650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7A1F4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7926F800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B77D613A0>]}


============================== 14:29:35.625002 | a4373339-d946-41bc-aa2e-8a6c50cae565 ==============================
[0m14:29:35.625002 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:29:35.625002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:rank_customer_revenue', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:29:36.075722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4373339-d946-41bc-aa2e-8a6c50cae565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7A1A7D10>]}
[0m14:29:36.127425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4373339-d946-41bc-aa2e-8a6c50cae565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7AEDCDD0>]}
[0m14:29:36.127425 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:29:36.496834 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:29:36.676394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:29:36.676394 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m14:29:36.923538 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:29:36.929180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4373339-d946-41bc-aa2e-8a6c50cae565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7C42D760>]}
[0m14:29:37.012231 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:29:37.012231 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:29:37.043906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4373339-d946-41bc-aa2e-8a6c50cae565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7C4F9310>]}
[0m14:29:37.043906 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:29:37.043906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4373339-d946-41bc-aa2e-8a6c50cae565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7C42DB50>]}
[0m14:29:37.043906 [warn ] [MainThread]: The selection criterion 'tag:rank_customer_revenue' does not match any enabled nodes
[0m14:29:37.043906 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:29:37.043906 [debug] [MainThread]: Command end result
[0m14:29:37.074792 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:29:37.077438 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:29:37.080960 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:29:37.080960 [debug] [MainThread]: Command `dbt run` succeeded at 14:29:37.080960 after 1.69 seconds
[0m14:29:37.082972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B79BE91F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B796A1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7C03AC90>]}
[0m14:29:37.082972 [debug] [MainThread]: Flushing usage events
[0m14:29:38.097858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:45.421358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C31E85820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C31E84230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C31E84560>]}


============================== 14:29:45.421358 | 1c330e57-082a-4166-af3e-d4a900491775 ==============================
[0m14:29:45.421358 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:29:45.421358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:29:45.876300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c330e57-082a-4166-af3e-d4a900491775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C32B57950>]}
[0m14:29:45.939516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c330e57-082a-4166-af3e-d4a900491775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C31F0AF60>]}
[0m14:29:45.939516 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:29:46.292802 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:29:46.457780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:29:46.457780 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:29:46.473824 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:29:46.506440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c330e57-082a-4166-af3e-d4a900491775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C32C86FC0>]}
[0m14:29:46.586851 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:29:46.586851 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:29:46.618456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c330e57-082a-4166-af3e-d4a900491775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C33E98680>]}
[0m14:29:46.618456 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:29:46.618456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c330e57-082a-4166-af3e-d4a900491775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C33FD8DA0>]}
[0m14:29:46.621686 [info ] [MainThread]: 
[0m14:29:46.621686 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:29:46.621686 [info ] [MainThread]: 
[0m14:29:46.621686 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:29:46.621686 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:29:46.725362 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:29:46.725362 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:29:46.725362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:48.640943 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.929 seconds
[0m14:29:48.657081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m14:29:48.657081 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:29:48.657081 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:29:48.672554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:50.279965 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.607 seconds
[0m14:29:50.281974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m14:29:50.283981 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:29:50.283981 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:29:50.642800 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.370 seconds
[0m14:29:50.642800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m14:29:50.659087 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:29:50.659087 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:29:51.017287 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.357 seconds
[0m14:29:51.019984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c330e57-082a-4166-af3e-d4a900491775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C32B568D0>]}
[0m14:29:51.025649 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m14:29:51.026167 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m14:29:51.027229 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m14:29:51.027229 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m14:29:51.035269 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m14:29:51.036269 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m14:29:51.060963 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m14:29:51.060963 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m14:29:51.060963 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (

WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue,
        COUNT(*) AS transaction_count
    FROM HEALTHCARE.stage.stg_transactions t
    LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
    ON 
        t.customer_id = c.customer_id
    where 
        revenue_type = 1 and t.revenue > 0
    GROUP BY 
        t.customer_id, c.customer_name
),
 
ranked_customers AS (
    SELECT
        customer_id,
        customer_name,
        total_revenue,
        transaction_count,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
 
SELECT * FROM ranked_customers
        );
[0m14:29:51.060963 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:29:53.515447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.448 seconds
[0m14:29:53.531562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c330e57-082a-4166-af3e-d4a900491775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2F22D940>]}
[0m14:29:53.531562 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_customers_revenue .................. [[32mSUCCESS 1[0m in 2.50s]
[0m14:29:53.531562 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m14:29:53.531562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:53.531562 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:29:53.531562 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:29:54.066338 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m14:29:54.066338 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m14:29:54.598170 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m14:29:54.598170 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m14:29:55.133565 [info ] [MainThread]: 
[0m14:29:55.133565 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.51 seconds (8.51s).
[0m14:29:55.133565 [debug] [MainThread]: Command end result
[0m14:29:55.152077 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:29:55.164006 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:29:55.168813 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:29:55.168813 [info ] [MainThread]: 
[0m14:29:55.168813 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:29:55.168813 [info ] [MainThread]: 
[0m14:29:55.168813 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:29:55.168813 [debug] [MainThread]: Command `dbt run` succeeded at 14:29:55.168813 after 9.91 seconds
[0m14:29:55.168813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C3190E630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C30F253D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C31BD3B30>]}
[0m14:29:55.168813 [debug] [MainThread]: Flushing usage events
[0m14:29:56.160164 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:49.266134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B9F8DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B9F8D190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B9F8CEF0>]}


============================== 14:34:49.281842 | b0deff07-d014-427a-bd99-d859e1c2cc41 ==============================
[0m14:34:49.281842 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:34:49.281842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:34:49.784387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0deff07-d014-427a-bd99-d859e1c2cc41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294BACD7D10>]}
[0m14:34:49.853135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0deff07-d014-427a-bd99-d859e1c2cc41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294BABF6630>]}
[0m14:34:49.853135 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:34:50.313771 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:34:51.614685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:34:51.614685 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m14:34:51.853848 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:34:51.853848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0deff07-d014-427a-bd99-d859e1c2cc41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294BC2F9460>]}
[0m14:34:51.943243 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:34:51.959248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:34:51.991519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0deff07-d014-427a-bd99-d859e1c2cc41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294BC295130>]}
[0m14:34:51.992151 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:34:51.993040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0deff07-d014-427a-bd99-d859e1c2cc41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294BC0B2ED0>]}
[0m14:34:51.994083 [info ] [MainThread]: 
[0m14:34:51.995331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:51.995331 [info ] [MainThread]: 
[0m14:34:51.996337 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:34:51.997371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:34:54.464099 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:34:54.472522 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:34:54.472522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:56.543634 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.070 seconds
[0m14:34:56.548591 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m14:34:56.552476 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:34:56.552476 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:34:56.552476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:58.069296 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.518 seconds
[0m14:34:58.079829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m14:34:58.083842 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:34:58.083842 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:34:58.453505 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.369 seconds
[0m14:34:58.457533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m14:34:58.512942 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:34:58.512942 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:34:58.936285 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.422 seconds
[0m14:34:58.938290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0deff07-d014-427a-bd99-d859e1c2cc41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294BC6720F0>]}
[0m14:34:58.942300 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m14:34:58.942300 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m14:34:58.944046 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m14:34:58.944046 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m14:34:58.951065 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m14:34:58.951065 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m14:34:58.986286 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m14:34:58.988284 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m14:34:58.989286 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (

WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue,
        COUNT(*) AS transaction_count
    FROM HEALTHCARE.stage.stg_transactions t
    LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
    ON 
        t.customer_id = c.customer_id
    where 
        revenue_type = 1 and t.revenue > 0
    GROUP BY 
        t.customer_id, c.customer_name
),
 
ranked_customers AS (
    SELECT
        cr.customer_id,
        cr.customer_name,
        c.region,
        c.country,
        cr.total_revenue,
        cr.transaction_count,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue AS cr
    LEFT JOIN HEALTHCARE.stage.stg_country_region AS c
    ON cr.customer_id = c.customer_id
)
 
SELECT * FROM ranked_customers
        );
[0m14:34:58.989286 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:35:01.937508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.949 seconds
[0m14:35:01.953488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0deff07-d014-427a-bd99-d859e1c2cc41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294B9460AD0>]}
[0m14:35:01.953488 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_customers_revenue .................. [[32mSUCCESS 1[0m in 3.01s]
[0m14:35:01.953488 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m14:35:01.953488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:01.953488 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:35:01.953488 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:35:02.528430 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m14:35:02.528430 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m14:35:03.073171 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m14:35:03.073171 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m14:35:03.622538 [info ] [MainThread]: 
[0m14:35:03.636945 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.63 seconds (11.63s).
[0m14:35:03.637958 [debug] [MainThread]: Command end result
[0m14:35:03.661643 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:35:03.663625 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:35:03.670298 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:35:03.672342 [info ] [MainThread]: 
[0m14:35:03.673857 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:03.673857 [info ] [MainThread]: 
[0m14:35:03.674867 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:35:03.675865 [debug] [MainThread]: Command `dbt run` succeeded at 14:35:03.675865 after 14.64 seconds
[0m14:35:03.676865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294BBFC95E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294BBFCB200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294BBFCB740>]}
[0m14:35:03.676865 [debug] [MainThread]: Flushing usage events
[0m14:35:05.109781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:30.816768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09D15C500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09D15C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09D15CBC0>]}


============================== 14:39:30.816768 | 7cdc8c28-e9cd-4993-9e36-aa28ade97263 ==============================
[0m14:39:30.816768 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:39:30.816768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:39:31.322239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cdc8c28-e9cd-4993-9e36-aa28ade97263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09EF26810>]}
[0m14:39:31.386946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cdc8c28-e9cd-4993-9e36-aa28ade97263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09DD792E0>]}
[0m14:39:31.389953 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:39:31.754545 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:39:31.954767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:31.954767 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m14:39:32.209522 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:39:32.222249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cdc8c28-e9cd-4993-9e36-aa28ade97263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09F5195E0>]}
[0m14:39:32.289065 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:39:32.289065 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:39:32.320700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cdc8c28-e9cd-4993-9e36-aa28ade97263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09F4B8FB0>]}
[0m14:39:32.320700 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:39:32.320700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cdc8c28-e9cd-4993-9e36-aa28ade97263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09F2AE9C0>]}
[0m14:39:32.320700 [info ] [MainThread]: 
[0m14:39:32.320700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:32.320700 [info ] [MainThread]: 
[0m14:39:32.336512 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:39:32.336512 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:39:32.436360 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:39:32.437362 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:39:32.437362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:34.429509 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.991 seconds
[0m14:39:34.440222 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m14:39:34.455463 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:39:34.455463 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:39:34.455463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:36.047167 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.598 seconds
[0m14:39:36.047167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m14:39:36.061050 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:39:36.062046 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:39:36.394694 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.345 seconds
[0m14:39:36.409674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m14:39:36.459212 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:39:36.459212 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:39:36.843751 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.385 seconds
[0m14:39:36.843751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cdc8c28-e9cd-4993-9e36-aa28ade97263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09F9AE120>]}
[0m14:39:36.860110 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m14:39:36.860110 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m14:39:36.860110 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m14:39:36.860110 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m14:39:36.860110 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m14:39:36.860110 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m14:39:36.897289 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m14:39:36.897289 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m14:39:36.897289 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (

WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue,
        COUNT(*) AS transaction_count
    FROM HEALTHCARE.stage.stg_transactions t
    LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
    ON 
        t.customer_id = c.customer_id
    where 
        revenue_type = 1 and t.revenue > 0
    GROUP BY 
        t.customer_id, c.customer_name
),
 
ranked_customers AS (
    SELECT
        cr.customer_id,
        cr.customer_name,
        c.region,
        c.country,
        cr.total_revenue,
        cr.transaction_count,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue AS cr
    LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_country_region) AS c
    ON cr.customer_id = c.customer_id
)
 
SELECT * FROM ranked_customers
        );
[0m14:39:36.897289 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:39:38.731639 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc5-0004-bb9d-0005-a3d30003d206
[0m14:39:38.731639 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 31 at position 44
invalid identifier 'CUSTOMER_NAME'
[0m14:39:38.744806 [debug] [Thread-1 (]: Database Error in model rank_customers_revenue (models\Mart\rank_customers_revenue.sql)
  000904 (42000): SQL compilation error: error line 31 at position 44
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\dbt_first\models\Mart\rank_customers_revenue.sql
[0m14:39:38.744806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cdc8c28-e9cd-4993-9e36-aa28ade97263', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09F379D00>]}
[0m14:39:38.744806 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.rank_customers_revenue .............. [[31mERROR[0m in 1.88s]
[0m14:39:38.750963 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m14:39:38.750963 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.rank_customers_revenue' to be skipped because of status 'error'.  Reason: Database Error in model rank_customers_revenue (models\Mart\rank_customers_revenue.sql)
  000904 (42000): SQL compilation error: error line 31 at position 44
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\dbt_first\models\Mart\rank_customers_revenue.sql.
[0m14:39:38.750963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:38.750963 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:39:38.750963 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:39:39.295728 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m14:39:39.295728 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m14:39:39.846024 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m14:39:39.846024 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m14:39:40.358615 [info ] [MainThread]: 
[0m14:39:40.358615 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.02 seconds (8.02s).
[0m14:39:40.358615 [debug] [MainThread]: Command end result
[0m14:39:40.385673 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:39:40.387678 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:39:40.387678 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:39:40.387678 [info ] [MainThread]: 
[0m14:39:40.387678 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:39:40.395930 [info ] [MainThread]: 
[0m14:39:40.396594 [error] [MainThread]:   Database Error in model rank_customers_revenue (models\Mart\rank_customers_revenue.sql)
  000904 (42000): SQL compilation error: error line 31 at position 44
  invalid identifier 'CUSTOMER_NAME'
  compiled code at target\run\dbt_first\models\Mart\rank_customers_revenue.sql
[0m14:39:40.396594 [info ] [MainThread]: 
[0m14:39:40.396594 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:39:40.396594 [debug] [MainThread]: Command `dbt run` failed at 14:39:40.396594 after 9.80 seconds
[0m14:39:40.396594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09CED4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09F2CFD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F09F2CF3B0>]}
[0m14:39:40.396594 [debug] [MainThread]: Flushing usage events
[0m14:39:41.330548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:25.181374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7BC6F9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7BC6E870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7BC6E330>]}


============================== 14:40:25.188242 | 6841dc7f-a91e-4686-8096-fceb99cc9a00 ==============================
[0m14:40:25.188242 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:40:25.188242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:40:25.644009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6841dc7f-a91e-4686-8096-fceb99cc9a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7DB7B800>]}
[0m14:40:25.705928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6841dc7f-a91e-4686-8096-fceb99cc9a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF79B57FE0>]}
[0m14:40:25.705928 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:40:26.081258 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:40:26.271537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:40:26.271537 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m14:40:26.520203 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:40:26.536994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6841dc7f-a91e-4686-8096-fceb99cc9a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7E0E9250>]}
[0m14:40:26.608567 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:40:26.608567 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:40:26.645575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6841dc7f-a91e-4686-8096-fceb99cc9a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7E089040>]}
[0m14:40:26.645575 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:40:26.645575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6841dc7f-a91e-4686-8096-fceb99cc9a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7E0C7A70>]}
[0m14:40:26.645575 [info ] [MainThread]: 
[0m14:40:26.645575 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:26.645575 [info ] [MainThread]: 
[0m14:40:26.645575 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:40:26.645575 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:40:26.752815 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:40:26.753815 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:40:26.753815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:28.706038 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.952 seconds
[0m14:40:28.730380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m14:40:28.739085 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:40:28.739085 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:40:28.739085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:30.286068 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.543 seconds
[0m14:40:30.290763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m14:40:30.294774 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:40:30.297290 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:40:30.656437 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.363 seconds
[0m14:40:30.666007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m14:40:30.736067 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:40:30.736067 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:40:31.086265 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.352 seconds
[0m14:40:31.086265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6841dc7f-a91e-4686-8096-fceb99cc9a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF792335F0>]}
[0m14:40:31.098845 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m14:40:31.098845 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m14:40:31.098845 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m14:40:31.098845 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m14:40:31.117291 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m14:40:31.118279 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m14:40:31.147185 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m14:40:31.147185 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m14:40:31.147185 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (

WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue,
        COUNT(*) AS transaction_count
    FROM HEALTHCARE.stage.stg_transactions t
    LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
    ON 
        t.customer_id = c.customer_id
    where 
        revenue_type = 1 and t.revenue > 0
    GROUP BY 
        t.customer_id, c.customer_name
),
 
ranked_customers AS (
    SELECT
        cr.customer_id,
        cr.customer_name,
        c.region,
        c.country,
        cr.total_revenue,
        cr.transaction_count,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue AS cr
    LEFT JOIN (SELECT DISTINCT * FROM HEALTHCARE.stage.stg_country_region) AS c
    ON cr.customer_id = c.customer_id
)
 
SELECT * FROM ranked_customers
        );
[0m14:40:31.147185 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:40:33.881258 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.726 seconds
[0m14:40:33.929884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6841dc7f-a91e-4686-8096-fceb99cc9a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7B250950>]}
[0m14:40:33.929884 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_customers_revenue .................. [[32mSUCCESS 1[0m in 2.83s]
[0m14:40:33.936114 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m14:40:33.936114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:33.936114 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:40:33.936114 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:40:34.490378 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m14:40:34.491374 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m14:40:35.006358 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m14:40:35.006358 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m14:40:35.528269 [info ] [MainThread]: 
[0m14:40:35.532101 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.88 seconds (8.88s).
[0m14:40:35.532101 [debug] [MainThread]: Command end result
[0m14:40:35.575761 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:40:35.577838 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:40:35.586187 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:40:35.586187 [info ] [MainThread]: 
[0m14:40:35.586187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:35.586187 [info ] [MainThread]: 
[0m14:40:35.586187 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:40:35.586187 [debug] [MainThread]: Command `dbt run` succeeded at 14:40:35.586187 after 10.58 seconds
[0m14:40:35.586187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7BD57530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7934F560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF7B205D30>]}
[0m14:40:35.586187 [debug] [MainThread]: Flushing usage events
[0m14:40:36.588626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:15.238931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210ED874470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210ED8773E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210ED875640>]}


============================== 14:41:15.255016 | 95e40358-bb71-41b0-b902-eb35fab00f22 ==============================
[0m14:41:15.255016 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:41:15.255016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:41:15.795545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95e40358-bb71-41b0-b902-eb35fab00f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210EE485D00>]}
[0m14:41:15.854754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95e40358-bb71-41b0-b902-eb35fab00f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210EE220320>]}
[0m14:41:15.856518 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:41:16.220999 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:41:16.401383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:16.401383 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:16.405632 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:41:16.447636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95e40358-bb71-41b0-b902-eb35fab00f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210EE5C6240>]}
[0m14:41:16.520961 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:41:16.525477 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:41:16.555543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95e40358-bb71-41b0-b902-eb35fab00f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210EF9E9FD0>]}
[0m14:41:16.555543 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:41:16.557520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e40358-bb71-41b0-b902-eb35fab00f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210EF858350>]}
[0m14:41:16.557520 [info ] [MainThread]: 
[0m14:41:16.557520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:41:16.557520 [info ] [MainThread]: 
[0m14:41:16.557520 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:41:16.557520 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:41:16.666405 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:41:16.666405 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:41:16.667405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:18.766227 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.103 seconds
[0m14:41:18.791088 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m14:41:18.811059 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:41:18.811059 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:41:18.811059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:20.316165 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.505 seconds
[0m14:41:20.316165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m14:41:20.323253 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:41:20.323253 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:41:20.658546 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.337 seconds
[0m14:41:20.658546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m14:41:20.658546 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:41:20.665848 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:41:21.000922 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.335 seconds
[0m14:41:21.002961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e40358-bb71-41b0-b902-eb35fab00f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210EE567770>]}
[0m14:41:21.007762 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m14:41:21.007762 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m14:41:21.008761 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m14:41:21.008761 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m14:41:21.016069 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m14:41:21.016069 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m14:41:21.049053 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m14:41:21.049053 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m14:41:21.049053 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (

WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue,
        COUNT(*) AS transaction_count
    FROM HEALTHCARE.stage.stg_transactions t
    LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
    ON 
        t.customer_id = c.customer_id
    where 
        revenue_type = 1 and t.revenue > 0
    GROUP BY 
        t.customer_id, c.customer_name
),
 
ranked_customers AS (
    SELECT
        cr.customer_id,
        cr.customer_name,
        c.region,
        c.country,
        cr.total_revenue,
        cr.transaction_count,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue AS cr
    LEFT JOIN (SELECT DISTINCT * FROM HEALTHCARE.stage.stg_country_region) AS c
    ON cr.customer_id = c.customer_id
)
 
SELECT * FROM ranked_customers
        );
[0m14:41:21.049053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:24.151352 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.100 seconds
[0m14:41:24.167072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e40358-bb71-41b0-b902-eb35fab00f22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210EAC19E50>]}
[0m14:41:24.167072 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_customers_revenue .................. [[32mSUCCESS 1[0m in 3.16s]
[0m14:41:24.167072 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m14:41:24.167072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:24.182451 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:41:24.182451 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:41:24.711597 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m14:41:24.713078 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m14:41:25.251777 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m14:41:25.251777 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m14:41:25.795385 [info ] [MainThread]: 
[0m14:41:25.795385 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.24 seconds (9.24s).
[0m14:41:25.795385 [debug] [MainThread]: Command end result
[0m14:41:25.818699 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:41:25.821983 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:41:25.829577 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:41:25.829577 [info ] [MainThread]: 
[0m14:41:25.829577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:25.829577 [info ] [MainThread]: 
[0m14:41:25.829577 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:41:25.829577 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:25.829577 after 10.74 seconds
[0m14:41:25.829577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210ED5DE5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210ED827B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210EF9C8BC0>]}
[0m14:41:25.834250 [debug] [MainThread]: Flushing usage events
[0m14:41:26.803948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:42:02.469272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3C9111BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CC05B770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CC6A7B30>]}


============================== 14:42:02.469272 | 016ecac7-12fb-4d6c-9c18-1dec7213d3ad ==============================
[0m14:42:02.469272 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:42:02.469272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:42:02.926110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '016ecac7-12fb-4d6c-9c18-1dec7213d3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CA447A10>]}
[0m14:42:02.991861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '016ecac7-12fb-4d6c-9c18-1dec7213d3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CD407680>]}
[0m14:42:02.991861 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:42:03.345734 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:42:03.519922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:42:03.519922 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m14:42:03.765257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:42:03.768948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '016ecac7-12fb-4d6c-9c18-1dec7213d3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CE9A9520>]}
[0m14:42:03.854362 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:42:03.856363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:42:03.888062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '016ecac7-12fb-4d6c-9c18-1dec7213d3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CE935430>]}
[0m14:42:03.888062 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:42:03.888062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '016ecac7-12fb-4d6c-9c18-1dec7213d3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CE985160>]}
[0m14:42:03.888062 [info ] [MainThread]: 
[0m14:42:03.888062 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:42:03.888062 [info ] [MainThread]: 
[0m14:42:03.888062 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:42:03.888062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:42:03.991266 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:42:03.991266 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:42:03.992266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:05.954772 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.963 seconds
[0m14:42:05.962380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m14:42:05.971813 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:42:05.971813 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:42:05.971813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:07.459597 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.497 seconds
[0m14:42:07.459597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m14:42:07.476298 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:42:07.476298 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:42:07.812475 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.334 seconds
[0m14:42:07.813062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m14:42:07.886452 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:42:07.886452 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:42:08.225389 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.335 seconds
[0m14:42:08.227847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '016ecac7-12fb-4d6c-9c18-1dec7213d3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CEEEC2C0>]}
[0m14:42:08.244543 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m14:42:08.244543 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m14:42:08.244543 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m14:42:08.254272 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m14:42:08.266221 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m14:42:08.266221 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m14:42:08.296199 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m14:42:08.296199 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m14:42:08.296199 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (

WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue) AS total_revenue,
        COUNT(*) AS transaction_count
    FROM HEALTHCARE.stage.stg_transactions t
    LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
    ON 
        t.customer_id = c.customer_id
    where 
        revenue_type = 1 and t.revenue > 0
    GROUP BY 
        t.customer_id, c.customer_name
),
 
ranked_customers AS (
    SELECT DISTINCT
        cr.customer_id,
        cr.customer_name,
        c.region,
        c.country,
        cr.total_revenue,
        cr.transaction_count,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue AS cr
    LEFT JOIN (SELECT DISTINCT * FROM HEALTHCARE.stage.stg_country_region) AS c
    ON cr.customer_id = c.customer_id
)
 
SELECT * FROM ranked_customers
        );
[0m14:42:08.296199 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:42:10.574021 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.275 seconds
[0m14:42:10.607199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '016ecac7-12fb-4d6c-9c18-1dec7213d3ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3C9A4DB20>]}
[0m14:42:10.607199 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_customers_revenue .................. [[32mSUCCESS 1[0m in 2.36s]
[0m14:42:10.608351 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m14:42:10.610359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:10.610359 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:42:10.611380 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:42:11.129263 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m14:42:11.129263 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m14:42:11.664643 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m14:42:11.666691 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m14:42:12.181367 [info ] [MainThread]: 
[0m14:42:12.181367 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.29 seconds (8.29s).
[0m14:42:12.197509 [debug] [MainThread]: Command end result
[0m14:42:12.219943 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:42:12.219943 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:42:12.229924 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:42:12.229924 [info ] [MainThread]: 
[0m14:42:12.231926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:42:12.231926 [info ] [MainThread]: 
[0m14:42:12.232925 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:42:12.233923 [debug] [MainThread]: Command `dbt run` succeeded at 14:42:12.233923 after 9.92 seconds
[0m14:42:12.234923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3C9111BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CC657530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3CC1E6990>]}
[0m14:42:12.234923 [debug] [MainThread]: Flushing usage events
[0m14:42:13.161889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:04.905902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287C9A441D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287C98EB770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287C9A47680>]}


============================== 14:43:04.921757 | 2c240b3e-0341-476d-bc16-b1ffe7bb9d6e ==============================
[0m14:43:04.921757 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:43:04.921757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:43:05.393281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c240b3e-0341-476d-bc16-b1ffe7bb9d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287C6DFAD80>]}
[0m14:43:05.449623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c240b3e-0341-476d-bc16-b1ffe7bb9d6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CB8044D0>]}
[0m14:43:05.449623 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:43:05.815104 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:43:06.004562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:06.004562 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m14:43:06.194581 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_first.rank_customers_revenue' (models\Mart\rank_customers_revenue.sql) depends on a node named 'stg_TRANSACTION' which was not found
[0m14:43:06.194581 [debug] [MainThread]: Command `dbt run` failed at 14:43:06.194581 after 1.46 seconds
[0m14:43:06.194581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287C92E44D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CB806D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000287CBA04290>]}
[0m14:43:06.194581 [debug] [MainThread]: Flushing usage events
[0m14:43:07.138547 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:07.029952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234CD5D5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234CD5C6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234CD5D1F0>]}


============================== 14:44:07.048796 | 3f24e40b-7466-49d6-82c1-4334631469f8 ==============================
[0m14:44:07.048796 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:44:07.048796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:44:07.560672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f24e40b-7466-49d6-82c1-4334631469f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234C897D10>]}
[0m14:44:07.645950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f24e40b-7466-49d6-82c1-4334631469f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234DAB4DD0>]}
[0m14:44:07.645950 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:44:08.018632 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:44:08.222887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:44:08.222887 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m14:44:08.502780 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:44:08.516953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f24e40b-7466-49d6-82c1-4334631469f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234F0F95E0>]}
[0m14:44:08.601025 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:44:08.604026 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:44:08.630106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f24e40b-7466-49d6-82c1-4334631469f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234F085040>]}
[0m14:44:08.630106 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:44:08.630106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f24e40b-7466-49d6-82c1-4334631469f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234F0E2000>]}
[0m14:44:08.630106 [warn ] [MainThread]: The selection criterion 'tag:rank_customers_revenue' does not match any enabled nodes
[0m14:44:08.630106 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:44:08.630106 [debug] [MainThread]: Command end result
[0m14:44:08.659000 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:44:08.661007 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:44:08.666962 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:44:08.667970 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:08.667970 after 1.82 seconds
[0m14:44:08.668971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234C667560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234CD2C170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002234BCAD5B0>]}
[0m14:44:08.668971 [debug] [MainThread]: Flushing usage events
[0m14:44:09.699968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:44.000800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C2C436720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C2E009A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C2C435760>]}


============================== 14:45:44.000800 | 32d0d40e-9e5c-47aa-a27e-96aeb7cc02c9 ==============================
[0m14:45:44.000800 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:45:44.000800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:45:44.473088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32d0d40e-9e5c-47aa-a27e-96aeb7cc02c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C2E19C4D0>]}
[0m14:45:44.530483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32d0d40e-9e5c-47aa-a27e-96aeb7cc02c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C2E19E180>]}
[0m14:45:44.532489 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:45:44.878335 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:45:45.067609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:45:45.067609 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m14:45:45.314468 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m14:45:45.330568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32d0d40e-9e5c-47aa-a27e-96aeb7cc02c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C30855760>]}
[0m14:45:45.410134 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:45:45.410134 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:45:45.447903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32d0d40e-9e5c-47aa-a27e-96aeb7cc02c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C30935250>]}
[0m14:45:45.447903 [info ] [MainThread]: Found 1 seed, 9 models, 4 sources, 477 macros
[0m14:45:45.450745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32d0d40e-9e5c-47aa-a27e-96aeb7cc02c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C3073E2A0>]}
[0m14:45:45.450745 [info ] [MainThread]: 
[0m14:45:45.450745 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:45.450745 [info ] [MainThread]: 
[0m14:45:45.450745 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:45:45.450745 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m14:45:45.551027 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m14:45:45.551027 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m14:45:45.551027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:47.940360 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.397 seconds
[0m14:45:47.956517 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m14:45:47.972605 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m14:45:47.972605 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m14:45:47.972605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:49.557475 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.590 seconds
[0m14:45:49.557475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m14:45:49.557475 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m14:45:49.557475 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m14:45:49.945069 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.385 seconds
[0m14:45:49.945069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m14:45:49.992903 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m14:45:49.992903 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m14:45:50.381958 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.376 seconds
[0m14:45:50.384716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32d0d40e-9e5c-47aa-a27e-96aeb7cc02c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C30D57230>]}
[0m14:45:50.392472 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m14:45:50.393641 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m14:45:50.394607 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m14:45:50.395053 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m14:45:50.401950 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m14:45:50.403919 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m14:45:50.433821 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m14:45:50.435787 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m14:45:50.436141 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (
WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(CAST(t.revenue AS DECIMAL(10,2))) AS total_revenue,
        COUNT(*) AS transaction_count
    FROM HEALTHCARE.stage.stg_transactions t
    LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
    ON t.customer_id = c.customer_id
    where revenue_type = 1 and t.revenue > 0
    GROUP BY t.customer_id, c.customer_name
),
 
ranked_customers AS (
    SELECT
        customer_id,
        customer_name,
        total_revenue,
        transaction_count,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
 
SELECT * FROM ranked_customers
        );
[0m14:45:50.436141 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:52.647784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.217 seconds
[0m14:45:52.663621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32d0d40e-9e5c-47aa-a27e-96aeb7cc02c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C2BA3D850>]}
[0m14:45:52.663621 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_customers_revenue .................. [[32mSUCCESS 1[0m in 2.27s]
[0m14:45:52.679676 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m14:45:52.679676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:52.679676 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m14:45:52.679676 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m14:45:53.197121 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m14:45:53.197121 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m14:45:53.718560 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m14:45:53.718560 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m14:45:54.235998 [info ] [MainThread]: 
[0m14:45:54.235998 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m14:45:54.235998 [debug] [MainThread]: Command end result
[0m14:45:54.258171 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m14:45:54.258171 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m14:45:54.269529 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m14:45:54.270541 [info ] [MainThread]: 
[0m14:45:54.271537 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:54.271537 [info ] [MainThread]: 
[0m14:45:54.272568 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:45:54.273535 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:54.273535 after 10.44 seconds
[0m14:45:54.274538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C2E009A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C309A9A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C2D57AB40>]}
[0m14:45:54.274538 [debug] [MainThread]: Flushing usage events
[0m14:45:55.337449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:01.860196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1F9624A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1F718FEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1F9627590>]}


============================== 15:04:01.879521 | 908f55f4-fbdc-4e97-98a4-ddaaf96dc047 ==============================
[0m15:04:01.879521 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:04:01.880017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:04:02.401565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '908f55f4-fbdc-4e97-98a4-ddaaf96dc047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1F9645E20>]}
[0m15:04:02.461489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '908f55f4-fbdc-4e97-98a4-ddaaf96dc047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1F91635C0>]}
[0m15:04:02.461489 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:04:02.917654 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:04:04.291570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:04:04.291570 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Mart\new_logo_each_fiscal.sql
[0m15:04:04.293576 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m15:04:04.466327 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_first.new_logo_each_fiscal' (models\Mart\new_logo_each_fiscal.sql) depends on a node named 'stg_transasctions' which was not found
[0m15:04:04.466327 [debug] [MainThread]: Command `dbt run` failed at 15:04:04.466327 after 2.81 seconds
[0m15:04:04.466327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1F9458800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1FB4155B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1F8A7FA10>]}
[0m15:04:04.466327 [debug] [MainThread]: Flushing usage events
[0m15:04:05.505488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:24.022778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B342159D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B344663BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3446617F0>]}


============================== 15:04:24.036535 | e6f43f2c-0b0d-4c1a-b5a5-cdf0721081ee ==============================
[0m15:04:24.036535 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:04:24.039454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'send_anonymous_usage_stats': 'True'}
[0m15:04:24.507763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6f43f2c-0b0d-4c1a-b5a5-cdf0721081ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B346C4EED0>]}
[0m15:04:24.557412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6f43f2c-0b0d-4c1a-b5a5-cdf0721081ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B34587BE60>]}
[0m15:04:24.571293 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:04:24.928398 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:04:25.102699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:04:25.102699 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Mart\new_logo_each_fiscal.sql
[0m15:04:25.102699 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m15:04:25.353445 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:04:25.353445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6f43f2c-0b0d-4c1a-b5a5-cdf0721081ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B347064320>]}
[0m15:04:25.441999 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:04:25.457440 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:04:25.489660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6f43f2c-0b0d-4c1a-b5a5-cdf0721081ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B347159880>]}
[0m15:04:25.491408 [info ] [MainThread]: Found 1 seed, 10 models, 4 sources, 477 macros
[0m15:04:25.491408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6f43f2c-0b0d-4c1a-b5a5-cdf0721081ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B346B8FEF0>]}
[0m15:04:25.491408 [info ] [MainThread]: 
[0m15:04:25.491408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:04:25.491408 [info ] [MainThread]: 
[0m15:04:25.491408 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:04:25.491408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:04:28.179546 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:04:28.188546 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:04:28.188546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:30.190851 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.006 seconds
[0m15:04:30.190851 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m15:04:30.206601 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:04:30.206601 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:04:30.206601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:31.695339 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.498 seconds
[0m15:04:31.712648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m15:04:31.760037 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:04:31.760037 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:04:32.065106 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.311 seconds
[0m15:04:32.074279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m15:04:32.074279 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:04:32.074279 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:04:32.408786 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.335 seconds
[0m15:04:32.408786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6f43f2c-0b0d-4c1a-b5a5-cdf0721081ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3474C0200>]}
[0m15:04:32.408786 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m15:04:32.408786 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m15:04:32.408786 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m15:04:32.408786 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m15:04:32.424659 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m15:04:32.424659 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m15:04:32.450695 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m15:04:32.465386 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m15:04:32.465386 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (
-- WITH customer_revenue AS (
--     SELECT
--         t.customer_id,
--         c.customer_name,
--         SUM(CAST(t.revenue AS DECIMAL(10,2))) AS total_revenue,
--         COUNT(*) AS transaction_count
--     FROM HEALTHCARE.stage.stg_transactions t
--     LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
--     ON t.customer_id = c.customer_id
--     where revenue_type = 1 and t.revenue > 0
--     GROUP BY t.customer_id, c.customer_name
-- ),
 
-- ranked_customers AS (
--     SELECT
--         customer_id,
--         customer_name,
--         total_revenue,
--         transaction_count,
--         DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
--     FROM customer_revenue
-- )
 
-- SELECT * FROM ranked_customers

WITH cte_product_revenue AS (
    SELECT 
        customer_id,
        SUM(revenue) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions 
    GROUP BY 
        customer_id
)
SELECT 
    customer_id,
    total_revenue,
    DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS product_rank
FROM cte_product_revenue
        );
[0m15:04:32.466437 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:04:35.141068 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.687 seconds
[0m15:04:35.172998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6f43f2c-0b0d-4c1a-b5a5-cdf0721081ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B342259E50>]}
[0m15:04:35.172998 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_customers_revenue .................. [[32mSUCCESS 1[0m in 2.76s]
[0m15:04:35.172998 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m15:04:35.172998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:35.172998 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:04:35.172998 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:04:35.706215 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m15:04:35.706215 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m15:04:36.240183 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m15:04:36.240183 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m15:04:36.770991 [info ] [MainThread]: 
[0m15:04:36.770991 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.28 seconds (11.28s).
[0m15:04:36.770991 [debug] [MainThread]: Command end result
[0m15:04:36.816558 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:04:36.823736 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:04:36.827523 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:04:36.827523 [info ] [MainThread]: 
[0m15:04:36.827523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:36.827523 [info ] [MainThread]: 
[0m15:04:36.827523 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:04:36.827523 [debug] [MainThread]: Command `dbt run` succeeded at 15:04:36.827523 after 12.96 seconds
[0m15:04:36.827523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B34430CF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B34430CFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B34430DC70>]}
[0m15:04:36.836420 [debug] [MainThread]: Flushing usage events
[0m15:04:38.107284 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:13.480947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD8C247A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD8C274A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD8C24230>]}


============================== 15:06:13.480947 | d0369cd6-77f8-4881-a18e-d09a202b5905 ==============================
[0m15:06:13.480947 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:06:13.480947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:13.984583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0369cd6-77f8-4881-a18e-d09a202b5905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD8C3CB00>]}
[0m15:06:14.049640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0369cd6-77f8-4881-a18e-d09a202b5905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD8BD7B60>]}
[0m15:06:14.049640 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:06:14.513178 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:06:15.826546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:06:15.826546 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m15:06:15.828552 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\new_logo_each_fiscal.sql
[0m15:06:16.060309 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:06:16.083266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0369cd6-77f8-4881-a18e-d09a202b5905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADADFF380>]}
[0m15:06:16.154254 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:06:16.168761 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:06:16.204051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0369cd6-77f8-4881-a18e-d09a202b5905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADAF1E4B0>]}
[0m15:06:16.204051 [info ] [MainThread]: Found 1 seed, 10 models, 4 sources, 477 macros
[0m15:06:16.204051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0369cd6-77f8-4881-a18e-d09a202b5905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADADBD8E0>]}
[0m15:06:16.204051 [info ] [MainThread]: 
[0m15:06:16.204051 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:06:16.204051 [info ] [MainThread]: 
[0m15:06:16.204051 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:06:16.204051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:06:18.681795 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:06:18.686462 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:06:18.686462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:20.727308 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.048 seconds
[0m15:06:20.727308 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m15:06:20.743198 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:06:20.743198 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:06:20.743198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:22.330453 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.592 seconds
[0m15:06:22.346252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m15:06:22.393660 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:06:22.393660 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:06:22.717411 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.337 seconds
[0m15:06:22.733422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m15:06:22.733422 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:06:22.733422 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:06:23.138482 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.405 seconds
[0m15:06:23.138482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0369cd6-77f8-4881-a18e-d09a202b5905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADAF2C6B0>]}
[0m15:06:23.138482 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m15:06:23.138482 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m15:06:23.154187 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m15:06:23.154187 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m15:06:23.154187 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m15:06:23.154187 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m15:06:23.193040 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m15:06:23.193040 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m15:06:23.193040 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (
-- WITH customer_revenue AS (
--     SELECT
--         t.customer_id,
--         c.customer_name,
--         SUM(CAST(t.revenue AS DECIMAL(10,2))) AS total_revenue,
--         COUNT(*) AS transaction_count
--     FROM HEALTHCARE.stage.stg_transactions t
--     LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
--     ON t.customer_id = c.customer_id
--     where revenue_type = 1 and t.revenue > 0
--     GROUP BY t.customer_id, c.customer_name
-- ),
 
-- ranked_customers AS (
--     SELECT
--         customer_id,
--         customer_name,
--         total_revenue,
--         transaction_count,
--         DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
--     FROM customer_revenue
-- )
 
-- SELECT * FROM ranked_customers

WITH customer_revenue AS (
    SELECT
        c.CUSTOMER_ID AS customer_id,
        SUM(t.REVENUE) AS total_revenue,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM HEALTHCARE.stage.stg_transactions as t
    JOIN HEALTHCARE.stage.stg_customers as  c
    ON c.CUSTOMER_ID = t.CUSTOMER_ID
    GROUP BY c.CUSTOMER_ID
)
 
SELECT
    customer_id,
    total_revenue,
    revenue_rank
FROM customer_revenue
ORDER BY revenue_rank
        );
[0m15:06:23.193040 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:06:25.639077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.438 seconds
[0m15:06:25.661859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0369cd6-77f8-4881-a18e-d09a202b5905', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD5FD9C40>]}
[0m15:06:25.661859 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_customers_revenue .................. [[32mSUCCESS 1[0m in 2.49s]
[0m15:06:25.661859 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m15:06:25.661859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:25.661859 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:06:25.661859 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:06:26.202671 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m15:06:26.202671 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m15:06:26.712771 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m15:06:26.712771 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m15:06:27.230128 [info ] [MainThread]: 
[0m15:06:27.245801 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.03 seconds (11.03s).
[0m15:06:27.245801 [debug] [MainThread]: Command end result
[0m15:06:27.272461 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:06:27.274831 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:06:27.279869 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:06:27.281202 [info ] [MainThread]: 
[0m15:06:27.281202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:27.281202 [info ] [MainThread]: 
[0m15:06:27.281202 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:06:27.281202 [debug] [MainThread]: Command `dbt run` succeeded at 15:06:27.281202 after 13.98 seconds
[0m15:06:27.281202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD633FE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD80975C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD8798CE0>]}
[0m15:06:27.281202 [debug] [MainThread]: Flushing usage events
[0m15:06:28.283125 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:16.797071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002297BC7D0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002297BC7D190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002297BC7CDD0>]}


============================== 15:07:16.809655 | de7af3f7-36d1-43ba-b5b7-ebe64bb1a6f5 ==============================
[0m15:07:16.809655 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:07:16.809655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:07:17.272153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de7af3f7-36d1-43ba-b5b7-ebe64bb1a6f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002297C977140>]}
[0m15:07:17.339893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de7af3f7-36d1-43ba-b5b7-ebe64bb1a6f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002297916C6B0>]}
[0m15:07:17.348936 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:07:17.692811 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:07:17.883922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:07:17.883922 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m15:07:18.132039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:07:18.147696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de7af3f7-36d1-43ba-b5b7-ebe64bb1a6f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002297DF99F70>]}
[0m15:07:18.239470 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:07:18.243352 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:07:18.274225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de7af3f7-36d1-43ba-b5b7-ebe64bb1a6f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002297DF92000>]}
[0m15:07:18.274225 [info ] [MainThread]: Found 1 seed, 10 models, 4 sources, 477 macros
[0m15:07:18.275352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de7af3f7-36d1-43ba-b5b7-ebe64bb1a6f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002297DAB7980>]}
[0m15:07:18.277350 [info ] [MainThread]: 
[0m15:07:18.277350 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:18.278544 [info ] [MainThread]: 
[0m15:07:18.278544 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:07:18.280558 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:07:18.380671 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:07:18.381681 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:07:18.382718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:20.273414 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.891 seconds
[0m15:07:20.280246 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m15:07:20.282618 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:07:20.282618 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:07:20.282618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:21.855450 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.565 seconds
[0m15:07:21.858408 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m15:07:21.861404 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:07:21.861404 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:07:22.212708 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.351 seconds
[0m15:07:22.216165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m15:07:22.275056 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:07:22.275056 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:07:23.090170 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.814 seconds
[0m15:07:23.093161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de7af3f7-36d1-43ba-b5b7-ebe64bb1a6f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002297DFA05F0>]}
[0m15:07:23.097723 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m15:07:23.097723 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m15:07:23.098723 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m15:07:23.098723 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m15:07:23.102410 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m15:07:23.102410 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m15:07:23.138480 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m15:07:23.138480 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m15:07:23.138480 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (
-- WITH customer_revenue AS (
--     SELECT
--         t.customer_id,
--         c.customer_name,
--         SUM(CAST(t.revenue AS DECIMAL(10,2))) AS total_revenue,
--         COUNT(*) AS transaction_count
--     FROM HEALTHCARE.stage.stg_transactions t
--     LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
--     ON t.customer_id = c.customer_id
--     where revenue_type = 1 and t.revenue > 0
--     GROUP BY t.customer_id, c.customer_name
-- ),
 
-- ranked_customers AS (
--     SELECT
--         customer_id,
--         customer_name,
--         total_revenue,
--         transaction_count,
--         DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
--     FROM customer_revenue
-- )
 
-- SELECT * FROM ranked_customers

WITH customer_revenue AS (
    SELECT
        c.CUSTOMER_ID AS customer_id,
        c.customer_name,
        SUM(t.REVENUE) AS total_revenue,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM HEALTHCARE.stage.stg_transactions as t
    JOIN HEALTHCARE.stage.stg_customers as  c
    ON c.CUSTOMER_ID = t.CUSTOMER_ID
    GROUP BY c.CUSTOMER_ID
)
 
SELECT
    customer_id,
    customer_name,
        total_revenue,
    revenue_rank
FROM customer_revenue
ORDER BY revenue_rank
        );
[0m15:07:23.138480 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:07:24.827860 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffe1-0004-bb9f-0005-a3d30003c392
[0m15:07:24.827860 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 32 at position 8
'C.CUSTOMER_NAME' in select clause is neither an aggregate nor in the group by clause.
[0m15:07:24.845305 [debug] [Thread-1 (]: Database Error in model rank_customers_revenue (models\Mart\rank_customers_revenue.sql)
  001104 (42601): SQL compilation error: error line 32 at position 8
  'C.CUSTOMER_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\dbt_first\models\Mart\rank_customers_revenue.sql
[0m15:07:24.847304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de7af3f7-36d1-43ba-b5b7-ebe64bb1a6f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002297B150950>]}
[0m15:07:24.848306 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.rank_customers_revenue .............. [[31mERROR[0m in 1.75s]
[0m15:07:24.849276 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m15:07:24.850282 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.rank_customers_revenue' to be skipped because of status 'error'.  Reason: Database Error in model rank_customers_revenue (models\Mart\rank_customers_revenue.sql)
  001104 (42601): SQL compilation error: error line 32 at position 8
  'C.CUSTOMER_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\dbt_first\models\Mart\rank_customers_revenue.sql.
[0m15:07:24.852281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:24.852281 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:07:24.852281 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:07:25.375978 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m15:07:25.375978 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m15:07:25.888728 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m15:07:25.888728 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m15:07:26.416601 [info ] [MainThread]: 
[0m15:07:26.416601 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.14 seconds (8.14s).
[0m15:07:26.416601 [debug] [MainThread]: Command end result
[0m15:07:26.446008 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:07:26.446008 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:07:26.457308 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:07:26.457308 [info ] [MainThread]: 
[0m15:07:26.457308 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:07:26.457308 [info ] [MainThread]: 
[0m15:07:26.457308 [error] [MainThread]:   Database Error in model rank_customers_revenue (models\Mart\rank_customers_revenue.sql)
  001104 (42601): SQL compilation error: error line 32 at position 8
  'C.CUSTOMER_NAME' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\dbt_first\models\Mart\rank_customers_revenue.sql
[0m15:07:26.457308 [info ] [MainThread]: 
[0m15:07:26.457308 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:07:26.457308 [debug] [MainThread]: Command `dbt run` failed at 15:07:26.457308 after 9.84 seconds
[0m15:07:26.457308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002297AC4BB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002297DA2A1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002297DA2B830>]}
[0m15:07:26.457308 [debug] [MainThread]: Flushing usage events
[0m15:07:27.415760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:45.218046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F429FE3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F429FC830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F429FE420>]}


============================== 15:07:45.223741 | a9c304bd-7316-4d16-a7a6-356bd48dbbde ==============================
[0m15:07:45.223741 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:07:45.223741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:07:45.686764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9c304bd-7316-4d16-a7a6-356bd48dbbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F42B4C710>]}
[0m15:07:45.753915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9c304bd-7316-4d16-a7a6-356bd48dbbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F43857B60>]}
[0m15:07:45.754334 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:07:46.111994 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:07:46.309303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:07:46.318029 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m15:07:46.575918 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:07:46.587684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9c304bd-7316-4d16-a7a6-356bd48dbbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F44E7A090>]}
[0m15:07:46.662362 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:07:46.662362 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:07:46.703170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9c304bd-7316-4d16-a7a6-356bd48dbbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F44E15C10>]}
[0m15:07:46.703170 [info ] [MainThread]: Found 1 seed, 10 models, 4 sources, 477 macros
[0m15:07:46.704202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9c304bd-7316-4d16-a7a6-356bd48dbbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F44975550>]}
[0m15:07:46.706170 [info ] [MainThread]: 
[0m15:07:46.706170 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:46.707170 [info ] [MainThread]: 
[0m15:07:46.708170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:07:46.709040 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:07:46.805706 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:07:46.805706 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:07:46.806708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:49.445752 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.639 seconds
[0m15:07:49.451251 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m15:07:49.462698 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:07:49.463697 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:07:49.463697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:51.045838 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.585 seconds
[0m15:07:51.045838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m15:07:51.045838 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:07:51.045838 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:07:51.436656 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.384 seconds
[0m15:07:51.436656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m15:07:51.478983 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:07:51.478983 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:07:51.812347 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.322 seconds
[0m15:07:51.812347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9c304bd-7316-4d16-a7a6-356bd48dbbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3FF735F0>]}
[0m15:07:51.812347 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m15:07:51.812347 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m15:07:51.812347 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m15:07:51.812347 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m15:07:51.831644 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m15:07:51.832730 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m15:07:51.864621 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m15:07:51.864621 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m15:07:51.864621 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (
-- WITH customer_revenue AS (
--     SELECT
--         t.customer_id,
--         c.customer_name,
--         SUM(CAST(t.revenue AS DECIMAL(10,2))) AS total_revenue,
--         COUNT(*) AS transaction_count
--     FROM HEALTHCARE.stage.stg_transactions t
--     LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
--     ON t.customer_id = c.customer_id
--     where revenue_type = 1 and t.revenue > 0
--     GROUP BY t.customer_id, c.customer_name
-- ),
 
-- ranked_customers AS (
--     SELECT
--         customer_id,
--         customer_name,
--         total_revenue,
--         transaction_count,
--         DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
--     FROM customer_revenue
-- )
 
-- SELECT * FROM ranked_customers

WITH customer_revenue AS (
    SELECT
        c.CUSTOMER_ID AS customer_id,
        c.customer_name,
        SUM(t.REVENUE) AS total_revenue,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM HEALTHCARE.stage.stg_transactions as t
    JOIN HEALTHCARE.stage.stg_customers as  c
    ON c.CUSTOMER_ID = t.CUSTOMER_ID
    GROUP BY c.CUSTOMER_ID,c.customer_name
)
 
SELECT
    customer_id,
    customer_name,
        total_revenue,
    revenue_rank
FROM customer_revenue
ORDER BY revenue_rank
        );
[0m15:07:51.864621 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:07:54.531132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.667 seconds
[0m15:07:54.579006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9c304bd-7316-4d16-a7a6-356bd48dbbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F3FEDD8E0>]}
[0m15:07:54.579006 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_customers_revenue .................. [[32mSUCCESS 1[0m in 2.77s]
[0m15:07:54.579006 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m15:07:54.579006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:54.579006 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:07:54.579006 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:07:55.136645 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m15:07:55.136645 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m15:07:55.685632 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m15:07:55.685632 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m15:07:56.233921 [info ] [MainThread]: 
[0m15:07:56.233921 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.53 seconds (9.53s).
[0m15:07:56.233921 [debug] [MainThread]: Command end result
[0m15:07:56.261751 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:07:56.263753 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:07:56.272309 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:07:56.272309 [info ] [MainThread]: 
[0m15:07:56.273309 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:56.274323 [info ] [MainThread]: 
[0m15:07:56.275323 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:07:56.275709 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:56.275709 after 11.22 seconds
[0m15:07:56.275709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4293F770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4023F5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F4264DA90>]}
[0m15:07:56.277735 [debug] [MainThread]: Flushing usage events
[0m15:07:57.191834 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:08:29.076266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273A0EA7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002739F0B91F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273A0EA66F0>]}


============================== 15:08:29.076266 | 76481ff7-aad1-46ca-b305-a8f2e42f3cc6 ==============================
[0m15:08:29.076266 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:08:29.076266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:29.550013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76481ff7-aad1-46ca-b305-a8f2e42f3cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273A1FF5BE0>]}
[0m15:08:29.609975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76481ff7-aad1-46ca-b305-a8f2e42f3cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273A21075F0>]}
[0m15:08:29.611955 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:08:29.965927 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:08:30.147443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:08:30.149448 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m15:08:30.376469 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:08:30.392495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76481ff7-aad1-46ca-b305-a8f2e42f3cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273A36A9AF0>]}
[0m15:08:30.473972 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:08:30.473972 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:08:30.502016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76481ff7-aad1-46ca-b305-a8f2e42f3cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273A3576BA0>]}
[0m15:08:30.502016 [info ] [MainThread]: Found 1 seed, 10 models, 4 sources, 477 macros
[0m15:08:30.502016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76481ff7-aad1-46ca-b305-a8f2e42f3cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273A36B03E0>]}
[0m15:08:30.502016 [info ] [MainThread]: 
[0m15:08:30.502016 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:08:30.502016 [info ] [MainThread]: 
[0m15:08:30.502016 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:08:30.502016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:08:30.603169 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:08:30.603169 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:08:30.603169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:32.547621 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.942 seconds
[0m15:08:32.558450 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m15:08:32.563511 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:08:32.563511 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:08:32.563511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:34.190137 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.626 seconds
[0m15:08:34.190137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m15:08:34.197575 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:08:34.197575 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:08:34.569846 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.369 seconds
[0m15:08:34.569846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m15:08:34.633405 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:08:34.633405 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:08:35.031360 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.386 seconds
[0m15:08:35.035387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76481ff7-aad1-46ca-b305-a8f2e42f3cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273A3B0FF80>]}
[0m15:08:35.039320 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m15:08:35.039320 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m15:08:35.039320 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m15:08:35.039320 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m15:08:35.039320 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m15:08:35.039320 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m15:08:35.075702 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m15:08:35.075702 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m15:08:35.075702 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (
WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(CAST(t.revenue AS DECIMAL(10,2))) AS total_revenue,
        COUNT(*) AS transaction_count
    FROM HEALTHCARE.stage.stg_transactions t
    LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
    ON t.customer_id = c.customer_id
    where revenue_type = 1 and t.revenue > 0
    GROUP BY t.customer_id, c.customer_name
),
 
ranked_customers AS (
    SELECT
        customer_id,
        customer_name,
        total_revenue,
        transaction_count,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
 
SELECT * FROM ranked_customers

-- WITH customer_revenue AS (
--     SELECT
--         c.CUSTOMER_ID AS customer_id,
--         c.customer_name,
--         SUM(t.REVENUE) AS total_revenue,
--         DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
--     FROM HEALTHCARE.stage.stg_transactions as t
--     JOIN HEALTHCARE.stage.stg_customers as  c
--     ON c.CUSTOMER_ID = t.CUSTOMER_ID
--     GROUP BY c.CUSTOMER_ID,c.customer_name
-- )
 
-- SELECT
--     customer_id,
--     customer_name,
--         total_revenue,
--     revenue_rank
-- FROM customer_revenue
-- ORDER BY revenue_rank
        );
[0m15:08:35.075702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:37.563340 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.485 seconds
[0m15:08:37.594886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76481ff7-aad1-46ca-b305-a8f2e42f3cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273A08207A0>]}
[0m15:08:37.594886 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_customers_revenue .................. [[32mSUCCESS 1[0m in 2.54s]
[0m15:08:37.594886 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m15:08:37.594886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:37.594886 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:08:37.594886 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:08:38.147199 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m15:08:38.148680 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m15:08:38.818864 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m15:08:38.818864 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m15:08:39.928720 [info ] [MainThread]: 
[0m15:08:39.928720 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.43 seconds (9.43s).
[0m15:08:39.928720 [debug] [MainThread]: Command end result
[0m15:08:39.971444 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:08:39.973452 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:08:39.980403 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:08:39.980403 [info ] [MainThread]: 
[0m15:08:39.980403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:39.980403 [info ] [MainThread]: 
[0m15:08:39.980403 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:08:39.980403 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:39.980403 after 11.07 seconds
[0m15:08:39.980403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002739E75D640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002739F116780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002739F116810>]}
[0m15:08:39.980403 [debug] [MainThread]: Flushing usage events
[0m15:08:40.937660 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:45.309451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3907A4AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3907A45C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3907A7860>]}


============================== 15:17:45.309451 | 600ec962-a37b-420a-9fe2-b28e01b37866 ==============================
[0m15:17:45.309451 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:17:45.309451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:rank_product_revenue', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:17:45.783312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '600ec962-a37b-420a-9fe2-b28e01b37866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E38DB5EC60>]}
[0m15:17:45.846455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '600ec962-a37b-420a-9fe2-b28e01b37866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3914E4E90>]}
[0m15:17:45.853124 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:17:46.204540 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:17:46.395045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:46.395045 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m15:17:46.626536 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:17:46.652427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '600ec962-a37b-420a-9fe2-b28e01b37866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E392B019A0>]}
[0m15:17:46.730793 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:17:46.734791 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:17:46.766250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '600ec962-a37b-420a-9fe2-b28e01b37866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E392A85490>]}
[0m15:17:46.766250 [info ] [MainThread]: Found 1 seed, 10 models, 4 sources, 477 macros
[0m15:17:46.766250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '600ec962-a37b-420a-9fe2-b28e01b37866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E391656BA0>]}
[0m15:17:46.769865 [info ] [MainThread]: 
[0m15:17:46.769865 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:46.769865 [info ] [MainThread]: 
[0m15:17:46.769865 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:17:46.769865 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:17:46.868985 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:17:46.868985 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:17:46.868985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:48.878150 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.011 seconds
[0m15:17:48.878150 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m15:17:48.895839 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:17:48.895839 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:17:48.895839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:50.362889 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.464 seconds
[0m15:17:50.364893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m15:17:50.368904 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:17:50.368904 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:17:50.706537 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.349 seconds
[0m15:17:50.706537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m15:17:50.772274 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:17:50.772274 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:17:51.099106 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.317 seconds
[0m15:17:51.102106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '600ec962-a37b-420a-9fe2-b28e01b37866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E38DBEF920>]}
[0m15:17:51.105932 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m15:17:51.106974 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_product_revenue ......................... [RUN]
[0m15:17:51.107971 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_product_revenue'
[0m15:17:51.107971 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m15:17:51.116265 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m15:17:51.117265 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m15:17:51.141413 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m15:17:51.141413 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m15:17:51.141413 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

WITH cte_product_revenue AS (
    SELECT 
        product_id,
        SUM(revenue) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions 
    where revenue_type = 1 and revenue > 0
    GROUP BY 
        product_id
)
SELECT 
    product_id,
    total_revenue,
    DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS product_rank
FROM cte_product_revenue
        );
[0m15:17:51.141413 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:17:53.469455 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.320 seconds
[0m15:17:53.485139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '600ec962-a37b-420a-9fe2-b28e01b37866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39295DA30>]}
[0m15:17:53.485139 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_product_revenue .................... [[32mSUCCESS 1[0m in 2.38s]
[0m15:17:53.485139 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m15:17:53.485139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:53.485139 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:17:53.485139 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:17:54.027164 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m15:17:54.028318 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m15:17:55.127146 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was left open.
[0m15:17:55.127146 [debug] [MainThread]: On model.dbt_first.rank_product_revenue: Close
[0m15:17:55.655807 [info ] [MainThread]: 
[0m15:17:55.657545 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.89 seconds (8.89s).
[0m15:17:55.660699 [debug] [MainThread]: Command end result
[0m15:17:55.689355 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:17:55.691361 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:17:55.699578 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:17:55.699578 [info ] [MainThread]: 
[0m15:17:55.701601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:55.702585 [info ] [MainThread]: 
[0m15:17:55.702585 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:17:55.704603 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:55.703584 after 10.56 seconds
[0m15:17:55.704603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3902BCFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E392F52F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E39289B140>]}
[0m15:17:55.704603 [debug] [MainThread]: Flushing usage events
[0m15:17:56.701657 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:17.778790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295D67A8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295D67A9F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295D67A82C0>]}


============================== 15:18:17.790146 | 5a5aae74-5b03-4fd0-82ee-25f124f10512 ==============================
[0m15:18:17.790146 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:18:17.792263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:rank_product_revenue', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:18:18.251557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a5aae74-5b03-4fd0-82ee-25f124f10512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295D73E86B0>]}
[0m15:18:18.314968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a5aae74-5b03-4fd0-82ee-25f124f10512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295D67A8470>]}
[0m15:18:18.314968 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:18:18.670705 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:18:18.852076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:18.852076 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m15:18:19.100208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:18:19.116993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a5aae74-5b03-4fd0-82ee-25f124f10512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295D8B59B50>]}
[0m15:18:19.201446 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:18:19.203126 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:18:19.235452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a5aae74-5b03-4fd0-82ee-25f124f10512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295D8AD58B0>]}
[0m15:18:19.236458 [info ] [MainThread]: Found 1 seed, 10 models, 4 sources, 477 macros
[0m15:18:19.237457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a5aae74-5b03-4fd0-82ee-25f124f10512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295D88E62D0>]}
[0m15:18:19.238458 [info ] [MainThread]: 
[0m15:18:19.239465 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:18:19.239465 [info ] [MainThread]: 
[0m15:18:19.240607 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:18:19.241645 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:18:19.336494 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:18:19.337495 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:18:19.337495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:21.434588 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.104 seconds
[0m15:18:21.434588 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m15:18:21.452136 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:18:21.452136 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:18:21.452136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:22.971425 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.514 seconds
[0m15:18:22.971425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m15:18:22.971425 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:18:22.971425 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:18:23.311415 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.334 seconds
[0m15:18:23.311415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m15:18:23.359118 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:18:23.359118 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:18:23.699133 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.342 seconds
[0m15:18:23.699133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a5aae74-5b03-4fd0-82ee-25f124f10512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295D88B6330>]}
[0m15:18:23.714973 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m15:18:23.714973 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_product_revenue ......................... [RUN]
[0m15:18:23.714973 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_product_revenue'
[0m15:18:23.714973 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m15:18:23.714973 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m15:18:23.714973 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m15:18:23.746951 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m15:18:23.758613 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m15:18:23.758613 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

WITH cte_product_revenue AS (
    SELECT 
        product_id,
        SUM(revenue) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions 
  
    GROUP BY 
        product_id
)
SELECT 
    product_id,
    total_revenue,
    DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS product_rank
FROM cte_product_revenue
        );
[0m15:18:23.758613 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:26.021777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.262 seconds
[0m15:18:26.047433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a5aae74-5b03-4fd0-82ee-25f124f10512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295D8B70260>]}
[0m15:18:26.047433 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_product_revenue .................... [[32mSUCCESS 1[0m in 2.33s]
[0m15:18:26.048567 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m15:18:26.050606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:26.050606 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:18:26.050606 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:18:26.571893 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m15:18:26.571893 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m15:18:27.112147 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was left open.
[0m15:18:27.112147 [debug] [MainThread]: On model.dbt_first.rank_product_revenue: Close
[0m15:18:27.627951 [info ] [MainThread]: 
[0m15:18:27.627951 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.39 seconds (8.39s).
[0m15:18:27.643513 [debug] [MainThread]: Command end result
[0m15:18:27.675679 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:18:27.675679 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:18:27.675679 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:18:27.675679 [info ] [MainThread]: 
[0m15:18:27.675679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:27.692216 [info ] [MainThread]: 
[0m15:18:27.692216 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:18:27.692216 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:27.692216 after 10.07 seconds
[0m15:18:27.692216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295D4551A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295D4552D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295D4552AE0>]}
[0m15:18:27.692216 [debug] [MainThread]: Flushing usage events
[0m15:18:28.679971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:17.704239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F09B5B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F1F06660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F38C87A0>]}


============================== 15:22:17.711692 | 55d44cc8-048c-4a59-844c-d9d30765e69a ==============================
[0m15:22:17.711692 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:22:17.713701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:fiscal', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:18.234342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55d44cc8-048c-4a59-844c-d9d30765e69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F4182120>]}
[0m15:22:18.284837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55d44cc8-048c-4a59-844c-d9d30765e69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F4004410>]}
[0m15:22:18.300540 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:22:18.798320 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:22:20.198135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:22:20.200142 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\new_logo_each_fiscal.sql
[0m15:22:20.200142 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m15:22:20.435805 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:22:20.460947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55d44cc8-048c-4a59-844c-d9d30765e69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F65362A0>]}
[0m15:22:20.539780 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:22:20.540749 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:22:20.582323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55d44cc8-048c-4a59-844c-d9d30765e69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F64D5C70>]}
[0m15:22:20.582323 [info ] [MainThread]: Found 1 seed, 10 models, 4 sources, 477 macros
[0m15:22:20.582323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55d44cc8-048c-4a59-844c-d9d30765e69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F61A43B0>]}
[0m15:22:20.582323 [info ] [MainThread]: 
[0m15:22:20.582323 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:22:20.588088 [info ] [MainThread]: 
[0m15:22:20.588088 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:22:20.588088 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:22:23.182908 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:22:23.191634 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:22:23.191634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:25.355412 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.167 seconds
[0m15:22:25.355412 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m15:22:25.371179 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:22:25.371179 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:22:25.371179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:26.940636 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.570 seconds
[0m15:22:26.940636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m15:22:26.988333 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:22:26.988333 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:22:27.359901 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.374 seconds
[0m15:22:27.359901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m15:22:27.359901 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:22:27.359901 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:22:27.732167 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.357 seconds
[0m15:22:27.732167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55d44cc8-048c-4a59-844c-d9d30765e69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F682C470>]}
[0m15:22:27.738603 [debug] [Thread-1 (]: Began running node model.dbt_first.new_logo_each_fiscal
[0m15:22:27.740608 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.new_logo_each_fiscal ......................... [RUN]
[0m15:22:27.740608 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.new_logo_each_fiscal'
[0m15:22:27.740608 [debug] [Thread-1 (]: Began compiling node model.dbt_first.new_logo_each_fiscal
[0m15:22:27.749193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.new_logo_each_fiscal"
[0m15:22:27.750799 [debug] [Thread-1 (]: Began executing node model.dbt_first.new_logo_each_fiscal
[0m15:22:27.780702 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.new_logo_each_fiscal"
[0m15:22:27.782743 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.new_logo_each_fiscal"
[0m15:22:27.782743 [debug] [Thread-1 (]: On model.dbt_first.new_logo_each_fiscal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.new_logo_each_fiscal"} */
create or replace transient table HEALTHCARE.mart.new_logo_each_fiscal
         as
        (

WITH cte_first_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date
    FROM
        HEALTHCARE.stage.stg_transactions
    GROUP BY
        customer_id
),
 
cte_extract_year AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_purchase_date) AS fiscal_year
    FROM
        cte_first_purchase
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_logos
FROM
    cte_extract_year
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year;
[0m15:22:27.782743 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:22:29.425416 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff0-0004-bb9f-0005-a3d30003c3f6
[0m15:22:29.425416 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 31 at position 15 unexpected ';'.
[0m15:22:29.440959 [debug] [Thread-1 (]: Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 15 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql
[0m15:22:29.444743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55d44cc8-048c-4a59-844c-d9d30765e69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F695A570>]}
[0m15:22:29.444743 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.new_logo_each_fiscal ................ [[31mERROR[0m in 1.70s]
[0m15:22:29.444743 [debug] [Thread-1 (]: Finished running node model.dbt_first.new_logo_each_fiscal
[0m15:22:29.444743 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.new_logo_each_fiscal' to be skipped because of status 'error'.  Reason: Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 15 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql.
[0m15:22:29.449202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:29.449202 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:22:29.451225 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:22:29.978387 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m15:22:29.978387 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m15:22:30.548228 [debug] [MainThread]: Connection 'model.dbt_first.new_logo_each_fiscal' was left open.
[0m15:22:30.557485 [debug] [MainThread]: On model.dbt_first.new_logo_each_fiscal: Close
[0m15:22:31.097458 [info ] [MainThread]: 
[0m15:22:31.097458 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.51 seconds (10.51s).
[0m15:22:31.097458 [debug] [MainThread]: Command end result
[0m15:22:31.134610 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:22:31.138893 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:22:31.142895 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:22:31.142895 [info ] [MainThread]: 
[0m15:22:31.142895 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:22:31.146997 [info ] [MainThread]: 
[0m15:22:31.146997 [error] [MainThread]:   Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 15 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql
[0m15:22:31.146997 [info ] [MainThread]: 
[0m15:22:31.146997 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:22:31.146997 [debug] [MainThread]: Command `dbt run` failed at 15:22:31.146997 after 13.63 seconds
[0m15:22:31.151545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F09B5B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F3D7FF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F3C3A720>]}
[0m15:22:31.152570 [debug] [MainThread]: Flushing usage events
[0m15:22:32.085685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:43.969837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7D4CD160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7D4CCA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7D4CCE00>]}


============================== 15:22:43.969837 | 1aa55a82-12d2-4bde-ad37-d9d929d23494 ==============================
[0m15:22:43.969837 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:22:43.969837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:fiscal', 'send_anonymous_usage_stats': 'True'}
[0m15:22:44.440310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1aa55a82-12d2-4bde-ad37-d9d929d23494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7A89AC90>]}
[0m15:22:44.503328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1aa55a82-12d2-4bde-ad37-d9d929d23494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7CA42120>]}
[0m15:22:44.503328 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:22:44.862035 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:22:45.035385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:22:45.035385 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\new_logo_each_fiscal.sql
[0m15:22:45.296193 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:22:45.312461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1aa55a82-12d2-4bde-ad37-d9d929d23494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7F84DBE0>]}
[0m15:22:45.391954 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:22:45.394956 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:22:45.414649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1aa55a82-12d2-4bde-ad37-d9d929d23494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7F7E5880>]}
[0m15:22:45.414649 [info ] [MainThread]: Found 1 seed, 10 models, 4 sources, 477 macros
[0m15:22:45.414649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aa55a82-12d2-4bde-ad37-d9d929d23494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7F84E3C0>]}
[0m15:22:45.414649 [info ] [MainThread]: 
[0m15:22:45.414649 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:22:45.414649 [info ] [MainThread]: 
[0m15:22:45.414649 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:22:45.414649 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:22:45.529473 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:22:45.530473 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:22:45.530473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:47.403339 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.874 seconds
[0m15:22:47.425362 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m15:22:47.451363 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:22:47.451363 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:22:47.452404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:48.999730 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.556 seconds
[0m15:22:48.999730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m15:22:48.999730 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:22:48.999730 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:22:49.370823 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.370 seconds
[0m15:22:49.386934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m15:22:49.434725 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:22:49.434725 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:22:49.792135 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.359 seconds
[0m15:22:49.798268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1aa55a82-12d2-4bde-ad37-d9d929d23494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7A933A10>]}
[0m15:22:49.798268 [debug] [Thread-1 (]: Began running node model.dbt_first.new_logo_each_fiscal
[0m15:22:49.798268 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.new_logo_each_fiscal ......................... [RUN]
[0m15:22:49.798268 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.new_logo_each_fiscal'
[0m15:22:49.798268 [debug] [Thread-1 (]: Began compiling node model.dbt_first.new_logo_each_fiscal
[0m15:22:49.807901 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.new_logo_each_fiscal"
[0m15:22:49.807901 [debug] [Thread-1 (]: Began executing node model.dbt_first.new_logo_each_fiscal
[0m15:22:49.837730 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.new_logo_each_fiscal"
[0m15:22:49.837730 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.new_logo_each_fiscal"
[0m15:22:49.837730 [debug] [Thread-1 (]: On model.dbt_first.new_logo_each_fiscal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.new_logo_each_fiscal"} */
create or replace transient table HEALTHCARE.mart.new_logo_each_fiscal
         as
        (

WITH cte_first_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date
    FROM
        HEALTHCARE.stage.stg_transactions
    GROUP BY
        customer_id
),
 
cte_extract_year AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_purchase_date) AS fiscal_year
    FROM
        cte_first_purchase
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_logos
FROM
    cte_extract_year
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m15:22:49.837730 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:22:52.101133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.265 seconds
[0m15:22:52.116925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1aa55a82-12d2-4bde-ad37-d9d929d23494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7C9B0B60>]}
[0m15:22:52.132940 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.new_logo_each_fiscal .................... [[32mSUCCESS 1[0m in 2.32s]
[0m15:22:52.132940 [debug] [Thread-1 (]: Finished running node model.dbt_first.new_logo_each_fiscal
[0m15:22:52.132940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:52.132940 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:22:52.132940 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:22:52.667097 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m15:22:52.667097 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m15:22:53.168523 [debug] [MainThread]: Connection 'model.dbt_first.new_logo_each_fiscal' was left open.
[0m15:22:53.168523 [debug] [MainThread]: On model.dbt_first.new_logo_each_fiscal: Close
[0m15:22:53.734668 [info ] [MainThread]: 
[0m15:22:53.734668 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.32 seconds (8.32s).
[0m15:22:53.748079 [debug] [MainThread]: Command end result
[0m15:22:53.774143 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:22:53.774143 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:22:53.774143 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:22:53.774143 [info ] [MainThread]: 
[0m15:22:53.774143 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:53.774143 [info ] [MainThread]: 
[0m15:22:53.774143 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:22:53.788513 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:53.788513 after 9.97 seconds
[0m15:22:53.789553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7DF5F440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7DF5E6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017A7DF5D640>]}
[0m15:22:53.789553 [debug] [MainThread]: Flushing usage events
[0m15:22:54.796889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:34:50.919522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022029F559D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022029F57BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022029F55520>]}


============================== 15:34:50.925133 | 2c91e609-5baa-405f-aa92-9f8b24a4488f ==============================
[0m15:34:50.925133 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:34:50.926113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:fiscal', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:34:51.403368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c91e609-5baa-405f-aa92-9f8b24a4488f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022029402390>]}
[0m15:34:51.462552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c91e609-5baa-405f-aa92-9f8b24a4488f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220294C1AF0>]}
[0m15:34:51.462552 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:34:51.821887 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:34:51.948550 [debug] [MainThread]: Failed to load parsed file from disk at C:\Users\VarshaS\dbt_first\target\partial_parse.msgpack: Field "files" of type MutableMapping[str, Union[SchemaSourceFile, SourceFile, FixtureSourceFile]] in Manifest has invalid value {'dbt_first://macros\\generate_custom_schema.sql': {'path': {'searched_path': 'macros', 'relative_path': 'generate_custom_schema.sql', 'modification_time': 1741925833.5505874, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': '0516e108f4a4e9645a785e31d4067cd1e67e9f53504e9200b29c689372cab590'}, 'project_name': 'dbt_first', 'parse_file_type': 'macro', 'macros': ['macro.dbt_first.generate_schema_name']}, 'dbt_first://models\\Stage\\stg_country_region.sql': {'path': {'searched_path': 'models', 'relative_path': 'Stage\\stg_country_region.sql', 'modification_time': 1741936888.8418913, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': 'e7a89e446f0a52f92b382c63b6b05b0a68987682fff01017c26f46d16ce828ee'}, 'project_name': 'dbt_first', 'parse_file_type': 'model', 'nodes': ['model.dbt_first.stg_country_region']}, 'dbt_first://models\\Stage\\stg_customers.sql': {'path': {'searched_path': 'models', 'relative_path': 'Stage\\stg_customers.sql', 'modification_time': 1741936912.1988828, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': '7bf8ed52ec4dc64b1e3e85e5548ad4a347fe6aad21cc0aa4795dd0f66fa42e24'}, 'project_name': 'dbt_first', 'parse_file_type': 'model', 'nodes': ['model.dbt_first.stg_customers']}, 'dbt_first://models\\Stage\\stg_products.sql': {'path': {'searched_path': 'models', 'relative_path': 'Stage\\stg_products.sql', 'modification_time': 1741936132.7968152, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': '02d3174ff9b305a7cb3788171b9f5b02df255a35bbf4da95cc60757e5f1e0df0'}, 'project_name': 'dbt_first', 'parse_file_type': 'model', 'nodes': ['model.dbt_first.stg_products']}, 'dbt_first://models\\Stage\\stg_transactions.sql': {'path': {'searched_path': 'models', 'relative_path': 'Stage\\stg_transactions.sql', 'modification_time': 1741936180.1039896, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': '421853534f795eb95d4240d903d9611ec386d3d02ad266852f5ab31b377361fc'}, 'project_name': 'dbt_first', 'parse_file_type': 'model', 'nodes': ['model.dbt_first.stg_transactions']}, 'dbt_first://seeds\\country_region.csv': {'path': {'searched_path': 'seeds', 'relative_path': 'country_region.csv', 'modification_time': 1741925834.0085764, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': '2b7b6a54ae2c2b8b295d661f2bde6deafd4e8bce548cf23b691ba5fb013b245b'}, 'project_name': 'dbt_first', 'parse_file_type': 'seed', 'nodes': ['seed.dbt_first.country_region']}, 'dbt_first://models\\Stage\\sources.yml': {'path': {'searched_path': 'models', 'relative_path': 'Stage\\sources.yml', 'modification_time': 1741925833.782114, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': '556ce8a96ff73b76fb4be004a9e3cf078acde2dfafb686dba26c8956482ef4e2'}, 'project_name': 'dbt_first', 'parse_file_type': 'schema', 'dfy': {'version': 2, 'sources': [{'name': 'sources', 'database': 'HEALTHCARE', 'schema': 'RAW', 'tables': [{'name': 'CUSTOMERS'}, {'name': 'PRODUCTS'}, {'name': 'TRANSACTIONS'}, {'name': 'COUNTRY_REGION'}]}]}, 'data_tests': {}, 'sources': ['source.dbt_first.sources.CUSTOMERS', 'source.dbt_first.sources.PRODUCTS', 'source.dbt_first.sources.TRANSACTIONS', 'source.dbt_first.sources.COUNTRY_REGION'], 'metrics_from_measures': {}, 'mcp': {}, 'env_vars': {}, 'unrendered_configs': {}, 'unrendered_databases': {'sources': {'sources': 'HEALTHCARE'}}, 'unrendered_schemas': {'sources': {'sources': 'RAW'}}}, 'dbt_snowflake://macros\\adapters.sql': {'path': {'searched_path': 'macros', 'relative_path': 'adapters.sql', 'modification_time': 1741579342.2155292, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '1cd45de77196d7c56a79e16bacec7c53cddb4d6f36e3c4d62b9b75b05b877dec'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.get_column_comment_sql', 'macro.dbt_snowflake.get_persist_docs_column_list', 'macro.dbt_snowflake.snowflake__get_columns_in_relation', 'macro.dbt_snowflake.snowflake__show_object_metadata', 'macro.dbt_snowflake.snowflake__list_schemas', 'macro.dbt_snowflake.snowflake__get_paginated_relations_array', 'macro.dbt_snowflake.snowflake__list_relations_without_caching', 'macro.dbt_snowflake.snowflake__check_schema_exists', 'macro.dbt_snowflake.snowflake__alter_column_type', 'macro.dbt_snowflake.snowflake__alter_relation_comment', 'macro.dbt_snowflake.snowflake__alter_column_comment', 'macro.dbt_snowflake.get_current_query_tag', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt_snowflake.snowflake__set_query_tag', 'macro.dbt_snowflake.unset_query_tag', 'macro.dbt_snowflake.snowflake__unset_query_tag', 'macro.dbt_snowflake.snowflake__alter_relation_add_remove_columns', 'macro.dbt_snowflake.snowflake_dml_explicit_transaction', 'macro.dbt_snowflake.snowflake__truncate_relation']}, 'dbt_snowflake://macros\\apply_grants.sql': {'path': {'searched_path': 'macros', 'relative_path': 'apply_grants.sql', 'modification_time': 1741579342.2175343, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'e3a0e7f03800275adc9d2f996d73b7135575d39dd6e5ed401de0a789174e96a8'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__copy_grants', 'macro.dbt_snowflake.snowflake__support_multiple_grantees_per_dcl_statement']}, 'dbt_snowflake://macros\\catalog.sql': {'path': {'searched_path': 'macros', 'relative_path': 'catalog.sql', 'modification_time': 1741579342.2175343, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '60619b32e7ebc3367cd63df3e9613078f4ce482f14e43c29bd57ebe617b9b611'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_catalog', 'macro.dbt_snowflake.snowflake__get_catalog_relations', 'macro.dbt_snowflake.snowflake__get_catalog_tables_sql', 'macro.dbt_snowflake.snowflake__get_catalog_columns_sql', 'macro.dbt_snowflake.snowflake__get_catalog_results_sql', 'macro.dbt_snowflake.snowflake__catalog_equals', 'macro.dbt_snowflake.snowflake__get_catalog_schemas_where_clause_sql', 'macro.dbt_snowflake.snowflake__get_catalog_relations_where_clause_sql']}, 'dbt_snowflake://macros\\metadata.sql': {'path': {'searched_path': 'macros', 'relative_path': 'metadata.sql', 'modification_time': 1741579342.2175343, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '0d02059a22d98e75842de3da7937e2ca7c22a890f0648bb413f471885bd6a72f'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_relation_last_modified']}, 'dbt_snowflake://macros\\materializations\\clone.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\clone.sql', 'modification_time': 1741579342.21954, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '84d9b8671a2db3d749b90c43b67869c5f789ace177e850736314a67fd6b57648'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__can_clone_table', 'macro.dbt_snowflake.snowflake__create_or_replace_clone']}, 'dbt_snowflake://macros\\materializations\\dynamic_table.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\dynamic_table.sql', 'modification_time': 1741579342.21954, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'bc7589806f58b39c523dfc2902d26c1923fb0e3003f60d5e0e490399b09d936a'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.materialization_dynamic_table_snowflake', 'macro.dbt_snowflake.dynamic_table_get_build_sql', 'macro.dbt_snowflake.dynamic_table_execute_no_op', 'macro.dbt_snowflake.dynamic_table_execute_build_sql', 'macro.dbt_snowflake.snowflake__get_dynamic_table_configuration_changes']}, 'dbt_snowflake://macros\\materializations\\incremental.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\incremental.sql', 'modification_time': 1741579342.2235508, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '62c2e79d983a194f447e1604b1baf18cb414bb1099d489b5e184cbbff6531050'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.dbt_snowflake_get_tmp_relation_type', 'macro.dbt_snowflake.materialization_incremental_snowflake', 'macro.dbt_snowflake.snowflake__get_incremental_default_sql']}, 'dbt_snowflake://macros\\materializations\\seed.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\seed.sql', 'modification_time': 1741579342.2235508, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'f9969d964bc033afca1c9e549dc44fda6af23389bae8b0aea38d9f44585c2d5b'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__load_csv_rows', 'macro.dbt_snowflake.materialization_seed_snowflake']}, 'dbt_snowflake://macros\\materializations\\snapshot.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\snapshot.sql', 'modification_time': 1741579342.2235508, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '341d2d51c292bd438c06c4b2533f088556ffeaa12c592691d89200d3f36a93d4'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.materialization_snapshot_snowflake']}, 'dbt_snowflake://macros\\materializations\\table.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\table.sql', 'modification_time': 1741579342.2235508, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'edeb3a2bbb71011947aaca191b6af41ee7da4b97672b46110bd8f529bf3bc0c9'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.materialization_table_snowflake', 'macro.dbt_snowflake.py_write_table']}, 'dbt_snowflake://macros\\materializations\\test.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\test.sql', 'modification_time': 1741579342.2293086, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'a3210d472381caac5089c2320be097fe6cd48dc3eae043790025a87550631307'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.materialization_test_snowflake']}, 'dbt_snowflake://macros\\materializations\\view.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\view.sql', 'modification_time': 1741579342.2293086, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'cdcbc4a377c5f998ff843eaead59a5ac39206d9cffb56ec508a405722e073ac4'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.materialization_view_snowflake']}, 'dbt_snowflake://macros\\materializations\\incremental\\insert_overwrite.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\incremental\\insert_overwrite.sql', 'modification_time': 1741579342.231314, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'b92416484934767ea44da5ed23ba9e786950582ce6af806ed52bd96831faf81a'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.get_incremental_insert_overwrite_sql', 'macro.dbt_snowflake.snowflake__insert_overwrite_get_sql']}, 'dbt_snowflake://macros\\materializations\\incremental\\merge.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\incremental\\merge.sql', 'modification_time': 1741579342.2333193, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'dcd6a1d374a52dcf1123b5010535500fe9e2a23f35cfba67949366bb9af28fea'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_merge_sql', 'macro.dbt_snowflake.snowflake__get_delete_insert_merge_sql', 'macro.dbt_snowflake.snowflake__snapshot_merge_sql', 'macro.dbt_snowflake.snowflake__get_incremental_append_sql', 'macro.dbt_snowflake.snowflake__get_incremental_microbatch_sql']}, 'dbt_snowflake://macros\\relations\\create.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\create.sql', 'modification_time': 1741579342.2333193, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '21eebbaea12af7ca61c7cc25bf1b4b402657ad2924f23f269ef770b2893b6143'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_create_sql']}, 'dbt_snowflake://macros\\relations\\create_backup.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\create_backup.sql', 'modification_time': 1741579342.2333193, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '69b7415a2dd117999822b14bbfea2d5a8f23c8691e01aefa65ca294582286fd5'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_create_backup_sql']}, 'dbt_snowflake://macros\\relations\\drop.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\drop.sql', 'modification_time': 1741579342.2453465, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '8741adcc93cb2d649a372e262e3785c8e96a53de63b37f957a50f0267ae296bd'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_drop_sql']}, 'dbt_snowflake://macros\\relations\\rename.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\rename.sql', 'modification_time': 1741579342.2453465, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '6c8528b5fa848752bc196b3a80d684f50dcab423ee09f2dea7be05b297f11163'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__rename_relation']}, 'dbt_snowflake://macros\\relations\\rename_intermediate.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\rename_intermediate.sql', 'modification_time': 1741579342.2611127, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '1e1f76d3453ae5397047765b70d04b23a5c503e966c35e9816486cf6315e22b0'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_rename_intermediate_sql']}, 'dbt_snowflake://macros\\relations\\replace.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\replace.sql', 'modification_time': 1741579342.2611127, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'c3e55739bd254e63c9bd33d03c3ce0cf00b726d06c6772be6414e63a1a198cbf'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_replace_sql']}, 'dbt_snowflake://macros\\relations\\dynamic_table\\alter.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\dynamic_table\\alter.sql', 'modification_time': 1741579342.2631173, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '6111f481a1a7d176e4b13ba3b9015b76a1e3655ea6a6e3c41b6a80d183bc1517'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_alter_dynamic_table_as_sql']}, 'dbt_snowflake://macros\\relations\\dynamic_table\\create.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\dynamic_table\\create.sql', 'modification_time': 1741579342.2631173, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '3b8142db88fff2475b4e9e23abe675561ad60dc335b9e01d9e9c6da18c8ee7c1'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_create_dynamic_table_as_sql', 'macro.dbt_snowflake._get_create_dynamic_standard_table_as_sql', 'macro.dbt_snowflake._get_create_dynamic_iceberg_table_as_sql']}, 'dbt_snowflake://macros\\relations\\dynamic_table\\describe.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\dynamic_table\\describe.sql', 'modification_time': 1741579342.2651224, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'c66aa85a2ea44476a10934843fb85a03262d3356408335605f8ac722e81c3556'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__describe_dynamic_table', 'macro.dbt_snowflake._get_describe_iceberg_catalog_sql']}, 'dbt_snowflake://macros\\relations\\dynamic_table\\drop.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\dynamic_table\\drop.sql', 'modification_time': 1741579342.2691324, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '36841999c766e89fb195a31791298c215f0eb0eecb8f44b41575632448a80773'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_drop_dynamic_table_sql']}, 'dbt_snowflake://macros\\relations\\dynamic_table\\refresh.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\dynamic_table\\refresh.sql', 'modification_time': 1741579342.2691324, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '68ee1639a6b0368b1b8a07556d9c488e13358d495ae3802d1c1e4b6cff123735'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__refresh_dynamic_table']}, 'dbt_snowflake://macros\\relations\\dynamic_table\\replace.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\dynamic_table\\replace.sql', 'modification_time': 1741579342.2711387, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'c8793d62728f8667d628491ece17db26b296f865f5ca1fe8685d74c34b41347a'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_replace_dynamic_table_sql', 'macro.dbt_snowflake._get_replace_dynamic_standard_table_as_sql', 'macro.dbt_snowflake._get_replace_dynamic_iceberg_table_as_sql']}, 'dbt_snowflake://macros\\relations\\table\\create.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\table\\create.sql', 'modification_time': 1741579342.2731452, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'f12e9ab4cdbbd9ed2cf5ddad657f78843db2863260364247a03bff47a1f3fcb3'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__create_table_as']}, 'dbt_snowflake://macros\\relations\\table\\drop.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\table\\drop.sql', 'modification_time': 1741579342.2731452, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '02cc4c8696f20afad40ed6a695e304f59ba447c0e192db29121f4579ea0ed2f7'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_drop_table_sql']}, 'dbt_snowflake://macros\\relations\\table\\rename.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\table\\rename.sql', 'modification_time': 1741579342.274893, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'c41eeadc65eab3d36e027a2f25d4d14fdcc56216383f169e9a554494d78b4915'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_rename_table_sql']}, 'dbt_snowflake://macros\\relations\\table\\replace.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\table\\replace.sql', 'modification_time': 1741579342.274893, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '42240a4441c7c3f585bcdcef9c9ea9d836f578c447dbade19cb3753444f89789'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_replace_table_sql']}, 'dbt_snowflake://macros\\relations\\view\\create.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\view\\create.sql', 'modification_time': 1741579342.2768986, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '10d1e4c505aae8758eab9c0d4821d97d927504e846942bb94f25c8a2ec62ab2b'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__create_view_as_with_temp_flag', 'macro.dbt_snowflake.snowflake__create_view_as', 'macro.dbt_snowflake.snowflake__create_or_replace_view']}, 'dbt_snowflake://macros\\relations\\view\\drop.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\view\\drop.sql', 'modification_time': 1741579342.2789042, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'ae6d5aef1914177a284df3d3eec81e90f10150d798e9231ed093d2bff4cbfe89'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_drop_view_sql']}, 'dbt_snowflake://macros\\relations\\view\\rename.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\view\\rename.sql', 'modification_time': 1741579342.2789042, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '58761b098ed10e229923d10fdf7974d25004a17c0bfec650fb851da83e6f8d1d'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_rename_view_sql']}, 'dbt_snowflake://macros\\relations\\view\\replace.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\view\\replace.sql', 'modification_time': 1741579342.2789042, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '9c5368e6953d5f5296849892af2b6a289cfa085afc920a0a555b7c33c1a86439'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__get_replace_view_sql']}, 'dbt_snowflake://macros\\utils\\array_construct.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\array_construct.sql', 'modification_time': 1741579342.28091, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'b06c2a6f3072dbbca8e94839193a2f5c3262c6c21e30716813ec3680404c3e4c'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__array_construct']}, 'dbt_snowflake://macros\\utils\\bool_or.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\bool_or.sql', 'modification_time': 1741579342.28091, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '385d3d692f343343e9da2b2c5ca07d03d36744b0731f5f943a1bfd075d3925eb'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__bool_or']}, 'dbt_snowflake://macros\\utils\\cast.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\cast.sql', 'modification_time': 1741579342.28091, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'e136efe81aa13f7d858ed380cc60a5d4034b0ae3652d7644b4fe18013363b15c'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__cast']}, 'dbt_snowflake://macros\\utils\\escape_single_quotes.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\escape_single_quotes.sql', 'modification_time': 1741579342.2829156, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'e4e0b47c6dc8263f4e1c44e07594977322995bc21794734fc0ca9178d4cb70f9'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__escape_single_quotes']}, 'dbt_snowflake://macros\\utils\\optional.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\optional.sql', 'modification_time': 1741579342.2829156, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'fe49a8f59f1cc19ffdf49d9249c697d238a64d66137d57df3bd85bd2c63c5729'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.optional']}, 'dbt_snowflake://macros\\utils\\right.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\right.sql', 'modification_time': 1741579342.2829156, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'c01b249cffb226b3019064e69850021943d9761b37bf9c832bc57d2bb5488758'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__right']}, 'dbt_snowflake://macros\\utils\\safe_cast.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\safe_cast.sql', 'modification_time': 1741579342.284922, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': 'aec7be3a6b6cc939ba576c9e921ac35322edbe74410bcc758f87474048ce8738'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__safe_cast']}, 'dbt_snowflake://macros\\utils\\timestamps.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\timestamps.sql', 'modification_time': 1741579342.284922, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\snowflake'}, 'checksum': {'name': 'sha256', 'checksum': '1cf6adf012a773e884cc3685e0031e4e1eeea0acf272aee8ab3039b18dcdd2cf'}, 'project_name': 'dbt_snowflake', 'parse_file_type': 'macro', 'macros': ['macro.dbt_snowflake.snowflake__current_timestamp', 'macro.dbt_snowflake.snowflake__snapshot_string_as_time', 'macro.dbt_snowflake.snowflake__snapshot_get_time', 'macro.dbt_snowflake.snowflake__current_timestamp_backcompat', 'macro.dbt_snowflake.snowflake__current_timestamp_in_utc_backcompat']}, 'dbt://macros\\adapters\\apply_grants.sql': {'path': {'searched_path': 'macros', 'relative_path': 'adapters\\apply_grants.sql', 'modification_time': 1741579310.401116, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'f0166958bfcd465fe888ea2eb4e1dd9b9646a58195736a409e66fdeb2b08faeb'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.copy_grants', 'macro.dbt.default__copy_grants', 'macro.dbt.support_multiple_grantees_per_dcl_statement', 'macro.dbt.default__support_multiple_grantees_per_dcl_statement', 'macro.dbt.should_revoke', 'macro.dbt.get_show_grant_sql', 'macro.dbt.default__get_show_grant_sql', 'macro.dbt.get_grant_sql', 'macro.dbt.default__get_grant_sql', 'macro.dbt.get_revoke_sql', 'macro.dbt.default__get_revoke_sql', 'macro.dbt.get_dcl_statement_list', 'macro.dbt.default__get_dcl_statement_list', 'macro.dbt.call_dcl_statements', 'macro.dbt.default__call_dcl_statements', 'macro.dbt.apply_grants', 'macro.dbt.default__apply_grants']}, 'dbt://macros\\adapters\\columns.sql': {'path': {'searched_path': 'macros', 'relative_path': 'adapters\\columns.sql', 'modification_time': 1741579310.401116, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'b5451fad0e8602a946b4e5ef9639c0ebc22943e213c284d26e36d75a50ae53d0'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_columns_in_relation', 'macro.dbt.default__get_columns_in_relation', 'macro.dbt.sql_convert_columns_in_relation', 'macro.dbt.get_empty_subquery_sql', 'macro.dbt.default__get_empty_subquery_sql', 'macro.dbt.get_empty_schema_sql', 'macro.dbt.default__get_empty_schema_sql', 'macro.dbt.get_column_schema_from_query', 'macro.dbt.get_columns_in_query', 'macro.dbt.default__get_columns_in_query', 'macro.dbt.alter_column_type', 'macro.dbt.default__alter_column_type', 'macro.dbt.alter_relation_add_remove_columns', 'macro.dbt.default__alter_relation_add_remove_columns']}, 'dbt://macros\\adapters\\freshness.sql': {'path': {'searched_path': 'macros', 'relative_path': 'adapters\\freshness.sql', 'modification_time': 1741579310.401116, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'a7f1bcf5d41109bebcfc7c1840d9468c672a4f9dddd35329573354db119ab2ad'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.collect_freshness', 'macro.dbt.default__collect_freshness', 'macro.dbt.collect_freshness_custom_sql', 'macro.dbt.default__collect_freshness_custom_sql']}, 'dbt://macros\\adapters\\indexes.sql': {'path': {'searched_path': 'macros', 'relative_path': 'adapters\\indexes.sql', 'modification_time': 1741579310.401116, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'f6e06969b303b1bdcb1366c80fbdea6de290a2c53cb8698c6c24d3020877ee21'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_create_index_sql', 'macro.dbt.default__get_create_index_sql', 'macro.dbt.create_indexes', 'macro.dbt.default__create_indexes', 'macro.dbt.get_drop_index_sql', 'macro.dbt.default__get_drop_index_sql', 'macro.dbt.get_show_indexes_sql', 'macro.dbt.default__get_show_indexes_sql']}, 'dbt://macros\\adapters\\metadata.sql': {'path': {'searched_path': 'macros', 'relative_path': 'adapters\\metadata.sql', 'modification_time': 1741579310.401116, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '47019f89a7f6c49c6075bf910d2cc4b7219cfd355c5494e753bd441a39099e98'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_catalog_relations', 'macro.dbt.default__get_catalog_relations', 'macro.dbt.get_catalog', 'macro.dbt.default__get_catalog', 'macro.dbt.information_schema_name', 'macro.dbt.default__information_schema_name', 'macro.dbt.list_schemas', 'macro.dbt.default__list_schemas', 'macro.dbt.check_schema_exists', 'macro.dbt.default__check_schema_exists', 'macro.dbt.list_relations_without_caching', 'macro.dbt.default__list_relations_without_caching', 'macro.dbt.get_catalog_for_single_relation', 'macro.dbt.default__get_catalog_for_single_relation', 'macro.dbt.get_relations', 'macro.dbt.default__get_relations', 'macro.dbt.get_relation_last_modified', 'macro.dbt.default__get_relation_last_modified']}, 'dbt://macros\\adapters\\persist_docs.sql': {'path': {'searched_path': 'macros', 'relative_path': 'adapters\\persist_docs.sql', 'modification_time': 1741579310.416983, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '20cf90d527d1fb977f99c2e08115cc19aa41d691c00dedb29e399b7020d8b803'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.alter_column_comment', 'macro.dbt.default__alter_column_comment', 'macro.dbt.alter_relation_comment', 'macro.dbt.default__alter_relation_comment', 'macro.dbt.persist_docs', 'macro.dbt.default__persist_docs']}, 'dbt://macros\\adapters\\relation.sql': {'path': {'searched_path': 'macros', 'relative_path': 'adapters\\relation.sql', 'modification_time': 1741579310.416983, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '2855dcee32ba00974214d48db517555797447da509ad255fd2786c3c3a238d27'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.make_intermediate_relation', 'macro.dbt.default__make_intermediate_relation', 'macro.dbt.make_temp_relation', 'macro.dbt.default__make_temp_relation', 'macro.dbt.make_backup_relation', 'macro.dbt.default__make_backup_relation', 'macro.dbt.truncate_relation', 'macro.dbt.default__truncate_relation', 'macro.dbt.get_or_create_relation', 'macro.dbt.default__get_or_create_relation', 'macro.dbt.load_cached_relation', 'macro.dbt.load_relation']}, 'dbt://macros\\adapters\\schema.sql': {'path': {'searched_path': 'macros', 'relative_path': 'adapters\\schema.sql', 'modification_time': 1741579310.416983, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'f5b800311512dba70712e7d4131a8a3fb1e113b4a31768d76d8b5f2eef405dbb'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.create_schema', 'macro.dbt.default__create_schema', 'macro.dbt.drop_schema', 'macro.dbt.default__drop_schema']}, 'dbt://macros\\adapters\\show.sql': {'path': {'searched_path': 'macros', 'relative_path': 'adapters\\show.sql', 'modification_time': 1741579310.416983, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'd96b77ae50ff36dc1b1f4c88b6ec757d855257ea2019a9e7c879ee32863aaf68'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_show_sql', 'macro.dbt.get_limit_subquery_sql', 'macro.dbt.default__get_limit_sql']}, 'dbt://macros\\adapters\\timestamps.sql': {'path': {'searched_path': 'macros', 'relative_path': 'adapters\\timestamps.sql', 'modification_time': 1741579310.416983, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '4d17728f1d76c68ec2dcf7150db4d5f033847ce2b96bfdcfbe099f06a3fceef9'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.current_timestamp', 'macro.dbt.default__current_timestamp', 'macro.dbt.snapshot_get_time', 'macro.dbt.default__snapshot_get_time', 'macro.dbt.get_snapshot_get_time_data_type', 'macro.dbt.current_timestamp_backcompat', 'macro.dbt.default__current_timestamp_backcompat', 'macro.dbt.current_timestamp_in_utc_backcompat', 'macro.dbt.default__current_timestamp_in_utc_backcompat']}, 'dbt://macros\\adapters\\validate_sql.sql': {'path': {'searched_path': 'macros', 'relative_path': 'adapters\\validate_sql.sql', 'modification_time': 1741579310.4210787, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'a001893a80049b0c0dd0a05c04462e1aba0b79a84473232fb68984b997f730a9'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.validate_sql', 'macro.dbt.default__validate_sql']}, 'dbt://macros\\etc\\datetime.sql': {'path': {'searched_path': 'macros', 'relative_path': 'etc\\datetime.sql', 'modification_time': 1741579310.4210787, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '1674180b85da07e6f41309f96dffcb56622429be3b51f9ceda0ee28ca73f5a1a'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.convert_datetime', 'macro.dbt.dates_in_range', 'macro.dbt.partition_range', 'macro.dbt.py_current_timestring']}, 'dbt://macros\\etc\\statement.sql': {'path': {'searched_path': 'macros', 'relative_path': 'etc\\statement.sql', 'modification_time': 1741579310.4210787, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '2b131961ddbc7e3b9ccdefe6309cbb6fa958e6dee6d728e223120a14435db6a0'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.statement', 'macro.dbt.noop_statement', 'macro.dbt.run_query']}, 'dbt://macros\\generic_test_sql\\accepted_values.sql': {'path': {'searched_path': 'macros', 'relative_path': 'generic_test_sql\\accepted_values.sql', 'modification_time': 1741579310.4210787, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'c93ed1cc4fb5d4e3a46c3747b617772c6084f79e69d09211e2a31d532b031c88'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.default__test_accepted_values']}, 'dbt://macros\\generic_test_sql\\not_null.sql': {'path': {'searched_path': 'macros', 'relative_path': 'generic_test_sql\\not_null.sql', 'modification_time': 1741579310.4210787, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'e8bd19204cdf66ae5ee35da1d172e90f00b6e65f2b058d2120d0868d62f14a55'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.default__test_not_null']}, 'dbt://macros\\generic_test_sql\\relationships.sql': {'path': {'searched_path': 'macros', 'relative_path': 'generic_test_sql\\relationships.sql', 'modification_time': 1741579310.4210787, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '27b0441d03a3f8f6c1a58ceab429ba1575bb90dd111c091f1e5becbcc3804a82'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.default__test_relationships']}, 'dbt://macros\\generic_test_sql\\unique.sql': {'path': {'searched_path': 'macros', 'relative_path': 'generic_test_sql\\unique.sql', 'modification_time': 1741579310.4210787, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '7acb068b5daf2147b6a6a1b89610baee7e23a59690f3ae8190833d3df91d3b1a'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.default__test_unique']}, 'dbt://macros\\get_custom_name\\get_custom_alias.sql': {'path': {'searched_path': 'macros', 'relative_path': 'get_custom_name\\get_custom_alias.sql', 'modification_time': 1741579310.4270828, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '0acd33e645a8db35ac0efae54141bb006db0104d54a19fdc3b09731d2d3192a1'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.generate_alias_name', 'macro.dbt.default__generate_alias_name']}, 'dbt://macros\\get_custom_name\\get_custom_database.sql': {'path': {'searched_path': 'macros', 'relative_path': 'get_custom_name\\get_custom_database.sql', 'modification_time': 1741579310.4270828, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'cddf72116416a5c30316a0f85de82f9f0a9af764579b738b9d530bbc27d05604'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.generate_database_name', 'macro.dbt.default__generate_database_name']}, 'dbt://macros\\get_custom_name\\get_custom_schema.sql': {'path': {'searched_path': 'macros', 'relative_path': 'get_custom_name\\get_custom_schema.sql', 'modification_time': 1741579310.4270828, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '8bb73b9c91225bbb23e90104cbb03f904d3ba925960bee15812346c3b1bdbaf2'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.generate_schema_name', 'macro.dbt.default__generate_schema_name', 'macro.dbt.generate_schema_name_for_env']}, 'dbt://macros\\materializations\\configs.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\configs.sql', 'modification_time': 1741579310.4290884, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '80b9911692ffec727df78e2ec7e1f9db151097be6776f3c312e159be6ffd8304'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.set_sql_header', 'macro.dbt.should_full_refresh', 'macro.dbt.should_store_failures']}, 'dbt://macros\\materializations\\hooks.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\hooks.sql', 'modification_time': 1741579310.4290884, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'ed41b8d1ba2bb7d5c03358dc2a3a8451f9308dcdf9133c8ebc864da5e03ec761'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.run_hooks', 'macro.dbt.make_hook_config', 'macro.dbt.before_begin', 'macro.dbt.in_transaction', 'macro.dbt.after_commit']}, 'dbt://macros\\materializations\\models\\materialized_view.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\models\\materialized_view.sql', 'modification_time': 1741579310.4290884, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '30f4dd599ec877a6798e770222e5fd364fbccd47ee24ece446103a01f67abc08'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.materialization_materialized_view_default', 'macro.dbt.materialized_view_setup', 'macro.dbt.materialized_view_teardown', 'macro.dbt.materialized_view_get_build_sql', 'macro.dbt.materialized_view_execute_no_op', 'macro.dbt.materialized_view_execute_build_sql']}, 'dbt://macros\\materializations\\models\\table.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\models\\table.sql', 'modification_time': 1741579310.4290884, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '3413d393d88545f1670725f8a452f60a2061cc66b0c1ddd9f28ba91b442b04b7'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.materialization_table_default']}, 'dbt://macros\\materializations\\models\\view.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\models\\view.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'e5e020732cff4f18aba80e75aa216e569a082f77d1f602d4eafa73fa07e6d9fb'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.materialization_view_default']}, 'dbt://macros\\materializations\\models\\clone\\can_clone_table.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\models\\clone\\can_clone_table.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '128b0c400b9e6f33bf3f03b2beffc57b8f9f6231000ac9a695315377943a41d9'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.can_clone_table', 'macro.dbt.default__can_clone_table']}, 'dbt://macros\\materializations\\models\\clone\\clone.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\models\\clone\\clone.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'c48a23293b86dfbf174c4beec815f6adef5aacac0425f089dd1939ffe77b9f82'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.materialization_clone_default']}, 'dbt://macros\\materializations\\models\\clone\\create_or_replace_clone.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\models\\clone\\create_or_replace_clone.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'c781c9f4d532dfd5a3d5a0e75aa71faad8eb35f7cc138798d98bb994d1b2f640'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.create_or_replace_clone', 'macro.dbt.default__create_or_replace_clone']}, 'dbt://macros\\materializations\\models\\incremental\\column_helpers.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\models\\incremental\\column_helpers.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '1942a82055b53d897047ee7b72a4492add9512bb2316b5b72bafbe478241c31c'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_quoted_csv', 'macro.dbt.diff_columns', 'macro.dbt.diff_column_data_types', 'macro.dbt.get_merge_update_columns', 'macro.dbt.default__get_merge_update_columns']}, 'dbt://macros\\materializations\\models\\incremental\\incremental.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\models\\incremental\\incremental.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '28ad6d00d59743a6f08107a5036fcd24dbeca600426df3f354289b011d92832f'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.materialization_incremental_default']}, 'dbt://macros\\materializations\\models\\incremental\\is_incremental.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\models\\incremental\\is_incremental.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '223c405740dc5d944321f88800fb5a00db4f2c04b5b96d474a521980ebd771b3'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.is_incremental']}, 'dbt://macros\\materializations\\models\\incremental\\merge.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\models\\incremental\\merge.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '05edaf45f3d8f71bad928c5f45b18b2b64ae44ae4610492e6f39a7095daa3f02'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_merge_sql', 'macro.dbt.default__get_merge_sql', 'macro.dbt.get_delete_insert_merge_sql', 'macro.dbt.default__get_delete_insert_merge_sql', 'macro.dbt.get_insert_overwrite_merge_sql', 'macro.dbt.default__get_insert_overwrite_merge_sql']}, 'dbt://macros\\materializations\\models\\incremental\\on_schema_change.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\models\\incremental\\on_schema_change.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '052dc4a9a3030642e1067b80712e798cb0c8779163c84edbcdf016bc4276ce79'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.incremental_validate_on_schema_change', 'macro.dbt.check_for_schema_changes', 'macro.dbt.sync_column_schemas', 'macro.dbt.process_schema_changes']}, 'dbt://macros\\materializations\\models\\incremental\\strategies.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\models\\incremental\\strategies.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'c006eae4606688f56456e0e692c593841a9dafb689d3de7932e72353c8f65deb'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_incremental_append_sql', 'macro.dbt.default__get_incremental_append_sql', 'macro.dbt.get_incremental_delete_insert_sql', 'macro.dbt.default__get_incremental_delete_insert_sql', 'macro.dbt.get_incremental_merge_sql', 'macro.dbt.default__get_incremental_merge_sql', 'macro.dbt.get_incremental_insert_overwrite_sql', 'macro.dbt.default__get_incremental_insert_overwrite_sql', 'macro.dbt.get_incremental_default_sql', 'macro.dbt.default__get_incremental_default_sql', 'macro.dbt.get_incremental_microbatch_sql', 'macro.dbt.default__get_incremental_microbatch_sql', 'macro.dbt.get_insert_into_sql']}, 'dbt://macros\\materializations\\seeds\\helpers.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\seeds\\helpers.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '9d8414b3d865fa47a8f7ad3de7bc0b779f70ee06ecc0bf4f56f3ab912953895e'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.create_csv_table', 'macro.dbt.default__create_csv_table', 'macro.dbt.reset_csv_table', 'macro.dbt.default__reset_csv_table', 'macro.dbt.get_csv_sql', 'macro.dbt.default__get_csv_sql', 'macro.dbt.get_binding_char', 'macro.dbt.default__get_binding_char', 'macro.dbt.get_batch_size', 'macro.dbt.default__get_batch_size', 'macro.dbt.get_seed_column_quoted_csv', 'macro.dbt.load_csv_rows', 'macro.dbt.default__load_csv_rows']}, 'dbt://macros\\materializations\\seeds\\seed.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\seeds\\seed.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '810d1b9fc04c172257dce580fe7a60cb0f272fa1e8eab1aa71c8340372953f57'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.materialization_seed_default']}, 'dbt://macros\\materializations\\snapshots\\helpers.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\snapshots\\helpers.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'ec9a893d0b6474c7fcf7900ec37f8c37c7715f24f9f22617e3fb84ffffaf2b33'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.create_columns', 'macro.dbt.default__create_columns', 'macro.dbt.post_snapshot', 'macro.dbt.default__post_snapshot', 'macro.dbt.get_true_sql', 'macro.dbt.default__get_true_sql', 'macro.dbt.snapshot_staging_table', 'macro.dbt.get_snapshot_table_column_names', 'macro.dbt.default__snapshot_staging_table', 'macro.dbt.build_snapshot_table', 'macro.dbt.default__build_snapshot_table', 'macro.dbt.build_snapshot_staging_table', 'macro.dbt.get_updated_at_column_data_type', 'macro.dbt.check_time_data_types', 'macro.dbt.get_dbt_valid_to_current', 'macro.dbt.unique_key_fields', 'macro.dbt.unique_key_join_on', 'macro.dbt.unique_key_is_null', 'macro.dbt.unique_key_is_not_null']}, 'dbt://macros\\materializations\\snapshots\\snapshot.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\snapshots\\snapshot.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'd44bea2b75a03191ed343dcd205b05caa71fa64570783e6e0569602e4902dd1a'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.materialization_snapshot_default']}, 'dbt://macros\\materializations\\snapshots\\snapshot_merge.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\snapshots\\snapshot_merge.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'd32349a95e945c202b1d27aa7ec5a636918f1db4430a7d661364c2ccb97417b3'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.snapshot_merge_sql', 'macro.dbt.default__snapshot_merge_sql']}, 'dbt://macros\\materializations\\snapshots\\strategies.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\snapshots\\strategies.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'fdd55148e6d2a93c3816f2a75961b9be4cdfc586c31f788d00c9ce6eec577ebe'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.strategy_dispatch', 'macro.dbt.snapshot_hash_arguments', 'macro.dbt.default__snapshot_hash_arguments', 'macro.dbt.snapshot_timestamp_strategy', 'macro.dbt.snapshot_string_as_time', 'macro.dbt.default__snapshot_string_as_time', 'macro.dbt.snapshot_check_all_get_existing_columns', 'macro.dbt.snapshot_check_strategy']}, 'dbt://macros\\materializations\\tests\\helpers.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\tests\\helpers.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'b6e88bc1d92bb942d8cc527cbd2253839846f3d55887e88208fdcdcc9c3529b3'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_test_sql', 'macro.dbt.default__get_test_sql', 'macro.dbt.get_unit_test_sql', 'macro.dbt.default__get_unit_test_sql']}, 'dbt://macros\\materializations\\tests\\test.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\tests\\test.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '760cabfb2685de8ab4c723fa76d32c8b03eb1ed76faf16902f52ce6b011a404b'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.materialization_test_default']}, 'dbt://macros\\materializations\\tests\\unit.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\tests\\unit.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '01d55fa803145d65299d25d1ae454a0820f367d8e349066f5db34d98e483ce93'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.materialization_unit_default']}, 'dbt://macros\\materializations\\tests\\where_subquery.sql': {'path': {'searched_path': 'macros', 'relative_path': 'materializations\\tests\\where_subquery.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'b48eed0a167e830aafd42c965159f6bd6f6dcdfcbd77f88a7c8fd7561602fb24'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_where_subquery', 'macro.dbt.default__get_where_subquery']}, 'dbt://macros\\python_model\\python.sql': {'path': {'searched_path': 'macros', 'relative_path': 'python_model\\python.sql', 'modification_time': 1741579310.432657, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '277e9adc7e6d4a213538725daede6c83076bcafd1b6097961cda1baf97055aee'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.resolve_model_name', 'macro.dbt.default__resolve_model_name', 'macro.dbt.build_ref_function', 'macro.dbt.build_source_function', 'macro.dbt.build_config_dict', 'macro.dbt.py_script_postfix', 'macro.dbt.py_script_comment']}, 'dbt://macros\\relations\\create.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\create.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '4b6c88e82e7f1ec5fc4b91da6ce2b8aac01adec3f42a804fc279a1428b77c18b'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_create_sql', 'macro.dbt.default__get_create_sql']}, 'dbt://macros\\relations\\create_backup.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\create_backup.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '898312f077282c49b1eae41ca9e3f3308a69728c42d8ee29454ea464a57126ad'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_create_backup_sql', 'macro.dbt.default__get_create_backup_sql']}, 'dbt://macros\\relations\\create_intermediate.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\create_intermediate.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'c100e75392dc8dc3ecad3dd814d1678295b6c8cb0758bee2ae916e78701f32ea'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_create_intermediate_sql', 'macro.dbt.default__get_create_intermediate_sql']}, 'dbt://macros\\relations\\drop.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\drop.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'f1d75bd3fea7ff225930795df0421170570a34903253be4f0456e31e37c5eb9d'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_drop_sql', 'macro.dbt.default__get_drop_sql', 'macro.dbt.drop_relation', 'macro.dbt.default__drop_relation', 'macro.dbt.drop_relation_if_exists']}, 'dbt://macros\\relations\\drop_backup.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\drop_backup.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '66852df952ec3c10fc21b8feddcfc6e37386d12c370d55a4eaf5f5a96549fe67'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_drop_backup_sql', 'macro.dbt.default__get_drop_backup_sql']}, 'dbt://macros\\relations\\rename.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\rename.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'bace6993f3679b284ada5c41e65f3bf42e6f209dd629747bb554e2f2d5283908'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_rename_sql', 'macro.dbt.default__get_rename_sql', 'macro.dbt.rename_relation', 'macro.dbt.default__rename_relation']}, 'dbt://macros\\relations\\rename_intermediate.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\rename_intermediate.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '9fa8eb4207e26646a7cd44a6e4f598af9ed89abd59382949ec52574597ce1929'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_rename_intermediate_sql', 'macro.dbt.default__get_rename_intermediate_sql']}, 'dbt://macros\\relations\\replace.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\replace.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'd6b6edc7fb71a5b887f49ae1927753e12931d10df0eda24a478b986f0cfb8e3c'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_replace_sql', 'macro.dbt.default__get_replace_sql']}, 'dbt://macros\\relations\\schema.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\schema.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'afee33e846e1578492912d0307f7b8dc070a43ce0f92fd108fa32d5cc6c220dd'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.drop_schema_named', 'macro.dbt.default__drop_schema_named']}, 'dbt://macros\\relations\\column\\columns_spec_ddl.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\column\\columns_spec_ddl.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '2670dd84dd035f721da94e8fa9e20a201d4a21641e628bc64f187a99e50d92a4'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_table_columns_and_constraints', 'macro.dbt.default__get_table_columns_and_constraints', 'macro.dbt.table_columns_and_constraints', 'macro.dbt.get_assert_columns_equivalent', 'macro.dbt.default__get_assert_columns_equivalent', 'macro.dbt.assert_columns_equivalent', 'macro.dbt.format_columns', 'macro.dbt.default__format_column']}, 'dbt://macros\\relations\\materialized_view\\alter.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\materialized_view\\alter.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'd151f8ead6b5667c8b13922d9b970e1de5b18b319fd34f9ad684a54805bafba1'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_alter_materialized_view_as_sql', 'macro.dbt.default__get_alter_materialized_view_as_sql', 'macro.dbt.get_materialized_view_configuration_changes', 'macro.dbt.default__get_materialized_view_configuration_changes']}, 'dbt://macros\\relations\\materialized_view\\create.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\materialized_view\\create.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'e3402b09ed0d11edf57833576777fb955052708b4a98f3448bafe5b797461701'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_create_materialized_view_as_sql', 'macro.dbt.default__get_create_materialized_view_as_sql']}, 'dbt://macros\\relations\\materialized_view\\drop.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\materialized_view\\drop.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'b6b39939c2b822faa58ada5234c89fe93ba95edd1bed711f66b349ed93d7ba94'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.drop_materialized_view', 'macro.dbt.default__drop_materialized_view']}, 'dbt://macros\\relations\\materialized_view\\refresh.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\materialized_view\\refresh.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '855b6158df85ace8312b750ed8245f98602aeded513471c3f64dff309ae7ab6b'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.refresh_materialized_view', 'macro.dbt.default__refresh_materialized_view']}, 'dbt://macros\\relations\\materialized_view\\rename.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\materialized_view\\rename.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'b42b9178eedaf009da430463e5cdbc03a580afe8f0081ed8598824dc41b35319'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_rename_materialized_view_sql', 'macro.dbt.default__get_rename_materialized_view_sql']}, 'dbt://macros\\relations\\materialized_view\\replace.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\materialized_view\\replace.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'bf74f3ac01db145f6f9132ce43be0752727cdc3d318755a20eeeb499fccffb77'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_replace_materialized_view_sql', 'macro.dbt.default__get_replace_materialized_view_sql']}, 'dbt://macros\\relations\\table\\create.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\table\\create.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'd2ce6a7d9e846349ed9e45bfcc0fc999f30b63627051f60b64e6fee11fe46567'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_create_table_as_sql', 'macro.dbt.default__get_create_table_as_sql', 'macro.dbt.create_table_as', 'macro.dbt.default__create_table_as', 'macro.dbt.default__get_column_names', 'macro.dbt.get_select_subquery', 'macro.dbt.default__get_select_subquery']}, 'dbt://macros\\relations\\table\\drop.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\table\\drop.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'abc6b9ee0d7f471e31a23e695d284900c77103e119f8884ed285194b5e2ea057'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.drop_table', 'macro.dbt.default__drop_table']}, 'dbt://macros\\relations\\table\\rename.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\table\\rename.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '84b76ff4fb0ce6b58a39e4592e8d2f7214c0e34c11541f9d28066fa0fc8e8d8d'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_rename_table_sql', 'macro.dbt.default__get_rename_table_sql']}, 'dbt://macros\\relations\\table\\replace.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\table\\replace.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'c6a07b57b11a856836e83e9b9b71995acae871d885c056dc0f234f729931201a'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_replace_table_sql', 'macro.dbt.default__get_replace_table_sql']}, 'dbt://macros\\relations\\view\\create.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\view\\create.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '6775f9952852b15c4734110ab9bcfb8d9bf27c1241f612599f5c226e71c50594'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_create_view_as_sql', 'macro.dbt.default__get_create_view_as_sql', 'macro.dbt.create_view_as', 'macro.dbt.default__create_view_as']}, 'dbt://macros\\relations\\view\\drop.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\view\\drop.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'f9be2fe6201fde67e5a53e614f38e905a454a0c24606439f9b2bcde409e2a883'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.drop_view', 'macro.dbt.default__drop_view']}, 'dbt://macros\\relations\\view\\rename.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\view\\rename.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'ba722fc2b08f3be27feb04c7290cb15ebd0e54b01fbdc7f5017e8103d52a8915'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_rename_view_sql', 'macro.dbt.default__get_rename_view_sql']}, 'dbt://macros\\relations\\view\\replace.sql': {'path': {'searched_path': 'macros', 'relative_path': 'relations\\view\\replace.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '8d1e1480b327bad30abba08854d2a857b3df5b5e5660b6e94839d3c7dd23644b'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_replace_view_sql', 'macro.dbt.default__get_replace_view_sql', 'macro.dbt.create_or_replace_view', 'macro.dbt.handle_existing_table', 'macro.dbt.default__handle_existing_table']}, 'dbt://macros\\unit_test_sql\\get_fixture_sql.sql': {'path': {'searched_path': 'macros', 'relative_path': 'unit_test_sql\\get_fixture_sql.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '40368e65665c694d02249a2f290d6bc30697f63f0053e09af76af1295164dd4f'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_fixture_sql', 'macro.dbt.get_expected_sql', 'macro.dbt.format_row', 'macro.dbt.validate_fixture_rows', 'macro.dbt.default__validate_fixture_rows']}, 'dbt://macros\\utils\\any_value.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\any_value.sql', 'modification_time': 1741579310.4483688, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '0150eb4ecf186b02766c15ff4aa4a1e079f6174abaf03c7cf2f412bc0001e9de'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.any_value', 'macro.dbt.default__any_value']}, 'dbt://macros\\utils\\array_append.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\array_append.sql', 'modification_time': 1741579310.4641235, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '04f365e0ca64eb7d1ce29044855ad75d52c8184b73ca734c15036ed6d3ae26df'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.array_append', 'macro.dbt.default__array_append']}, 'dbt://macros\\utils\\array_concat.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\array_concat.sql', 'modification_time': 1741579310.4641235, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'd7ac6fb6096305ed0d6b0e9b349118e494064e2c61a7d4e9b170b6746320f451'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.array_concat', 'macro.dbt.default__array_concat']}, 'dbt://macros\\utils\\array_construct.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\array_construct.sql', 'modification_time': 1741579310.4641235, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'c991a90da146d2ff855d262f5b64d2f8deaaafe58249333ffa00519ad34ea113'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.array_construct', 'macro.dbt.default__array_construct']}, 'dbt://macros\\utils\\bool_or.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\bool_or.sql', 'modification_time': 1741579310.4641235, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '6ab49a5c4a449a5e448f8f60bbb478ab0046b3558b87b1212dbc2d0d63101b45'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.bool_or', 'macro.dbt.default__bool_or']}, 'dbt://macros\\utils\\cast.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\cast.sql', 'modification_time': 1741579310.4641235, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'e0066e1a6c530d3241897a9aaf778d04fd2bf570be8f62a0ece1755c30da6de2'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.cast', 'macro.dbt.default__cast']}, 'dbt://macros\\utils\\cast_bool_to_text.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\cast_bool_to_text.sql', 'modification_time': 1741579310.4641235, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'ef2e4fc337d8a20ce4fe6db19f3f88376e84033bde6491b582fe0a2ec0f75367'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.cast_bool_to_text', 'macro.dbt.default__cast_bool_to_text']}, 'dbt://macros\\utils\\concat.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\concat.sql', 'modification_time': 1741579310.4671333, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'd2c2251801fbe1d19f96e366563735240b4b1b6ee2dacf7a9e6da0718c59b38e'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.concat', 'macro.dbt.default__concat']}, 'dbt://macros\\utils\\data_types.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\data_types.sql', 'modification_time': 1741579310.4671333, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '1d24f4628b497498cc120a269160870c651e34628abebd7a39d7c48cb2ec5da5'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.type_string', 'macro.dbt.default__type_string', 'macro.dbt.type_timestamp', 'macro.dbt.default__type_timestamp', 'macro.dbt.type_float', 'macro.dbt.default__type_float', 'macro.dbt.type_numeric', 'macro.dbt.default__type_numeric', 'macro.dbt.type_bigint', 'macro.dbt.default__type_bigint', 'macro.dbt.type_int', 'macro.dbt.default__type_int', 'macro.dbt.type_boolean', 'macro.dbt.default__type_boolean']}, 'dbt://macros\\utils\\date.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\date.sql', 'modification_time': 1741579310.4671333, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'ec8fd99a06d9a0ed55415721765b037c3600c67799761f6346e33744762b1c9a'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.date', 'macro.dbt.default__date']}, 'dbt://macros\\utils\\dateadd.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\dateadd.sql', 'modification_time': 1741579310.4671333, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '850f9916f59f74dd86594d8644e85ad017fd3fd2aa20da7b0eb09ef9916d94ec'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.dateadd', 'macro.dbt.default__dateadd']}, 'dbt://macros\\utils\\datediff.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\datediff.sql', 'modification_time': 1741579310.4671333, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'e557647be9341ee0a5c24af1009bbdcb81bcd2fe2fc3f08ba103901af562ca4e'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.datediff', 'macro.dbt.default__datediff']}, 'dbt://macros\\utils\\date_spine.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\date_spine.sql', 'modification_time': 1741579310.4671333, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '81ff8fb03f53088ff0f4ba41d6ceccbddfe0c670818ee819b2b9d1745eaf2c97'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_intervals_between', 'macro.dbt.default__get_intervals_between', 'macro.dbt.date_spine', 'macro.dbt.default__date_spine']}, 'dbt://macros\\utils\\date_trunc.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\date_trunc.sql', 'modification_time': 1741579310.4671333, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'a1bb71479d02691cff8eb1ca73667a21b0072044dca3cc8599ba549a99d96435'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.date_trunc', 'macro.dbt.default__date_trunc']}, 'dbt://macros\\utils\\equals.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\equals.sql', 'modification_time': 1741579310.4671333, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '671a435b1cc1d4645221dcf148c77838028692c1cdc378543c078fccb212d01f'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.equals', 'macro.dbt.default__equals']}, 'dbt://macros\\utils\\escape_single_quotes.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\escape_single_quotes.sql', 'modification_time': 1741579310.4716938, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '4dfcffd65689848a5bcd2369cc51ac93a3df64ecc2c7a011724e26d968c9e9c0'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.escape_single_quotes', 'macro.dbt.default__escape_single_quotes']}, 'dbt://macros\\utils\\except.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\except.sql', 'modification_time': 1741579310.4716938, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '68b65421f0eb336cfb6da071a35c387ce9d64c00f3ffea870701bc5461d8624d'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.except', 'macro.dbt.default__except']}, 'dbt://macros\\utils\\generate_series.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\generate_series.sql', 'modification_time': 1741579310.4716938, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'cc9b9a3543828b7a910f8480a42c28d83ef63dab4f529bff8b6f07b399e396de'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.get_powers_of_two', 'macro.dbt.default__get_powers_of_two', 'macro.dbt.generate_series', 'macro.dbt.default__generate_series']}, 'dbt://macros\\utils\\hash.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\hash.sql', 'modification_time': 1741579310.4716938, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '9c054f571043a3f116316a4810195b57ae04ec8893bb037d3d5ab4ebdcbea910'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.hash', 'macro.dbt.default__hash']}, 'dbt://macros\\utils\\intersect.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\intersect.sql', 'modification_time': 1741579310.4736989, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'b6ec209ae71a109da5be64bab6c9884944d60f93410b604c2806c4071fb3ff75'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.intersect', 'macro.dbt.default__intersect']}, 'dbt://macros\\utils\\last_day.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\last_day.sql', 'modification_time': 1741579310.4736989, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'cf0a700714fd42fdc4e54dc12ab928f27c02fb232fa1a6acafc49ef27cbc98d7'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.last_day', 'macro.dbt.default_last_day', 'macro.dbt.default__last_day']}, 'dbt://macros\\utils\\length.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\length.sql', 'modification_time': 1741579310.4736989, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'f78655a25de377b0c45542985dc88e7a4cdb8540d40f8bd25f5a292ee20ce266'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.length', 'macro.dbt.default__length']}, 'dbt://macros\\utils\\listagg.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\listagg.sql', 'modification_time': 1741579310.4736989, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '2e3d94ca486cd4a85ab9b6ed57b38de55245a45fdb6cb1a18d0035a2ea418b19'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.listagg', 'macro.dbt.default__listagg']}, 'dbt://macros\\utils\\literal.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\literal.sql', 'modification_time': 1741579310.4757054, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'a0b015ff47abe60699377241a6a8889a596ec215eb37fde56e6fbdd0ab87c72a'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.string_literal', 'macro.dbt.default__string_literal']}, 'dbt://macros\\utils\\position.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\position.sql', 'modification_time': 1741579310.4757054, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'c326d161111b17ea0eeace9f7fb6180135c99a1469a1af7ae81de368ef214923'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.position', 'macro.dbt.default__position']}, 'dbt://macros\\utils\\replace.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\replace.sql', 'modification_time': 1741579310.4757054, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'fbf6a26d1391d9304e58061160d8feb9ed817e9dac4738209636b6ddeb9edb17'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.replace', 'macro.dbt.default__replace']}, 'dbt://macros\\utils\\right.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\right.sql', 'modification_time': 1741579310.4777122, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': '5ef2c2784965c47cf10c64824130f6007711c998ccf8dd0256e531048c0e9839'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.right', 'macro.dbt.default__right']}, 'dbt://macros\\utils\\safe_cast.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\safe_cast.sql', 'modification_time': 1741579310.4777122, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'd498c512988148186f2c7f824b79f53340a81e22cae82d53029fc4e3ecf7604c'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.safe_cast', 'macro.dbt.default__safe_cast']}, 'dbt://macros\\utils\\split_part.sql': {'path': {'searched_path': 'macros', 'relative_path': 'utils\\split_part.sql', 'modification_time': 1741579310.4777122, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'd8a06f877bc1b605d01d3e72d2baf6fec79681a86600bbce3c4f7223dfd3fe3a'}, 'project_name': 'dbt', 'parse_file_type': 'macro', 'macros': ['macro.dbt.split_part', 'macro.dbt.default__split_part', 'macro.dbt._split_part_negative']}, 'dbt://tests\\generic\\builtin.sql': {'path': {'searched_path': 'tests\\generic', 'relative_path': 'builtin.sql', 'modification_time': 1741579310.4797182, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'df527358bbfe8d46ed6105508c55ab778a2f3279bf73561192a41a35785456f0'}, 'project_name': 'dbt', 'parse_file_type': 'generic_test', 'macros': ['macro.dbt.test_unique', 'macro.dbt.test_not_null', 'macro.dbt.test_accepted_values', 'macro.dbt.test_relationships']}, 'dbt://docs\\overview.md': {'path': {'searched_path': 'docs', 'relative_path': 'overview.md', 'modification_time': 1741579310.401116, 'project_root': 'C:\\Users\\VarshaS\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\dbt\\include\\global_project'}, 'checksum': {'name': 'sha256', 'checksum': 'ae763012154541491542531020bf1bd379264a5ac112e81b429eb9d1e37252af'}, 'project_name': 'dbt', 'parse_file_type': 'docs', 'docs': ['doc.dbt.__overview__']}, 'dbt_first://macros\\cast_cols.sql': {'path': {'searched_path': 'macros', 'relative_path': 'cast_cols.sql', 'modification_time': 1741925833.5124063, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': '57ffbd6551fa0d39d9c45bd38c26bb3395d516b1ef8b1efa2b2a278b2afb7217'}, 'project_name': 'dbt_first', 'parse_file_type': 'macro', 'macros': ['macro.dbt_first.cast_cols']}, 'dbt_first://macros\\not_null.sql': {'path': {'searched_path': 'macros', 'relative_path': 'not_null.sql', 'modification_time': 1741925833.584433, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': 'f8128bdd8ad4364e834da198fa2790a518043b11f14253c65c7a10c08b657136'}, 'project_name': 'dbt_first', 'parse_file_type': 'macro', 'macros': ['macro.dbt_first.not_null']}, 'dbt_first://models\\Mart\\highest_cross_sell.sql': {'path': {'searched_path': 'models', 'relative_path': 'Mart\\highest_cross_sell.sql', 'modification_time': 1741928769.8927076, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855'}, 'project_name': 'dbt_first', 'parse_file_type': 'model', 'nodes': ['model.dbt_first.highest_cross_sell']}, 'dbt_first://models\\Mart\\schema.yml': {'path': {'searched_path': 'models', 'relative_path': 'Mart\\schema.yml', 'modification_time': 1741925833.7357612, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855'}, 'project_name': 'dbt_first', 'parse_file_type': 'schema', 'dfy': {}, 'data_tests': {}, 'metrics_from_measures': {}, 'mcp': {}, 'env_vars': {}, 'unrendered_configs': {}, 'unrendered_databases': {}, 'unrendered_schemas': {}}, 'dbt_first://models\\Mart\\churned_new_customers.sql': {'path': {'searched_path': 'models', 'relative_path': 'Mart\\churned_new_customers.sql', 'modification_time': 1741941084.7453003, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': '5bd0f8f537e3c5dc6380c629d9cd170a9b6b23da51ed1d345d745dd002de1472'}, 'project_name': 'dbt_first', 'parse_file_type': 'model', 'nodes': ['model.dbt_first.churned_new_customers']}, 'dbt_first://models\\Mart\\product_churn.sql': {'path': {'searched_path': 'models', 'relative_path': 'Mart\\product_churn.sql', 'modification_time': 1741932840.0449781, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': '2c2454eca8cc56474d002a116ff667d5a74bcbb15174df96580a8aa7e8e5a3f4'}, 'project_name': 'dbt_first', 'parse_file_type': 'model', 'nodes': ['model.dbt_first.product_churn']}, 'dbt_first://models\\Mart\\rank_product_revenue.sql': {'path': {'searched_path': 'models', 'relative_path': 'Mart\\rank_product_revenue.sql', 'modification_time': 1741945853.5962307, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': 'd53a4dabc9f181344ffe36219c689155eb3144ff9be5acee3f1ef46b92c7892a'}, 'project_name': 'dbt_first', 'parse_file_type': 'model', 'nodes': ['model.dbt_first.rank_product_revenue']}, 'dbt_first://models\\Mart\\rank_customers_revenue.sql': {'path': {'searched_path': 'models', 'relative_path': 'Mart\\rank_customers_revenue.sql', 'modification_time': 1741945104.3820539, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': 'aa46989e94e03ee52c694e6f93db535d25d6b2a9829afb8c50eacc2374cdfd0a'}, 'project_name': 'dbt_first', 'parse_file_type': 'model', 'nodes': ['model.dbt_first.rank_customers_revenue']}, 'dbt_first://models\\Mart\\new_logo_each_fiscal.sql': {'path': {'searched_path': 'models', 'relative_path': 'Mart\\new_logo_each_fiscal.sql', 'modification_time': 1741945954.655106, 'project_root': 'C:\\Users\\VarshaS\\dbt_first'}, 'checksum': {'name': 'sha256', 'checksum': '2d8a2505a80ef814d3a16d7750e1f602c572a308cfd10f17fd8cc27ef309fc50'}, 'project_name': 'dbt_first', 'parse_file_type': 'model', 'nodes': ['model.dbt_first.new_logo_each_fiscal']}}
[0m15:34:51.952557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c91e609-5baa-405f-aa92-9f8b24a4488f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202C047EF0>]}
[0m15:34:53.277642 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:34:53.293710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c91e609-5baa-405f-aa92-9f8b24a4488f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202C137E30>]}
[0m15:34:53.374047 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:34:53.374047 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:34:53.416122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c91e609-5baa-405f-aa92-9f8b24a4488f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202C17B350>]}
[0m15:34:53.417123 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 477 macros
[0m15:34:53.417123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c91e609-5baa-405f-aa92-9f8b24a4488f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202C1EAA50>]}
[0m15:34:53.419155 [info ] [MainThread]: 
[0m15:34:53.420125 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:34:53.420125 [info ] [MainThread]: 
[0m15:34:53.421122 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:34:53.422155 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:34:53.527768 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:34:53.528767 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:34:53.528767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:55.412755 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.896 seconds
[0m15:34:55.428439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:55.428439 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:34:55.428439 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:34:55.949721 [info ] [MainThread]: 
[0m15:34:55.949721 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m15:34:55.949721 [error] [MainThread]: Encountered an error:

[0m15:34:55.977694 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 528, in execute_with_hooks
    before_run_status = self.before_run(adapter, selected_uids)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\run.py", line 1045, in before_run
    self.create_schemas(adapter, required_schemas)
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 696, in create_schemas
    for ls_future in as_completed(list_futures):
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\concurrent\futures\_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\threading.py", line 655, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m15:34:55.981219 [debug] [MainThread]: Command `dbt run` failed at 15:34:55.981219 after 5.29 seconds
[0m15:34:55.981219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022027CF64B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202BF739E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202C275160>]}
[0m15:34:55.982219 [debug] [MainThread]: Flushing usage events
[0m15:34:56.983617 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:35:19.731225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB6332330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB5DA2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB5DA3860>]}


============================== 15:35:19.731225 | 3b005faa-c299-43fe-b3ff-a7aa16e260b0 ==============================
[0m15:35:19.731225 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:35:19.731225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:35:20.270221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b005faa-c299-43fe-b3ff-a7aa16e260b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB7207A10>]}
[0m15:35:20.334051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b005faa-c299-43fe-b3ff-a7aa16e260b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB59B1F40>]}
[0m15:35:20.334051 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:35:20.798413 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:35:22.198383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:35:22.198383 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:35:22.204401 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:35:22.240225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b005faa-c299-43fe-b3ff-a7aa16e260b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB8434BF0>]}
[0m15:35:22.319434 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:35:22.338862 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:35:22.368773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b005faa-c299-43fe-b3ff-a7aa16e260b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB864BC20>]}
[0m15:35:22.369773 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 477 macros
[0m15:35:22.370774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b005faa-c299-43fe-b3ff-a7aa16e260b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB7073DA0>]}
[0m15:35:22.371804 [info ] [MainThread]: 
[0m15:35:22.372976 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:35:22.374066 [info ] [MainThread]: 
[0m15:35:22.375109 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:35:22.376076 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:35:25.068506 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:35:25.068506 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:35:25.068506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:27.211477 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.155 seconds
[0m15:35:27.227247 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m15:35:27.243074 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:35:27.243074 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:35:27.243074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:28.844587 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.597 seconds
[0m15:35:28.844587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m15:35:28.844587 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:35:28.844587 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:35:29.217465 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.366 seconds
[0m15:35:29.217465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m15:35:29.217465 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:35:29.217465 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:35:29.558742 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.334 seconds
[0m15:35:29.560767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b005faa-c299-43fe-b3ff-a7aa16e260b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB84349E0>]}
[0m15:35:29.560767 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m15:35:29.560767 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m15:35:29.560767 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m15:35:29.560767 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m15:35:29.572468 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m15:35:29.572468 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m15:35:29.609437 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m15:35:29.612389 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m15:35:29.612389 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (
WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue * t.quantity) AS total_revenue,
        COUNT(*) AS transaction_count
    FROM HEALTHCARE.stage.stg_transactions t
    LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
    ON t.customer_id = c.customer_id
    where revenue_type = 1 and t.revenue > 0
    GROUP BY t.customer_id, c.customer_name
),
 
ranked_customers AS (
    SELECT
        customer_id,
        customer_name,
        total_revenue,
        transaction_count,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
 
SELECT * FROM ranked_customers

-- WITH customer_revenue AS (
--     SELECT
--         c.CUSTOMER_ID AS customer_id,
--         c.customer_name,
--         SUM(t.REVENUE) AS total_revenue,
--         DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
--     FROM HEALTHCARE.stage.stg_transactions as t
--     JOIN HEALTHCARE.stage.stg_customers as  c
--     ON c.CUSTOMER_ID = t.CUSTOMER_ID
--     GROUP BY c.CUSTOMER_ID,c.customer_name
-- )
 
-- SELECT
--     customer_id,
--     customer_name,
--         total_revenue,
--     revenue_rank
-- FROM customer_revenue
-- ORDER BY revenue_rank
        );
[0m15:35:29.614439 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:35:32.980813 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.368 seconds
[0m15:35:33.029438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b005faa-c299-43fe-b3ff-a7aa16e260b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB5920800>]}
[0m15:35:33.029438 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_customers_revenue .................. [[32mSUCCESS 1[0m in 3.47s]
[0m15:35:33.029438 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m15:35:33.029438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:33.029438 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:35:33.029438 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:35:33.581754 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m15:35:33.582792 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m15:35:34.114077 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m15:35:34.114077 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m15:35:34.651124 [info ] [MainThread]: 
[0m15:35:34.663858 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.28 seconds (12.28s).
[0m15:35:34.663858 [debug] [MainThread]: Command end result
[0m15:35:34.686613 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:35:34.688611 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:35:34.698287 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:35:34.699305 [info ] [MainThread]: 
[0m15:35:34.701289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:35:34.702286 [info ] [MainThread]: 
[0m15:35:34.703333 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:35:34.704298 [debug] [MainThread]: Command `dbt run` succeeded at 15:35:34.704298 after 15.15 seconds
[0m15:35:34.705293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB3B7F7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB421A360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB421A450>]}
[0m15:35:34.705716 [debug] [MainThread]: Flushing usage events
[0m15:35:35.759329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:59.630650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60CAFC440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60CAFC290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60CAFCEF0>]}


============================== 15:36:59.630650 | c9c65f3f-4d91-4772-9868-49e4b2097bb7 ==============================
[0m15:36:59.630650 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:36:59.630650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:rank_product_revenue', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:37:00.100286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9c65f3f-4d91-4772-9868-49e4b2097bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60A10C470>]}
[0m15:37:00.163823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9c65f3f-4d91-4772-9868-49e4b2097bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60D84D880>]}
[0m15:37:00.163823 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:37:00.508725 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:37:00.698187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:37:00.698187 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m15:37:00.943977 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:37:00.946917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9c65f3f-4d91-4772-9868-49e4b2097bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60ED1CD40>]}
[0m15:37:01.034546 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:37:01.034546 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:37:01.065954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9c65f3f-4d91-4772-9868-49e4b2097bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60EDE1A60>]}
[0m15:37:01.065954 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 477 macros
[0m15:37:01.065954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9c65f3f-4d91-4772-9868-49e4b2097bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60ECFBC20>]}
[0m15:37:01.065954 [info ] [MainThread]: 
[0m15:37:01.065954 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:37:01.065954 [info ] [MainThread]: 
[0m15:37:01.065954 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:37:01.065954 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:37:01.167696 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:37:01.167696 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:37:01.167696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:03.163852 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.005 seconds
[0m15:37:03.179636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m15:37:03.195522 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:37:03.195522 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:37:03.195522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:04.738412 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.542 seconds
[0m15:37:04.740422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m15:37:04.742428 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:37:04.744434 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:37:05.090595 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.356 seconds
[0m15:37:05.090595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m15:37:05.138328 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:37:05.138328 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:37:05.477181 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.337 seconds
[0m15:37:05.477181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9c65f3f-4d91-4772-9868-49e4b2097bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B609F5FA40>]}
[0m15:37:05.493047 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m15:37:05.493047 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_product_revenue ......................... [RUN]
[0m15:37:05.493047 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_product_revenue'
[0m15:37:05.493047 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m15:37:05.505735 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m15:37:05.505735 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m15:37:05.539334 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m15:37:05.541294 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m15:37:05.541294 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

WITH cte_product_revenue AS (
    SELECT 
        product_id,
        SUM(revenue*quantity) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions 
    where revenue_type = 1 and revenue > 0
    GROUP BY 
        product_id
)
SELECT 
    product_id,
    total_revenue,
    DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS product_rank
FROM cte_product_revenue
        );
[0m15:37:05.542331 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:37:07.766290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.224 seconds
[0m15:37:07.791011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9c65f3f-4d91-4772-9868-49e4b2097bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B609EC9E50>]}
[0m15:37:07.791011 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_product_revenue .................... [[32mSUCCESS 1[0m in 2.30s]
[0m15:37:07.791011 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m15:37:07.791011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:07.791011 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:37:07.791011 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:37:08.309330 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m15:37:08.309330 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m15:37:08.860374 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was left open.
[0m15:37:08.860374 [debug] [MainThread]: On model.dbt_first.rank_product_revenue: Close
[0m15:37:09.422829 [info ] [MainThread]: 
[0m15:37:09.422829 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.34 seconds (8.34s).
[0m15:37:09.422829 [debug] [MainThread]: Command end result
[0m15:37:09.446059 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:37:09.451394 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:37:09.456436 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:37:09.456436 [info ] [MainThread]: 
[0m15:37:09.456436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:37:09.459616 [info ] [MainThread]: 
[0m15:37:09.459616 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:37:09.459616 [debug] [MainThread]: Command `dbt run` succeeded at 15:37:09.459616 after 10.00 seconds
[0m15:37:09.459616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60F2E8DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60EBFCAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60A617EC0>]}
[0m15:37:09.459616 [debug] [MainThread]: Flushing usage events
[0m15:37:10.748247 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:51:12.448257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028025594E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028025596000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028025597BF0>]}


============================== 15:51:12.455264 | a2dd2a85-4119-482e-bfe0-c7be58a0ddfd ==============================
[0m15:51:12.455264 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:51:12.455264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m15:51:13.103119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2dd2a85-4119-482e-bfe0-c7be58a0ddfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028026297290>]}
[0m15:51:13.178697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2dd2a85-4119-482e-bfe0-c7be58a0ddfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802577C2F0>]}
[0m15:51:13.183497 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:51:13.658661 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:51:15.196593 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:15.196593 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m15:51:15.382581 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_first.churned_new_customers' (models\Mart\churned_new_customers.sql) depends on a node named 'stg_TRANSACTION' which was not found
[0m15:51:15.388236 [debug] [MainThread]: Command `dbt run` failed at 15:51:15.388236 after 3.29 seconds
[0m15:51:15.388236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028021FA4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280276FC650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802758A3F0>]}
[0m15:51:15.388236 [debug] [MainThread]: Flushing usage events
[0m15:51:16.378733 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:51:45.541417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CF96E1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFB9C4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFB9C6600>]}


============================== 15:51:45.541417 | 4c636bcd-ab2b-41f0-90ba-0582c2e5952c ==============================
[0m15:51:45.541417 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:51:45.541417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:51:45.996203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c636bcd-ab2b-41f0-90ba-0582c2e5952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFC2EF920>]}
[0m15:51:46.059102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c636bcd-ab2b-41f0-90ba-0582c2e5952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFE124B90>]}
[0m15:51:46.059102 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:51:46.417524 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:51:46.599325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:46.599325 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m15:51:46.842455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:51:46.861246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c636bcd-ab2b-41f0-90ba-0582c2e5952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFE61A600>]}
[0m15:51:46.933479 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:51:46.955248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:51:46.981126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c636bcd-ab2b-41f0-90ba-0582c2e5952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFE6E89E0>]}
[0m15:51:46.981126 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 477 macros
[0m15:51:46.981126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c636bcd-ab2b-41f0-90ba-0582c2e5952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFE7207A0>]}
[0m15:51:46.981126 [info ] [MainThread]: 
[0m15:51:46.981126 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:51:46.981126 [info ] [MainThread]: 
[0m15:51:46.981126 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:51:46.981126 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:51:49.619435 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:51:49.619435 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:51:49.619435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:51.571012 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.951 seconds
[0m15:51:51.571012 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m15:51:51.583540 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:51:51.583540 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:51:51.583540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:53.216884 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.628 seconds
[0m15:51:53.220217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m15:51:53.223581 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:51:53.224619 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:51:53.607185 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.396 seconds
[0m15:51:53.623545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m15:51:53.673442 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:51:53.682469 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:51:54.069376 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.386 seconds
[0m15:51:54.069376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c636bcd-ab2b-41f0-90ba-0582c2e5952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFE4F7C20>]}
[0m15:51:54.077544 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m15:51:54.077544 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m15:51:54.078543 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m15:51:54.078543 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m15:51:54.087746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m15:51:54.088781 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m15:51:54.107514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m15:51:54.121871 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m15:51:54.123354 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

-- WITH first_last_purchase AS (
--     SELECT
--         customer_id,
--         MIN(payment_date) AS first_purchase_date,
--         MAX(payment_date) AS last_purchase_date
--     FROM HEALTHCARE.stage.stg_transactions  AS t
--     GROUP BY customer_id
-- ),
-- max_min_overall AS(
--     SELECT
--         MAX(payment_date) AS max_date,
--         MIN(payment_date) AS min_date
--     FROM HEALTHCARE.stage.stg_transactions
-- ),
-- customer_status AS (
--     SELECT
--         flp.customer_id,
--         flp.first_purchase_date,
--         flp.last_purchase_date, 
--         CASE
--             WHEN flp.last_purchase_date < DATEADD(month, -3, mmo.max_date) THEN 1
--             ELSE 0
--         END AS churned_customer,
--         CASE
--             WHEN flp.first_purchase_date > DATEADD(month, -3, mmo.max_date) THEN 1
--             ELSE 0
--         END AS new_customer
--     FROM first_last_purchase AS flp
--     CROSS JOIN max_min_overall AS mmo
-- ),
-- customer_status_over_time AS (
--     SELECT
--         DATE_TRUNC('month', flp.first_purchase_date) AS month,
--         SUM(cs.churned_customer) AS churned_customers,
--         SUM(cs.new_customer) AS new_customers
--     FROM customer_status AS cs
--     JOIN first_last_purchase AS flp ON cs.customer_id = flp.customer_id
--     GROUP BY month
-- )
-- SELECT 
--     month,
--     churned_customers,
--     new_customers
-- FROM 
--     customer_status_over_time
-- ORDER BY 
--     month



    WITH first_payment AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_payment_date
    FROM
        HEALTHCARE.stage.stg_transactions
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
    FROM
        first_payment
),
 
date_range AS (
    SELECT
        MIN(payment_date) AS start_date,
        MAX(payment_date) AS end_date
    FROM
        HEALTHCARE.stage.stg_transactions
),
 
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_date) AS last_payment_date
    FROM
        HEALTHCARE.stage.stg_transactions
    GROUP BY
        customer_id
),
 
churned_customers AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM last_payment_date) AS fiscal_year
    FROM
        last_payment,
        date_range
    WHERE
        last_payment_date < end_date
),
 
fiscal_years AS (
    SELECT DISTINCT
        EXTRACT(YEAR FROM payment_date) AS fiscal_year
    FROM
        HEALTHCARE.stage.stg_transactions
)
 
SELECT
    fy.fiscal_year,
    COUNT(DISTINCT new_customers_by_fy.customer_id) AS new_customers_count,
    COUNT(DISTINCT churned_customers.customer_id) AS churned_customers_count
FROM
    fiscal_years fy
    LEFT JOIN new_customers_by_fy ON fy.fiscal_year = new_customers_by_fy.fiscal_year
    LEFT JOIN churned_customers ON fy.fiscal_year = churned_customers.fiscal_year
GROUP BY
    fy.fiscal_year
ORDER BY
    fy.fiscal_year
        );
[0m15:51:54.123354 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:51:56.888533 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.769 seconds
[0m15:51:56.904661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c636bcd-ab2b-41f0-90ba-0582c2e5952c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFB8E0710>]}
[0m15:51:56.904661 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 2.83s]
[0m15:51:56.904661 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m15:51:56.904661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:56.904661 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:51:56.904661 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:51:57.444132 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m15:51:57.444476 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m15:51:57.995926 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m15:51:57.995926 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m15:51:58.551086 [info ] [MainThread]: 
[0m15:51:58.552085 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.57 seconds (11.57s).
[0m15:51:58.553083 [debug] [MainThread]: Command end result
[0m15:51:58.587254 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:51:58.591639 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:51:58.598632 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:51:58.598632 [info ] [MainThread]: 
[0m15:51:58.599633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:58.600640 [info ] [MainThread]: 
[0m15:51:58.601351 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:51:58.601351 [debug] [MainThread]: Command `dbt run` succeeded at 15:51:58.601351 after 13.22 seconds
[0m15:51:58.601351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFC22F770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFC01F500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFB895C10>]}
[0m15:51:58.604862 [debug] [MainThread]: Flushing usage events
[0m15:51:59.523285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:54:23.061510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A3AD40B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A1856480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A0E38590>]}


============================== 15:54:23.065863 | fcdeeee0-f797-414a-af64-746a750a1df3 ==============================
[0m15:54:23.065863 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:54:23.067932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:hig_cross_sell', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:54:23.436922 [error] [MainThread]: Encountered an error:

[0m15:54:23.539590 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 251, in wrapper
    project = load_project(
              ^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\runtime.py", line 59, in load_project
    project = Project.from_project_root(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\project.py", line 752, in from_project_root
    return partial.render(renderer)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\project.py", line 321, in render
    return self.create_project(rendered)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\config\project.py", line 373, in create_project
    ProjectContract.validate(rendered.project_dict)
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\contracts\project.py", line 294, in validate
    super().validate(data)
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\dataclass_schema.py", line 95, in validate
    json_schema = cls.json_schema()
                  ^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt_common\dataclass_schema.py", line 89, in json_schema
    json_schema_obj = build_json_schema(cls)
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\jsonschema\builder.py", line 45, in build_json_schema
    schema = get_schema(instance, context, with_dialect_uri=with_dialect_uri)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\jsonschema\schema.py", line 268, in get_schema
    schema = schema_creator(instance, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\jsonschema\schema.py", line 353, in on_dataclass
    for f_name, f_type, has_default, f_default in instance.fields():
                                                  ^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\jsonschema\schema.py", line 188, in fields
    f_default = _default(f_type, f_default, self.get_self_config())
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\jsonschema\schema.py", line 290, in _default
    class CC(DataClassJSONMixin):
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\mixins\dict.py", line 25, in __init_subclass__
    compile_mixin_unpacker(cls, **builder_params["unpacker"])
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\core\meta\mixin.py", line 49, in compile_mixin_unpacker
    builder.add_unpack_method()
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\core\meta\code\builder.py", line 588, in add_unpack_method
    self.compile()
  File "C:\Users\VarshaS\AppData\Local\Programs\Python\Python312\Lib\site-packages\mashumaro\core\meta\code\builder.py", line 332, in compile
    exec(code, self.globals, self.__dict__)
  File "<string>", line 0, in <module>
KeyboardInterrupt

[0m15:54:23.539590 [debug] [MainThread]: Command `dbt run` failed at 15:54:23.539590 after 0.72 seconds
[0m15:54:23.539590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A3A87530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A451BBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2A4837830>]}
[0m15:54:23.539590 [debug] [MainThread]: Flushing usage events
[0m15:54:24.908066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:54:40.490412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E8654710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E80494C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E86573B0>]}


============================== 15:54:40.497838 | 9ae4670c-858d-4d76-8eb5-8f4fe6919eac ==============================
[0m15:54:40.497838 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:54:40.497838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:high_cross_sell', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:54:40.959583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ae4670c-858d-4d76-8eb5-8f4fe6919eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E5A0EA50>]}
[0m15:54:41.017165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ae4670c-858d-4d76-8eb5-8f4fe6919eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E8231FA0>]}
[0m15:54:41.017165 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:54:41.379311 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:54:41.570385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:54:41.570385 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m15:54:41.570385 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\highest_cross_sell.sql
[0m15:54:41.815843 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:54:41.823703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ae4670c-858d-4d76-8eb5-8f4fe6919eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254EA7D0E00>]}
[0m15:54:41.906985 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:54:41.906985 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:54:41.941039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ae4670c-858d-4d76-8eb5-8f4fe6919eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254EA914DD0>]}
[0m15:54:41.941039 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 477 macros
[0m15:54:41.943154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ae4670c-858d-4d76-8eb5-8f4fe6919eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254EA7D1460>]}
[0m15:54:41.943154 [warn ] [MainThread]: The selection criterion 'tag:high_cross_sell' does not match any enabled nodes
[0m15:54:41.943154 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:54:41.943154 [debug] [MainThread]: Command end result
[0m15:54:41.965144 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:54:41.965144 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:54:41.973788 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:54:41.974832 [debug] [MainThread]: Command `dbt run` succeeded at 15:54:41.973788 after 1.64 seconds
[0m15:54:41.974832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E81C9AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E7A6ABA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E5A737D0>]}
[0m15:54:41.975829 [debug] [MainThread]: Flushing usage events
[0m15:54:43.002720 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:05.797341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801F887B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801F59EFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801D3D64B0>]}


============================== 15:55:05.813149 | bb0619f0-9eea-4c5b-abd0-7489768479cf ==============================
[0m15:55:05.813149 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:55:05.813149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:highest_cross_sell', 'send_anonymous_usage_stats': 'True'}
[0m15:55:06.268161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb0619f0-9eea-4c5b-abd0-7489768479cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028020AF5820>]}
[0m15:55:06.331378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb0619f0-9eea-4c5b-abd0-7489768479cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801F10CDD0>]}
[0m15:55:06.331378 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:55:06.680898 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:55:06.849220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:55:06.849220 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:55:06.849220 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:55:06.900633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb0619f0-9eea-4c5b-abd0-7489768479cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028021BD7B30>]}
[0m15:55:06.965228 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:55:06.980999 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:55:06.996732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb0619f0-9eea-4c5b-abd0-7489768479cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002802008D5B0>]}
[0m15:55:06.996732 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 477 macros
[0m15:55:06.996732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb0619f0-9eea-4c5b-abd0-7489768479cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801F8879B0>]}
[0m15:55:06.996732 [info ] [MainThread]: 
[0m15:55:06.996732 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:55:06.996732 [info ] [MainThread]: 
[0m15:55:07.012868 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:55:07.012868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:55:07.116136 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:55:07.116136 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:55:07.116136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:09.103045 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.987 seconds
[0m15:55:09.103045 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m15:55:09.122980 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:55:09.122980 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:55:09.122980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:10.712449 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.588 seconds
[0m15:55:10.714458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m15:55:10.716463 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:55:10.716463 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:55:11.046409 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.339 seconds
[0m15:55:11.059050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m15:55:11.060557 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:55:11.062564 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:55:11.392019 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.329 seconds
[0m15:55:11.394027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb0619f0-9eea-4c5b-abd0-7489768479cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028020A96BA0>]}
[0m15:55:11.399646 [debug] [Thread-1 (]: Began running node model.dbt_first.highest_cross_sell
[0m15:55:11.399646 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.highest_cross_sell ........................... [RUN]
[0m15:55:11.399646 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.highest_cross_sell'
[0m15:55:11.399646 [debug] [Thread-1 (]: Began compiling node model.dbt_first.highest_cross_sell
[0m15:55:11.399646 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.highest_cross_sell"
[0m15:55:11.399646 [debug] [Thread-1 (]: Began executing node model.dbt_first.highest_cross_sell
[0m15:55:11.437196 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.highest_cross_sell"
[0m15:55:11.437196 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.highest_cross_sell"
[0m15:55:11.437196 [debug] [Thread-1 (]: On model.dbt_first.highest_cross_sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.highest_cross_sell"} */
create or replace transient table HEALTHCARE.mart.highest_cross_sell
         as
        (

select * from HEALTHCARE.stage.stg_products
        );
[0m15:55:11.437196 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:55:13.795017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.353 seconds
[0m15:55:13.811024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb0619f0-9eea-4c5b-abd0-7489768479cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801F1F0380>]}
[0m15:55:13.811024 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.highest_cross_sell ...................... [[32mSUCCESS 1[0m in 2.41s]
[0m15:55:13.811024 [debug] [Thread-1 (]: Finished running node model.dbt_first.highest_cross_sell
[0m15:55:13.811024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:13.811024 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:55:13.811024 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:55:14.378269 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m15:55:14.378269 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m15:55:14.913612 [debug] [MainThread]: Connection 'model.dbt_first.highest_cross_sell' was left open.
[0m15:55:14.913612 [debug] [MainThread]: On model.dbt_first.highest_cross_sell: Close
[0m15:55:15.441573 [info ] [MainThread]: 
[0m15:55:15.442540 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m15:55:15.443537 [debug] [MainThread]: Command end result
[0m15:55:15.467040 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:55:15.472111 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:55:15.479697 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:55:15.479697 [info ] [MainThread]: 
[0m15:55:15.479697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:55:15.479697 [info ] [MainThread]: 
[0m15:55:15.479697 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:55:15.479697 [debug] [MainThread]: Command `dbt run` succeeded at 15:55:15.479697 after 9.84 seconds
[0m15:55:15.479697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801EE01730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801F8B9BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002801F4F1940>]}
[0m15:55:15.479697 [debug] [MainThread]: Flushing usage events
[0m15:55:16.463425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:00.498297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A853C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A853E450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A853C590>]}


============================== 15:57:00.498297 | ce768525-333f-42db-b3f0-f196923f86ef ==============================
[0m15:57:00.498297 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:57:00.498297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:57:00.636984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce768525-333f-42db-b3f0-f196923f86ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A8586F30>]}
[0m15:57:00.689171 [debug] [MainThread]: Command `dbt clean` succeeded at 15:57:00.689171 after 0.37 seconds
[0m15:57:00.689171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A83356D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A8600F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A8517710>]}
[0m15:57:00.689171 [debug] [MainThread]: Flushing usage events
[0m15:57:02.093526 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:18.396217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232E0E8CD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232E0E8C4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232E0E8C3B0>]}


============================== 15:57:18.396217 | 57257ea7-6b2f-4f49-b958-9bada7f72e03 ==============================
[0m15:57:18.396217 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:57:18.396217 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:18.526908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57257ea7-6b2f-4f49-b958-9bada7f72e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DE26EAB0>]}
[0m15:57:18.558493 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:57:18.574139 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:57:18.574139 [debug] [MainThread]: Command `dbt deps` succeeded at 15:57:18.574139 after 0.35 seconds
[0m15:57:18.574139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232E0F49850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232DE26EAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232E0E8C6E0>]}
[0m15:57:18.576149 [debug] [MainThread]: Flushing usage events
[0m15:57:23.850740 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:36.462753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57CDE25A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57CF615E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57CF60680>]}


============================== 15:57:36.462753 | 7feaea07-897c-4fe4-8aa7-ed294ee74b19 ==============================
[0m15:57:36.462753 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:57:36.462753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:57:37.153623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7feaea07-897c-4fe4-8aa7-ed294ee74b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57DAD2CC0>]}
[0m15:57:37.200694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7feaea07-897c-4fe4-8aa7-ed294ee74b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57ABF9250>]}
[0m15:57:37.200694 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:57:37.593190 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:57:37.593190 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:57:37.593190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7feaea07-897c-4fe4-8aa7-ed294ee74b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57EE85D00>]}
[0m15:57:38.992796 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:57:39.012361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7feaea07-897c-4fe4-8aa7-ed294ee74b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57EEA9760>]}
[0m15:57:39.083582 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:57:39.083582 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:57:39.124468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7feaea07-897c-4fe4-8aa7-ed294ee74b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57EDF6360>]}
[0m15:57:39.124468 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 477 macros
[0m15:57:39.124468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7feaea07-897c-4fe4-8aa7-ed294ee74b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57F24A300>]}
[0m15:57:39.124468 [info ] [MainThread]: 
[0m15:57:39.130256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:39.130256 [info ] [MainThread]: 
[0m15:57:39.130256 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:57:39.136172 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m15:57:39.256628 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:57:39.257628 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:57:39.257628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:41.344189 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.088 seconds
[0m15:57:41.346196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m15:57:41.346196 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:57:41.346196 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:57:41.722281 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.371 seconds
[0m15:57:41.729870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m15:57:41.736693 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:57:41.736693 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:57:42.148729 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.411 seconds
[0m15:57:42.148729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7feaea07-897c-4fe4-8aa7-ed294ee74b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57AD53740>]}
[0m15:57:42.164438 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_country_region
[0m15:57:42.164438 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_country_region'
[0m15:57:42.164438 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_country_region
[0m15:57:42.174275 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_country_region"
[0m15:57:42.176280 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_country_region
[0m15:57:42.176280 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_country_region
[0m15:57:42.179095 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m15:57:42.179095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_country_region, now model.dbt_first.stg_customers)
[0m15:57:42.179095 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m15:57:42.180101 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m15:57:42.180101 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m15:57:42.180101 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m15:57:42.180101 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_products
[0m15:57:42.180101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_products)
[0m15:57:42.187474 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_products
[0m15:57:42.189480 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_products"
[0m15:57:42.191485 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_products
[0m15:57:42.191485 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_products
[0m15:57:42.191485 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_transactions
[0m15:57:42.193694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_products, now model.dbt_first.stg_transactions)
[0m15:57:42.193694 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_transactions
[0m15:57:42.197706 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_transactions"
[0m15:57:42.197706 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_transactions
[0m15:57:42.197706 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_transactions
[0m15:57:42.197706 [debug] [Thread-1 (]: Began running node seed.dbt_first.country_region
[0m15:57:42.197706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_transactions, now seed.dbt_first.country_region)
[0m15:57:42.201359 [debug] [Thread-1 (]: Began compiling node seed.dbt_first.country_region
[0m15:57:42.201359 [debug] [Thread-1 (]: Began executing node seed.dbt_first.country_region
[0m15:57:42.203365 [debug] [Thread-1 (]: Finished running node seed.dbt_first.country_region
[0m15:57:42.203365 [debug] [Thread-1 (]: Began running node model.dbt_first.highest_cross_sell
[0m15:57:42.203365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_first.country_region, now model.dbt_first.highest_cross_sell)
[0m15:57:42.203365 [debug] [Thread-1 (]: Began compiling node model.dbt_first.highest_cross_sell
[0m15:57:42.207377 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.highest_cross_sell"
[0m15:57:42.207377 [debug] [Thread-1 (]: Began executing node model.dbt_first.highest_cross_sell
[0m15:57:42.207377 [debug] [Thread-1 (]: Finished running node model.dbt_first.highest_cross_sell
[0m15:57:42.209828 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m15:57:42.209828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.highest_cross_sell, now model.dbt_first.churned_new_customers)
[0m15:57:42.209828 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m15:57:42.213573 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m15:57:42.213573 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m15:57:42.213573 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m15:57:42.213573 [debug] [Thread-1 (]: Began running node model.dbt_first.new_logo_each_fiscal
[0m15:57:42.213573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.churned_new_customers, now model.dbt_first.new_logo_each_fiscal)
[0m15:57:42.217396 [debug] [Thread-1 (]: Began compiling node model.dbt_first.new_logo_each_fiscal
[0m15:57:42.219403 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.new_logo_each_fiscal"
[0m15:57:42.219403 [debug] [Thread-1 (]: Began executing node model.dbt_first.new_logo_each_fiscal
[0m15:57:42.219403 [debug] [Thread-1 (]: Finished running node model.dbt_first.new_logo_each_fiscal
[0m15:57:42.219403 [debug] [Thread-1 (]: Began running node model.dbt_first.product_churn
[0m15:57:42.222745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.new_logo_each_fiscal, now model.dbt_first.product_churn)
[0m15:57:42.222745 [debug] [Thread-1 (]: Began compiling node model.dbt_first.product_churn
[0m15:57:42.224751 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.product_churn"
[0m15:57:42.224751 [debug] [Thread-1 (]: Began executing node model.dbt_first.product_churn
[0m15:57:42.227574 [debug] [Thread-1 (]: Finished running node model.dbt_first.product_churn
[0m15:57:42.227574 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m15:57:42.227574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.product_churn, now model.dbt_first.rank_customers_revenue)
[0m15:57:42.227574 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m15:57:42.232093 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m15:57:42.232093 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m15:57:42.234099 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m15:57:42.234099 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m15:57:42.234099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.rank_customers_revenue, now model.dbt_first.rank_product_revenue)
[0m15:57:42.234099 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m15:57:42.236105 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m15:57:42.238111 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m15:57:42.238111 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m15:57:42.238111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:42.238111 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m15:57:42.238111 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m15:57:42.791383 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was properly closed.
[0m15:57:42.804580 [debug] [MainThread]: Command end result
[0m15:57:42.828124 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:57:42.831122 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:57:42.837635 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:57:42.838635 [debug] [MainThread]: Command `dbt compile` succeeded at 15:57:42.838635 after 6.53 seconds
[0m15:57:42.838635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57D0478C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57CBAF1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B57A55E240>]}
[0m15:57:42.838635 [debug] [MainThread]: Flushing usage events
[0m15:57:43.774279 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:52.644884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D49FD68A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4CA35070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4CA35FD0>]}


============================== 15:57:52.644884 | 2e7a5a81-6e1d-4756-84c7-b574a183a8e2 ==============================
[0m15:57:52.644884 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:57:52.653184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:57:53.116443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4D5CBAD0>]}
[0m15:57:53.187787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4D101520>]}
[0m15:57:53.189793 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:57:53.544026 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:57:53.711940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:53.711940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:53.727959 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m15:57:53.765479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4D0DCD10>]}
[0m15:57:53.845148 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:57:53.846895 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:57:53.878667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4F6A9A90>]}
[0m15:57:53.878667 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 477 macros
[0m15:57:53.878667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4E1ABB30>]}
[0m15:57:53.878667 [info ] [MainThread]: 
[0m15:57:53.878667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:53.878667 [info ] [MainThread]: 
[0m15:57:53.878667 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:57:53.878667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m15:57:53.982483 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:57:53.982483 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:57:53.982483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:55.533345 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.538 seconds
[0m15:57:55.533345 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m15:57:55.533345 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m15:57:55.834888 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.305 seconds
[0m15:57:55.846445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m15:57:55.857665 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m15:57:55.857665 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m15:57:55.857665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:57.863874 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.009 seconds
[0m15:57:57.870131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m15:57:57.872138 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m15:57:57.872138 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m15:57:58.199780 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.332 seconds
[0m15:57:58.207624 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m15:57:58.209630 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m15:57:58.209630 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m15:57:58.559925 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.351 seconds
[0m15:57:58.561934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4B282F60>]}
[0m15:57:58.566203 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_country_region
[0m15:57:58.566203 [info ] [Thread-1 (]: 1 of 10 START sql table model stage.stg_country_region ......................... [RUN]
[0m15:57:58.566203 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.stg_country_region'
[0m15:57:58.566203 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_country_region
[0m15:57:58.566203 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_country_region"
[0m15:57:58.566203 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_country_region
[0m15:57:58.603700 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_country_region"
[0m15:57:58.603700 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_country_region"
[0m15:57:58.603700 [debug] [Thread-1 (]: On model.dbt_first.stg_country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_country_region"} */
create or replace transient table HEALTHCARE.stage.stg_country_region
         as
        (

WITH cte_remove_duplicates AS (
    SELECT 
        customer_id,
        country,
        region
    FROM HEALTHCARE.RAW.COUNTRY_REGION
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

), 
cte_cleaned_data AS (
    SELECT 
        CAST(customer_id AS NUMBER(38,0)) AS customer_id,
        CAST(country AS VARCHAR(200)) AS country,
        CAST(region AS VARCHAR(200)) AS region,
        UPPER(TRIM(country)) AS cleaned_country,
        INITCAP(TRIM(region)) AS cleaned_region
    FROM HEALTHCARE.RAW.COUNTRY_REGION
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)

SELECT 
    customer_id,
    cleaned_country AS country,
    cleaned_region AS region
FROM cte_cleaned_data
        );
[0m15:57:58.603700 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:58:01.370476 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.755 seconds
[0m15:58:01.386271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4CA80AD0>]}
[0m15:58:01.386271 [info ] [Thread-1 (]: 1 of 10 OK created sql table model stage.stg_country_region .................... [[32mSUCCESS 1[0m in 2.82s]
[0m15:58:01.386271 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_country_region
[0m15:58:01.386271 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m15:58:01.386271 [info ] [Thread-1 (]: 2 of 10 START sql table model stage.stg_customers .............................. [RUN]
[0m15:58:01.386271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_country_region, now model.dbt_first.stg_customers)
[0m15:58:01.386271 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m15:58:01.402058 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m15:58:01.405284 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m15:58:01.407940 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_customers"
[0m15:58:01.411380 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_customers"
[0m15:58:01.411380 [debug] [Thread-1 (]: On model.dbt_first.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_customers"} */
create or replace transient table HEALTHCARE.stage.stg_customers
         as
        (

WITH cte_handle_null AS (
    SELECT 
        customer_id,
        INITCAP(TRIM(customer_name)) AS customer_name,
        TRIM(company) AS company
    FROM HEALTHCARE.RAW.CUSTOMERS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    
  
),

cte_final AS (
    SELECT 
    DISTINCT
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(customer_name AS VARCHAR(300)) AS customer_name,
    
        CAST(company AS VARCHAR(100)) AS company,
    

    FROM cte_handle_null
)

SELECT * FROM cte_final
        );
[0m15:58:02.956631 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.553 seconds
[0m15:58:02.956631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4F65D640>]}
[0m15:58:02.956631 [info ] [Thread-1 (]: 2 of 10 OK created sql table model stage.stg_customers ......................... [[32mSUCCESS 1[0m in 1.57s]
[0m15:58:02.956631 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m15:58:02.956631 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_products
[0m15:58:02.956631 [info ] [Thread-1 (]: 3 of 10 START sql table model stage.stg_products ............................... [RUN]
[0m15:58:02.972301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_products)
[0m15:58:02.972301 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_products
[0m15:58:02.975491 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_products"
[0m15:58:02.975491 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_products
[0m15:58:02.975491 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_products"
[0m15:58:02.975491 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_products"
[0m15:58:02.975491 [debug] [Thread-1 (]: On model.dbt_first.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_products"} */
create or replace transient table HEALTHCARE.stage.stg_products
         as
        (

WITH cte_not_null AS (
    SELECT 
        TRIM(product_id) AS product_id, 
        TRIM(product_family) AS product_family, 
        TRIM(product_sub_family) AS product_sub_family
    FROM HEALTHCARE.RAW.PRODUCTS
    WHERE 
    
        product_id IS NOT NULL
         AND 
    
        product_family IS NOT NULL
         AND 
    
        product_sub_family IS NOT NULL
        
    

),

cte_final AS (
    SELECT 
    DISTINCT
        
    
        CAST(product_id AS VARCHAR(500)) AS product_id,
    
        CAST(product_family AS VARCHAR(500)) AS product_family,
    
        CAST(product_sub_family AS VARCHAR(500)) AS product_sub_family,
    

    FROM cte_not_null
)

SELECT * FROM cte_final
        );
[0m15:58:03.952701 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.971 seconds
[0m15:58:03.952701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4FE8ED80>]}
[0m15:58:03.952701 [info ] [Thread-1 (]: 3 of 10 OK created sql table model stage.stg_products .......................... [[32mSUCCESS 1[0m in 0.98s]
[0m15:58:03.952701 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_products
[0m15:58:03.952701 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_transactions
[0m15:58:03.952701 [info ] [Thread-1 (]: 4 of 10 START sql table model stage.stg_transactions ........................... [RUN]
[0m15:58:03.952701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_products, now model.dbt_first.stg_transactions)
[0m15:58:03.952701 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_transactions
[0m15:58:03.952701 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_transactions"
[0m15:58:03.952701 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_transactions
[0m15:58:03.968369 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_transactions"
[0m15:58:03.972462 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_transactions"
[0m15:58:03.972462 [debug] [Thread-1 (]: On model.dbt_first.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_transactions"} */
create or replace transient table HEALTHCARE.stage.stg_transactions
         as
        (

WITH cte_cleaned_data AS (
    SELECT  
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(revenue AS DECIMAL(10,3)) AS revenue,
    
        CAST(quantity AS INT) AS quantity,
    
        CAST(product_id AS VARCHAR(200)) AS product_id,
    
        CAST(payment_mode AS DATE) AS payment_mode,
    
        CAST(companies AS VARCHAR(100)) AS companies,
    


        CASE 
            WHEN revenue_type = 'True' THEN 1
            WHEN revenue_type = 'False' THEN 0
            ELSE NULL 
        END AS revenue_type,
        CAST(payment_mode AS DATE) AS payment_date,
        CAST(dimension_1 AS VARCHAR(10)) AS dim_1,
        CAST(dimension_2 AS VARCHAR(10)) AS dim_2,
        CAST(dimension_3 AS VARCHAR(10)) AS dim_3,
        CAST(dimension_4 AS VARCHAR(10)) AS dim_4,
        CAST(dimension_5 AS VARCHAR(10)) AS dim_5,
        CAST(dimension_6 AS VARCHAR(10)) AS dim_6,
        CAST(dimension_7 AS VARCHAR(10)) AS dim_7,
        CAST(dimension_8 AS VARCHAR(10)) AS dim_8,
        CAST(dimension_9 AS VARCHAR(10)) AS dim_9,
        CAST(dimension_10 AS VARCHAR(10)) AS dim_10
    FROM HEALTHCARE.RAW.TRANSACTIONS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        product_id IS NOT NULL
         AND 
    
        payment_mode IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        dimension_1 IS NOT NULL
         AND 
    
        dimension_2 IS NOT NULL
         AND 
    
        dimension_3 IS NOT NULL
         AND 
    
        dimension_4 IS NOT NULL
         AND 
    
        dimension_5 IS NOT NULL
         AND 
    
        dimension_6 IS NOT NULL
         AND 
    
        dimension_7 IS NOT NULL
         AND 
    
        dimension_8 IS NOT NULL
         AND 
    
        dimension_9 IS NOT NULL
         AND 
    
        dimension_10 IS NOT NULL
         AND 
    
        companies IS NOT NULL
        
    

),
cte_name_change AS(
    SELECT 
    DISTINCT
        customer_id,
        revenue,
        quantity,
        product_id,
        payment_mode AS payment_date,
        companies       AS company_name,
        revenue_type,
        dim_1,
        dim_2,
        dim_3,
        dim_4,
        dim_5,
        dim_6,
        dim_7,
        dim_8,
        dim_9,
        dim_10
    FROM 
        cte_cleaned_data
)

SELECT * FROM cte_name_change
        );
[0m15:58:05.513898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.541 seconds
[0m15:58:05.515901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4FE870E0>]}
[0m15:58:05.515901 [info ] [Thread-1 (]: 4 of 10 OK created sql table model stage.stg_transactions ...................... [[32mSUCCESS 1[0m in 1.56s]
[0m15:58:05.515901 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_transactions
[0m15:58:05.515901 [debug] [Thread-1 (]: Began running node model.dbt_first.highest_cross_sell
[0m15:58:05.517905 [info ] [Thread-1 (]: 5 of 10 START sql table model mart.highest_cross_sell .......................... [RUN]
[0m15:58:05.517905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_transactions, now model.dbt_first.highest_cross_sell)
[0m15:58:05.517905 [debug] [Thread-1 (]: Began compiling node model.dbt_first.highest_cross_sell
[0m15:58:05.521863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.highest_cross_sell"
[0m15:58:05.521863 [debug] [Thread-1 (]: Began executing node model.dbt_first.highest_cross_sell
[0m15:58:05.521863 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.highest_cross_sell"
[0m15:58:05.521863 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.highest_cross_sell"
[0m15:58:05.521863 [debug] [Thread-1 (]: On model.dbt_first.highest_cross_sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.highest_cross_sell"} */
create or replace transient table HEALTHCARE.mart.highest_cross_sell
         as
        (

select * from HEALTHCARE.stage.stg_products
        );
[0m15:58:06.789909 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.270 seconds
[0m15:58:06.789909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4FEB2ED0>]}
[0m15:58:06.789909 [info ] [Thread-1 (]: 5 of 10 OK created sql table model mart.highest_cross_sell ..................... [[32mSUCCESS 1[0m in 1.27s]
[0m15:58:06.789909 [debug] [Thread-1 (]: Finished running node model.dbt_first.highest_cross_sell
[0m15:58:06.789909 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m15:58:06.789909 [info ] [Thread-1 (]: 6 of 10 START sql table model mart.churned_new_customers ....................... [RUN]
[0m15:58:06.789909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.highest_cross_sell, now model.dbt_first.churned_new_customers)
[0m15:58:06.789909 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m15:58:06.805678 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m15:58:06.805678 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m15:58:06.861256 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m15:58:06.865262 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m15:58:06.866265 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    GROUP BY customer_id
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
customer_status AS (
    SELECT
        flp.customer_id,
        flp.first_purchase_date,
        flp.last_purchase_date, 
        CASE
            WHEN flp.last_purchase_date < DATEADD(month, -3, mmo.max_date) THEN 1
            ELSE 0
        END AS churned_customer,
        CASE
            WHEN flp.first_purchase_date > DATEADD(month, -3, mmo.max_date) THEN 1
            ELSE 0
        END AS new_customer
    FROM first_last_purchase AS flp
    CROSS JOIN max_min_overall AS mmo
),
customer_status_over_time AS (
    SELECT
        DATE_TRUNC('month', flp.first_purchase_date) AS month,
        SUM(cs.churned_customer) AS churned_customers,
        SUM(cs.new_customer) AS new_customers
    FROM customer_status AS cs
    JOIN first_last_purchase AS flp ON cs.customer_id = flp.customer_id
    GROUP BY month
)
SELECT 
    month,
    churned_customers,
    new_customers
FROM 
    customer_status_over_time
ORDER BY 
    month



--     WITH first_payment AS (
--     SELECT
--         customer_id,
--         MIN(payment_date) AS first_payment_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
--     GROUP BY
--         customer_id
-- ),
 
-- new_customers_by_fy AS (
--     SELECT
--         customer_id,
--         EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
--     FROM
--         first_payment
-- ),
 
-- date_range AS (
--     SELECT
--         MIN(payment_date) AS start_date,
--         MAX(payment_date) AS end_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
-- ),
 
-- last_payment AS (
--     SELECT
--         customer_id,
--         MAX(payment_date) AS last_payment_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
--     GROUP BY
--         customer_id
-- ),
 
-- churned_customers AS (
--     SELECT
--         customer_id,
--         EXTRACT(YEAR FROM last_payment_date) AS fiscal_year
--     FROM
--         last_payment,
--         date_range
--     WHERE
--         last_payment_date < end_date
-- ),
 
-- fiscal_years AS (
--     SELECT DISTINCT
--         EXTRACT(YEAR FROM payment_date) AS fiscal_year
--     FROM
--         HEALTHCARE.stage.stg_transactions
-- )
 
-- SELECT
--     fy.fiscal_year,
--     COUNT(DISTINCT new_customers_by_fy.customer_id) AS new_customers_count,
--     COUNT(DISTINCT churned_customers.customer_id) AS churned_customers_count
-- FROM
--     fiscal_years fy
--     LEFT JOIN new_customers_by_fy ON fy.fiscal_year = new_customers_by_fy.fiscal_year
--     LEFT JOIN churned_customers ON fy.fiscal_year = churned_customers.fiscal_year
-- GROUP BY
--     fy.fiscal_year
-- ORDER BY
--     fy.fiscal_year
        );
[0m15:58:07.969910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.104 seconds
[0m15:58:07.969910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4FEB1250>]}
[0m15:58:07.969910 [info ] [Thread-1 (]: 6 of 10 OK created sql table model mart.churned_new_customers .................. [[32mSUCCESS 1[0m in 1.18s]
[0m15:58:07.969910 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m15:58:07.969910 [debug] [Thread-1 (]: Began running node model.dbt_first.new_logo_each_fiscal
[0m15:58:07.969910 [info ] [Thread-1 (]: 7 of 10 START sql table model mart.new_logo_each_fiscal ........................ [RUN]
[0m15:58:07.969910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.churned_new_customers, now model.dbt_first.new_logo_each_fiscal)
[0m15:58:07.969910 [debug] [Thread-1 (]: Began compiling node model.dbt_first.new_logo_each_fiscal
[0m15:58:07.969910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.new_logo_each_fiscal"
[0m15:58:07.969910 [debug] [Thread-1 (]: Began executing node model.dbt_first.new_logo_each_fiscal
[0m15:58:07.969910 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.new_logo_each_fiscal"
[0m15:58:07.985859 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.new_logo_each_fiscal"
[0m15:58:07.985859 [debug] [Thread-1 (]: On model.dbt_first.new_logo_each_fiscal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.new_logo_each_fiscal"} */
create or replace transient table HEALTHCARE.mart.new_logo_each_fiscal
         as
        (

WITH cte_first_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date
    FROM
        HEALTHCARE.stage.stg_transactions
    GROUP BY
        customer_id
),
 
cte_extract_year AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_purchase_date) AS fiscal_year
    FROM
        cte_first_purchase
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_logos
FROM
    cte_extract_year
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m15:58:09.083276 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.096 seconds
[0m15:58:09.083276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4FEB0920>]}
[0m15:58:09.083276 [info ] [Thread-1 (]: 7 of 10 OK created sql table model mart.new_logo_each_fiscal ................... [[32mSUCCESS 1[0m in 1.11s]
[0m15:58:09.083276 [debug] [Thread-1 (]: Finished running node model.dbt_first.new_logo_each_fiscal
[0m15:58:09.083276 [debug] [Thread-1 (]: Began running node model.dbt_first.product_churn
[0m15:58:09.083276 [info ] [Thread-1 (]: 8 of 10 START sql table model mart.product_churn ............................... [RUN]
[0m15:58:09.083276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.new_logo_each_fiscal, now model.dbt_first.product_churn)
[0m15:58:09.083276 [debug] [Thread-1 (]: Began compiling node model.dbt_first.product_churn
[0m15:58:09.083276 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.product_churn"
[0m15:58:09.083276 [debug] [Thread-1 (]: Began executing node model.dbt_first.product_churn
[0m15:58:09.083276 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.product_churn"
[0m15:58:09.098248 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.product_churn"
[0m15:58:09.098248 [debug] [Thread-1 (]: On model.dbt_first.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.product_churn"} */
create or replace transient table HEALTHCARE.mart.product_churn
         as
        (

WITH cte_first_order_date AS()
-- WITH last_purchase AS (
--     SELECT
--         product_id,
--         MAX(payment_date) AS last_transaction_date
--     FROM HEALTHCARE.stage.stg_transactions
--     GROUP BY product_id
-- ),

-- churned_products AS (
--     SELECT
--         p.product_id,
--         p.product_family,
--         lp.last_transaction_date
--     FROM last_purchase AS lp
--     JOIN HEALTHCARE.stage.stg_products  AS p ON lp.product_id = p.product_id
--     WHERE lp.last_transaction_date < DATEADD(MONTH, -6, CURRENT_DATE)  -- Products not sold in last 6 months
-- )

-- SELECT * FROM churned_products
        );
[0m15:58:09.576089 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0014-0004-c0bd-0005-a3d30003b8ae
[0m15:58:09.576089 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 29 unexpected ')'.
[0m15:58:09.589870 [debug] [Thread-1 (]: Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 29 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m15:58:09.589870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4FE8E570>]}
[0m15:58:09.589870 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model mart.product_churn ...................... [[31mERROR[0m in 0.51s]
[0m15:58:09.589870 [debug] [Thread-1 (]: Finished running node model.dbt_first.product_churn
[0m15:58:09.589870 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m15:58:09.589870 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.product_churn' to be skipped because of status 'error'.  Reason: Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 29 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql.
[0m15:58:09.589870 [info ] [Thread-1 (]: 9 of 10 START sql table model mart.rank_customers_revenue ...................... [RUN]
[0m15:58:09.589870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.product_churn, now model.dbt_first.rank_customers_revenue)
[0m15:58:09.589870 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m15:58:09.599564 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m15:58:09.602265 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m15:58:09.605125 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m15:58:09.607162 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m15:58:09.608161 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (
WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue * t.quantity) AS total_revenue,
        COUNT(*) AS transaction_count
    FROM HEALTHCARE.stage.stg_transactions t
    LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
    ON t.customer_id = c.customer_id
    where revenue_type = 1 and t.revenue > 0
    GROUP BY t.customer_id, c.customer_name
),
 
ranked_customers AS (
    SELECT
        customer_id,
        customer_name,
        total_revenue,
        transaction_count,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
 
SELECT * FROM ranked_customers

-- WITH customer_revenue AS (
--     SELECT
--         c.CUSTOMER_ID AS customer_id,
--         c.customer_name,
--         SUM(t.REVENUE) AS total_revenue,
--         DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
--     FROM HEALTHCARE.stage.stg_transactions as t
--     JOIN HEALTHCARE.stage.stg_customers as  c
--     ON c.CUSTOMER_ID = t.CUSTOMER_ID
--     GROUP BY c.CUSTOMER_ID,c.customer_name
-- )
 
-- SELECT
--     customer_id,
--     customer_name,
--         total_revenue,
--     revenue_rank
-- FROM customer_revenue
-- ORDER BY revenue_rank
        );
[0m15:58:10.701589 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.104 seconds
[0m15:58:10.713744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4FD5D010>]}
[0m15:58:10.713744 [info ] [Thread-1 (]: 9 of 10 OK created sql table model mart.rank_customers_revenue ................. [[32mSUCCESS 1[0m in 1.12s]
[0m15:58:10.713744 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m15:58:10.713744 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m15:58:10.713744 [info ] [Thread-1 (]: 10 of 10 START sql table model mart.rank_product_revenue ....................... [RUN]
[0m15:58:10.713744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.rank_customers_revenue, now model.dbt_first.rank_product_revenue)
[0m15:58:10.713744 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m15:58:10.713744 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m15:58:10.713744 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m15:58:10.713744 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m15:58:10.713744 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m15:58:10.713744 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

WITH cte_product_revenue AS (
    SELECT 
        product_id,
        SUM(revenue*quantity) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions 
    where revenue_type = 1 and revenue > 0
    GROUP BY 
        product_id
)
SELECT 
    product_id,
    total_revenue,
    DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS product_rank
FROM cte_product_revenue
        );
[0m15:58:11.718744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.997 seconds
[0m15:58:11.718744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7a5a81-6e1d-4756-84c7-b574a183a8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4FD832C0>]}
[0m15:58:11.734270 [info ] [Thread-1 (]: 10 of 10 OK created sql table model mart.rank_product_revenue .................. [[32mSUCCESS 1[0m in 1.00s]
[0m15:58:11.734270 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m15:58:11.734270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:11.734270 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m15:58:11.734270 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m15:58:12.284449 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m15:58:12.284449 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m15:58:13.079884 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was left open.
[0m15:58:13.093467 [debug] [MainThread]: On model.dbt_first.rank_product_revenue: Close
[0m15:58:13.618838 [info ] [MainThread]: 
[0m15:58:13.618838 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 19.74 seconds (19.74s).
[0m15:58:13.618838 [debug] [MainThread]: Command end result
[0m15:58:13.651327 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m15:58:13.654334 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m15:58:13.659770 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m15:58:13.659770 [info ] [MainThread]: 
[0m15:58:13.659770 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:58:13.659770 [info ] [MainThread]: 
[0m15:58:13.659770 [error] [MainThread]:   Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 29 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m15:58:13.659770 [info ] [MainThread]: 
[0m15:58:13.659770 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m15:58:13.659770 [debug] [MainThread]: Command `dbt run` failed at 15:58:13.659770 after 21.18 seconds
[0m15:58:13.659770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4AD8ABA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4B36A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D4B36A3C0>]}
[0m15:58:13.668023 [debug] [MainThread]: Flushing usage events
[0m15:58:14.925059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:17.693032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C966514380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C965E0A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9637818E0>]}


============================== 16:08:17.702653 | a72e8757-bcb5-4b8f-8c08-706e6663862a ==============================
[0m16:08:17.702653 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:08:17.703659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:highest_cross_sell', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:08:18.242325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a72e8757-bcb5-4b8f-8c08-706e6663862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C967124B00>]}
[0m16:08:18.306796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a72e8757-bcb5-4b8f-8c08-706e6663862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C967207D70>]}
[0m16:08:18.306796 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:08:18.793236 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:08:20.245017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:08:20.245017 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\highest_cross_sell.sql
[0m16:08:20.245017 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\product_churn.sql
[0m16:08:20.499972 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m16:08:20.514086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a72e8757-bcb5-4b8f-8c08-706e6663862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9686DBF20>]}
[0m16:08:20.590762 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:08:20.606848 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:08:20.642908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a72e8757-bcb5-4b8f-8c08-706e6663862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9688220F0>]}
[0m16:08:20.642908 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 477 macros
[0m16:08:20.642908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a72e8757-bcb5-4b8f-8c08-706e6663862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96882A690>]}
[0m16:08:20.642908 [info ] [MainThread]: 
[0m16:08:20.642908 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:08:20.642908 [info ] [MainThread]: 
[0m16:08:20.642908 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:08:20.642908 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m16:08:23.438940 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m16:08:23.438940 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m16:08:23.438940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:25.661924 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.228 seconds
[0m16:08:25.661924 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m16:08:25.677601 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m16:08:25.677601 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m16:08:25.677601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:27.250981 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.565 seconds
[0m16:08:27.250981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m16:08:27.298868 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m16:08:27.298868 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m16:08:27.640508 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.338 seconds
[0m16:08:27.642512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m16:08:27.644515 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m16:08:27.644515 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m16:08:27.990743 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.349 seconds
[0m16:08:27.990743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a72e8757-bcb5-4b8f-8c08-706e6663862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96871F260>]}
[0m16:08:28.007655 [debug] [Thread-1 (]: Began running node model.dbt_first.highest_cross_sell
[0m16:08:28.007655 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.highest_cross_sell ........................... [RUN]
[0m16:08:28.007655 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.highest_cross_sell'
[0m16:08:28.007655 [debug] [Thread-1 (]: Began compiling node model.dbt_first.highest_cross_sell
[0m16:08:28.017947 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.highest_cross_sell"
[0m16:08:28.018943 [debug] [Thread-1 (]: Began executing node model.dbt_first.highest_cross_sell
[0m16:08:28.047428 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.highest_cross_sell"
[0m16:08:28.047428 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.highest_cross_sell"
[0m16:08:28.047428 [debug] [Thread-1 (]: On model.dbt_first.highest_cross_sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.highest_cross_sell"} */
create or replace transient table HEALTHCARE.mart.highest_cross_sell
         as
        (

WITH customer_product_count AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS product_count
    FROM 
        HEALTHCARE.stage.stg_transactions
    GROUP BY 
        CUSTOMER_ID
),
highest_cross_sell AS (
    SELECT 
        CUSTOMER_ID,
        product_count,
        DENSE_RANK() OVER(ORDER BY product_count DESC) AS cross_sell_rank
    FROM 
        customer_product_count
)
SELECT 
    hcs.CUSTOMER_ID,
    c.customer_name,
    hcs.product_count,
    hcs.cross_sell_rank
FROM 
    highest_cross_sell AS hcs
INNER JOIN 
      HEALTHCARE.stage.stg_customers AS c
ON 
    hcs.CUSTOMER_ID = c.CUSTOMER_ID
ORDER BY 
    hcs.cross_sell_rank;
[0m16:08:28.047428 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:08:29.630251 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb001e-0004-c0bd-0005-a3d30003b8c6
[0m16:08:29.630251 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 34 at position 23 unexpected ';'.
[0m16:08:29.646097 [debug] [Thread-1 (]: Database Error in model highest_cross_sell (models\Mart\highest_cross_sell.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 23 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\highest_cross_sell.sql
[0m16:08:29.646097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a72e8757-bcb5-4b8f-8c08-706e6663862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9672C6F90>]}
[0m16:08:29.646097 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.highest_cross_sell .................. [[31mERROR[0m in 1.64s]
[0m16:08:29.646097 [debug] [Thread-1 (]: Finished running node model.dbt_first.highest_cross_sell
[0m16:08:29.646097 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.highest_cross_sell' to be skipped because of status 'error'.  Reason: Database Error in model highest_cross_sell (models\Mart\highest_cross_sell.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 23 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\highest_cross_sell.sql.
[0m16:08:29.646097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:29.646097 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m16:08:29.646097 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m16:08:30.199218 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m16:08:30.199218 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m16:08:30.732908 [debug] [MainThread]: Connection 'model.dbt_first.highest_cross_sell' was left open.
[0m16:08:30.732908 [debug] [MainThread]: On model.dbt_first.highest_cross_sell: Close
[0m16:08:31.246388 [info ] [MainThread]: 
[0m16:08:31.246388 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.60 seconds (10.60s).
[0m16:08:31.246388 [debug] [MainThread]: Command end result
[0m16:08:31.283777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:08:31.283777 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:08:31.300248 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m16:08:31.300248 [info ] [MainThread]: 
[0m16:08:31.300248 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:08:31.300248 [info ] [MainThread]: 
[0m16:08:31.300248 [error] [MainThread]:   Database Error in model highest_cross_sell (models\Mart\highest_cross_sell.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 23 unexpected ';'.
  compiled code at target\run\dbt_first\models\Mart\highest_cross_sell.sql
[0m16:08:31.300248 [info ] [MainThread]: 
[0m16:08:31.300248 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:08:31.300248 [debug] [MainThread]: Command `dbt run` failed at 16:08:31.300248 after 13.81 seconds
[0m16:08:31.300248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96612CCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9654CDD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9654CF7A0>]}
[0m16:08:31.300248 [debug] [MainThread]: Flushing usage events
[0m16:08:32.268243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:45.176377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC01BBDAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC016908C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC00688590>]}


============================== 16:08:45.181463 | 8709d793-6234-4b23-a7ca-7df057bcb1b9 ==============================
[0m16:08:45.181463 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:08:45.182462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:highest_cross_sell', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:08:45.631257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8709d793-6234-4b23-a7ca-7df057bcb1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC05D68B60>]}
[0m16:08:45.692381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8709d793-6234-4b23-a7ca-7df057bcb1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC04897830>]}
[0m16:08:45.692381 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:08:46.058350 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:08:46.250104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:08:46.250104 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\highest_cross_sell.sql
[0m16:08:46.485591 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m16:08:46.506903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8709d793-6234-4b23-a7ca-7df057bcb1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC062DDFD0>]}
[0m16:08:46.581647 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:08:46.581647 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:08:46.623294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8709d793-6234-4b23-a7ca-7df057bcb1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC06284A40>]}
[0m16:08:46.623294 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 477 macros
[0m16:08:46.623294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8709d793-6234-4b23-a7ca-7df057bcb1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC062D2E40>]}
[0m16:08:46.623294 [info ] [MainThread]: 
[0m16:08:46.628799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:08:46.628799 [info ] [MainThread]: 
[0m16:08:46.628799 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:08:46.630807 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m16:08:46.731734 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m16:08:46.731734 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m16:08:46.731734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:48.673012 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.954 seconds
[0m16:08:48.694787 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m16:08:48.704889 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m16:08:48.704889 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m16:08:48.704889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:50.237434 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.543 seconds
[0m16:08:50.250289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m16:08:50.253466 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m16:08:50.253466 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m16:08:50.566002 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.311 seconds
[0m16:08:50.566002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m16:08:50.613236 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m16:08:50.613236 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m16:08:50.945333 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.330 seconds
[0m16:08:50.952811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8709d793-6234-4b23-a7ca-7df057bcb1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC062DFAA0>]}
[0m16:08:50.962304 [debug] [Thread-1 (]: Began running node model.dbt_first.highest_cross_sell
[0m16:08:50.963305 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.highest_cross_sell ........................... [RUN]
[0m16:08:50.965264 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.highest_cross_sell'
[0m16:08:50.966304 [debug] [Thread-1 (]: Began compiling node model.dbt_first.highest_cross_sell
[0m16:08:50.982028 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.highest_cross_sell"
[0m16:08:50.988222 [debug] [Thread-1 (]: Began executing node model.dbt_first.highest_cross_sell
[0m16:08:51.025538 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.highest_cross_sell"
[0m16:08:51.027539 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.highest_cross_sell"
[0m16:08:51.028539 [debug] [Thread-1 (]: On model.dbt_first.highest_cross_sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.highest_cross_sell"} */
create or replace transient table HEALTHCARE.mart.highest_cross_sell
         as
        (

WITH customer_product_count AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS product_count
    FROM 
        HEALTHCARE.stage.stg_transactions
    GROUP BY 
        CUSTOMER_ID
),
highest_cross_sell AS (
    SELECT 
        CUSTOMER_ID,
        product_count,
        DENSE_RANK() OVER(ORDER BY product_count DESC) AS cross_sell_rank
    FROM 
        customer_product_count
)
SELECT 
    hcs.CUSTOMER_ID,
    c.customer_name,
    hcs.product_count,
    hcs.cross_sell_rank
FROM 
    highest_cross_sell AS hcs
INNER JOIN 
      HEALTHCARE.stage.stg_customers AS c
ON 
    hcs.CUSTOMER_ID = c.CUSTOMER_ID
ORDER BY 
    hcs.cross_sell_rank
        );
[0m16:08:51.028539 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:08:53.501923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.473 seconds
[0m16:08:53.523727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8709d793-6234-4b23-a7ca-7df057bcb1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC03410AD0>]}
[0m16:08:53.523727 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.highest_cross_sell ...................... [[32mSUCCESS 1[0m in 2.56s]
[0m16:08:53.523727 [debug] [Thread-1 (]: Finished running node model.dbt_first.highest_cross_sell
[0m16:08:53.523727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:53.523727 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m16:08:53.523727 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m16:08:54.072726 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m16:08:54.073768 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m16:08:54.608264 [debug] [MainThread]: Connection 'model.dbt_first.highest_cross_sell' was left open.
[0m16:08:54.608264 [debug] [MainThread]: On model.dbt_first.highest_cross_sell: Close
[0m16:08:55.164942 [info ] [MainThread]: 
[0m16:08:55.164942 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.54 seconds (8.54s).
[0m16:08:55.180666 [debug] [MainThread]: Command end result
[0m16:08:55.203838 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:08:55.210484 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:08:55.214368 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m16:08:55.214368 [info ] [MainThread]: 
[0m16:08:55.214368 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:55.214368 [info ] [MainThread]: 
[0m16:08:55.214368 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:08:55.214368 [debug] [MainThread]: Command `dbt run` succeeded at 16:08:55.214368 after 10.22 seconds
[0m16:08:55.214368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC01BBDAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC0121DA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC03C127E0>]}
[0m16:08:55.214368 [debug] [MainThread]: Flushing usage events
[0m16:08:56.282898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:34.935350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9AB06CC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9AADE2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9AB06C350>]}


============================== 16:34:34.943359 | cee4fecf-9941-478a-b759-ede66957bc76 ==============================
[0m16:34:34.943359 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:34:34.945041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m16:34:35.767522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cee4fecf-9941-478a-b759-ede66957bc76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9ABE67C20>]}
[0m16:34:35.814878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cee4fecf-9941-478a-b759-ede66957bc76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9AA579D00>]}
[0m16:34:35.830884 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:34:36.331917 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:34:37.743121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:34:37.743121 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m16:34:37.996247 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m16:34:38.012115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cee4fecf-9941-478a-b759-ede66957bc76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9AD42A2A0>]}
[0m16:34:38.103444 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:34:38.115601 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:34:38.181617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cee4fecf-9941-478a-b759-ede66957bc76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9AD3C9D60>]}
[0m16:34:38.181617 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 477 macros
[0m16:34:38.181617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cee4fecf-9941-478a-b759-ede66957bc76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9AD13B950>]}
[0m16:34:38.181617 [info ] [MainThread]: 
[0m16:34:38.181617 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:38.181617 [info ] [MainThread]: 
[0m16:34:38.181617 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:34:38.181617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m16:34:40.985709 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m16:34:40.985709 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m16:34:40.985709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:43.160679 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.176 seconds
[0m16:34:43.163700 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m16:34:43.176389 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m16:34:43.176389 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m16:34:43.176389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:44.808301 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.630 seconds
[0m16:34:44.808301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m16:34:44.808301 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m16:34:44.808301 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m16:34:45.166414 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.358 seconds
[0m16:34:45.175441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m16:34:45.228066 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m16:34:45.228066 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m16:34:45.579689 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.365 seconds
[0m16:34:45.596379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cee4fecf-9941-478a-b759-ede66957bc76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9AAD42030>]}
[0m16:34:45.604657 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m16:34:45.605695 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m16:34:45.606702 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m16:34:45.606702 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m16:34:45.615703 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m16:34:45.618309 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m16:34:45.639431 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m16:34:45.655684 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m16:34:45.655684 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    GROUP BY customer_id
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
customer_status AS (
    SELECT
        flp.customer_id,
        flp.first_purchase_date,
        flp.last_purchase_date, 
        CASE
            WHEN flp.last_purchase_date < DATEADD(month, -1, mmo.max_date) THEN 1
            ELSE 0
        END AS churned_customer,
        CASE
            WHEN flp.first_purchase_date > DATEADD(month, -1, mmo.max_date) THEN 1
            ELSE 0
        END AS new_customer
    FROM first_last_purchase AS flp
    CROSS JOIN max_min_overall AS mmo
),
customer_status_over_time AS (
    SELECT
        DATE_TRUNC('month', flp.first_purchase_date) AS month,
        SUM(cs.churned_customer) AS churned_customers,
        SUM(cs.new_customer) AS new_customers
    FROM customer_status AS cs
    JOIN first_last_purchase AS flp ON cs.customer_id = flp.customer_id
    GROUP BY month
)
SELECT 
    month,
    churned_customers,
    new_customers
FROM 
    customer_status_over_time
ORDER BY 
    month



--     WITH first_payment AS (
--     SELECT
--         customer_id,
--         MIN(payment_date) AS first_payment_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
--     GROUP BY
--         customer_id
-- ),
 
-- new_customers_by_fy AS (
--     SELECT
--         customer_id,
--         EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
--     FROM
--         first_payment
-- ),
 
-- date_range AS (
--     SELECT
--         MIN(payment_date) AS start_date,
--         MAX(payment_date) AS end_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
-- ),
 
-- last_payment AS (
--     SELECT
--         customer_id,
--         MAX(payment_date) AS last_payment_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
--     GROUP BY
--         customer_id
-- ),
 
-- churned_customers AS (
--     SELECT
--         customer_id,
--         EXTRACT(YEAR FROM last_payment_date) AS fiscal_year
--     FROM
--         last_payment,
--         date_range
--     WHERE
--         last_payment_date < end_date
-- ),
 
-- fiscal_years AS (
--     SELECT DISTINCT
--         EXTRACT(YEAR FROM payment_date) AS fiscal_year
--     FROM
--         HEALTHCARE.stage.stg_transactions
-- )
 
-- SELECT
--     fy.fiscal_year,
--     COUNT(DISTINCT new_customers_by_fy.customer_id) AS new_customers_count,
--     COUNT(DISTINCT churned_customers.customer_id) AS churned_customers_count
-- FROM
--     fiscal_years fy
--     LEFT JOIN new_customers_by_fy ON fy.fiscal_year = new_customers_by_fy.fiscal_year
--     LEFT JOIN churned_customers ON fy.fiscal_year = churned_customers.fiscal_year
-- GROUP BY
--     fy.fiscal_year
-- ORDER BY
--     fy.fiscal_year
        );
[0m16:34:45.656691 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:34:48.693483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.036 seconds
[0m16:34:48.724526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cee4fecf-9941-478a-b759-ede66957bc76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9A8439CD0>]}
[0m16:34:48.725439 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 3.12s]
[0m16:34:48.725439 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m16:34:48.725439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:48.725439 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m16:34:48.725439 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m16:34:49.525388 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m16:34:49.525388 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m16:34:50.631436 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m16:34:50.636843 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m16:34:51.171772 [info ] [MainThread]: 
[0m16:34:51.172744 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.99 seconds (12.99s).
[0m16:34:51.174772 [debug] [MainThread]: Command end result
[0m16:34:51.200349 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:34:51.205495 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:34:51.212138 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m16:34:51.214146 [info ] [MainThread]: 
[0m16:34:51.215145 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:34:51.215145 [info ] [MainThread]: 
[0m16:34:51.216144 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:34:51.217144 [debug] [MainThread]: Command `dbt run` succeeded at 16:34:51.217144 after 17.19 seconds
[0m16:34:51.217144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9AD228B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9AB0B02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9AB0B26C0>]}
[0m16:34:51.218147 [debug] [MainThread]: Flushing usage events
[0m16:34:52.393777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:42.582118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5C84B4500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5C84B52E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5C84B5790>]}


============================== 16:35:42.583119 | 7f0433ac-075d-4215-b822-b72620753d8d ==============================
[0m16:35:42.583119 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:35:42.583119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:35:43.169612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f0433ac-075d-4215-b822-b72620753d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5C8FFC3E0>]}
[0m16:35:43.232137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f0433ac-075d-4215-b822-b72620753d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5C79F5DC0>]}
[0m16:35:43.232137 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:35:43.664120 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:35:43.871443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:35:43.873450 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m16:35:44.242805 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m16:35:44.257805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f0433ac-075d-4215-b822-b72620753d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5CA7B1FD0>]}
[0m16:35:44.352222 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:35:44.357030 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:35:44.392037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f0433ac-075d-4215-b822-b72620753d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5CA759A00>]}
[0m16:35:44.392037 [info ] [MainThread]: Found 10 models, 1 seed, 4 sources, 477 macros
[0m16:35:44.393036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f0433ac-075d-4215-b822-b72620753d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5CA649520>]}
[0m16:35:44.394036 [info ] [MainThread]: 
[0m16:35:44.395038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:35:44.395038 [info ] [MainThread]: 
[0m16:35:44.396035 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:35:44.397515 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m16:35:44.498091 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m16:35:44.498091 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m16:35:44.498091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:46.502364 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.996 seconds
[0m16:35:46.502364 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m16:35:46.522040 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m16:35:46.523183 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m16:35:46.523183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:48.039490 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.516 seconds
[0m16:35:48.041485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m16:35:48.044452 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m16:35:48.044452 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m16:35:48.382362 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.337 seconds
[0m16:35:48.386953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m16:35:48.450599 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m16:35:48.451592 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m16:35:48.802636 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.351 seconds
[0m16:35:48.806755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f0433ac-075d-4215-b822-b72620753d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5C58F3620>]}
[0m16:35:48.814010 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m16:35:48.815034 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m16:35:48.816009 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m16:35:48.817009 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m16:35:48.828423 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m16:35:48.829422 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m16:35:48.863291 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m16:35:48.865292 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m16:35:48.866297 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    GROUP BY customer_id
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
customer_status AS (
    SELECT
        flp.customer_id,
        flp.first_purchase_date,
        flp.last_purchase_date, 
        CASE
            WHEN flp.last_purchase_date < DATEADD(month, -3, mmo.max_date) THEN 1
            ELSE 0
        END AS churned_customer,
        CASE
            WHEN flp.first_purchase_date > DATEADD(month, -3, mmo.max_date) THEN 1
            ELSE 0
        END AS new_customer
    FROM first_last_purchase AS flp
    CROSS JOIN max_min_overall AS mmo
),
customer_status_over_time AS (
    SELECT
        DATE_TRUNC('month', flp.first_purchase_date) AS month,
        SUM(cs.churned_customer) AS churned_customers,
        SUM(cs.new_customer) AS new_customers
    FROM customer_status AS cs
    JOIN first_last_purchase AS flp ON cs.customer_id = flp.customer_id
    GROUP BY month
)
SELECT 
    month,
    churned_customers,
    new_customers
FROM 
    customer_status_over_time
ORDER BY 
    month



--     WITH first_payment AS (
--     SELECT
--         customer_id,
--         MIN(payment_date) AS first_payment_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
--     GROUP BY
--         customer_id
-- ),
 
-- new_customers_by_fy AS (
--     SELECT
--         customer_id,
--         EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
--     FROM
--         first_payment
-- ),
 
-- date_range AS (
--     SELECT
--         MIN(payment_date) AS start_date,
--         MAX(payment_date) AS end_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
-- ),
 
-- last_payment AS (
--     SELECT
--         customer_id,
--         MAX(payment_date) AS last_payment_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
--     GROUP BY
--         customer_id
-- ),
 
-- churned_customers AS (
--     SELECT
--         customer_id,
--         EXTRACT(YEAR FROM last_payment_date) AS fiscal_year
--     FROM
--         last_payment,
--         date_range
--     WHERE
--         last_payment_date < end_date
-- ),
 
-- fiscal_years AS (
--     SELECT DISTINCT
--         EXTRACT(YEAR FROM payment_date) AS fiscal_year
--     FROM
--         HEALTHCARE.stage.stg_transactions
-- )
 
-- SELECT
--     fy.fiscal_year,
--     COUNT(DISTINCT new_customers_by_fy.customer_id) AS new_customers_count,
--     COUNT(DISTINCT churned_customers.customer_id) AS churned_customers_count
-- FROM
--     fiscal_years fy
--     LEFT JOIN new_customers_by_fy ON fy.fiscal_year = new_customers_by_fy.fiscal_year
--     LEFT JOIN churned_customers ON fy.fiscal_year = churned_customers.fiscal_year
-- GROUP BY
--     fy.fiscal_year
-- ORDER BY
--     fy.fiscal_year
        );
[0m16:35:48.866297 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:35:51.421655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.570 seconds
[0m16:35:51.453235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f0433ac-075d-4215-b822-b72620753d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5CA61AFF0>]}
[0m16:35:51.453235 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 2.64s]
[0m16:35:51.453235 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m16:35:51.453235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:51.453235 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m16:35:51.453235 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m16:35:51.981877 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m16:35:51.981877 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m16:35:52.498080 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m16:35:52.500093 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m16:35:53.028237 [info ] [MainThread]: 
[0m16:35:53.028237 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.63 seconds (8.63s).
[0m16:35:53.028237 [debug] [MainThread]: Command end result
[0m16:35:53.064229 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:35:53.068246 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:35:53.074522 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m16:35:53.074522 [info ] [MainThread]: 
[0m16:35:53.078140 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:53.079339 [info ] [MainThread]: 
[0m16:35:53.081346 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:35:53.083948 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:53.083948 after 10.73 seconds
[0m16:35:53.083948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5C8467F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5C901B3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5CA4CBA40>]}
[0m16:35:53.083948 [debug] [MainThread]: Flushing usage events
[0m16:35:54.057738 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:32.864701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A265CAC5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A265CAD0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A265CAC680>]}


============================== 16:38:32.871220 | 0189cd5f-3969-43b1-a0d3-9aa91bfbdc93 ==============================
[0m16:38:32.871220 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:38:32.871220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'send_anonymous_usage_stats': 'True'}
[0m16:38:33.374075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0189cd5f-3969-43b1-a0d3-9aa91bfbdc93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A266A9EF60>]}
[0m16:38:33.449510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0189cd5f-3969-43b1-a0d3-9aa91bfbdc93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A265599370>]}
[0m16:38:33.449510 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:38:33.928188 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:38:35.354079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:38:35.356084 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Mart\revenue_contraction.sql
[0m16:38:35.548086 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_first.revenue_contraction' (models\Mart\revenue_contraction.sql) depends on a node named 'stg_transaction' which was not found
[0m16:38:35.548086 [debug] [MainThread]: Command `dbt run` failed at 16:38:35.548086 after 2.94 seconds
[0m16:38:35.550092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A265CAC590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A267CA9E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A267E67FB0>]}
[0m16:38:35.550092 [debug] [MainThread]: Flushing usage events
[0m16:38:36.614645 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:46.077898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA87A9C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA87A9C380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA87A9CB90>]}


============================== 16:38:46.093821 | 141f0b37-8c56-4deb-9a2d-68f5be96b0af ==============================
[0m16:38:46.093821 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:38:46.093821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:46.562875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '141f0b37-8c56-4deb-9a2d-68f5be96b0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA88865C70>]}
[0m16:38:46.625578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '141f0b37-8c56-4deb-9a2d-68f5be96b0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA887E7110>]}
[0m16:38:46.625578 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:38:46.987055 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:38:47.167787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:38:47.169794 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Mart\revenue_contraction.sql
[0m16:38:47.414121 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m16:38:47.424383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '141f0b37-8c56-4deb-9a2d-68f5be96b0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA89E324E0>]}
[0m16:38:47.510898 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:38:47.514403 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:38:47.552738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '141f0b37-8c56-4deb-9a2d-68f5be96b0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA89E00740>]}
[0m16:38:47.552738 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m16:38:47.552738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '141f0b37-8c56-4deb-9a2d-68f5be96b0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA86FB9940>]}
[0m16:38:47.561598 [info ] [MainThread]: 
[0m16:38:47.561598 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:47.561598 [info ] [MainThread]: 
[0m16:38:47.561598 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:38:47.561598 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m16:38:50.124429 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m16:38:50.124429 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m16:38:50.124429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:52.234801 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.105 seconds
[0m16:38:52.234801 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m16:38:52.243755 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m16:38:52.243755 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m16:38:52.243755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:53.714016 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.463 seconds
[0m16:38:53.717049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m16:38:53.719518 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m16:38:53.721024 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m16:38:54.121929 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.404 seconds
[0m16:38:54.126734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m16:38:54.169366 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m16:38:54.169366 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m16:38:54.522464 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.357 seconds
[0m16:38:54.522464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '141f0b37-8c56-4deb-9a2d-68f5be96b0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA89E15490>]}
[0m16:38:54.538133 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m16:38:54.538133 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m16:38:54.538133 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m16:38:54.538133 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m16:38:54.538133 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m16:38:54.538133 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m16:38:54.588017 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m16:38:54.590015 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m16:38:54.591013 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY PRODUCT_ID ORDER BY PAYMENT_MONTH) AS PREV_REVENUE
FROM HEALTHCARE.stage.stg_transactions
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    PAYMENT_MONTH,
    PREV_REVENUE,
    REVENUE,
     FROM revenue_drop
)
    SELECT
    PRODUCT_ID,
    PAYMENT_MONTH,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_MONTH  
ORDER BY Revenue_Loss DESC
        );
[0m16:38:54.591013 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:38:56.324408 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb003c-0004-bb9f-0005-a3d30003c54e
[0m16:38:56.326413 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 8 at position 4
invalid identifier 'PAYMENT_MONTH'
[0m16:38:56.341900 [debug] [Thread-1 (]: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m16:38:56.343884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '141f0b37-8c56-4deb-9a2d-68f5be96b0af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA8A3BED50>]}
[0m16:38:56.344884 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.revenue_contraction ................. [[31mERROR[0m in 1.80s]
[0m16:38:56.345851 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m16:38:56.345851 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.revenue_contraction' to be skipped because of status 'error'.  Reason: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql.
[0m16:38:56.347852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:56.348885 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m16:38:56.348885 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m16:38:56.889242 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m16:38:56.889242 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m16:38:57.422228 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m16:38:57.423653 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m16:38:57.972325 [info ] [MainThread]: 
[0m16:38:57.972325 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.41 seconds (10.41s).
[0m16:38:57.972325 [debug] [MainThread]: Command end result
[0m16:38:57.999758 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:38:58.002725 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:38:58.008987 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m16:38:58.008987 [info ] [MainThread]: 
[0m16:38:58.009990 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:38:58.010987 [info ] [MainThread]: 
[0m16:38:58.010987 [error] [MainThread]:   Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 8 at position 4
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m16:38:58.011988 [info ] [MainThread]: 
[0m16:38:58.012988 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:38:58.012988 [debug] [MainThread]: Command `dbt run` failed at 16:38:58.012988 after 12.09 seconds
[0m16:38:58.012988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA87CECBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA87AE2B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA87AE1BB0>]}
[0m16:38:58.012988 [debug] [MainThread]: Flushing usage events
[0m16:38:58.990335 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:09.220302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002793E614680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002793E4B77A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002793E614C80>]}


============================== 16:40:09.227322 | c437aec2-0dd3-4637-ae45-c36d2c6448a0 ==============================
[0m16:40:09.227322 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:40:09.227322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:40:09.701733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c437aec2-0dd3-4637-ae45-c36d2c6448a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002793F2F7950>]}
[0m16:40:09.763294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c437aec2-0dd3-4637-ae45-c36d2c6448a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002793F2167B0>]}
[0m16:40:09.773520 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:40:10.139729 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:40:10.330013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:40:10.330013 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m16:40:10.596396 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m16:40:10.613050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c437aec2-0dd3-4637-ae45-c36d2c6448a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027940922420>]}
[0m16:40:10.700072 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:40:10.700072 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:40:10.740270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c437aec2-0dd3-4637-ae45-c36d2c6448a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279408C5D00>]}
[0m16:40:10.741271 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m16:40:10.741271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c437aec2-0dd3-4637-ae45-c36d2c6448a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279407EBB90>]}
[0m16:40:10.743297 [info ] [MainThread]: 
[0m16:40:10.743297 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:40:10.744275 [info ] [MainThread]: 
[0m16:40:10.744275 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:40:10.746146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m16:40:10.844764 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m16:40:10.844764 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m16:40:10.845763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:12.792650 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.947 seconds
[0m16:40:12.796517 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m16:40:12.808348 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m16:40:12.808348 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m16:40:12.808348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:14.347661 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.545 seconds
[0m16:40:14.347661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m16:40:14.347661 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m16:40:14.347661 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m16:40:14.717219 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.365 seconds
[0m16:40:14.717219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m16:40:14.780622 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m16:40:14.780622 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m16:40:15.122586 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.341 seconds
[0m16:40:15.124589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c437aec2-0dd3-4637-ae45-c36d2c6448a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027940CA6480>]}
[0m16:40:15.130603 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m16:40:15.130603 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m16:40:15.130603 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m16:40:15.132349 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m16:40:15.134888 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m16:40:15.134888 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m16:40:15.172227 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m16:40:15.172227 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m16:40:15.172227 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    payment_date,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY PRODUCT_ID ORDER BY payment_date) AS PREV_REVENUE
FROM HEALTHCARE.stage.stg_transactions
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    payment_date,
    PREV_REVENUE,
    REVENUE,
     FROM revenue_drop
)
    SELECT
    PRODUCT_ID,
    payment_date,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,PAYMENT_MONTH  
ORDER BY Revenue_Loss DESC
        );
[0m16:40:15.172227 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:40:16.694413 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb003e-0004-bded-0005-a3d30003f43a
[0m16:40:16.694413 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 28 at position 20
invalid identifier 'PAYMENT_MONTH'
[0m16:40:16.710271 [debug] [Thread-1 (]: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 28 at position 20
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m16:40:16.710271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c437aec2-0dd3-4637-ae45-c36d2c6448a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002793DAC0710>]}
[0m16:40:16.710271 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.revenue_contraction ................. [[31mERROR[0m in 1.58s]
[0m16:40:16.710271 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m16:40:16.710271 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.revenue_contraction' to be skipped because of status 'error'.  Reason: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 28 at position 20
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql.
[0m16:40:16.726172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:16.726172 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m16:40:16.726172 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m16:40:17.238385 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m16:40:17.238385 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m16:40:17.770985 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m16:40:17.770985 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m16:40:18.297600 [info ] [MainThread]: 
[0m16:40:18.297600 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.55 seconds (7.55s).
[0m16:40:18.297600 [debug] [MainThread]: Command end result
[0m16:40:18.331737 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:40:18.339569 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:40:18.343619 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m16:40:18.343619 [info ] [MainThread]: 
[0m16:40:18.343619 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:40:18.343619 [info ] [MainThread]: 
[0m16:40:18.351194 [error] [MainThread]:   Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 28 at position 20
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m16:40:18.351194 [info ] [MainThread]: 
[0m16:40:18.351194 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:40:18.354106 [debug] [MainThread]: Command `dbt run` failed at 16:40:18.353634 after 9.32 seconds
[0m16:40:18.354106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002793DBC4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002793C3BE5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002793C3BE360>]}
[0m16:40:18.354106 [debug] [MainThread]: Flushing usage events
[0m16:40:19.390332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:46.000322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBA73D880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBDB777A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBDCAD070>]}


============================== 16:40:46.000322 | 95398d0e-3f39-4531-87c4-064f7440c3ae ==============================
[0m16:40:46.000322 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:40:46.000322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:40:46.485354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95398d0e-3f39-4531-87c4-064f7440c3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBDCEA030>]}
[0m16:40:46.550414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95398d0e-3f39-4531-87c4-064f7440c3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBDCD5820>]}
[0m16:40:46.551082 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:40:46.920309 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:40:47.101342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:40:47.101342 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m16:40:47.346673 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m16:40:47.362771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95398d0e-3f39-4531-87c4-064f7440c3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBFF2B320>]}
[0m16:40:47.447012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:40:47.450012 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:40:47.481537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95398d0e-3f39-4531-87c4-064f7440c3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBFFFA1E0>]}
[0m16:40:47.481537 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m16:40:47.481537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95398d0e-3f39-4531-87c4-064f7440c3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBFF04AA0>]}
[0m16:40:47.481537 [info ] [MainThread]: 
[0m16:40:47.481537 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:40:47.481537 [info ] [MainThread]: 
[0m16:40:47.481537 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:40:47.481537 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m16:40:47.583451 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m16:40:47.583451 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m16:40:47.583451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:49.738626 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.157 seconds
[0m16:40:49.738626 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m16:40:49.754651 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m16:40:49.754651 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m16:40:49.754651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:51.291860 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.536 seconds
[0m16:40:51.291860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m16:40:51.291860 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m16:40:51.291860 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m16:40:51.660528 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.360 seconds
[0m16:40:51.660528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m16:40:51.723384 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m16:40:51.723384 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m16:40:52.310288 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.577 seconds
[0m16:40:52.317618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95398d0e-3f39-4531-87c4-064f7440c3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DC03D7FE0>]}
[0m16:40:52.320755 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m16:40:52.320755 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m16:40:52.320755 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m16:40:52.320755 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m16:40:52.341575 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m16:40:52.343538 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m16:40:52.392014 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m16:40:52.394021 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m16:40:52.394021 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH revenue_drop as(
    SELECT
    PRODUCT_ID,
    payment_date,
    REVENUE,
    LAG(REVENUE) OVER (PARTITION BY PRODUCT_ID ORDER BY payment_date) AS PREV_REVENUE
FROM HEALTHCARE.stage.stg_transactions
),
replace_null as(
    SELECT COALESCE(PREV_REVENUE,0) as Previous_Revenue,
    PRODUCT_ID,
    payment_date,
    PREV_REVENUE,
    REVENUE,
     FROM revenue_drop
)
    SELECT
    PRODUCT_ID,
    payment_date,
    SUM(Previous_Revenue) as Previous_Revenue,
    SUM(REVENUE) as Current_Revenue,
    SUM(Previous_Revenue) - SUM(REVENUE) as Revenue_Loss,
FROM replace_null
GROUP BY PRODUCT_ID,payment_date  
ORDER BY Revenue_Loss DESC
        );
[0m16:40:52.394021 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:40:54.634469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.239 seconds
[0m16:40:54.654511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95398d0e-3f39-4531-87c4-064f7440c3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBD190740>]}
[0m16:40:54.656516 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.33s]
[0m16:40:54.656516 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m16:40:54.658261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:54.658261 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m16:40:54.658261 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m16:40:55.167015 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m16:40:55.182082 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m16:40:55.677626 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m16:40:55.693482 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m16:40:56.225998 [info ] [MainThread]: 
[0m16:40:56.225998 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.74 seconds (8.74s).
[0m16:40:56.225998 [debug] [MainThread]: Command end result
[0m16:40:56.258618 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:40:56.266448 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:40:56.268413 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m16:40:56.268413 [info ] [MainThread]: 
[0m16:40:56.268413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:56.268413 [info ] [MainThread]: 
[0m16:40:56.268413 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:40:56.268413 [debug] [MainThread]: Command `dbt run` succeeded at 16:40:56.268413 after 10.43 seconds
[0m16:40:56.277650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBD274CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBD8147D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DBDC877A0>]}
[0m16:40:56.277650 [debug] [MainThread]: Flushing usage events
[0m16:40:57.589735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:22.651237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026575944770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026575944F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265759440B0>]}


============================== 16:58:22.651237 | 57e57c8e-fa91-4aa9-8bfe-b0b374edddb8 ==============================
[0m16:58:22.651237 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:58:22.651237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:58:23.216147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57e57c8e-fa91-4aa9-8bfe-b0b374edddb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265765E2F90>]}
[0m16:58:23.277357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57e57c8e-fa91-4aa9-8bfe-b0b374edddb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026576695250>]}
[0m16:58:23.279105 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:58:23.741895 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:58:25.078749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:58:25.080755 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\new_logo_each_fiscal.sql
[0m16:58:25.080755 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m16:58:25.319431 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m16:58:25.338246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57e57c8e-fa91-4aa9-8bfe-b0b374edddb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026577B4DDF0>]}
[0m16:58:25.415290 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:58:25.419676 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:58:25.451597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57e57c8e-fa91-4aa9-8bfe-b0b374edddb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026577C5A120>]}
[0m16:58:25.451597 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m16:58:25.451597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57e57c8e-fa91-4aa9-8bfe-b0b374edddb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026577B6BAD0>]}
[0m16:58:25.451597 [info ] [MainThread]: 
[0m16:58:25.451597 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:58:25.451597 [info ] [MainThread]: 
[0m16:58:25.451597 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:58:25.451597 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m16:58:28.110263 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m16:58:28.110263 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m16:58:28.110263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:30.148303 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.037 seconds
[0m16:58:30.155837 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m16:58:30.161436 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m16:58:30.161436 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m16:58:30.161436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:31.716522 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.550 seconds
[0m16:58:31.716522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m16:58:31.764438 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m16:58:31.764438 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m16:58:32.103823 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.336 seconds
[0m16:58:32.103823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m16:58:32.103823 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m16:58:32.103823 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m16:58:32.443893 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.340 seconds
[0m16:58:32.443893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57e57c8e-fa91-4aa9-8bfe-b0b374edddb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265780412B0>]}
[0m16:58:32.458898 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m16:58:32.458898 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m16:58:32.458898 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m16:58:32.458898 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m16:58:32.458898 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m16:58:32.458898 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m16:58:32.495580 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m16:58:32.495580 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m16:58:32.495580 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH revenue_drop as(
    SELECT
        product_id,
        customer_id,
        payment_date,
        revenue,
        LAG(revenue) OVER (PARTITION BY  product_id ORDER BY payment_date) AS prev_revenue
    FROM
        HEALTHCARE.stage.stg_transactions
    WHERE 
        revenue_type = 1
),
replace_null as(
    SELECT COALESCE(prev_revenue,0) as previous_revenue,
        product_id,
        customer_id,
        payment_date,
        prev_revenue,
        revenue
    FROM 
        revenue_drop
)
SELECT
    product_id,
    customer_id,
    payment_date,
    SUM(previous_revenue) as previous_revenue,
    SUM(revenue) as current_revenue,
    SUM(previous_revenue) - SUM(revenue) as revenue_loss,
FROM 
    replace_null
GROUP BY 
    product_id, 
    payment_date  
ORDER BY 
    revenue_loss DESC
        );
[0m16:58:32.495580 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:58:34.147483 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0050-0004-bb9d-0005-a3d30003d466
[0m16:58:34.147483 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 29 at position 4
'REPLACE_NULL.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
[0m16:58:34.162351 [debug] [Thread-1 (]: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  001104 (42601): SQL compilation error: error line 29 at position 4
  'REPLACE_NULL.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m16:58:34.162351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57e57c8e-fa91-4aa9-8bfe-b0b374edddb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265777D5940>]}
[0m16:58:34.162351 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.revenue_contraction ................. [[31mERROR[0m in 1.70s]
[0m16:58:34.162351 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m16:58:34.162351 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.revenue_contraction' to be skipped because of status 'error'.  Reason: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  001104 (42601): SQL compilation error: error line 29 at position 4
  'REPLACE_NULL.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql.
[0m16:58:34.162351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:34.162351 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m16:58:34.162351 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m16:58:34.695670 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m16:58:34.697678 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m16:58:35.208908 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m16:58:35.208908 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m16:58:35.743704 [info ] [MainThread]: 
[0m16:58:35.743704 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m16:58:35.751770 [debug] [MainThread]: Command end result
[0m16:58:35.774986 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m16:58:35.778029 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m16:58:35.783384 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m16:58:35.783384 [info ] [MainThread]: 
[0m16:58:35.785395 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:58:35.785395 [info ] [MainThread]: 
[0m16:58:35.785395 [error] [MainThread]:   Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  001104 (42601): SQL compilation error: error line 29 at position 4
  'REPLACE_NULL.CUSTOMER_ID' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m16:58:35.785395 [info ] [MainThread]: 
[0m16:58:35.785395 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:58:35.785395 [debug] [MainThread]: Command `dbt run` failed at 16:58:35.785395 after 13.39 seconds
[0m16:58:35.785395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265736F5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265736F6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265736F6600>]}
[0m16:58:35.785395 [debug] [MainThread]: Flushing usage events
[0m16:58:36.826742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:35.832100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028091A547A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002809171EED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002808F546ED0>]}


============================== 17:13:35.838997 | f726ce7c-82d4-416b-8ca7-caa4e6c73204 ==============================
[0m17:13:35.838997 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:13:35.838997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'send_anonymous_usage_stats': 'True'}
[0m17:13:36.587247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f726ce7c-82d4-416b-8ca7-caa4e6c73204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028090EF31D0>]}
[0m17:13:36.647126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f726ce7c-82d4-416b-8ca7-caa4e6c73204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280923F02C0>]}
[0m17:13:36.647126 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:13:37.136398 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:13:38.532304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:13:38.532304 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\new_logo_each_fiscal.sql
[0m17:13:38.533301 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m17:13:38.781835 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:13:38.797905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f726ce7c-82d4-416b-8ca7-caa4e6c73204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028093BC2600>]}
[0m17:13:38.863501 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:13:38.879227 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:13:38.927038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f726ce7c-82d4-416b-8ca7-caa4e6c73204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028093A71C40>]}
[0m17:13:38.927038 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:13:38.927038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f726ce7c-82d4-416b-8ca7-caa4e6c73204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028093D46030>]}
[0m17:13:38.942819 [info ] [MainThread]: 
[0m17:13:38.942819 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:13:38.942819 [info ] [MainThread]: 
[0m17:13:38.942819 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:13:38.942819 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:13:41.584352 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:13:41.594013 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:13:41.594013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:43.704659 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.117 seconds
[0m17:13:43.704659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m17:13:43.720606 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:13:43.720606 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:13:43.720606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:45.283423 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.559 seconds
[0m17:13:45.283423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m17:13:45.331787 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:13:45.337156 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:13:45.753083 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.419 seconds
[0m17:13:45.753083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m17:13:45.753083 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:13:45.753083 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:13:46.080259 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.330 seconds
[0m17:13:46.080259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f726ce7c-82d4-416b-8ca7-caa4e6c73204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028093D310D0>]}
[0m17:13:46.095948 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:13:46.095948 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m17:13:46.095948 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m17:13:46.095948 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:13:46.095948 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:13:46.095948 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:13:46.143045 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:13:46.145012 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:13:46.145012 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH previous_month as(
    SELECT 
        *,
        EXTRACT(MONTH FROM payment_date) as month,
    FROM HEALTHCARE.stage.stg_transactions
)
SELECT 
    * 
FROM previous_month
        );
[0m17:13:46.145012 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:13:48.983448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.845 seconds
[0m17:13:48.999143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f726ce7c-82d4-416b-8ca7-caa4e6c73204', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002808EDFD9A0>]}
[0m17:13:49.014818 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.90s]
[0m17:13:49.014818 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:13:49.014818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:49.014818 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:13:49.014818 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:13:49.548883 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m17:13:49.548883 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m17:13:50.064722 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:13:50.064722 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:13:50.618270 [info ] [MainThread]: 
[0m17:13:50.619712 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.68 seconds (11.68s).
[0m17:13:50.621722 [debug] [MainThread]: Command end result
[0m17:13:50.672244 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:13:50.675245 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:13:50.684365 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:13:50.684365 [info ] [MainThread]: 
[0m17:13:50.684365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:13:50.684365 [info ] [MainThread]: 
[0m17:13:50.684365 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:13:50.684365 [debug] [MainThread]: Command `dbt run` succeeded at 17:13:50.684365 after 15.11 seconds
[0m17:13:50.684365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028093D61460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002808F7F64E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280924A06B0>]}
[0m17:13:50.684365 [debug] [MainThread]: Flushing usage events
[0m17:13:51.744710 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:44.261428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014515E3B6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014516A34950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014516A37B90>]}


============================== 17:18:44.268417 | b765798d-4e35-4a42-a8aa-258dea842b57 ==============================
[0m17:18:44.268417 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:18:44.268417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:18:44.732307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b765798d-4e35-4a42-a8aa-258dea842b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145187C5430>]}
[0m17:18:44.795569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b765798d-4e35-4a42-a8aa-258dea842b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014516D2FF50>]}
[0m17:18:44.795569 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:18:45.153042 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:18:45.342816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:45.342816 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m17:18:45.579743 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:18:45.594175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b765798d-4e35-4a42-a8aa-258dea842b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014518D62420>]}
[0m17:18:45.671880 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:18:45.675851 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:18:45.704478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b765798d-4e35-4a42-a8aa-258dea842b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014518CF9D30>]}
[0m17:18:45.704478 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:18:45.704478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b765798d-4e35-4a42-a8aa-258dea842b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014518D61CA0>]}
[0m17:18:45.704478 [info ] [MainThread]: 
[0m17:18:45.704478 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:18:45.704478 [info ] [MainThread]: 
[0m17:18:45.704478 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:18:45.704478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:18:45.817178 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:18:45.817178 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:18:45.818173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:47.744969 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.928 seconds
[0m17:18:47.746979 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m17:18:47.760646 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:18:47.760646 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:18:47.760646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:49.278897 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.525 seconds
[0m17:18:49.278897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m17:18:49.291475 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:18:49.291475 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:18:49.669764 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.387 seconds
[0m17:18:49.669764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m17:18:49.717295 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:18:49.717295 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:18:50.056254 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.325 seconds
[0m17:18:50.056254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b765798d-4e35-4a42-a8aa-258dea842b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145191C4950>]}
[0m17:18:50.056254 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:18:50.056254 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m17:18:50.056254 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m17:18:50.056254 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:18:50.069694 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:18:50.069694 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:18:50.104047 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:18:50.106028 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:18:50.107046 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH monthly_revenue AS (
    SELECT 
        DATE_TRUNC('month', payment_date) AS month,
        SUM(CAST(revenue AS DECIMAL)) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE 
        revenue_type = 1 
    GROUP BY 
        DATE_TRUNC('month', payment_date)
),
revenue_difference AS (
    SELECT 
        month,
        total_revenue,
        LAG(total_revenue, 1) OVER (ORDER BY month) AS previous_month_revenue,
        total_revenue - LAG(total_revenue, 1) OVER (ORDER BY month) AS revenue_difference,
        CASE
            WHEN total_revenue - LAG(total_revenue, 1) OVER (ORDER BY month) < 0 THEN 'Loss'
            ELSE 'No Loss'
        END AS loss_indicator
    FROM 
        monthly_revenue
)
SELECT 
    month,
    total_revenue,
    previous_month_revenue,
    revenue_difference,
    loss_indicator
FROM 
    revenue_difference
ORDER BY 
    month
        );
[0m17:18:50.107046 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:18:52.335040 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.234 seconds
[0m17:18:52.351101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b765798d-4e35-4a42-a8aa-258dea842b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014515EE0740>]}
[0m17:18:52.366781 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.29s]
[0m17:18:52.366781 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:18:52.366781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:52.366781 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:18:52.366781 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:18:52.884838 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m17:18:52.884838 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m17:18:53.419675 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:18:53.419675 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:18:53.961084 [info ] [MainThread]: 
[0m17:18:53.976499 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.26 seconds (8.26s).
[0m17:18:53.977223 [debug] [MainThread]: Command end result
[0m17:18:54.001137 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:18:54.001137 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:18:54.011594 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:18:54.012604 [info ] [MainThread]: 
[0m17:18:54.012604 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:18:54.014110 [info ] [MainThread]: 
[0m17:18:54.014110 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:18:54.015680 [debug] [MainThread]: Command `dbt run` succeeded at 17:18:54.015680 after 9.92 seconds
[0m17:18:54.015680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014515FE6C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014514525AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001451617A0F0>]}
[0m17:18:54.015680 [debug] [MainThread]: Flushing usage events
[0m17:18:54.996148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:21:55.369835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220675EA000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022064C814F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220675E9430>]}


============================== 17:21:55.369835 | a623bd3b-975c-4801-b853-14d0891fdeec ==============================
[0m17:21:55.369835 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:21:55.369835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'send_anonymous_usage_stats': 'True'}
[0m17:21:55.824018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a623bd3b-975c-4801-b853-14d0891fdeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002206499EED0>]}
[0m17:21:55.887381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a623bd3b-975c-4801-b853-14d0891fdeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220682C1820>]}
[0m17:21:55.887381 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:21:56.251802 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:21:56.422589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:21:56.422589 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m17:21:56.677147 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:21:56.691459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a623bd3b-975c-4801-b853-14d0891fdeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022069942210>]}
[0m17:21:56.758804 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:21:56.758804 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:21:56.790646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a623bd3b-975c-4801-b853-14d0891fdeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022069918740>]}
[0m17:21:56.801716 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:21:56.801716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a623bd3b-975c-4801-b853-14d0891fdeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002206978CC80>]}
[0m17:21:56.801716 [info ] [MainThread]: 
[0m17:21:56.801716 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:21:56.801716 [info ] [MainThread]: 
[0m17:21:56.806374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:21:56.806374 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:21:56.902715 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:21:56.902715 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:21:56.903712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:59.086235 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.182 seconds
[0m17:21:59.092779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m17:21:59.103196 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:21:59.103196 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:21:59.104199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:00.634436 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.535 seconds
[0m17:22:00.634436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m17:22:00.634436 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:22:00.634436 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:22:00.991523 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.349 seconds
[0m17:22:00.991523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m17:22:01.039004 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:22:01.039004 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:22:01.399311 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.352 seconds
[0m17:22:01.401323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a623bd3b-975c-4801-b853-14d0891fdeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022064A2FC50>]}
[0m17:22:01.401323 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:22:01.401323 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m17:22:01.401323 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m17:22:01.401323 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:22:01.413890 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:22:01.413890 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:22:01.446480 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:22:01.447486 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:22:01.449598 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH monthly_revenue AS (
    SELECT 
        DATE_TRUNC('month', payment_date) AS month,
        SUM(CAST(revenue AS DECIMAL)) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE 
        revenue_type = 1 
    GROUP BY 
        DATE_TRUNC('month', payment_date)
),
revenue_difference AS (
    SELECT 
        month,
        total_revenue,
        CASE
            WHEN LAG(total_revenue, 1) OVER (ORDER BY month) IS NULL THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY month)
        END AS previous_month_revenue,
        total_revenue - LAG(total_revenue, 1) OVER (ORDER BY month) AS revenue_difference,
        CASE
            WHEN total_revenue - LAG(total_revenue, 1) OVER (ORDER BY month) < 0 THEN 'Loss'
            ELSE 'No Loss'
        END AS loss_indicator
    FROM 
        monthly_revenue
)
SELECT 
    month,
    total_revenue,
    previous_month_revenue,
    revenue_difference,
    loss_indicator
FROM 
    revenue_difference
ORDER BY 
    month
        );
[0m17:22:01.449598 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:22:03.705558 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.263 seconds
[0m17:22:03.752484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a623bd3b-975c-4801-b853-14d0891fdeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220697CA5A0>]}
[0m17:22:03.752484 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.35s]
[0m17:22:03.752484 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:22:03.752484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:03.752484 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:22:03.752484 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:22:04.371920 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m17:22:04.371920 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m17:22:04.905359 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:22:04.905359 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:22:05.427376 [info ] [MainThread]: 
[0m17:22:05.427376 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.63 seconds (8.63s).
[0m17:22:05.427376 [debug] [MainThread]: Command end result
[0m17:22:05.458152 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:22:05.461153 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:22:05.474523 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:22:05.475520 [info ] [MainThread]: 
[0m17:22:05.478523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:22:05.481443 [info ] [MainThread]: 
[0m17:22:05.482444 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:22:05.483443 [debug] [MainThread]: Command `dbt run` succeeded at 17:22:05.483443 after 10.27 seconds
[0m17:22:05.484448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022066646720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220696CB290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220670BA7E0>]}
[0m17:22:05.484448 [debug] [MainThread]: Flushing usage events
[0m17:22:06.800487 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:28.494300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94CCF8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94CCFA930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94CCF8FE0>]}


============================== 17:24:28.494300 | f003d529-b4e2-4386-a78a-15048ebd3c2c ==============================
[0m17:24:28.494300 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:24:28.494300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:24:28.995935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f003d529-b4e2-4386-a78a-15048ebd3c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94DA46690>]}
[0m17:24:29.059869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f003d529-b4e2-4386-a78a-15048ebd3c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94C155130>]}
[0m17:24:29.059869 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:24:29.532660 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:24:30.860894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:24:30.860894 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m17:24:31.098210 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:24:31.117689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f003d529-b4e2-4386-a78a-15048ebd3c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94F0125A0>]}
[0m17:24:31.180040 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:24:31.196070 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:24:31.228201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f003d529-b4e2-4386-a78a-15048ebd3c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94EFA9EE0>]}
[0m17:24:31.228201 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:24:31.228201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f003d529-b4e2-4386-a78a-15048ebd3c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94EFF5970>]}
[0m17:24:31.228201 [info ] [MainThread]: 
[0m17:24:31.244219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:31.244219 [info ] [MainThread]: 
[0m17:24:31.244219 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:24:31.244219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:24:33.704386 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:24:33.706655 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:24:33.706655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:35.718416 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.012 seconds
[0m17:24:35.721440 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m17:24:35.730861 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:24:35.730861 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:24:35.730861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:37.217589 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.489 seconds
[0m17:24:37.217589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m17:24:37.236716 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:24:37.236716 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:24:37.552363 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.324 seconds
[0m17:24:37.552363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m17:24:37.599899 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:24:37.599899 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:24:37.946150 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.339 seconds
[0m17:24:37.946150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f003d529-b4e2-4386-a78a-15048ebd3c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94C1804A0>]}
[0m17:24:37.961956 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:24:37.961956 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m17:24:37.961956 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m17:24:37.961956 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:24:37.986514 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:24:37.987617 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:24:38.018784 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:24:38.021526 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:24:38.021526 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH monthly_revenue AS (
    SELECT 
        DATE_TRUNC('month', payment_date) AS month,
        SUM(CAST(revenue AS DECIMAL)) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE 
        revenue_type = 1 
    GROUP BY 
        DATE_TRUNC('month', payment_date)
),
revenue_difference AS (
    SELECT 
        month,
        total_revenue,
        CASE
            WHEN LAG(total_revenue, 1) OVER (ORDER BY month) IS NULL THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY month)
        END AS previous_month_revenue,
        total_revenue - LAG(total_revenue, 1) OVER (ORDER BY month) AS revenue_difference,
        CASE
            WHEN total_revenue - LAG(total_revenue, 1) OVER (ORDER BY month) < 0 THEN 1
            ELSE 0
        END AS loss_indicator
    FROM 
        monthly_revenue
)
SELECT 
    month,
    total_revenue,
    previous_month_revenue,
    revenue_difference,
    loss_indicator
FROM 
    revenue_difference
ORDER BY 
    month
        );
[0m17:24:38.022521 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:24:40.177257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.158 seconds
[0m17:24:40.193134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f003d529-b4e2-4386-a78a-15048ebd3c2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94A09D970>]}
[0m17:24:40.193134 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.23s]
[0m17:24:40.193134 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:24:40.193134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:40.193134 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:24:40.193134 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:24:40.745857 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m17:24:40.752738 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m17:24:41.273745 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:24:41.273745 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:24:41.825358 [info ] [MainThread]: 
[0m17:24:41.840507 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.58 seconds (10.58s).
[0m17:24:41.840507 [debug] [MainThread]: Command end result
[0m17:24:41.864505 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:24:41.864505 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:24:41.864505 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:24:41.873279 [info ] [MainThread]: 
[0m17:24:41.875304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:24:41.875304 [info ] [MainThread]: 
[0m17:24:41.876287 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:24:41.877299 [debug] [MainThread]: Command `dbt run` succeeded at 17:24:41.877299 after 13.58 seconds
[0m17:24:41.878288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94F252240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94C8356D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E94C8379E0>]}
[0m17:24:41.878288 [debug] [MainThread]: Flushing usage events
[0m17:24:42.840410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:26:48.195201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014265CF6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014265CF6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014265CF67E0>]}


============================== 17:26:48.196210 | a0e907c7-6bf7-4260-a869-a8ac2fa71092 ==============================
[0m17:26:48.196210 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:26:48.196210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:26:48.655655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0e907c7-6bf7-4260-a869-a8ac2fa71092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001426898F050>]}
[0m17:26:48.713270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0e907c7-6bf7-4260-a869-a8ac2fa71092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014268C867E0>]}
[0m17:26:48.715276 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:26:49.052481 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:26:49.249406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:26:49.249406 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m17:26:49.499959 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:26:49.499959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0e907c7-6bf7-4260-a869-a8ac2fa71092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001426A11B410>]}
[0m17:26:49.584535 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:26:49.584535 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:26:49.623152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0e907c7-6bf7-4260-a869-a8ac2fa71092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001426A1E9EB0>]}
[0m17:26:49.625158 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:26:49.625158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0e907c7-6bf7-4260-a869-a8ac2fa71092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014269F6A7E0>]}
[0m17:26:49.625158 [info ] [MainThread]: 
[0m17:26:49.625158 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:49.625158 [info ] [MainThread]: 
[0m17:26:49.625158 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:26:49.625158 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:26:49.729247 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:26:49.729247 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:26:49.730247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:51.637989 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.909 seconds
[0m17:26:51.644666 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m17:26:51.644666 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:26:51.644666 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:26:51.644666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:53.147144 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.505 seconds
[0m17:26:53.163071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m17:26:53.179038 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:26:53.179038 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:26:53.531038 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.348 seconds
[0m17:26:53.531038 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m17:26:53.566933 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:26:53.582772 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:26:53.907114 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.336 seconds
[0m17:26:53.928942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0e907c7-6bf7-4260-a869-a8ac2fa71092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001426A810E00>]}
[0m17:26:53.932466 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:26:53.932466 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m17:26:53.932466 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m17:26:53.932466 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:26:53.939853 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:26:53.939853 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:26:53.973529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:26:53.973529 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:26:53.973529 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH monthly_revenue AS (
    SELECT 
        DATE_TRUNC('month', payment_date) AS month,
        SUM(CAST(revenue AS DECIMAL)) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE 
        revenue_type = 1 
    GROUP BY 
        DATE_TRUNC('month', payment_date)
),
revenue_difference AS (
    SELECT 
        month,
        total_revenue,
        CASE
            WHEN LAG(total_revenue, 1) OVER (ORDER BY month) IS NULL THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY month)
        END AS previous_month_revenue,
        total_revenue - 
        CASE 
            LAG(total_revenue, 1) OVER (ORDER BY month) IS NULL
            WHEN TRUE THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY month)
        END
            AS revenue_difference,
        CASE
            WHEN total_revenue - LAG(total_revenue, 1) OVER (ORDER BY month) < 0 THEN 1
            ELSE 0
        END AS loss_indicator
    FROM 
        monthly_revenue
)
SELECT 
    month,
    total_revenue,
    previous_month_revenue,
    revenue_difference,
    loss_indicator
FROM 
    revenue_difference
ORDER BY 
    month
        );
[0m17:26:53.973529 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:26:56.203425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.234 seconds
[0m17:26:56.240676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0e907c7-6bf7-4260-a869-a8ac2fa71092', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142674006E0>]}
[0m17:26:56.240676 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.30s]
[0m17:26:56.240676 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:26:56.240676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:56.240676 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:26:56.240676 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:26:56.753651 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m17:26:56.753651 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m17:26:57.270811 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:26:57.272822 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:26:57.797445 [info ] [MainThread]: 
[0m17:26:57.799463 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.17 seconds (8.17s).
[0m17:26:57.799463 [debug] [MainThread]: Command end result
[0m17:26:57.812155 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:26:57.826176 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:26:57.833540 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:26:57.833540 [info ] [MainThread]: 
[0m17:26:57.834544 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:26:57.834544 [info ] [MainThread]: 
[0m17:26:57.834544 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:26:57.834544 [debug] [MainThread]: Command `dbt run` succeeded at 17:26:57.834544 after 9.95 seconds
[0m17:26:57.834544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014267CA3AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014265CF67E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014265CF6720>]}
[0m17:26:57.834544 [debug] [MainThread]: Flushing usage events
[0m17:26:59.144361 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:32.078733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2542DA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE24A39130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE257D57C0>]}


============================== 17:28:32.089226 | d2352a70-5877-4398-a8c3-48969e6b653c ==============================
[0m17:28:32.089226 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:28:32.094638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:28:32.550526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2352a70-5877-4398-a8c3-48969e6b653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE28DC56A0>]}
[0m17:28:32.613851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2352a70-5877-4398-a8c3-48969e6b653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE28DC6CF0>]}
[0m17:28:32.615858 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:28:32.958268 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:28:33.133008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:28:33.133008 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m17:28:33.390323 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:28:33.392519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2352a70-5877-4398-a8c3-48969e6b653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2A482330>]}
[0m17:28:33.471396 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:28:33.471396 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:28:33.503127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2352a70-5877-4398-a8c3-48969e6b653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2A419C70>]}
[0m17:28:33.503127 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:28:33.503127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2352a70-5877-4398-a8c3-48969e6b653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE29F985C0>]}
[0m17:28:33.503127 [info ] [MainThread]: 
[0m17:28:33.518813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:28:33.518813 [info ] [MainThread]: 
[0m17:28:33.518813 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:28:33.518813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:28:33.615056 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:28:33.616052 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:28:33.616052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:35.598109 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.984 seconds
[0m17:28:35.598109 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m17:28:35.614092 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:28:35.614092 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:28:35.614092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:37.133416 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.527 seconds
[0m17:28:37.133416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m17:28:37.133416 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:28:37.149562 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:28:37.508328 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.371 seconds
[0m17:28:37.521087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m17:28:37.568919 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:28:37.568919 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:28:37.909468 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.342 seconds
[0m17:28:37.909468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2352a70-5877-4398-a8c3-48969e6b653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE255DF5F0>]}
[0m17:28:37.923393 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:28:37.923393 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m17:28:37.923393 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m17:28:37.923393 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:28:37.923393 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:28:37.939837 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:28:37.960450 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:28:37.960450 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:28:37.975104 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH monthly_revenue AS (
    SELECT 
        DATE_TRUNC('month', payment_date) AS month,
        SUM(CAST(revenue AS DECIMAL)) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE 
        revenue_type = 1 
    GROUP BY 
        DATE_TRUNC('month', payment_date)
),
revenue_difference AS (
    SELECT 
        month,
        total_revenue,
        CASE
            WHEN LAG(total_revenue, 1) OVER (ORDER BY month) IS NULL THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY month)
        END AS previous_month_revenue,
        total_revenue - 
        CASE 
            LAG(total_revenue, 1) OVER (ORDER BY month) IS NULL
            WHEN TRUE THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY month)
        END
            AS revenue_difference,
        CASE
            WHEN total_revenue - LAG(total_revenue, 1) OVER (ORDER BY month) < 0 THEN 1
            ELSE 0
        END AS revenue_loss
    FROM 
        monthly_revenue
)
SELECT 
    month,
    total_revenue,
    previous_month_revenue,
    revenue_difference,
    revenue_loss
FROM 
    revenue_difference
ORDER BY 
    month
        );
[0m17:28:37.975104 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:28:40.228605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.252 seconds
[0m17:28:40.251673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2352a70-5877-4398-a8c3-48969e6b653c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2554D970>]}
[0m17:28:40.251673 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.33s]
[0m17:28:40.251673 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:28:40.255278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:40.255278 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:28:40.255278 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:28:40.806623 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m17:28:40.806623 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m17:28:41.352590 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:28:41.354603 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:28:41.891566 [info ] [MainThread]: 
[0m17:28:41.893588 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.37 seconds (8.37s).
[0m17:28:41.896998 [debug] [MainThread]: Command end result
[0m17:28:41.939609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:28:41.941607 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:28:41.949304 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:28:41.949304 [info ] [MainThread]: 
[0m17:28:41.949304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:28:41.949304 [info ] [MainThread]: 
[0m17:28:41.949304 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:28:41.949304 [debug] [MainThread]: Command `dbt run` succeeded at 17:28:41.949304 after 10.04 seconds
[0m17:28:41.949304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE28CDB260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE27557830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE2819E990>]}
[0m17:28:41.949304 [debug] [MainThread]: Flushing usage events
[0m17:28:42.938637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:42.281176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288444C6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028843EB9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028843EBB590>]}


============================== 17:29:42.297042 | 7ec29190-e3db-495f-8799-d673af5d4fdb ==============================
[0m17:29:42.297042 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:29:42.297042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:29:42.752447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002884625BEF0>]}
[0m17:29:42.800004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288462372C0>]}
[0m17:29:42.800004 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:29:43.160038 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:29:43.350047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:29:43.350047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:29:43.350047 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:29:43.397987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288462C6FF0>]}
[0m17:29:43.471859 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:29:43.475277 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:29:43.503929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288466468D0>]}
[0m17:29:43.503929 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:29:43.503929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002884643BA40>]}
[0m17:29:43.503929 [info ] [MainThread]: 
[0m17:29:43.503929 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:29:43.503929 [info ] [MainThread]: 
[0m17:29:43.503929 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:29:43.503929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:29:43.624394 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:29:43.626688 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:29:43.626688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:45.530840 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.904 seconds
[0m17:29:45.532846 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:29:45.534852 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:29:45.810614 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.286 seconds
[0m17:29:45.826254 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m17:29:45.843029 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:29:45.843772 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:29:45.843772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:47.379464 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.540 seconds
[0m17:29:47.379464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m17:29:47.379464 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:29:47.379464 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:29:47.704983 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.320 seconds
[0m17:29:47.704983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m17:29:47.704983 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:29:47.704983 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:29:48.042918 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.338 seconds
[0m17:29:48.042918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002884664ADB0>]}
[0m17:29:48.058717 [debug] [Thread-1 (]: Began running node model.dbt_first.product_churn
[0m17:29:48.058717 [info ] [Thread-1 (]: 1 of 11 START sql table model mart.product_churn ............................... [RUN]
[0m17:29:48.058717 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.product_churn'
[0m17:29:48.058717 [debug] [Thread-1 (]: Began compiling node model.dbt_first.product_churn
[0m17:29:48.058717 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.product_churn"
[0m17:29:48.058717 [debug] [Thread-1 (]: Began executing node model.dbt_first.product_churn
[0m17:29:48.096069 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.product_churn"
[0m17:29:48.096069 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.product_churn"
[0m17:29:48.096069 [debug] [Thread-1 (]: On model.dbt_first.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.product_churn"} */
create or replace transient table HEALTHCARE.mart.product_churn
         as
        (
        );
[0m17:29:48.096069 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:29:49.721970 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb006f-0004-bde4-0005-a3d30003e4fe
[0m17:29:49.721970 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 8 unexpected ')'.
[0m17:29:49.737761 [debug] [Thread-1 (]: Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 8 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m17:29:49.737761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288439707A0>]}
[0m17:29:49.737761 [error] [Thread-1 (]: 1 of 11 ERROR creating sql table model mart.product_churn ...................... [[31mERROR[0m in 1.68s]
[0m17:29:49.737761 [debug] [Thread-1 (]: Finished running node model.dbt_first.product_churn
[0m17:29:49.737761 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_country_region
[0m17:29:49.737761 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.product_churn' to be skipped because of status 'error'.  Reason: Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 8 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql.
[0m17:29:49.737761 [info ] [Thread-1 (]: 2 of 11 START sql table model stage.stg_country_region ......................... [RUN]
[0m17:29:49.737761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.product_churn, now model.dbt_first.stg_country_region)
[0m17:29:49.737761 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_country_region
[0m17:29:49.756135 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_country_region"
[0m17:29:49.758143 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_country_region
[0m17:29:49.760796 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_country_region"
[0m17:29:49.764280 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_country_region"
[0m17:29:49.764280 [debug] [Thread-1 (]: On model.dbt_first.stg_country_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_country_region"} */
create or replace transient table HEALTHCARE.stage.stg_country_region
         as
        (

WITH cte_remove_duplicates AS (
    SELECT 
        customer_id,
        country,
        region
    FROM HEALTHCARE.RAW.COUNTRY_REGION
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

), 
cte_cleaned_data AS (
    SELECT 
        CAST(customer_id AS NUMBER(38,0)) AS customer_id,
        CAST(country AS VARCHAR(200)) AS country,
        CAST(region AS VARCHAR(200)) AS region,
        UPPER(TRIM(country)) AS cleaned_country,
        INITCAP(TRIM(region)) AS cleaned_region
    FROM HEALTHCARE.RAW.COUNTRY_REGION
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        country IS NOT NULL
         AND 
    
        region IS NOT NULL
        
    

)

SELECT 
    customer_id,
    cleaned_country AS country,
    cleaned_region AS region
FROM cte_cleaned_data
        );
[0m17:29:51.294157 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.532 seconds
[0m17:29:51.311852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028844515100>]}
[0m17:29:51.311852 [info ] [Thread-1 (]: 2 of 11 OK created sql table model stage.stg_country_region .................... [[32mSUCCESS 1[0m in 1.57s]
[0m17:29:51.311852 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_country_region
[0m17:29:51.311852 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_customers
[0m17:29:51.311852 [info ] [Thread-1 (]: 3 of 11 START sql table model stage.stg_customers .............................. [RUN]
[0m17:29:51.311852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_country_region, now model.dbt_first.stg_customers)
[0m17:29:51.311852 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_customers
[0m17:29:51.326189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_customers"
[0m17:29:51.326189 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_customers
[0m17:29:51.326189 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_customers"
[0m17:29:51.326189 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_customers"
[0m17:29:51.326189 [debug] [Thread-1 (]: On model.dbt_first.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_customers"} */
create or replace transient table HEALTHCARE.stage.stg_customers
         as
        (

WITH cte_handle_null AS (
    SELECT 
        customer_id,
        INITCAP(TRIM(customer_name)) AS customer_name,
        TRIM(company) AS company
    FROM HEALTHCARE.RAW.CUSTOMERS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        customer_name IS NOT NULL
         AND 
    
        company IS NOT NULL
        
    
  
),

cte_final AS (
    SELECT 
    DISTINCT
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(customer_name AS VARCHAR(300)) AS customer_name,
    
        CAST(company AS VARCHAR(100)) AS company,
    

    FROM cte_handle_null
)

SELECT * FROM cte_final
        );
[0m17:29:52.443593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.111 seconds
[0m17:29:52.443593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028846B986E0>]}
[0m17:29:52.443593 [info ] [Thread-1 (]: 3 of 11 OK created sql table model stage.stg_customers ......................... [[32mSUCCESS 1[0m in 1.13s]
[0m17:29:52.443593 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_customers
[0m17:29:52.443593 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_products
[0m17:29:52.443593 [info ] [Thread-1 (]: 4 of 11 START sql table model stage.stg_products ............................... [RUN]
[0m17:29:52.443593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_customers, now model.dbt_first.stg_products)
[0m17:29:52.443593 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_products
[0m17:29:52.443593 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_products"
[0m17:29:52.443593 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_products
[0m17:29:52.459554 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_products"
[0m17:29:52.461909 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_products"
[0m17:29:52.461909 [debug] [Thread-1 (]: On model.dbt_first.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_products"} */
create or replace transient table HEALTHCARE.stage.stg_products
         as
        (

WITH cte_not_null AS (
    SELECT 
        TRIM(product_id) AS product_id, 
        TRIM(product_family) AS product_family, 
        TRIM(product_sub_family) AS product_sub_family
    FROM HEALTHCARE.RAW.PRODUCTS
    WHERE 
    
        product_id IS NOT NULL
         AND 
    
        product_family IS NOT NULL
         AND 
    
        product_sub_family IS NOT NULL
        
    

),

cte_final AS (
    SELECT 
    DISTINCT
        
    
        CAST(product_id AS VARCHAR(500)) AS product_id,
    
        CAST(product_family AS VARCHAR(500)) AS product_family,
    
        CAST(product_sub_family AS VARCHAR(500)) AS product_sub_family,
    

    FROM cte_not_null
)

SELECT * FROM cte_final
        );
[0m17:29:53.754069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.294 seconds
[0m17:29:53.754069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028846E367E0>]}
[0m17:29:53.754069 [info ] [Thread-1 (]: 4 of 11 OK created sql table model stage.stg_products .......................... [[32mSUCCESS 1[0m in 1.31s]
[0m17:29:53.754069 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_products
[0m17:29:53.754069 [debug] [Thread-1 (]: Began running node model.dbt_first.stg_transactions
[0m17:29:53.754069 [info ] [Thread-1 (]: 5 of 11 START sql table model stage.stg_transactions ........................... [RUN]
[0m17:29:53.754069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_products, now model.dbt_first.stg_transactions)
[0m17:29:53.754069 [debug] [Thread-1 (]: Began compiling node model.dbt_first.stg_transactions
[0m17:29:53.754069 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.stg_transactions"
[0m17:29:53.769822 [debug] [Thread-1 (]: Began executing node model.dbt_first.stg_transactions
[0m17:29:53.773455 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.stg_transactions"
[0m17:29:53.777882 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.stg_transactions"
[0m17:29:53.777882 [debug] [Thread-1 (]: On model.dbt_first.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.stg_transactions"} */
create or replace transient table HEALTHCARE.stage.stg_transactions
         as
        (

WITH cte_cleaned_data AS (
    SELECT  
        
    
        CAST(customer_id AS INT) AS customer_id,
    
        CAST(revenue AS DECIMAL(10,3)) AS revenue,
    
        CAST(quantity AS INT) AS quantity,
    
        CAST(product_id AS VARCHAR(200)) AS product_id,
    
        CAST(payment_mode AS DATE) AS payment_mode,
    
        CAST(companies AS VARCHAR(100)) AS companies,
    


        CASE 
            WHEN revenue_type = 'True' THEN 1
            WHEN revenue_type = 'False' THEN 0
            ELSE NULL 
        END AS revenue_type,
        CAST(payment_mode AS DATE) AS payment_date,
        CAST(dimension_1 AS VARCHAR(10)) AS dim_1,
        CAST(dimension_2 AS VARCHAR(10)) AS dim_2,
        CAST(dimension_3 AS VARCHAR(10)) AS dim_3,
        CAST(dimension_4 AS VARCHAR(10)) AS dim_4,
        CAST(dimension_5 AS VARCHAR(10)) AS dim_5,
        CAST(dimension_6 AS VARCHAR(10)) AS dim_6,
        CAST(dimension_7 AS VARCHAR(10)) AS dim_7,
        CAST(dimension_8 AS VARCHAR(10)) AS dim_8,
        CAST(dimension_9 AS VARCHAR(10)) AS dim_9,
        CAST(dimension_10 AS VARCHAR(10)) AS dim_10
    FROM HEALTHCARE.RAW.TRANSACTIONS
    WHERE 
    
        customer_id IS NOT NULL
         AND 
    
        product_id IS NOT NULL
         AND 
    
        payment_mode IS NOT NULL
         AND 
    
        revenue IS NOT NULL
         AND 
    
        quantity IS NOT NULL
         AND 
    
        dimension_1 IS NOT NULL
         AND 
    
        dimension_2 IS NOT NULL
         AND 
    
        dimension_3 IS NOT NULL
         AND 
    
        dimension_4 IS NOT NULL
         AND 
    
        dimension_5 IS NOT NULL
         AND 
    
        dimension_6 IS NOT NULL
         AND 
    
        dimension_7 IS NOT NULL
         AND 
    
        dimension_8 IS NOT NULL
         AND 
    
        dimension_9 IS NOT NULL
         AND 
    
        dimension_10 IS NOT NULL
         AND 
    
        companies IS NOT NULL
        
    

),
cte_name_change AS(
    SELECT 
    DISTINCT
        customer_id,
        revenue,
        quantity,
        product_id,
        payment_mode AS payment_date,
        companies       AS company_name,
        revenue_type,
        dim_1,
        dim_2,
        dim_3,
        dim_4,
        dim_5,
        dim_6,
        dim_7,
        dim_8,
        dim_9,
        dim_10
    FROM 
        cte_cleaned_data
)

SELECT * FROM cte_name_change
        );
[0m17:29:54.967424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.190 seconds
[0m17:29:54.967424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028846E68290>]}
[0m17:29:54.967424 [info ] [Thread-1 (]: 5 of 11 OK created sql table model stage.stg_transactions ...................... [[32mSUCCESS 1[0m in 1.21s]
[0m17:29:54.967424 [debug] [Thread-1 (]: Finished running node model.dbt_first.stg_transactions
[0m17:29:54.967424 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m17:29:54.967424 [info ] [Thread-1 (]: 6 of 11 START sql table model mart.churned_new_customers ....................... [RUN]
[0m17:29:54.967424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.stg_transactions, now model.dbt_first.churned_new_customers)
[0m17:29:54.967424 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m17:29:55.022087 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m17:29:55.036234 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m17:29:55.037178 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m17:29:55.037178 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m17:29:55.037178 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

WITH first_last_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date,
        MAX(payment_date) AS last_purchase_date
    FROM HEALTHCARE.stage.stg_transactions  AS t
    GROUP BY customer_id
),
max_min_overall AS(
    SELECT
        MAX(payment_date) AS max_date,
        MIN(payment_date) AS min_date
    FROM HEALTHCARE.stage.stg_transactions
),
customer_status AS (
    SELECT
        flp.customer_id,
        flp.first_purchase_date,
        flp.last_purchase_date, 
        CASE
            WHEN flp.last_purchase_date < DATEADD(month, -3, mmo.max_date) THEN 1
            ELSE 0
        END AS churned_customer,
        CASE
            WHEN flp.first_purchase_date > DATEADD(month, -3, mmo.max_date) THEN 1
            ELSE 0
        END AS new_customer
    FROM first_last_purchase AS flp
    CROSS JOIN max_min_overall AS mmo
),
customer_status_over_time AS (
    SELECT
        DATE_TRUNC('month', flp.first_purchase_date) AS month,
        SUM(cs.churned_customer) AS churned_customers,
        SUM(cs.new_customer) AS new_customers
    FROM customer_status AS cs
    JOIN first_last_purchase AS flp ON cs.customer_id = flp.customer_id
    GROUP BY month
)
SELECT 
    month,
    churned_customers,
    new_customers
FROM 
    customer_status_over_time
ORDER BY 
    month



--     WITH first_payment AS (
--     SELECT
--         customer_id,
--         MIN(payment_date) AS first_payment_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
--     GROUP BY
--         customer_id
-- ),
 
-- new_customers_by_fy AS (
--     SELECT
--         customer_id,
--         EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
--     FROM
--         first_payment
-- ),
 
-- date_range AS (
--     SELECT
--         MIN(payment_date) AS start_date,
--         MAX(payment_date) AS end_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
-- ),
 
-- last_payment AS (
--     SELECT
--         customer_id,
--         MAX(payment_date) AS last_payment_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
--     GROUP BY
--         customer_id
-- ),
 
-- churned_customers AS (
--     SELECT
--         customer_id,
--         EXTRACT(YEAR FROM last_payment_date) AS fiscal_year
--     FROM
--         last_payment,
--         date_range
--     WHERE
--         last_payment_date < end_date
-- ),
 
-- fiscal_years AS (
--     SELECT DISTINCT
--         EXTRACT(YEAR FROM payment_date) AS fiscal_year
--     FROM
--         HEALTHCARE.stage.stg_transactions
-- )
 
-- SELECT
--     fy.fiscal_year,
--     COUNT(DISTINCT new_customers_by_fy.customer_id) AS new_customers_count,
--     COUNT(DISTINCT churned_customers.customer_id) AS churned_customers_count
-- FROM
--     fiscal_years fy
--     LEFT JOIN new_customers_by_fy ON fy.fiscal_year = new_customers_by_fy.fiscal_year
--     LEFT JOIN churned_customers ON fy.fiscal_year = churned_customers.fiscal_year
-- GROUP BY
--     fy.fiscal_year
-- ORDER BY
--     fy.fiscal_year
        );
[0m17:29:56.129453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.086 seconds
[0m17:29:56.132161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288451CC1A0>]}
[0m17:29:56.133153 [info ] [Thread-1 (]: 6 of 11 OK created sql table model mart.churned_new_customers .................. [[32mSUCCESS 1[0m in 1.16s]
[0m17:29:56.134123 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m17:29:56.134123 [debug] [Thread-1 (]: Began running node model.dbt_first.highest_cross_sell
[0m17:29:56.134123 [info ] [Thread-1 (]: 7 of 11 START sql table model mart.highest_cross_sell .......................... [RUN]
[0m17:29:56.135441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.churned_new_customers, now model.dbt_first.highest_cross_sell)
[0m17:29:56.135441 [debug] [Thread-1 (]: Began compiling node model.dbt_first.highest_cross_sell
[0m17:29:56.139821 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.highest_cross_sell"
[0m17:29:56.140818 [debug] [Thread-1 (]: Began executing node model.dbt_first.highest_cross_sell
[0m17:29:56.142785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.highest_cross_sell"
[0m17:29:56.145190 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.highest_cross_sell"
[0m17:29:56.145190 [debug] [Thread-1 (]: On model.dbt_first.highest_cross_sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.highest_cross_sell"} */
create or replace transient table HEALTHCARE.mart.highest_cross_sell
         as
        (

WITH customer_product_count AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS product_count
    FROM 
        HEALTHCARE.stage.stg_transactions
    GROUP BY 
        CUSTOMER_ID
),
highest_cross_sell AS (
    SELECT 
        CUSTOMER_ID,
        product_count,
        DENSE_RANK() OVER(ORDER BY product_count DESC) AS cross_sell_rank
    FROM 
        customer_product_count
)
SELECT 
    hcs.CUSTOMER_ID,
    c.customer_name,
    hcs.product_count,
    hcs.cross_sell_rank
FROM 
    highest_cross_sell AS hcs
INNER JOIN 
      HEALTHCARE.stage.stg_customers AS c
ON 
    hcs.CUSTOMER_ID = c.CUSTOMER_ID
ORDER BY 
    hcs.cross_sell_rank
        );
[0m17:29:57.339281 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.194 seconds
[0m17:29:57.339281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028845226AE0>]}
[0m17:29:57.339281 [info ] [Thread-1 (]: 7 of 11 OK created sql table model mart.highest_cross_sell ..................... [[32mSUCCESS 1[0m in 1.20s]
[0m17:29:57.339281 [debug] [Thread-1 (]: Finished running node model.dbt_first.highest_cross_sell
[0m17:29:57.339281 [debug] [Thread-1 (]: Began running node model.dbt_first.new_logo_each_fiscal
[0m17:29:57.339281 [info ] [Thread-1 (]: 8 of 11 START sql table model mart.new_logo_each_fiscal ........................ [RUN]
[0m17:29:57.339281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.highest_cross_sell, now model.dbt_first.new_logo_each_fiscal)
[0m17:29:57.339281 [debug] [Thread-1 (]: Began compiling node model.dbt_first.new_logo_each_fiscal
[0m17:29:57.339281 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.new_logo_each_fiscal"
[0m17:29:57.339281 [debug] [Thread-1 (]: Began executing node model.dbt_first.new_logo_each_fiscal
[0m17:29:57.339281 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.new_logo_each_fiscal"
[0m17:29:57.355250 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.new_logo_each_fiscal"
[0m17:29:57.355250 [debug] [Thread-1 (]: On model.dbt_first.new_logo_each_fiscal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.new_logo_each_fiscal"} */
create or replace transient table HEALTHCARE.mart.new_logo_each_fiscal
         as
        (

-- WITH cte_first_purchase AS (
--     SELECT
--         customer_id,
--         MIN(payment_date) AS first_purchase_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
--     GROUP BY
--         customer_id
-- ),
 
-- cte_extract_year AS (
--     SELECT
--         customer_id,
--         EXTRACT(YEAR FROM first_purchase_date) AS fiscal_year
--     FROM
--         cte_first_purchase
-- )
 
-- SELECT
--     fiscal_year,
--     COUNT(DISTINCT customer_id) AS new_logos
-- FROM
--     cte_extract_year
-- GROUP BY
--     fiscal_year
-- ORDER BY
--     fiscal_year

with add_fy as(
    select
        trans.customer_id,
        custs.customername,
        trans.payment_date,
        (case
            WHEN MONTH(trans.payment_date) >= 4 THEN YEAR(trans.payment_date)
            ELSE YEAR(trans.payment_date) - 1
        end) as fiscal_year,
        trans.revenue,
        trans.revenue_type
    from HEALTHCARE.stage.stg_transactions trans                                                                              
    left join HEALTHCARE.stage.stg_customers custs
    on trans.customer_id = custs.customer_id
    order by trans.payment_date
),
fy_partition as (
    select distinct
        customer_id,
        customername,
        min(payment_date) as first_in_fy,
        fiscal_year,
        row_number() over(partition by customername, customer_id order by first_in_fy) as uid
    from add_fy
    group by fiscal_year, customer_id, customername
    order by customername
),
new_in_fy as (
    select
        customer_id,
        customername,
        first_in_fy,
        fiscal_year
    from fy_partition
    where uid = 1
)
select * from new_in_fy
order by fiscal_year
        );
[0m17:29:57.670294 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb006f-0004-c0bd-0005-a3d30003b9d6
[0m17:29:57.670294 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 36 at position 8
invalid identifier 'CUSTS.CUSTOMERNAME'
[0m17:29:57.670294 [debug] [Thread-1 (]: Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  000904 (42000): SQL compilation error: error line 36 at position 8
  invalid identifier 'CUSTS.CUSTOMERNAME'
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql
[0m17:29:57.670294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028846C503B0>]}
[0m17:29:57.670294 [error] [Thread-1 (]: 8 of 11 ERROR creating sql table model mart.new_logo_each_fiscal ............... [[31mERROR[0m in 0.33s]
[0m17:29:57.670294 [debug] [Thread-1 (]: Finished running node model.dbt_first.new_logo_each_fiscal
[0m17:29:57.670294 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m17:29:57.670294 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.new_logo_each_fiscal' to be skipped because of status 'error'.  Reason: Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  000904 (42000): SQL compilation error: error line 36 at position 8
  invalid identifier 'CUSTS.CUSTOMERNAME'
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql.
[0m17:29:57.670294 [info ] [Thread-1 (]: 9 of 11 START sql table model mart.rank_customers_revenue ...................... [RUN]
[0m17:29:57.670294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.new_logo_each_fiscal, now model.dbt_first.rank_customers_revenue)
[0m17:29:57.670294 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m17:29:57.670294 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m17:29:57.670294 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m17:29:57.686169 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m17:29:57.688462 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m17:29:57.688462 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (
WITH customer_revenue AS (
    SELECT
        t.customer_id,
        c.customer_name,
        SUM(t.revenue * t.quantity) AS total_revenue,
        COUNT(*) AS transaction_count
    FROM HEALTHCARE.stage.stg_transactions t
    LEFT JOIN (SELECT DISTINCT customer_id, customer_name FROM HEALTHCARE.stage.stg_customers) c
    ON t.customer_id = c.customer_id
    where revenue_type = 1 and t.revenue > 0
    GROUP BY t.customer_id, c.customer_name
),
 
ranked_customers AS (
    SELECT
        customer_id,
        customer_name,
        total_revenue,
        transaction_count,
        DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
    FROM customer_revenue
)
 
SELECT * FROM ranked_customers

-- WITH customer_revenue AS (
--     SELECT
--         c.CUSTOMER_ID AS customer_id,
--         c.customer_name,
--         SUM(t.REVENUE) AS total_revenue,
--         DENSE_RANK() OVER (ORDER BY total_revenue DESC) AS revenue_rank
--     FROM HEALTHCARE.stage.stg_transactions as t
--     JOIN HEALTHCARE.stage.stg_customers as  c
--     ON c.CUSTOMER_ID = t.CUSTOMER_ID
--     GROUP BY c.CUSTOMER_ID,c.customer_name
-- )
 
-- SELECT
--     customer_id,
--     customer_name,
--         total_revenue,
--     revenue_rank
-- FROM customer_revenue
-- ORDER BY revenue_rank
        );
[0m17:29:58.889305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.200 seconds
[0m17:29:58.889305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028846C7BA40>]}
[0m17:29:58.889305 [info ] [Thread-1 (]: 9 of 11 OK created sql table model mart.rank_customers_revenue ................. [[32mSUCCESS 1[0m in 1.22s]
[0m17:29:58.889305 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m17:29:58.889305 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m17:29:58.889305 [info ] [Thread-1 (]: 10 of 11 START sql table model mart.rank_product_revenue ....................... [RUN]
[0m17:29:58.889305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.rank_customers_revenue, now model.dbt_first.rank_product_revenue)
[0m17:29:58.889305 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m17:29:58.904488 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m17:29:58.905647 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m17:29:58.909611 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m17:29:58.911579 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m17:29:58.911579 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

WITH cte_product_revenue AS (
    SELECT 
        product_id,
        SUM(revenue*quantity) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions 
    where revenue_type = 1 and revenue > 0
    GROUP BY 
        product_id
)
SELECT 
    product_id,
    total_revenue,
    DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS product_rank
FROM cte_product_revenue
        );
[0m17:29:59.869540 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.968 seconds
[0m17:29:59.869540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002884666E210>]}
[0m17:29:59.869540 [info ] [Thread-1 (]: 10 of 11 OK created sql table model mart.rank_product_revenue .................. [[32mSUCCESS 1[0m in 0.98s]
[0m17:29:59.869540 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m17:29:59.869540 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:29:59.885474 [info ] [Thread-1 (]: 11 of 11 START sql table model mart.revenue_contraction ........................ [RUN]
[0m17:29:59.885474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_first.rank_product_revenue, now model.dbt_first.revenue_contraction)
[0m17:29:59.885474 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:29:59.885474 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:29:59.885474 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:29:59.885474 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:29:59.885474 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:29:59.885474 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH monthly_revenue AS (
    SELECT 
        DATE_TRUNC('month', payment_date) AS month,
        SUM(CAST(revenue AS DECIMAL)) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE 
        revenue_type = 1 
    GROUP BY 
        DATE_TRUNC('month', payment_date)
),
revenue_difference AS (
    SELECT 
        month,
        total_revenue,
        CASE
            WHEN LAG(total_revenue, 1) OVER (ORDER BY month) IS NULL THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY month)
        END AS previous_month_revenue,
        total_revenue - 
        CASE 
            LAG(total_revenue, 1) OVER (ORDER BY month) IS NULL
            WHEN TRUE THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY month)
        END
            AS revenue_difference,
        CASE
            WHEN total_revenue - LAG(total_revenue, 1) OVER (ORDER BY month) < 0 THEN 1
            ELSE 0
        END AS revenue_loss
    FROM 
        monthly_revenue
)
SELECT 
    month,
    total_revenue,
    previous_month_revenue,
    revenue_difference,
    revenue_loss
FROM 
    revenue_difference
ORDER BY 
    month
        );
[0m17:30:00.909654 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.015 seconds
[0m17:30:00.909654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ec29190-e3db-495f-8799-d673af5d4fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028846E475F0>]}
[0m17:30:00.909654 [info ] [Thread-1 (]: 11 of 11 OK created sql table model mart.revenue_contraction ................... [[32mSUCCESS 1[0m in 1.02s]
[0m17:30:00.909654 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:30:00.909654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:00.909654 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:30:00.917267 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:30:01.419397 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m17:30:01.419397 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m17:30:01.968656 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:30:01.969637 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:30:02.506564 [info ] [MainThread]: 
[0m17:30:02.506564 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 19.00 seconds (19.00s).
[0m17:30:02.506564 [debug] [MainThread]: Command end result
[0m17:30:02.535344 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:30:02.538345 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:30:02.546895 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:30:02.547893 [info ] [MainThread]: 
[0m17:30:02.548714 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m17:30:02.548714 [info ] [MainThread]: 
[0m17:30:02.548714 [error] [MainThread]:   Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 8 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\product_churn.sql
[0m17:30:02.548714 [info ] [MainThread]: 
[0m17:30:02.548714 [error] [MainThread]:   Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  000904 (42000): SQL compilation error: error line 36 at position 8
  invalid identifier 'CUSTS.CUSTOMERNAME'
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql
[0m17:30:02.548714 [info ] [MainThread]: 
[0m17:30:02.548714 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=2 SKIP=0 TOTAL=11
[0m17:30:02.548714 [debug] [MainThread]: Command `dbt run` failed at 17:30:02.548714 after 20.44 seconds
[0m17:30:02.548714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028840E6DAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028844001790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028846A0B530>]}
[0m17:30:02.548714 [debug] [MainThread]: Flushing usage events
[0m17:30:04.182311 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:32:06.551723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203265143E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020326515100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020326516A50>]}


============================== 17:32:06.551723 | 0c902537-516d-4910-8acb-b493c30d13bf ==============================
[0m17:32:06.551723 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:32:06.551723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:highest_cross_sell', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:32:07.027977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c902537-516d-4910-8acb-b493c30d13bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203271B1130>]}
[0m17:32:07.092236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c902537-516d-4910-8acb-b493c30d13bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020327187620>]}
[0m17:32:07.101229 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:32:07.469214 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:32:07.633955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:32:07.633955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:32:07.649115 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:32:07.695689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c902537-516d-4910-8acb-b493c30d13bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032854FEF0>]}
[0m17:32:07.801006 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:32:07.809395 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:32:07.835842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c902537-516d-4910-8acb-b493c30d13bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203273D2DB0>]}
[0m17:32:07.835842 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:32:07.850780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c902537-516d-4910-8acb-b493c30d13bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203273A9640>]}
[0m17:32:07.853786 [info ] [MainThread]: 
[0m17:32:07.854788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:07.854788 [info ] [MainThread]: 
[0m17:32:07.856586 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:32:07.856586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:32:07.976206 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:32:07.976206 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:32:07.977353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:10.147362 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.171 seconds
[0m17:32:10.147362 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m17:32:10.165056 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:32:10.165056 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:32:10.165056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:12.180219 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.020 seconds
[0m17:32:12.180219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m17:32:12.190001 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:32:12.190001 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:32:12.552239 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.365 seconds
[0m17:32:12.552239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m17:32:12.552239 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:32:12.552239 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:32:12.896470 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.335 seconds
[0m17:32:12.896470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c902537-516d-4910-8acb-b493c30d13bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032394F920>]}
[0m17:32:12.907273 [debug] [Thread-1 (]: Began running node model.dbt_first.highest_cross_sell
[0m17:32:12.907273 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.highest_cross_sell ........................... [RUN]
[0m17:32:12.907273 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.highest_cross_sell'
[0m17:32:12.907273 [debug] [Thread-1 (]: Began compiling node model.dbt_first.highest_cross_sell
[0m17:32:12.924274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.highest_cross_sell"
[0m17:32:12.927351 [debug] [Thread-1 (]: Began executing node model.dbt_first.highest_cross_sell
[0m17:32:12.957945 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.highest_cross_sell"
[0m17:32:12.957945 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.highest_cross_sell"
[0m17:32:12.957945 [debug] [Thread-1 (]: On model.dbt_first.highest_cross_sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.highest_cross_sell"} */
create or replace transient table HEALTHCARE.mart.highest_cross_sell
         as
        (

WITH customer_product_count AS (
    SELECT 
        CUSTOMER_ID,
        COUNT(DISTINCT PRODUCT_ID) AS product_count
    FROM 
        HEALTHCARE.stage.stg_transactions
    GROUP BY 
        CUSTOMER_ID
),
highest_cross_sell AS (
    SELECT 
        CUSTOMER_ID,
        product_count,
        DENSE_RANK() OVER(ORDER BY product_count DESC) AS cross_sell_rank
    FROM 
        customer_product_count
)
SELECT 
    hcs.CUSTOMER_ID,
    c.customer_name,
    hcs.product_count,
    hcs.cross_sell_rank
FROM 
    highest_cross_sell AS hcs
INNER JOIN 
      HEALTHCARE.stage.stg_customers AS c
ON 
    hcs.CUSTOMER_ID = c.CUSTOMER_ID
ORDER BY 
    hcs.cross_sell_rank
        );
[0m17:32:12.957945 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:15.673297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.715 seconds
[0m17:32:15.689311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c902537-516d-4910-8acb-b493c30d13bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203259D0B30>]}
[0m17:32:15.689311 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.highest_cross_sell ...................... [[32mSUCCESS 1[0m in 2.78s]
[0m17:32:15.689311 [debug] [Thread-1 (]: Finished running node model.dbt_first.highest_cross_sell
[0m17:32:15.704988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:15.704988 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:32:15.704988 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:32:16.238815 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m17:32:16.238815 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m17:32:16.789631 [debug] [MainThread]: Connection 'model.dbt_first.highest_cross_sell' was left open.
[0m17:32:16.789631 [debug] [MainThread]: On model.dbt_first.highest_cross_sell: Close
[0m17:32:18.065528 [info ] [MainThread]: 
[0m17:32:18.065528 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.21 seconds (10.21s).
[0m17:32:18.065528 [debug] [MainThread]: Command end result
[0m17:32:18.101936 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:32:18.103942 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:32:18.103942 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:32:18.103942 [info ] [MainThread]: 
[0m17:32:18.111003 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:18.113010 [info ] [MainThread]: 
[0m17:32:18.114010 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:32:18.115011 [debug] [MainThread]: Command `dbt run` succeeded at 17:32:18.115011 after 11.81 seconds
[0m17:32:18.115011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032602DCA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032608E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032546DC70>]}
[0m17:32:18.116010 [debug] [MainThread]: Flushing usage events
[0m17:32:19.062285 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:41:14.639527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001253E605D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001253DD0B200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001253DD09D60>]}


============================== 17:41:14.655251 | 1656b2ee-4707-4269-ad02-f8a51c49447f ==============================
[0m17:41:14.655251 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:41:14.655251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:41:15.165358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1656b2ee-4707-4269-ad02-f8a51c49447f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001254208EE70>]}
[0m17:41:15.222878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1656b2ee-4707-4269-ad02-f8a51c49447f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001253DC4D880>]}
[0m17:41:15.222878 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:41:15.707441 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:41:17.086224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:41:17.099139 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m17:41:17.340595 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:41:17.362638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1656b2ee-4707-4269-ad02-f8a51c49447f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125431876B0>]}
[0m17:41:17.442113 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:41:17.455883 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:41:17.477410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1656b2ee-4707-4269-ad02-f8a51c49447f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000125436350D0>]}
[0m17:41:17.477410 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:41:17.477410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1656b2ee-4707-4269-ad02-f8a51c49447f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001254341D8E0>]}
[0m17:41:17.477410 [info ] [MainThread]: 
[0m17:41:17.477410 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:17.477410 [info ] [MainThread]: 
[0m17:41:17.477410 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:41:17.477410 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:41:20.177168 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:41:20.177168 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:41:20.177168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:22.201760 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.012 seconds
[0m17:41:22.208195 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m17:41:22.217763 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:41:22.217763 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:41:22.217763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:23.771897 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.553 seconds
[0m17:41:23.773945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m17:41:23.776943 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:41:23.776943 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:41:24.097791 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.321 seconds
[0m17:41:24.101827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m17:41:24.148245 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:41:24.150251 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:41:24.531116 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.383 seconds
[0m17:41:24.531116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1656b2ee-4707-4269-ad02-f8a51c49447f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001254366C9E0>]}
[0m17:41:24.531116 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:41:24.531116 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m17:41:24.531116 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m17:41:24.531116 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:41:24.546960 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:41:24.546960 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:41:24.573516 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:41:24.573516 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:41:24.573516 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH monthly_revenue AS (
    SELECT 
        DATE_TRUNC('month', payment_date) AS payment_month,
        SUM(CAST(revenue AS DECIMAL)) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE 
        revenue_type = 1 
    GROUP BY 
        DATE_TRUNC('month', payment_date)
),
revenue_difference AS (
    SELECT 
        month,
        total_revenue,
        CASE
            WHEN LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY payment_month)
        END AS previous_month_revenue,
        total_revenue - 
        CASE 
            LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL
            WHEN TRUE THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY month)
        END
            AS revenue_difference,
        CASE
            WHEN total_revenue - LAG(total_revenue, 1) OVER (ORDER BY month) < 0 THEN 1
            ELSE 0
        END AS revenue_loss
    FROM 
        monthly_revenue
)
SELECT 
    payment_month,
    total_revenue,
    previous_month_revenue,
    revenue_difference
FROM 
    (revenue_difference*(-1)) AS revenue_difference
WHERE
    revenue_loss = 1
ORDER BY 
    payment_month
        );
[0m17:41:24.573516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:41:26.226921 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb007b-0004-bb9d-0005-a3d30003d4e2
[0m17:41:26.226921 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 44 at position 5 unexpected 'revenue_difference'.
syntax error line 44 at position 28 unexpected ')'.
[0m17:41:26.242838 [debug] [Thread-1 (]: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 5 unexpected 'revenue_difference'.
  syntax error line 44 at position 28 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m17:41:26.242838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1656b2ee-4707-4269-ad02-f8a51c49447f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012540810710>]}
[0m17:41:26.242838 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.revenue_contraction ................. [[31mERROR[0m in 1.71s]
[0m17:41:26.242838 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:41:26.242838 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.revenue_contraction' to be skipped because of status 'error'.  Reason: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 5 unexpected 'revenue_difference'.
  syntax error line 44 at position 28 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql.
[0m17:41:26.242838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:26.242838 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:41:26.242838 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:41:26.765457 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m17:41:26.765457 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m17:41:27.321667 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:41:27.321667 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:41:27.846630 [info ] [MainThread]: 
[0m17:41:27.846630 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.37 seconds (10.37s).
[0m17:41:27.846630 [debug] [MainThread]: Command end result
[0m17:41:27.875284 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:41:27.878286 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:41:27.881285 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:41:27.881285 [info ] [MainThread]: 
[0m17:41:27.881285 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:41:27.881285 [info ] [MainThread]: 
[0m17:41:27.881285 [error] [MainThread]:   Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 44 at position 5 unexpected 'revenue_difference'.
  syntax error line 44 at position 28 unexpected ')'.
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m17:41:27.881285 [info ] [MainThread]: 
[0m17:41:27.881285 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:41:27.881285 [debug] [MainThread]: Command `dbt run` failed at 17:41:27.881285 after 13.49 seconds
[0m17:41:27.881285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001253F106660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001253F1066F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001253F1066C0>]}
[0m17:41:27.881285 [debug] [MainThread]: Flushing usage events
[0m17:41:28.841151 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:42:32.097489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027824092210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027825A6BB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027825F1B6B0>]}


============================== 17:42:32.099001 | 19124779-3986-4937-9163-f12b3ff7f9dc ==============================
[0m17:42:32.099001 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:42:32.099001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:42:32.568812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19124779-3986-4937-9163-f12b3ff7f9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027826F0BDA0>]}
[0m17:42:32.616309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19124779-3986-4937-9163-f12b3ff7f9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027827057BF0>]}
[0m17:42:32.616309 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:42:32.992479 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:42:33.180539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:42:33.182285 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m17:42:33.432486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:42:33.446381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19124779-3986-4937-9163-f12b3ff7f9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027828682390>]}
[0m17:42:33.523873 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:42:33.523873 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:42:33.557657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19124779-3986-4937-9163-f12b3ff7f9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027828618E90>]}
[0m17:42:33.557657 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:42:33.557657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19124779-3986-4937-9163-f12b3ff7f9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278286659A0>]}
[0m17:42:33.557657 [info ] [MainThread]: 
[0m17:42:33.557657 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:42:33.557657 [info ] [MainThread]: 
[0m17:42:33.557657 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:42:33.557657 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:42:33.658075 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:42:33.658075 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:42:33.658075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:35.601951 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.941 seconds
[0m17:42:35.602958 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m17:42:35.613627 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:42:35.613627 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:42:35.613627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:37.470426 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.855 seconds
[0m17:42:37.470426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m17:42:37.470426 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:42:37.470426 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:42:37.826491 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.359 seconds
[0m17:42:37.842107 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m17:42:37.889674 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:42:37.889674 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:42:38.226877 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.348 seconds
[0m17:42:38.242654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19124779-3986-4937-9163-f12b3ff7f9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027828652750>]}
[0m17:42:38.242654 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:42:38.242654 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m17:42:38.242654 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m17:42:38.242654 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:42:38.260272 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:42:38.262043 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:42:38.295398 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:42:38.298644 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:42:38.299643 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH monthly_revenue AS (
    SELECT 
        DATE_TRUNC('month', payment_date) AS payment_month,
        SUM(CAST(revenue AS DECIMAL)) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE 
        revenue_type = 1 
    GROUP BY 
        DATE_TRUNC('month', payment_date)
),
revenue_difference AS (
    SELECT 
        month,
        total_revenue,
        CASE
            WHEN LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY payment_month)
        END AS previous_month_revenue,
        total_revenue - 
        CASE 
            LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL
            WHEN TRUE THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY month)
        END
            AS revenue_difference,
        CASE
            WHEN total_revenue - LAG(total_revenue, 1) OVER (ORDER BY month) < 0 THEN 1
            ELSE 0
        END AS revenue_loss
    FROM 
        monthly_revenue
)
SELECT 
    payment_month,
    total_revenue,
    previous_month_revenue,
    (revenue_difference*(-1)) AS revenue_difference
FROM
    revenue_difference
WHERE
    revenue_loss = 1
ORDER BY 
    payment_month
        );
[0m17:42:38.299643 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:42:39.826518 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb007c-0004-bb9d-0005-a3d30003d4e6
[0m17:42:39.826518 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 8
invalid identifier 'MONTH'
[0m17:42:39.830542 [debug] [Thread-1 (]: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 18 at position 8
  invalid identifier 'MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m17:42:39.834550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19124779-3986-4937-9163-f12b3ff7f9dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278286C94C0>]}
[0m17:42:39.834550 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.revenue_contraction ................. [[31mERROR[0m in 1.59s]
[0m17:42:39.834550 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:42:39.836555 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.revenue_contraction' to be skipped because of status 'error'.  Reason: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 18 at position 8
  invalid identifier 'MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql.
[0m17:42:39.838561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:39.838561 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:42:39.838561 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:42:40.347839 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m17:42:40.347839 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m17:42:40.876023 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:42:40.887833 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:42:41.425730 [info ] [MainThread]: 
[0m17:42:41.425730 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.87 seconds (7.87s).
[0m17:42:41.425730 [debug] [MainThread]: Command end result
[0m17:42:41.453591 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:42:41.455593 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:42:41.455593 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:42:41.455593 [info ] [MainThread]: 
[0m17:42:41.455593 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:42:41.465805 [info ] [MainThread]: 
[0m17:42:41.465805 [error] [MainThread]:   Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 18 at position 8
  invalid identifier 'MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m17:42:41.467817 [info ] [MainThread]: 
[0m17:42:41.467817 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:42:41.467817 [debug] [MainThread]: Command `dbt run` failed at 17:42:41.467817 after 9.56 seconds
[0m17:42:41.467817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278262D7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027825E3EAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027825E3C710>]}
[0m17:42:41.467817 [debug] [MainThread]: Flushing usage events
[0m17:42:42.513925 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:48.923656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B82E95E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B79B6ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B81877A0>]}


============================== 17:43:48.936227 | 8fe9a6fd-f477-435d-b03c-de5a301c0e03 ==============================
[0m17:43:48.936227 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:43:48.939342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:43:49.405751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fe9a6fd-f477-435d-b03c-de5a301c0e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B82BD4F0>]}
[0m17:43:49.466816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fe9a6fd-f477-435d-b03c-de5a301c0e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B8CC9940>]}
[0m17:43:49.469110 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:43:49.827507 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:43:50.037275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:43:50.038066 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m17:43:50.301110 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:43:50.315746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fe9a6fd-f477-435d-b03c-de5a301c0e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BA5F2360>]}
[0m17:43:50.396193 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:43:50.400205 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:43:50.431690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fe9a6fd-f477-435d-b03c-de5a301c0e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BA58DC70>]}
[0m17:43:50.431690 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:43:50.431690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fe9a6fd-f477-435d-b03c-de5a301c0e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BA0E7740>]}
[0m17:43:50.431690 [info ] [MainThread]: 
[0m17:43:50.431690 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:50.431690 [info ] [MainThread]: 
[0m17:43:50.431690 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:43:50.437555 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:43:50.537853 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:43:50.537853 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:43:50.537853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:52.427264 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.889 seconds
[0m17:43:52.435943 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m17:43:52.446821 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:43:52.447822 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:43:52.450180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:53.956261 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.507 seconds
[0m17:43:53.958294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m17:43:53.962296 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:43:53.963293 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:43:54.388411 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.436 seconds
[0m17:43:54.400018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m17:43:54.458704 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:43:54.459706 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:43:54.880541 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.420 seconds
[0m17:43:54.883444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fe9a6fd-f477-435d-b03c-de5a301c0e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275BA8435C0>]}
[0m17:43:54.887449 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:43:54.888435 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m17:43:54.889447 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m17:43:54.889447 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:43:54.897482 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:43:54.897482 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:43:54.933718 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:43:54.935832 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:43:54.936834 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH monthly_revenue AS (
    SELECT 
        DATE_TRUNC('month', payment_date) AS payment_month,
        SUM(CAST(revenue AS DECIMAL)) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE 
        revenue_type = 1 
    GROUP BY 
        DATE_TRUNC('month', payment_date)
),
revenue_difference AS (
    SELECT 
        month,
        total_revenue,
        CASE
            WHEN LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY payment_month)
        END AS previous_month_revenue,
        total_revenue - 
        CASE 
            LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL
            WHEN TRUE THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY payment_month)
        END
            AS revenue_difference,
        CASE
            WHEN total_revenue - LAG(total_revenue, 1) OVER (ORDER BY payment_month) < 0 THEN 1
            ELSE 0
        END AS revenue_loss
    FROM 
        monthly_revenue
)
SELECT 
    payment_month,
    total_revenue,
    previous_month_revenue,
    (revenue_difference*(-1)) AS revenue_difference
FROM
    revenue_difference
WHERE
    revenue_loss = 1
ORDER BY 
    payment_month
        );
[0m17:43:54.936834 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:56.466227 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb007d-0004-bde4-0005-a3d30003e54e
[0m17:43:56.466227 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 8
invalid identifier 'MONTH'
[0m17:43:56.470241 [debug] [Thread-1 (]: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 18 at position 8
  invalid identifier 'MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m17:43:56.470241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fe9a6fd-f477-435d-b03c-de5a301c0e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B77A07D0>]}
[0m17:43:56.470241 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.revenue_contraction ................. [[31mERROR[0m in 1.58s]
[0m17:43:56.470241 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:43:56.470241 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.revenue_contraction' to be skipped because of status 'error'.  Reason: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 18 at position 8
  invalid identifier 'MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql.
[0m17:43:56.470241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:56.470241 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:43:56.470241 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:43:56.998253 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m17:43:57.002223 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m17:43:57.518011 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:43:57.519050 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:43:58.045896 [info ] [MainThread]: 
[0m17:43:58.046897 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m17:43:58.047906 [debug] [MainThread]: Command end result
[0m17:43:58.075375 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:43:58.078609 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:43:58.085606 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:43:58.086608 [info ] [MainThread]: 
[0m17:43:58.086608 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:43:58.087612 [info ] [MainThread]: 
[0m17:43:58.087612 [error] [MainThread]:   Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 18 at position 8
  invalid identifier 'MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m17:43:58.088607 [info ] [MainThread]: 
[0m17:43:58.089609 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:43:58.090607 [debug] [MainThread]: Command `dbt run` failed at 17:43:58.089609 after 9.32 seconds
[0m17:43:58.090607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B82977A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B80F2C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275B5648590>]}
[0m17:43:58.090607 [debug] [MainThread]: Flushing usage events
[0m17:43:59.087817 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:23.393433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651F154D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651CEA8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651F1565A0>]}


============================== 17:44:23.393433 | 5348f9d8-df77-471e-9ab1-f4bfd6b94854 ==============================
[0m17:44:23.393433 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:44:23.393433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:44:23.864050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5348f9d8-df77-471e-9ab1-f4bfd6b94854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651F1577D0>]}
[0m17:44:23.927891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5348f9d8-df77-471e-9ab1-f4bfd6b94854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651C8E49B0>]}
[0m17:44:23.927891 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:44:24.286155 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:44:24.461177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:44:24.461177 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:44:24.461177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:44:24.509246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5348f9d8-df77-471e-9ab1-f4bfd6b94854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265211DFF80>]}
[0m17:44:24.588316 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:44:24.588316 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:44:24.613821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5348f9d8-df77-471e-9ab1-f4bfd6b94854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026521396ED0>]}
[0m17:44:24.613821 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:44:24.613821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5348f9d8-df77-471e-9ab1-f4bfd6b94854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026520044170>]}
[0m17:44:24.613821 [info ] [MainThread]: 
[0m17:44:24.613821 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:24.613821 [info ] [MainThread]: 
[0m17:44:24.613821 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:44:24.613821 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:44:24.729324 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:44:24.729324 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:44:24.730323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:26.661739 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.934 seconds
[0m17:44:26.669999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m17:44:26.679757 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:44:26.679757 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:44:26.679757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:28.132243 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.464 seconds
[0m17:44:28.132243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m17:44:28.148186 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:44:28.148186 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:44:28.518534 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.372 seconds
[0m17:44:28.518534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m17:44:28.518534 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:44:28.518534 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:44:28.890020 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.370 seconds
[0m17:44:28.890020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5348f9d8-df77-471e-9ab1-f4bfd6b94854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000265218EFB90>]}
[0m17:44:28.905663 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:44:28.905663 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m17:44:28.905663 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m17:44:28.905663 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:44:28.915754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:44:28.915754 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:44:28.947269 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:44:28.947269 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:44:28.947269 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH monthly_revenue AS (
    SELECT 
        DATE_TRUNC('month', payment_date) AS payment_month,
        SUM(CAST(revenue AS DECIMAL)) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE 
        revenue_type = 1 
    GROUP BY 
        DATE_TRUNC('month', payment_date)
),
revenue_difference AS (
    SELECT 
        month,
        total_revenue,
        CASE
            WHEN LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY payment_month)
        END AS previous_month_revenue,
        total_revenue - 
        CASE 
            LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL
            WHEN TRUE THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY payment_month)
        END
            AS revenue_difference,
        CASE
            WHEN total_revenue - LAG(total_revenue, 1) OVER (ORDER BY payment_month) < 0 THEN 1
            ELSE 0
        END AS revenue_loss
    FROM 
        monthly_revenue
)
SELECT 
    payment_month,
    total_revenue,
    previous_month_revenue,
    (revenue_difference*(-1)) AS revenue_difference
FROM
    revenue_difference
WHERE
    revenue_loss = 1
ORDER BY 
    payment_month
        );
[0m17:44:28.947269 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:44:30.520576 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb007e-0004-c144-0005-a3d300040012
[0m17:44:30.522582 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 8
invalid identifier 'MONTH'
[0m17:44:30.524330 [debug] [Thread-1 (]: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 18 at position 8
  invalid identifier 'MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m17:44:30.526337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5348f9d8-df77-471e-9ab1-f4bfd6b94854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651E610260>]}
[0m17:44:30.526337 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.revenue_contraction ................. [[31mERROR[0m in 1.62s]
[0m17:44:30.526337 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:44:30.526337 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.revenue_contraction' to be skipped because of status 'error'.  Reason: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 18 at position 8
  invalid identifier 'MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql.
[0m17:44:30.531244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:30.531244 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:44:30.531244 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:44:31.070227 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m17:44:31.070227 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m17:44:31.581259 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:44:31.581259 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:44:32.093909 [info ] [MainThread]: 
[0m17:44:32.093909 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.48 seconds (7.48s).
[0m17:44:32.093909 [debug] [MainThread]: Command end result
[0m17:44:32.127424 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:44:32.130390 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:44:32.135933 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:44:32.135933 [info ] [MainThread]: 
[0m17:44:32.135933 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:44:32.135933 [info ] [MainThread]: 
[0m17:44:32.135933 [error] [MainThread]:   Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 18 at position 8
  invalid identifier 'MONTH'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m17:44:32.145750 [info ] [MainThread]: 
[0m17:44:32.146756 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:44:32.147754 [debug] [MainThread]: Command `dbt run` failed at 17:44:32.147754 after 8.92 seconds
[0m17:44:32.147754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651CEA8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651F12D6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002651C405C40>]}
[0m17:44:32.148779 [debug] [MainThread]: Flushing usage events
[0m17:44:34.729378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:06.836603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE7284CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE6D5A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE7286CC0>]}


============================== 17:45:06.836603 | 73dd70fa-f765-4638-9ed0-0c1896c93494 ==============================
[0m17:45:06.836603 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:45:06.852239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'send_anonymous_usage_stats': 'True'}
[0m17:45:07.310265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73dd70fa-f765-4638-9ed0-0c1896c93494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE80047D0>]}
[0m17:45:07.370893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73dd70fa-f765-4638-9ed0-0c1896c93494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE6C0A720>]}
[0m17:45:07.370893 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:45:07.737605 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:45:07.919946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:45:07.919946 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m17:45:08.159009 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:45:08.178797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73dd70fa-f765-4638-9ed0-0c1896c93494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE8025970>]}
[0m17:45:08.245417 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:45:08.262051 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:45:08.294241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73dd70fa-f765-4638-9ed0-0c1896c93494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE9568E60>]}
[0m17:45:08.294809 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:45:08.294809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73dd70fa-f765-4638-9ed0-0c1896c93494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE92372C0>]}
[0m17:45:08.296817 [info ] [MainThread]: 
[0m17:45:08.296817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:08.296817 [info ] [MainThread]: 
[0m17:45:08.298823 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:45:08.298823 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:45:08.395369 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:45:08.395369 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:45:08.395369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:10.381074 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.984 seconds
[0m17:45:10.387085 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m17:45:10.397005 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:45:10.398061 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:45:10.398061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:11.878896 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.485 seconds
[0m17:45:11.883663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m17:45:11.887675 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:45:11.887675 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:45:12.234697 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.347 seconds
[0m17:45:12.234697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m17:45:12.286456 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:45:12.286456 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:45:12.644262 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.369 seconds
[0m17:45:12.644262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73dd70fa-f765-4638-9ed0-0c1896c93494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE9499700>]}
[0m17:45:12.660241 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:45:12.660241 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m17:45:12.660241 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m17:45:12.660241 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:45:12.660241 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:45:12.660241 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:45:12.700008 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:45:12.700008 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:45:12.700008 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH monthly_revenue AS (
    SELECT 
        DATE_TRUNC('month', payment_date) AS payment_month,
        SUM(CAST(revenue AS DECIMAL)) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE 
        revenue_type = 1 
    GROUP BY 
        DATE_TRUNC('month', payment_date)
),
revenue_difference AS (
    SELECT 
        payment_month,
        total_revenue,
        CASE
            WHEN LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY payment_month)
        END AS previous_month_revenue,
        total_revenue - 
        CASE 
            LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL
            WHEN TRUE THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY payment_month)
        END
            AS revenue_difference,
        CASE
            WHEN total_revenue - LAG(total_revenue, 1) OVER (ORDER BY payment_month) < 0 THEN 1
            ELSE 0
        END AS revenue_loss
    FROM 
        monthly_revenue
)
SELECT 
    payment_month,
    total_revenue,
    previous_month_revenue,
    (revenue_difference*(-1)) AS revenue_difference
FROM
    revenue_difference
WHERE
    revenue_loss = 1
ORDER BY 
    payment_month
        );
[0m17:45:12.700008 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:45:15.797915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.098 seconds
[0m17:45:15.829662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73dd70fa-f765-4638-9ed0-0c1896c93494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE463D970>]}
[0m17:45:15.829662 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 3.17s]
[0m17:45:15.829662 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:45:15.829662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:15.829662 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:45:15.829662 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:45:16.347436 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m17:45:16.357788 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m17:45:16.864650 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:45:16.864650 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:45:17.404269 [info ] [MainThread]: 
[0m17:45:17.409266 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.11 seconds (9.11s).
[0m17:45:17.409266 [debug] [MainThread]: Command end result
[0m17:45:17.427859 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:45:17.437233 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:45:17.445264 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:45:17.445264 [info ] [MainThread]: 
[0m17:45:17.448390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:17.449380 [info ] [MainThread]: 
[0m17:45:17.449380 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:45:17.449380 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:17.449380 after 10.77 seconds
[0m17:45:17.449380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE6C36A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE72A1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE72A2810>]}
[0m17:45:17.449380 [debug] [MainThread]: Flushing usage events
[0m17:45:18.356089 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:46:01.475098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001482B6D4E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001482B6D5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001482B6D5A00>]}


============================== 17:46:01.481500 | e0ef0a6e-7eb3-4324-8ba2-aefd69e18f3d ==============================
[0m17:46:01.481500 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:46:01.481500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:46:01.952449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0ef0a6e-7eb3-4324-8ba2-aefd69e18f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001482B59E330>]}
[0m17:46:02.017036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0ef0a6e-7eb3-4324-8ba2-aefd69e18f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001482AC15C70>]}
[0m17:46:02.017601 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:46:02.405725 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:46:02.616236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:46:02.616236 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m17:46:02.866298 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:46:02.890112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0ef0a6e-7eb3-4324-8ba2-aefd69e18f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001482ABBAF00>]}
[0m17:46:02.970280 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:46:02.984679 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:46:03.014105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0ef0a6e-7eb3-4324-8ba2-aefd69e18f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001482D975F70>]}
[0m17:46:03.014105 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:46:03.015074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0ef0a6e-7eb3-4324-8ba2-aefd69e18f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001482D9D3F20>]}
[0m17:46:03.015954 [info ] [MainThread]: 
[0m17:46:03.015954 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:03.015954 [info ] [MainThread]: 
[0m17:46:03.015954 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:46:03.015954 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:46:03.116950 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:46:03.117991 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:46:03.117991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:04.981870 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.878 seconds
[0m17:46:04.997586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m17:46:04.997586 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:46:04.997586 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:46:04.997586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:06.600140 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.586 seconds
[0m17:46:06.602148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m17:46:06.606156 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:46:06.606156 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:46:06.966732 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.362 seconds
[0m17:46:06.972674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m17:46:07.027616 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:46:07.029625 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:46:07.391943 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.366 seconds
[0m17:46:07.391943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0ef0a6e-7eb3-4324-8ba2-aefd69e18f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001482DEE4AA0>]}
[0m17:46:07.391943 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:46:07.391943 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m17:46:07.404911 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m17:46:07.404911 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:46:07.404911 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:46:07.404911 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:46:07.443482 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:46:07.443482 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:46:07.443482 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH monthly_revenue AS (
    SELECT 
        DATE_TRUNC('month', payment_date) AS payment_month,
        SUM(CAST(revenue AS DECIMAL)) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE 
        revenue_type = 1 
    GROUP BY 
        DATE_TRUNC('month', payment_date)
),
revenue_difference AS (
    SELECT 
        payment_month,
        total_revenue,
        CASE
            WHEN LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY payment_month)
        END AS previous_month_revenue,
        total_revenue - 
        CASE 
            LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL
            WHEN TRUE THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY payment_month)
        END
            AS revenue_difference,
        CASE
            WHEN total_revenue - LAG(total_revenue, 1) OVER (ORDER BY payment_month) < 0 THEN 1
            ELSE 0
        END AS revenue_loss
    FROM 
        monthly_revenue
)
SELECT 
    payment_month,
    total_revenue,
    previous_month_revenue,
    (revenue_difference*(-1)) AS revenue_difference,
    revenue_loss
FROM
    revenue_difference
ORDER BY 
    payment_month
        );
[0m17:46:07.443482 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:46:09.902632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.451 seconds
[0m17:46:09.918740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0ef0a6e-7eb3-4324-8ba2-aefd69e18f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001482AB80770>]}
[0m17:46:09.918740 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.51s]
[0m17:46:09.918740 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:46:09.918740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:09.918740 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:46:09.918740 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:46:10.461992 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m17:46:10.462574 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m17:46:11.024267 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:46:11.024267 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:46:11.543532 [info ] [MainThread]: 
[0m17:46:11.543532 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.53 seconds (8.53s).
[0m17:46:11.543532 [debug] [MainThread]: Command end result
[0m17:46:11.571357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:46:11.579689 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:46:11.583068 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:46:11.583068 [info ] [MainThread]: 
[0m17:46:11.583068 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:46:11.583068 [info ] [MainThread]: 
[0m17:46:11.583068 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:46:11.583068 [debug] [MainThread]: Command `dbt run` succeeded at 17:46:11.583068 after 10.30 seconds
[0m17:46:11.592255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014829476660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001482B0C8770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014828DDEF60>]}
[0m17:46:11.592255 [debug] [MainThread]: Flushing usage events
[0m17:46:12.952044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:54.199358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EFCE99D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268F254CD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268EF26AC90>]}


============================== 17:49:54.200974 | 7c8075c0-d3e8-489c-bc47-1dc0460f7387 ==============================
[0m17:49:54.200974 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:49:54.200974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:49:54.697183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c8075c0-d3e8-489c-bc47-1dc0460f7387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268F22F98E0>]}
[0m17:49:54.764041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c8075c0-d3e8-489c-bc47-1dc0460f7387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268F3777110>]}
[0m17:49:54.764041 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:49:55.136899 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:49:55.331362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:49:55.331362 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m17:49:55.598269 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:49:55.598269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c8075c0-d3e8-489c-bc47-1dc0460f7387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268F35CB920>]}
[0m17:49:55.696994 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:49:55.700052 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:49:55.715511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c8075c0-d3e8-489c-bc47-1dc0460f7387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268F4CD8DA0>]}
[0m17:49:55.715511 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:49:55.715511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c8075c0-d3e8-489c-bc47-1dc0460f7387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268F4CE8800>]}
[0m17:49:55.729930 [info ] [MainThread]: 
[0m17:49:55.729930 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:49:55.729930 [info ] [MainThread]: 
[0m17:49:55.729930 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:49:55.729930 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:49:55.829557 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:49:55.830556 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:49:55.830556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:58.967809 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.148 seconds
[0m17:49:58.982798 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m17:49:58.994230 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:49:58.994230 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:49:58.994230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:00.598816 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.606 seconds
[0m17:50:00.598816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m17:50:00.598816 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:50:00.598816 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:50:00.989692 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.382 seconds
[0m17:50:00.991696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m17:50:01.040795 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:50:01.040795 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:50:01.372374 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.336 seconds
[0m17:50:01.383149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c8075c0-d3e8-489c-bc47-1dc0460f7387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268F516D9D0>]}
[0m17:50:01.388039 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:50:01.388039 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m17:50:01.388039 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m17:50:01.388039 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:50:01.388039 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:50:01.388039 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:50:01.431814 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:50:01.431814 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:50:01.431814 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
WITH monthly_revenue AS (
    SELECT 
        DATE_TRUNC('month', payment_date) AS payment_month,
        SUM(CAST(revenue AS DECIMAL)) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE 
        revenue_type = 1 
    GROUP BY 
        DATE_TRUNC('month', payment_date)
),
revenue_difference AS (
    SELECT 
        payment_month,
        total_revenue,
        CASE
            WHEN LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY payment_month)
        END AS previous_month_revenue,
        total_revenue - 
        CASE 
            LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL
            WHEN TRUE THEN 0
            ELSE LAG(total_revenue, 1) OVER (ORDER BY payment_month)
        END
            AS revenue_difference,
        CASE
            WHEN total_revenue - LAG(total_revenue, 1) OVER (ORDER BY payment_month) < 0 THEN 1
            ELSE 0
        END AS revenue_loss
    FROM 
        monthly_revenue
)
SELECT 
    payment_month,
    total_revenue,
    previous_month_revenue,
    revenue_difference,
    revenue_loss
FROM
    revenue_difference
ORDER BY 
    payment_month
        );
[0m17:50:01.431814 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:03.946225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.515 seconds
[0m17:50:03.962312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c8075c0-d3e8-489c-bc47-1dc0460f7387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268F1EF0800>]}
[0m17:50:03.962312 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.57s]
[0m17:50:03.977953 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:50:03.977953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:03.977953 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:50:03.977953 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:50:04.526318 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m17:50:04.526318 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m17:50:05.075843 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:50:05.075843 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:50:05.592355 [info ] [MainThread]: 
[0m17:50:05.592355 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.86 seconds (9.86s).
[0m17:50:05.592355 [debug] [MainThread]: Command end result
[0m17:50:05.624240 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:50:05.627260 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:50:05.630240 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:50:05.630240 [info ] [MainThread]: 
[0m17:50:05.630240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:05.630240 [info ] [MainThread]: 
[0m17:50:05.630240 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:50:05.630240 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:05.630240 after 11.69 seconds
[0m17:50:05.630240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268F29E7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268F4D25550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268F47A4E30>]}
[0m17:50:05.630240 [debug] [MainThread]: Flushing usage events
[0m17:50:06.659027 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:12.994355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC0D43290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC0D43AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC0D43E60>]}


============================== 17:51:12.994355 | 41f2ca7a-83fb-45a1-9246-b8f81390b833 ==============================
[0m17:51:12.994355 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:51:12.994355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:51:13.467769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41f2ca7a-83fb-45a1-9246-b8f81390b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC2FC6180>]}
[0m17:51:13.545420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41f2ca7a-83fb-45a1-9246-b8f81390b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC14A03B0>]}
[0m17:51:13.545420 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:51:13.900141 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:51:14.093065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:51:14.093065 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m17:51:14.346000 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m17:51:14.366772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41f2ca7a-83fb-45a1-9246-b8f81390b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC1DBAF00>]}
[0m17:51:14.448308 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:51:14.452308 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:51:14.480931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41f2ca7a-83fb-45a1-9246-b8f81390b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC3505D60>]}
[0m17:51:14.480931 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m17:51:14.480931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41f2ca7a-83fb-45a1-9246-b8f81390b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC33B20F0>]}
[0m17:51:14.480931 [info ] [MainThread]: 
[0m17:51:14.480931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:14.480931 [info ] [MainThread]: 
[0m17:51:14.480931 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:51:14.480931 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m17:51:14.581658 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m17:51:14.581658 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m17:51:14.581658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:16.558500 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.971 seconds
[0m17:51:16.564794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m17:51:16.574518 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m17:51:16.574518 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m17:51:16.575516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:18.171747 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.597 seconds
[0m17:51:18.173747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m17:51:18.177747 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m17:51:18.178745 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m17:51:18.575703 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.407 seconds
[0m17:51:18.575703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m17:51:18.623557 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m17:51:18.623557 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m17:51:19.060813 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.424 seconds
[0m17:51:19.064386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41f2ca7a-83fb-45a1-9246-b8f81390b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BABE6536E0>]}
[0m17:51:19.068007 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m17:51:19.069007 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m17:51:19.070304 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m17:51:19.070304 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m17:51:19.078217 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m17:51:19.079923 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m17:51:19.104237 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m17:51:19.104237 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m17:51:19.115181 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (
 
-- WITH monthly_revenue AS (
--     SELECT 
--         DATE_TRUNC('month', payment_date) AS payment_month,
--         SUM(CAST(revenue AS DECIMAL)) AS total_revenue
--     FROM 
--         HEALTHCARE.stage.stg_transactions
--     WHERE 
--         revenue_type = 1 
--     GROUP BY 
--         DATE_TRUNC('month', payment_date)
-- ),
-- revenue_difference AS (
--     SELECT 
--         payment_month,
--         total_revenue,
--         CASE
--             WHEN LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL THEN 0
--             ELSE LAG(total_revenue, 1) OVER (ORDER BY payment_month)
--         END AS previous_month_revenue,
--         total_revenue - 
--         CASE 
--             LAG(total_revenue, 1) OVER (ORDER BY payment_month) IS NULL
--             WHEN TRUE THEN 0
--             ELSE LAG(total_revenue, 1) OVER (ORDER BY payment_month)
--         END
--             AS revenue_difference,
--         CASE
--             WHEN total_revenue - LAG(total_revenue, 1) OVER (ORDER BY payment_month) < 0 THEN 1
--             ELSE 0
--         END AS revenue_loss
--     FROM 
--         monthly_revenue
-- )
-- SELECT 
--     payment_month,
--     total_revenue,
--     previous_month_revenue,
--     revenue_difference,
--     revenue_loss
-- FROM
--     revenue_difference
-- ORDER BY 
--     payment_month

 
with c1 as (
    select
        date_trunc('MONTH', payment_date) pay_month,
        sum(revenue*quantity) as revenuepmonth,
        lag(revenuepmonth) over (order by pay_month) as revenuelag
    from HEALTHCARE.stage.stg_transactions
    group by pay_month
),
c2 as (
    select pay_month, revenuepmonth, coalesce(revenuelag, 0) revenuelag from c1
),
c3 as (
    select
        pay_month,
        revenuepmonth,
        revenuelag,
        (revenuepmonth - revenuelag) as contraction
    from c2
    where revenuelag > revenuepmonth
)
select * from c3
        );
[0m17:51:19.116243 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:51:21.387725 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.272 seconds
[0m17:51:21.410511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41f2ca7a-83fb-45a1-9246-b8f81390b833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BABE5BD8B0>]}
[0m17:51:21.412515 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.34s]
[0m17:51:21.412515 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m17:51:21.414520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:21.414520 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m17:51:21.414520 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m17:51:21.951637 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m17:51:21.951637 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m17:51:22.486069 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m17:51:22.486069 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m17:51:23.002292 [info ] [MainThread]: 
[0m17:51:23.002292 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.52 seconds (8.52s).
[0m17:51:23.002292 [debug] [MainThread]: Command end result
[0m17:51:23.038706 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m17:51:23.040339 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m17:51:23.040339 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m17:51:23.040339 [info ] [MainThread]: 
[0m17:51:23.040339 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:23.050996 [info ] [MainThread]: 
[0m17:51:23.052003 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:51:23.054012 [debug] [MainThread]: Command `dbt run` succeeded at 17:51:23.053012 after 10.25 seconds
[0m17:51:23.056045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC0D7FC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BABDC04DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAC342B440>]}
[0m17:51:23.056045 [debug] [MainThread]: Flushing usage events
[0m17:51:24.202857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:00:21.096448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861E7CBCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861E7C82C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861E7C9400>]}


============================== 18:00:21.096448 | 16cc6058-04d3-4c9a-b1a9-b2fd9797e0c6 ==============================
[0m18:00:21.096448 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:00:21.096448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:21.603748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16cc6058-04d3-4c9a-b1a9-b2fd9797e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018620596810>]}
[0m18:00:21.674325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16cc6058-04d3-4c9a-b1a9-b2fd9797e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861F507950>]}
[0m18:00:21.676619 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:00:22.134748 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:00:23.463209 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:23.463209 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m18:00:23.700311 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:00:23.716329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16cc6058-04d3-4c9a-b1a9-b2fd9797e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018620B328D0>]}
[0m18:00:23.791195 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:00:23.819784 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:00:23.838708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16cc6058-04d3-4c9a-b1a9-b2fd9797e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018620ACA2D0>]}
[0m18:00:23.838708 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:00:23.838708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16cc6058-04d3-4c9a-b1a9-b2fd9797e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186206258B0>]}
[0m18:00:23.838708 [info ] [MainThread]: 
[0m18:00:23.854500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:23.854500 [info ] [MainThread]: 
[0m18:00:23.854500 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:23.854500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:00:26.459616 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:00:26.459616 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:00:26.459616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:28.562393 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.103 seconds
[0m18:00:28.562393 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m18:00:28.583779 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:00:28.583779 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:00:28.583779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:30.196058 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.617 seconds
[0m18:00:30.204439 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m18:00:30.207452 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:00:30.207452 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:00:30.570741 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.364 seconds
[0m18:00:30.572750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m18:00:30.624942 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:00:30.624942 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:00:31.041620 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.417 seconds
[0m18:00:31.043625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16cc6058-04d3-4c9a-b1a9-b2fd9797e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861BC638F0>]}
[0m18:00:31.043625 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m18:00:31.043625 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m18:00:31.043625 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m18:00:31.043625 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m18:00:31.053432 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m18:00:31.053432 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m18:00:31.081984 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m18:00:31.081984 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m18:00:31.081984 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (

WITH cte_prev_revenue AS (
    SELECT
        date_trunc('MONTH', payment_date) pay_month,
        sum(revenue*quantity) AS revenue_month,
        lag(revenue_month) over (order by pay_month) as revenue_lag
    
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE   
        revenue_type = 1
    GROUP BY
         pay_month
),
cte_handle_null AS (
    SELECT
        pay_month, 
        revenue_month, 
        coalesce(revenue_lag, 0) AS revenuelag 
    FROM 
        cte_prev_revenue
),
cte_revenue_loss AS(
    SELECT
        pay_month,
        revenue_month,
        revenuelag,
        (revenue_month - revenuelag)*(-1) as revenue_loss
    FROM 
        cte_handle_null
    WHERE 
        revenuelag > revenue_month

)
SELECT * FROM cte_revenue_loss
        );
[0m18:00:31.081984 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:00:33.399292 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.309 seconds
[0m18:00:33.433005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16cc6058-04d3-4c9a-b1a9-b2fd9797e0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018620B47710>]}
[0m18:00:33.433005 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.39s]
[0m18:00:33.433005 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m18:00:33.433005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:33.433005 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:00:33.433005 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:00:33.963751 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m18:00:33.963751 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m18:00:34.496707 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m18:00:34.496707 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m18:00:35.035300 [info ] [MainThread]: 
[0m18:00:35.036352 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.18 seconds (11.18s).
[0m18:00:35.036352 [debug] [MainThread]: Command end result
[0m18:00:35.071921 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:00:35.075807 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:00:35.078765 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:00:35.078765 [info ] [MainThread]: 
[0m18:00:35.078765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:35.078765 [info ] [MainThread]: 
[0m18:00:35.086668 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:00:35.088709 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:35.088709 after 14.23 seconds
[0m18:00:35.088709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861E29CCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861BAD5D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001861BAD5D90>]}
[0m18:00:35.089676 [debug] [MainThread]: Flushing usage events
[0m18:00:36.286672 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:44.753970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A84C19250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A848C2570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A84C19AC0>]}


============================== 18:01:44.758505 | 01199549-cd67-4a11-ad78-1cb4db1844b8 ==============================
[0m18:01:44.758505 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:01:44.759505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:01:45.233421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01199549-cd67-4a11-ad78-1cb4db1844b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A84161F70>]}
[0m18:01:45.293818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01199549-cd67-4a11-ad78-1cb4db1844b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A85B1A2D0>]}
[0m18:01:45.295937 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:01:45.656625 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:01:45.873414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:01:45.873414 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m18:01:46.157826 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:01:46.172017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01199549-cd67-4a11-ad78-1cb4db1844b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A87002900>]}
[0m18:01:46.257495 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:01:46.261495 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:01:46.293112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01199549-cd67-4a11-ad78-1cb4db1844b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A86D8B170>]}
[0m18:01:46.293112 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:01:46.294142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01199549-cd67-4a11-ad78-1cb4db1844b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A86E44BF0>]}
[0m18:01:46.295141 [info ] [MainThread]: 
[0m18:01:46.296145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:01:46.297110 [info ] [MainThread]: 
[0m18:01:46.297110 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:01:46.298616 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:01:46.393405 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:01:46.393405 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:01:46.393405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:48.386283 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.997 seconds
[0m18:01:48.386283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m18:01:48.408801 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:01:48.408801 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:01:48.408801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:49.970850 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.561 seconds
[0m18:01:49.970850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m18:01:49.970850 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:01:49.970850 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:01:50.323128 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.345 seconds
[0m18:01:50.326181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m18:01:50.373716 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:01:50.373716 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:01:50.745840 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.377 seconds
[0m18:01:50.745840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01199549-cd67-4a11-ad78-1cb4db1844b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A820AFAD0>]}
[0m18:01:50.745840 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m18:01:50.745840 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m18:01:50.761520 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m18:01:50.761520 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m18:01:50.761520 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m18:01:50.761520 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m18:01:50.796352 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m18:01:50.796352 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m18:01:50.796352 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (

WITH cte_prev_revenue AS (
    SELECT
        date_trunc('MONTH', payment_date) pay_month,
        sum(revenue*quantity) AS revenue_month,
        lag(revenue_month) over (order by pay_month) as revenue_lag
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE   
        revenue_type = 1
    GROUP BY
         pay_month
),
cte_handle_null AS (
    SELECT
        pay_month, 
        revenue_month, 
        coalesce(revenue_lag, 0) AS revenue_lag 
    FROM 
        cte_prev_revenue
),
cte_revenue_loss AS(
    SELECT
        pay_month,
        revenue_month,
        revenue_lag,
        (revenue_month - revenue_lag)*(-1) as revenue_loss
    FROM 
        cte_handle_null
    WHERE 
        revenuelag > revenue_month

)
SELECT * FROM cte_revenue_loss
        );
[0m18:01:50.796352 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:52.518432 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb008f-0004-bb9d-0005-a3d30003d51a
[0m18:01:52.518432 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 34 at position 8
invalid identifier 'REVENUELAG'
[0m18:01:52.536364 [debug] [Thread-1 (]: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 34 at position 8
  invalid identifier 'REVENUELAG'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m18:01:52.545084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01199549-cd67-4a11-ad78-1cb4db1844b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A86DA7530>]}
[0m18:01:52.545084 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.revenue_contraction ................. [[31mERROR[0m in 1.77s]
[0m18:01:52.548094 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m18:01:52.549093 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.revenue_contraction' to be skipped because of status 'error'.  Reason: Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 34 at position 8
  invalid identifier 'REVENUELAG'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql.
[0m18:01:52.550093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:52.551124 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:01:52.551124 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:01:53.080101 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m18:01:53.080101 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m18:01:53.627685 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m18:01:53.627685 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m18:01:54.175785 [info ] [MainThread]: 
[0m18:01:54.177404 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m18:01:54.177404 [debug] [MainThread]: Command end result
[0m18:01:54.203407 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:01:54.206492 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:01:54.206492 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:01:54.206492 [info ] [MainThread]: 
[0m18:01:54.213354 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:01:54.214363 [info ] [MainThread]: 
[0m18:01:54.215368 [error] [MainThread]:   Database Error in model revenue_contraction (models\Mart\revenue_contraction.sql)
  000904 (42000): SQL compilation error: error line 34 at position 8
  invalid identifier 'REVENUELAG'
  compiled code at target\run\dbt_first\models\Mart\revenue_contraction.sql
[0m18:01:54.216377 [info ] [MainThread]: 
[0m18:01:54.217051 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:01:54.217051 [debug] [MainThread]: Command `dbt run` failed at 18:01:54.217051 after 9.64 seconds
[0m18:01:54.219534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AFF4910D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A829D66F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A829D6750>]}
[0m18:01:54.220110 [debug] [MainThread]: Flushing usage events
[0m18:01:55.580602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:02:06.078270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39DC64770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39DC657F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39DC65850>]}


============================== 18:02:06.078270 | 62031695-9b5d-4aac-b93a-b70ff4fe5544 ==============================
[0m18:02:06.078270 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:02:06.078270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:02:06.544672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62031695-9b5d-4aac-b93a-b70ff4fe5544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39E9C7DD0>]}
[0m18:02:06.607633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62031695-9b5d-4aac-b93a-b70ff4fe5544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39D77D040>]}
[0m18:02:06.607633 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:02:06.953274 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:02:07.126919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:02:07.126919 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m18:02:07.376969 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:02:07.376969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62031695-9b5d-4aac-b93a-b70ff4fe5544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39FF72750>]}
[0m18:02:07.468425 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:02:07.472363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:02:07.501884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62031695-9b5d-4aac-b93a-b70ff4fe5544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39FF0A1B0>]}
[0m18:02:07.501884 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:02:07.501884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62031695-9b5d-4aac-b93a-b70ff4fe5544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39FBD8740>]}
[0m18:02:07.501884 [info ] [MainThread]: 
[0m18:02:07.501884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:07.501884 [info ] [MainThread]: 
[0m18:02:07.501884 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:02:07.501884 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:02:07.603112 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:02:07.604112 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:02:07.604112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:09.640739 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.038 seconds
[0m18:02:09.640739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m18:02:09.656518 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:02:09.656518 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:02:09.656518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:11.253255 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.595 seconds
[0m18:02:11.253255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m18:02:11.253255 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:02:11.253255 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:02:11.579979 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.316 seconds
[0m18:02:11.581743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m18:02:11.631354 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:02:11.631354 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:02:11.946852 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.313 seconds
[0m18:02:11.956756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62031695-9b5d-4aac-b93a-b70ff4fe5544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A3A03E4AA0>]}
[0m18:02:11.964862 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m18:02:11.964862 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m18:02:11.964862 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m18:02:11.964862 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m18:02:11.986672 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m18:02:11.986672 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m18:02:12.017039 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m18:02:12.017039 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m18:02:12.017039 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (

WITH cte_prev_revenue AS (
    SELECT
        date_trunc('MONTH', payment_date) pay_month,
        sum(revenue*quantity) AS revenue_month,
        lag(revenue_month) over (order by pay_month) as revenue_lag
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE   
        revenue_type = 1
    GROUP BY
         pay_month
),
cte_handle_null AS (
    SELECT
        pay_month, 
        revenue_month, 
        coalesce(revenue_lag, 0) AS revenue_lag 
    FROM 
        cte_prev_revenue
),
cte_revenue_loss AS(
    SELECT
        pay_month,
        revenue_month,
        revenue_lag,
        (revenue_month - revenue_lag)*(-1) as revenue_loss
    FROM 
        cte_handle_null
    WHERE 
        revenue_lag > revenue_month

)
SELECT * FROM cte_revenue_loss
        );
[0m18:02:12.017039 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:02:14.313923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.287 seconds
[0m18:02:14.329710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62031695-9b5d-4aac-b93a-b70ff4fe5544', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39B00D940>]}
[0m18:02:14.329710 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.36s]
[0m18:02:14.329710 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m18:02:14.329710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:14.329710 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:02:14.329710 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:02:14.900865 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m18:02:14.900865 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m18:02:15.436217 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m18:02:15.436217 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m18:02:15.963362 [info ] [MainThread]: 
[0m18:02:15.963362 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.46 seconds (8.46s).
[0m18:02:15.963362 [debug] [MainThread]: Command end result
[0m18:02:15.991119 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:02:15.992143 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:02:15.997428 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:02:15.999435 [info ] [MainThread]: 
[0m18:02:15.999435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:15.999435 [info ] [MainThread]: 
[0m18:02:16.001927 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:02:16.004358 [debug] [MainThread]: Command `dbt run` succeeded at 18:02:16.003199 after 10.08 seconds
[0m18:02:16.006030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39D0DD1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39D7A7DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A39D7A7BF0>]}
[0m18:02:16.006030 [debug] [MainThread]: Flushing usage events
[0m18:02:17.036677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:02.528009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5E5B8BAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5E58327E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5E5830320>]}


============================== 18:03:02.528009 | f40a9a0a-ae7e-4187-b229-a24083013af6 ==============================
[0m18:03:02.528009 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:03:02.528009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:FISCAL', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:03:02.982507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f40a9a0a-ae7e-4187-b229-a24083013af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5E2F2EB40>]}
[0m18:03:03.046256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f40a9a0a-ae7e-4187-b229-a24083013af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5E67AE8D0>]}
[0m18:03:03.046256 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:03:03.412466 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:03:03.580622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:03:03.580622 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:03:03.580622 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:03:03.630533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f40a9a0a-ae7e-4187-b229-a24083013af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5E7C2BFB0>]}
[0m18:03:03.700819 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:03:03.700819 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:03:03.730120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f40a9a0a-ae7e-4187-b229-a24083013af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5E7DEBF80>]}
[0m18:03:03.730120 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:03:03.730120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f40a9a0a-ae7e-4187-b229-a24083013af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5E69C6720>]}
[0m18:03:03.730120 [info ] [MainThread]: 
[0m18:03:03.730120 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:03:03.730120 [info ] [MainThread]: 
[0m18:03:03.745954 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:03:03.745954 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:03:03.849689 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:03:03.849689 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:03:03.849689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:05.753659 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.903 seconds
[0m18:03:05.753659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m18:03:05.765134 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:03:05.765134 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:03:05.765134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:07.268004 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.499 seconds
[0m18:03:07.268004 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m18:03:07.268004 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:03:07.268004 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:03:07.625286 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.361 seconds
[0m18:03:07.625286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m18:03:07.625286 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:03:07.642032 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:03:07.980124 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.348 seconds
[0m18:03:07.980124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f40a9a0a-ae7e-4187-b229-a24083013af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5E2FBF680>]}
[0m18:03:07.995827 [debug] [Thread-1 (]: Began running node model.dbt_first.new_logo_each_fiscal
[0m18:03:07.995827 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.new_logo_each_fiscal ......................... [RUN]
[0m18:03:07.995827 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.new_logo_each_fiscal'
[0m18:03:07.995827 [debug] [Thread-1 (]: Began compiling node model.dbt_first.new_logo_each_fiscal
[0m18:03:07.995827 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.new_logo_each_fiscal"
[0m18:03:07.995827 [debug] [Thread-1 (]: Began executing node model.dbt_first.new_logo_each_fiscal
[0m18:03:08.039991 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.new_logo_each_fiscal"
[0m18:03:08.041992 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.new_logo_each_fiscal"
[0m18:03:08.041992 [debug] [Thread-1 (]: On model.dbt_first.new_logo_each_fiscal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.new_logo_each_fiscal"} */
create or replace transient table HEALTHCARE.mart.new_logo_each_fiscal
         as
        (

-- WITH cte_first_purchase AS (
--     SELECT
--         customer_id,
--         MIN(payment_date) AS first_purchase_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
--     GROUP BY
--         customer_id
-- ),
 
-- cte_extract_year AS (
--     SELECT
--         customer_id,
--         EXTRACT(YEAR FROM first_purchase_date) AS fiscal_year
--     FROM
--         cte_first_purchase
-- )
 
-- SELECT
--     fiscal_year,
--     COUNT(DISTINCT customer_id) AS new_logos
-- FROM
--     cte_extract_year
-- GROUP BY
--     fiscal_year
-- ORDER BY
--     fiscal_year

with add_fy as(
    select
        trans.customer_id,
        custs.customername,
        trans.payment_date,
        (case
            WHEN MONTH(trans.payment_date) >= 4 THEN YEAR(trans.payment_date)
            ELSE YEAR(trans.payment_date) - 1
        end) as fiscal_year,
        trans.revenue,
        trans.revenue_type
    from HEALTHCARE.stage.stg_transactions trans                                                                              
    left join HEALTHCARE.stage.stg_customers custs
    on trans.customer_id = custs.customer_id
    order by trans.payment_date
),
fy_partition as (
    select distinct
        customer_id,
        customername,
        min(payment_date) as first_in_fy,
        fiscal_year,
        row_number() over(partition by customername, customer_id order by first_in_fy) as uid
    from add_fy
    group by fiscal_year, customer_id, customername
    order by customername
),
new_in_fy as (
    select
        customer_id,
        customername,
        first_in_fy,
        fiscal_year
    from fy_partition
    where uid = 1
)
select * from new_in_fy
order by fiscal_year
        );
[0m18:03:08.043534 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:03:09.597601 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0091-0004-bb9f-0005-a3d30003c64e
[0m18:03:09.597601 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 36 at position 8
invalid identifier 'CUSTS.CUSTOMERNAME'
[0m18:03:09.597601 [debug] [Thread-1 (]: Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  000904 (42000): SQL compilation error: error line 36 at position 8
  invalid identifier 'CUSTS.CUSTOMERNAME'
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql
[0m18:03:09.597601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f40a9a0a-ae7e-4187-b229-a24083013af6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5E50307D0>]}
[0m18:03:09.597601 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.new_logo_each_fiscal ................ [[31mERROR[0m in 1.60s]
[0m18:03:09.597601 [debug] [Thread-1 (]: Finished running node model.dbt_first.new_logo_each_fiscal
[0m18:03:09.597601 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.new_logo_each_fiscal' to be skipped because of status 'error'.  Reason: Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  000904 (42000): SQL compilation error: error line 36 at position 8
  invalid identifier 'CUSTS.CUSTOMERNAME'
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql.
[0m18:03:09.597601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:09.597601 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:03:09.597601 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:03:10.146708 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m18:03:10.146708 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m18:03:10.697229 [debug] [MainThread]: Connection 'model.dbt_first.new_logo_each_fiscal' was left open.
[0m18:03:10.697229 [debug] [MainThread]: On model.dbt_first.new_logo_each_fiscal: Close
[0m18:03:11.247055 [info ] [MainThread]: 
[0m18:03:11.247055 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.50 seconds (7.50s).
[0m18:03:11.262518 [debug] [MainThread]: Command end result
[0m18:03:11.284265 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:03:11.285232 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:03:11.294058 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:03:11.295022 [info ] [MainThread]: 
[0m18:03:11.296029 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:03:11.296627 [info ] [MainThread]: 
[0m18:03:11.297634 [error] [MainThread]:   Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  000904 (42000): SQL compilation error: error line 36 at position 8
  invalid identifier 'CUSTS.CUSTOMERNAME'
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql
[0m18:03:11.297634 [info ] [MainThread]: 
[0m18:03:11.298632 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:03:11.298632 [debug] [MainThread]: Command `dbt run` failed at 18:03:11.298632 after 8.93 seconds
[0m18:03:11.298632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5E4FE4E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5E569C440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5E569DDC0>]}
[0m18:03:11.298632 [debug] [MainThread]: Flushing usage events
[0m18:03:12.590719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:10.162840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A28C298B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A28C290D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A28C287A0>]}


============================== 18:04:10.173888 | 463d233a-69aa-49b6-a25d-3fc8ec6e36e4 ==============================
[0m18:04:10.173888 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:04:10.173888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:FISCAL', 'send_anonymous_usage_stats': 'True'}
[0m18:04:10.617951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '463d233a-69aa-49b6-a25d-3fc8ec6e36e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A28C3A210>]}
[0m18:04:10.681268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '463d233a-69aa-49b6-a25d-3fc8ec6e36e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A2873EFC0>]}
[0m18:04:10.681268 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:04:11.026124 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:04:11.215462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:11.215462 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\new_logo_each_fiscal.sql
[0m18:04:11.448156 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:04:11.469802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '463d233a-69aa-49b6-a25d-3fc8ec6e36e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A2AF62630>]}
[0m18:04:11.549211 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:04:11.549211 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:04:11.580987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '463d233a-69aa-49b6-a25d-3fc8ec6e36e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A2AF05D30>]}
[0m18:04:11.580987 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:04:11.580987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '463d233a-69aa-49b6-a25d-3fc8ec6e36e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A2ADA4C80>]}
[0m18:04:11.580987 [info ] [MainThread]: 
[0m18:04:11.580987 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:11.580987 [info ] [MainThread]: 
[0m18:04:11.580987 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:04:11.580987 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:04:11.690801 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:04:11.690801 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:04:11.690801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:13.576815 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.886 seconds
[0m18:04:13.583452 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m18:04:13.593286 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:04:13.593286 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:04:13.593286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:15.200206 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.607 seconds
[0m18:04:15.200206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m18:04:15.200206 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:04:15.200206 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:04:15.555898 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.360 seconds
[0m18:04:15.571770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m18:04:15.643222 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:04:15.643222 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:04:15.995719 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.354 seconds
[0m18:04:15.995719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '463d233a-69aa-49b6-a25d-3fc8ec6e36e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A2AF63CE0>]}
[0m18:04:15.995719 [debug] [Thread-1 (]: Began running node model.dbt_first.new_logo_each_fiscal
[0m18:04:16.011403 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.new_logo_each_fiscal ......................... [RUN]
[0m18:04:16.011403 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.new_logo_each_fiscal'
[0m18:04:16.011403 [debug] [Thread-1 (]: Began compiling node model.dbt_first.new_logo_each_fiscal
[0m18:04:16.011403 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.new_logo_each_fiscal"
[0m18:04:16.011403 [debug] [Thread-1 (]: Began executing node model.dbt_first.new_logo_each_fiscal
[0m18:04:16.054672 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.new_logo_each_fiscal"
[0m18:04:16.056712 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.new_logo_each_fiscal"
[0m18:04:16.057712 [debug] [Thread-1 (]: On model.dbt_first.new_logo_each_fiscal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.new_logo_each_fiscal"} */
create or replace transient table HEALTHCARE.mart.new_logo_each_fiscal
         as
        (

-- WITH cte_first_purchase AS (
--     SELECT
--         customer_id,
--         MIN(payment_date) AS first_purchase_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
--     GROUP BY
--         customer_id
-- ),
 
-- cte_extract_year AS (
--     SELECT
--         customer_id,
--         EXTRACT(YEAR FROM first_purchase_date) AS fiscal_year
--     FROM
--         cte_first_purchase
-- )
 
-- SELECT
--     fiscal_year,
--     COUNT(DISTINCT customer_id) AS new_logos
-- FROM
--     cte_extract_year
-- GROUP BY
--     fiscal_year
-- ORDER BY
--     fiscal_year

with add_fy as(
    select
        trans.customer_id,
        custs.customer_name,
        trans.payment_date,
        (case
            WHEN MONTH(trans.payment_date) >= 4 THEN YEAR(trans.payment_date)
            ELSE YEAR(trans.payment_date) - 1
        end) as fiscal_year,
        trans.revenue,
        trans.revenue_type
    from HEALTHCARE.stage.stg_transactions trans                                                                              
    left join HEALTHCARE.stage.stg_customers custs
    on trans.customer_id = custs.customer_id
    order by trans.payment_date
),
fy_partition as (
    select distinct
        customer_id,
        customer_name,
        min(payment_date) as first_in_fy,
        fiscal_year,
        row_number() over(partition by customername, customer_id order by first_in_fy) as uid
    from add_fy
    group by fiscal_year, customer_id, customer_name
    order by customer_name
),
new_in_fy as (
    select
        customer_id,
        customer_name,
        first_in_fy,
        fiscal_year
    from fy_partition
    where uid = 1
)
select * from new_in_fy
order by fiscal_year
        );
[0m18:04:16.057712 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:17.531045 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0092-0004-c0bd-0005-a3d30003ba5e
[0m18:04:17.531045 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 55 at position 39
invalid identifier 'CUSTOMERNAME'
[0m18:04:17.531045 [debug] [Thread-1 (]: Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  000904 (42000): SQL compilation error: error line 55 at position 39
  invalid identifier 'CUSTOMERNAME'
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql
[0m18:04:17.531045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '463d233a-69aa-49b6-a25d-3fc8ec6e36e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A2AFAA210>]}
[0m18:04:17.531045 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.new_logo_each_fiscal ................ [[31mERROR[0m in 1.52s]
[0m18:04:17.544715 [debug] [Thread-1 (]: Finished running node model.dbt_first.new_logo_each_fiscal
[0m18:04:17.544715 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.new_logo_each_fiscal' to be skipped because of status 'error'.  Reason: Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  000904 (42000): SQL compilation error: error line 55 at position 39
  invalid identifier 'CUSTOMERNAME'
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql.
[0m18:04:17.544715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:17.544715 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:04:17.544715 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:04:18.078919 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m18:04:18.078919 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m18:04:18.598539 [debug] [MainThread]: Connection 'model.dbt_first.new_logo_each_fiscal' was left open.
[0m18:04:18.598539 [debug] [MainThread]: On model.dbt_first.new_logo_each_fiscal: Close
[0m18:04:19.132349 [info ] [MainThread]: 
[0m18:04:19.132349 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.55 seconds (7.55s).
[0m18:04:19.132349 [debug] [MainThread]: Command end result
[0m18:04:19.169100 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:04:19.171099 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:04:19.178733 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:04:19.178733 [info ] [MainThread]: 
[0m18:04:19.179703 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:04:19.180559 [info ] [MainThread]: 
[0m18:04:19.180559 [error] [MainThread]:   Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  000904 (42000): SQL compilation error: error line 55 at position 39
  invalid identifier 'CUSTOMERNAME'
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql
[0m18:04:19.181729 [info ] [MainThread]: 
[0m18:04:19.181729 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:04:19.181729 [debug] [MainThread]: Command `dbt run` failed at 18:04:19.181729 after 9.18 seconds
[0m18:04:19.181729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A28BD7B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A28BD7C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A28C3AAE0>]}
[0m18:04:19.181729 [debug] [MainThread]: Flushing usage events
[0m18:04:20.182455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:46.500867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA92C38EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA92C397F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA92C38BF0>]}


============================== 18:04:46.505475 | efbc917f-b588-408b-852a-d009b816e417 ==============================
[0m18:04:46.505475 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:04:46.505475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:FISCAL', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:04:46.954188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efbc917f-b588-408b-852a-d009b816e417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA94A26450>]}
[0m18:04:47.015413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efbc917f-b588-408b-852a-d009b816e417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA92C3A990>]}
[0m18:04:47.015413 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:04:47.358242 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:04:47.547867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:47.547867 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\new_logo_each_fiscal.sql
[0m18:04:47.813443 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:04:47.813443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efbc917f-b588-408b-852a-d009b816e417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA94FC2480>]}
[0m18:04:47.903654 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:04:47.906331 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:04:47.935234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efbc917f-b588-408b-852a-d009b816e417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA94F59B50>]}
[0m18:04:47.935234 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:04:47.935234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efbc917f-b588-408b-852a-d009b816e417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA94FA44A0>]}
[0m18:04:47.940206 [info ] [MainThread]: 
[0m18:04:47.940206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:47.942213 [info ] [MainThread]: 
[0m18:04:47.942213 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:04:47.944219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:04:48.042964 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:04:48.042964 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:04:48.043964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:49.903595 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.868 seconds
[0m18:04:49.918774 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m18:04:49.918774 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:04:49.918774 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:04:49.918774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:51.523560 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.595 seconds
[0m18:04:51.523560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m18:04:51.523560 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:04:51.523560 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:04:51.850063 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.319 seconds
[0m18:04:51.852070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m18:04:51.891832 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:04:51.891832 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:04:52.265134 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.364 seconds
[0m18:04:52.265134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efbc917f-b588-408b-852a-d009b816e417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA95356510>]}
[0m18:04:52.273219 [debug] [Thread-1 (]: Began running node model.dbt_first.new_logo_each_fiscal
[0m18:04:52.273219 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.new_logo_each_fiscal ......................... [RUN]
[0m18:04:52.273219 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.new_logo_each_fiscal'
[0m18:04:52.273219 [debug] [Thread-1 (]: Began compiling node model.dbt_first.new_logo_each_fiscal
[0m18:04:52.273219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.new_logo_each_fiscal"
[0m18:04:52.273219 [debug] [Thread-1 (]: Began executing node model.dbt_first.new_logo_each_fiscal
[0m18:04:52.308237 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.new_logo_each_fiscal"
[0m18:04:52.308237 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.new_logo_each_fiscal"
[0m18:04:52.308237 [debug] [Thread-1 (]: On model.dbt_first.new_logo_each_fiscal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.new_logo_each_fiscal"} */
create or replace transient table HEALTHCARE.mart.new_logo_each_fiscal
         as
        (

-- WITH cte_first_purchase AS (
--     SELECT
--         customer_id,
--         MIN(payment_date) AS first_purchase_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
--     GROUP BY
--         customer_id
-- ),
 
-- cte_extract_year AS (
--     SELECT
--         customer_id,
--         EXTRACT(YEAR FROM first_purchase_date) AS fiscal_year
--     FROM
--         cte_first_purchase
-- )
 
-- SELECT
--     fiscal_year,
--     COUNT(DISTINCT customer_id) AS new_logos
-- FROM
--     cte_extract_year
-- GROUP BY
--     fiscal_year
-- ORDER BY
--     fiscal_year

with add_fy as(
    select
        trans.customer_id,
        custs.customer_name,
        trans.payment_date,
        (case
            WHEN MONTH(trans.payment_date) >= 4 THEN YEAR(trans.payment_date)
            ELSE YEAR(trans.payment_date) - 1
        end) as fiscal_year,
        trans.revenue,
        trans.revenue_type
    from HEALTHCARE.stage.stg_transactions trans                                                                              
    left join HEALTHCARE.stage.stg_customers custs
    on trans.customer_id = custs.customer_id
    order by trans.payment_date
),
fy_partition as (
    select distinct
        customer_id,
        customer_name,
        min(payment_date) as first_in_fy,
        fiscal_year,
        row_number() over(partition by customer_name, customer_id order by first_in_fy) as uid
    from add_fy
    group by fiscal_year, customer_id, customer_name
    order by customer_name
),
new_in_fy as (
    select
        customer_id,
        customer_name,
        first_in_fy,
        fiscal_year
    from fy_partition
    where uid = 1
)
select * from new_in_fy
order by fiscal_year
        );
[0m18:04:52.308237 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:54.914166 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.604 seconds
[0m18:04:54.945957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efbc917f-b588-408b-852a-d009b816e417', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA94E4A9C0>]}
[0m18:04:54.945957 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.new_logo_each_fiscal .................... [[32mSUCCESS 1[0m in 2.66s]
[0m18:04:54.945957 [debug] [Thread-1 (]: Finished running node model.dbt_first.new_logo_each_fiscal
[0m18:04:54.945957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:54.945957 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:04:54.945957 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:04:55.449931 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m18:04:55.465832 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m18:04:55.968558 [debug] [MainThread]: Connection 'model.dbt_first.new_logo_each_fiscal' was left open.
[0m18:04:55.968558 [debug] [MainThread]: On model.dbt_first.new_logo_each_fiscal: Close
[0m18:04:56.518758 [info ] [MainThread]: 
[0m18:04:56.518758 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.58 seconds (8.58s).
[0m18:04:56.518758 [debug] [MainThread]: Command end result
[0m18:04:56.563221 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:04:56.563221 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:04:56.563221 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:04:56.563221 [info ] [MainThread]: 
[0m18:04:56.563221 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:56.563221 [info ] [MainThread]: 
[0m18:04:56.563221 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:04:56.578343 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:56.578343 after 10.24 seconds
[0m18:04:56.579490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA8F61EE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA9287FEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA920E1280>]}
[0m18:04:56.579490 [debug] [MainThread]: Flushing usage events
[0m18:04:57.563172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:28.024292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134C85E240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134C85E720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134C85F9E0>]}


============================== 18:06:28.024292 | 2c6dfda5-10fc-4120-a401-48ec8dce8496 ==============================
[0m18:06:28.024292 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:06:28.040123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:FISCAL', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:06:28.493502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c6dfda5-10fc-4120-a401-48ec8dce8496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134D654170>]}
[0m18:06:28.556798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c6dfda5-10fc-4120-a401-48ec8dce8496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134C834260>]}
[0m18:06:28.556798 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:06:28.919503 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:06:29.089957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:06:29.089957 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\new_logo_each_fiscal.sql
[0m18:06:29.344815 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:06:29.358226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c6dfda5-10fc-4120-a401-48ec8dce8496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134ECA2540>]}
[0m18:06:29.439456 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:06:29.444469 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:06:29.475838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c6dfda5-10fc-4120-a401-48ec8dce8496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134EC45C70>]}
[0m18:06:29.475838 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:06:29.475838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c6dfda5-10fc-4120-a401-48ec8dce8496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134E72E3C0>]}
[0m18:06:29.489577 [info ] [MainThread]: 
[0m18:06:29.490567 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:29.491568 [info ] [MainThread]: 
[0m18:06:29.492569 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:06:29.493567 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:06:29.599753 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:06:29.599753 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:06:29.599753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:31.586780 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.989 seconds
[0m18:06:31.586780 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m18:06:31.602543 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:06:31.602543 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:06:31.602543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:33.251901 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.652 seconds
[0m18:06:33.251901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m18:06:33.251901 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:06:33.251901 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:06:33.657789 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.396 seconds
[0m18:06:33.657789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m18:06:33.721817 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:06:33.721817 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:06:34.077582 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.358 seconds
[0m18:06:34.077582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c6dfda5-10fc-4120-a401-48ec8dce8496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134F156E70>]}
[0m18:06:34.093650 [debug] [Thread-1 (]: Began running node model.dbt_first.new_logo_each_fiscal
[0m18:06:34.093650 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.new_logo_each_fiscal ......................... [RUN]
[0m18:06:34.093650 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.new_logo_each_fiscal'
[0m18:06:34.093650 [debug] [Thread-1 (]: Began compiling node model.dbt_first.new_logo_each_fiscal
[0m18:06:34.093650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.new_logo_each_fiscal"
[0m18:06:34.093650 [debug] [Thread-1 (]: Began executing node model.dbt_first.new_logo_each_fiscal
[0m18:06:34.129847 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.new_logo_each_fiscal"
[0m18:06:34.129847 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.new_logo_each_fiscal"
[0m18:06:34.129847 [debug] [Thread-1 (]: On model.dbt_first.new_logo_each_fiscal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.new_logo_each_fiscal"} */
create or replace transient table HEALTHCARE.mart.new_logo_each_fiscal
         as
        (

WITH cte_first_purchase AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_purchase_date
    FROM
        HEALTHCARE.stage.stg_transactions
    GROUP BY
        customer_id
),
 
cte_extract_year AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_purchase_date) AS fiscal_year
    FROM
        cte_first_purchase
)
 
SELECT
    fiscal_year,
    COUNT(DISTINCT customer_id) AS new_logos
FROM
    cte_extract_year
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year

-- with add_fy as(
--     select
--         trans.customer_id,
--         custs.customer_name,
--         trans.payment_date,
--         (case
--             WHEN MONTH(trans.payment_date) >= 4 THEN YEAR(trans.payment_date)
--             ELSE YEAR(trans.payment_date) - 1
--         end) as fiscal_year,
--         trans.revenue,
--         trans.revenue_type
--     from HEALTHCARE.stage.stg_transactions trans                                                                              
--     left join HEALTHCARE.stage.stg_customers custs
--     on trans.customer_id = custs.customer_id
--     order by trans.payment_date
-- ),
-- fy_partition as (
--     select distinct
--         customer_id,
--         customer_name,
--         min(payment_date) as first_in_fy,
--         fiscal_year,
--         row_number() over(partition by customer_name, customer_id order by first_in_fy) as uid
--     from add_fy
--     group by fiscal_year, customer_id, customer_name
--     order by customer_name
-- ),
-- new_in_fy as (
--     select
--         customer_id,
--         customer_name,
--         first_in_fy,
--         fiscal_year
--     from fy_partition
--     where uid = 1
-- )
-- select * from new_in_fy
-- order by fiscal_year
        );
[0m18:06:34.129847 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:06:36.579192 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.445 seconds
[0m18:06:36.611942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c6dfda5-10fc-4120-a401-48ec8dce8496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134EABE9F0>]}
[0m18:06:36.611942 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.new_logo_each_fiscal .................... [[32mSUCCESS 1[0m in 2.50s]
[0m18:06:36.611942 [debug] [Thread-1 (]: Finished running node model.dbt_first.new_logo_each_fiscal
[0m18:06:36.611942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:36.611942 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:06:36.611942 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:06:37.113755 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m18:06:37.113755 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m18:06:37.646385 [debug] [MainThread]: Connection 'model.dbt_first.new_logo_each_fiscal' was left open.
[0m18:06:37.646385 [debug] [MainThread]: On model.dbt_first.new_logo_each_fiscal: Close
[0m18:06:38.191006 [info ] [MainThread]: 
[0m18:06:38.191006 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.70 seconds (8.70s).
[0m18:06:38.191006 [debug] [MainThread]: Command end result
[0m18:06:38.221359 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:06:38.230688 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:06:38.237374 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:06:38.237374 [info ] [MainThread]: 
[0m18:06:38.237374 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:38.237374 [info ] [MainThread]: 
[0m18:06:38.237374 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:06:38.237374 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:38.237374 after 10.37 seconds
[0m18:06:38.237374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021349E37C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134C1ECCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134A6942C0>]}
[0m18:06:38.237374 [debug] [MainThread]: Flushing usage events
[0m18:06:39.301142 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:53.718545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDEC184770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDEC184DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDEC184EF0>]}


============================== 18:08:53.718545 | 2717ea7e-9ce2-4e4d-9793-69b6b99f8f27 ==============================
[0m18:08:53.718545 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:08:53.718545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:08:54.234427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2717ea7e-9ce2-4e4d-9793-69b6b99f8f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDECDABBF0>]}
[0m18:08:54.299685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2717ea7e-9ce2-4e4d-9793-69b6b99f8f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDECB72060>]}
[0m18:08:54.301690 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:08:54.761360 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:08:56.090435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:08:56.090435 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\new_logo_each_fiscal.sql
[0m18:08:56.090435 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m18:08:56.370430 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:08:56.386198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2717ea7e-9ce2-4e4d-9793-69b6b99f8f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDEE3ECE30>]}
[0m18:08:56.467140 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:08:56.484807 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:08:56.514616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2717ea7e-9ce2-4e4d-9793-69b6b99f8f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDEE2069C0>]}
[0m18:08:56.514616 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:08:56.514616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2717ea7e-9ce2-4e4d-9793-69b6b99f8f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDEE4A81A0>]}
[0m18:08:56.516625 [info ] [MainThread]: 
[0m18:08:56.516625 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:08:56.516625 [info ] [MainThread]: 
[0m18:08:56.516625 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:08:56.516625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:08:59.429365 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:08:59.429365 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:08:59.429365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:01.446992 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.003 seconds
[0m18:09:01.452970 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m18:09:01.461468 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:09:01.461468 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:09:01.461468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:03.062475 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.600 seconds
[0m18:09:03.062475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m18:09:03.102818 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:09:03.102818 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:09:03.429988 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.326 seconds
[0m18:09:03.442280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m18:09:03.442280 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:09:03.442280 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:09:03.786367 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.343 seconds
[0m18:09:03.786367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2717ea7e-9ce2-4e4d-9793-69b6b99f8f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDEE4A8530>]}
[0m18:09:03.786367 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m18:09:03.786367 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m18:09:03.786367 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m18:09:03.786367 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m18:09:03.801900 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m18:09:03.801900 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m18:09:03.826284 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m18:09:03.826284 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m18:09:03.841270 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

-- WITH first_last_purchase AS (
--     SELECT
--         customer_id,
--         MIN(payment_date) AS first_purchase_date,
--         MAX(payment_date) AS last_purchase_date
--     FROM HEALTHCARE.stage.stg_transactions  AS t
--     GROUP BY customer_id
-- ),
-- max_min_overall AS(
--     SELECT
--         MAX(payment_date) AS max_date,
--         MIN(payment_date) AS min_date
--     FROM HEALTHCARE.stage.stg_transactions
-- ),
-- customer_status AS (
--     SELECT
--         flp.customer_id,
--         flp.first_purchase_date,
--         flp.last_purchase_date, 
--         CASE
--             WHEN flp.last_purchase_date < DATEADD(month, -3, mmo.max_date) THEN 1
--             ELSE 0
--         END AS churned_customer,
--         CASE
--             WHEN flp.first_purchase_date > DATEADD(month, -3, mmo.max_date) THEN 1
--             ELSE 0
--         END AS new_customer
--     FROM first_last_purchase AS flp
--     CROSS JOIN max_min_overall AS mmo
-- ),
-- customer_status_over_time AS (
--     SELECT
--         DATE_TRUNC('month', flp.first_purchase_date) AS month,
--         SUM(cs.churned_customer) AS churned_customers,
--         SUM(cs.new_customer) AS new_customers
--     FROM customer_status AS cs
--     JOIN first_last_purchase AS flp ON cs.customer_id = flp.customer_id
--     GROUP BY month
-- )
-- SELECT 
--     month,
--     churned_customers,
--     new_customers
-- FROM 
--     customer_status_over_time
-- ORDER BY 
--     month



    WITH first_payment AS (
    SELECT
        customer_id,
        MIN(payment_date) AS first_payment_date
    FROM
        HEALTHCARE.stage.stg_transactions
    GROUP BY
        customer_id
),
 
new_customers_by_fy AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM first_payment_date) AS fiscal_year
    FROM
        first_payment
),
 
date_range AS (
    SELECT
        MIN(payment_date) AS start_date,
        MAX(payment_date) AS end_date
    FROM
        HEALTHCARE.stage.stg_transactions
),
 
last_payment AS (
    SELECT
        customer_id,
        MAX(payment_date) AS last_payment_date
    FROM
        HEALTHCARE.stage.stg_transactions
    GROUP BY
        customer_id
),
 
churned_customers AS (
    SELECT
        customer_id,
        EXTRACT(YEAR FROM last_payment_date) AS fiscal_year
    FROM
        last_payment,
        date_range
    WHERE
        last_payment_date < end_date
),
 
fiscal_years AS (
    SELECT DISTINCT
        EXTRACT(YEAR FROM payment_date) AS fiscal_year
    FROM
        HEALTHCARE.stage.stg_transactions
)
 
SELECT
    fy.fiscal_year,
    COUNT(DISTINCT new_customers_by_fy.customer_id) AS new_customers_count,
    COUNT(DISTINCT churned_customers.customer_id) AS churned_customers_count
FROM
    fiscal_years fy
    LEFT JOIN new_customers_by_fy ON fy.fiscal_year = new_customers_by_fy.fiscal_year
    LEFT JOIN churned_customers ON fy.fiscal_year = churned_customers.fiscal_year
GROUP BY
    fy.fiscal_year
ORDER BY
    fy.fiscal_year
        );
[0m18:09:03.842150 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:09:07.762288 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.922 seconds
[0m18:09:07.787982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2717ea7e-9ce2-4e4d-9793-69b6b99f8f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDE9529C40>]}
[0m18:09:07.787982 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 4.00s]
[0m18:09:07.789296 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m18:09:07.790302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:07.791337 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:09:07.791337 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:09:08.301407 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m18:09:08.302407 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m18:09:08.864258 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m18:09:08.864258 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m18:09:09.414391 [info ] [MainThread]: 
[0m18:09:09.415349 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.90 seconds (12.90s).
[0m18:09:09.417408 [debug] [MainThread]: Command end result
[0m18:09:09.440554 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:09:09.443217 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:09:09.449721 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:09:09.450720 [info ] [MainThread]: 
[0m18:09:09.451722 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:09.452677 [info ] [MainThread]: 
[0m18:09:09.453124 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:09:09.454740 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:09.453630 after 15.92 seconds
[0m18:09:09.454740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDE9EC6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDE9F2A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BDE9F2A450>]}
[0m18:09:09.455741 [debug] [MainThread]: Flushing usage events
[0m18:09:10.402249 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:21:28.650891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016508287BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001650821A570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016508287C80>]}


============================== 18:21:28.650891 | 6c2aaf2b-9bdc-4d57-b1b7-47e0cbb18bed ==============================
[0m18:21:28.650891 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:21:28.666443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:21:29.403218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c2aaf2b-9bdc-4d57-b1b7-47e0cbb18bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016508613B30>]}
[0m18:21:29.467780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c2aaf2b-9bdc-4d57-b1b7-47e0cbb18bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165091E73B0>]}
[0m18:21:29.467780 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:21:29.848728 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:21:30.068262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:21:30.068262 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m18:21:30.378796 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:21:30.385280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c2aaf2b-9bdc-4d57-b1b7-47e0cbb18bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001650AAC6360>]}
[0m18:21:30.469156 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:21:30.486949 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:21:30.531555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c2aaf2b-9bdc-4d57-b1b7-47e0cbb18bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001650A959D30>]}
[0m18:21:30.531555 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:21:30.532556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2aaf2b-9bdc-4d57-b1b7-47e0cbb18bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001650A79A600>]}
[0m18:21:30.534588 [info ] [MainThread]: 
[0m18:21:30.535106 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:21:30.535106 [info ] [MainThread]: 
[0m18:21:30.535106 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:21:30.535106 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:21:30.644121 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:21:30.644121 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:21:30.644121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:32.722084 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.078 seconds
[0m18:21:32.731212 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m18:21:32.739234 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:21:32.739234 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:21:32.739234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:34.313101 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.585 seconds
[0m18:21:34.328999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m18:21:34.328999 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:21:34.328999 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:21:34.757580 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.421 seconds
[0m18:21:34.764795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m18:21:34.808581 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:21:34.808581 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:21:35.222701 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.405 seconds
[0m18:21:35.226305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2aaf2b-9bdc-4d57-b1b7-47e0cbb18bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016505B8FA70>]}
[0m18:21:35.235848 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m18:21:35.235848 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m18:21:35.237851 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m18:21:35.237851 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m18:21:35.248829 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m18:21:35.248829 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m18:21:35.295505 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m18:21:35.295505 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m18:21:35.295505 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (

WITH cte_prev_revenue AS (
    SELECT
        date_trunc('MONTH', payment_date) pay_month,
        sum(revenue*quantity) AS revenue_month,
        lag(revenue_month,3) over (order by pay_month) as revenue_lag
    FROM 
        HEALTHCARE.stage.stg_transactions
    WHERE   
        revenue_type = 1
    GROUP BY
         pay_month
),
cte_handle_null AS (
    SELECT
        pay_month, 
        revenue_month, 
        coalesce(revenue_lag, 0) AS revenue_lag 
    FROM 
        cte_prev_revenue
),
cte_revenue_loss AS(
    SELECT
        pay_month,
        revenue_month,
        revenue_lag,
        (revenue_month - revenue_lag)*(-1) as revenue_loss
    FROM 
        cte_handle_null
    WHERE 
        revenue_lag > revenue_month

)
SELECT * FROM cte_revenue_loss
        );
[0m18:21:35.295505 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:21:38.127824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.833 seconds
[0m18:21:38.143116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2aaf2b-9bdc-4d57-b1b7-47e0cbb18bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016507C00B30>]}
[0m18:21:38.143116 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.91s]
[0m18:21:38.158712 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m18:21:38.160308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:21:38.160308 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:21:38.161897 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:21:38.689810 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m18:21:38.689810 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m18:21:39.222997 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m18:21:39.222997 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m18:21:39.773410 [info ] [MainThread]: 
[0m18:21:39.773410 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.24 seconds (9.24s).
[0m18:21:39.773410 [debug] [MainThread]: Command end result
[0m18:21:39.794218 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:21:39.794218 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:21:39.794218 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:21:39.794218 [info ] [MainThread]: 
[0m18:21:39.794218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:21:39.810045 [info ] [MainThread]: 
[0m18:21:39.810045 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:21:39.810045 [debug] [MainThread]: Command `dbt run` succeeded at 18:21:39.810045 after 11.51 seconds
[0m18:21:39.810045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165078F7E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165078F7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016507BB50D0>]}
[0m18:21:39.810045 [debug] [MainThread]: Flushing usage events
[0m18:21:41.367261 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:22:05.353532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022053C66180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220567777A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022056312570>]}


============================== 18:22:05.370212 | 33d96507-998c-43b3-8835-932ea2632f15 ==============================
[0m18:22:05.370212 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:22:05.370212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:22:05.853957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33d96507-998c-43b3-8835-932ea2632f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220569D4710>]}
[0m18:22:05.929875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33d96507-998c-43b3-8835-932ea2632f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022055F11F10>]}
[0m18:22:05.929875 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:22:06.320393 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:22:06.504659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:22:06.504659 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m18:22:06.754970 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:22:06.771573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33d96507-998c-43b3-8835-932ea2632f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022058CE27B0>]}
[0m18:22:06.870620 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:22:06.874619 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:22:06.904571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33d96507-998c-43b3-8835-932ea2632f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220587F1EE0>]}
[0m18:22:06.904571 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:22:06.904571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33d96507-998c-43b3-8835-932ea2632f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022058CC5B50>]}
[0m18:22:06.904571 [info ] [MainThread]: 
[0m18:22:06.904571 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:22:06.904571 [info ] [MainThread]: 
[0m18:22:06.904571 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:22:06.904571 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:22:07.005175 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:22:07.005175 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:22:07.005175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:08.931908 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.927 seconds
[0m18:22:08.940311 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m18:22:08.947947 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:22:08.947947 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:22:08.947947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:10.441583 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.496 seconds
[0m18:22:10.454903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m18:22:10.468707 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:22:10.468707 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:22:10.842616 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.370 seconds
[0m18:22:10.844623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m18:22:10.897409 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:22:10.897409 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:22:11.236588 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.338 seconds
[0m18:22:11.245267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33d96507-998c-43b3-8835-932ea2632f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022059108170>]}
[0m18:22:11.256866 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m18:22:11.258097 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m18:22:11.259911 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m18:22:11.260369 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m18:22:11.276782 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m18:22:11.278064 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m18:22:11.309687 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m18:22:11.309687 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m18:22:11.309687 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (

WITH cte_prev_revenue AS (
    SELECT
        date_trunc('MONTH', payment_date) pay_month,
        sum(revenue*quantity) AS revenue_month,
        lag(revenue_month,3) over (order by pay_month) as revenue_lag
    FROM 
        HEALTHCARE.stage.stg_transactions
    GROUP BY
         pay_month
),
cte_handle_null AS (
    SELECT
        pay_month, 
        revenue_month, 
        coalesce(revenue_lag, 0) AS revenue_lag 
    FROM 
        cte_prev_revenue
),
cte_revenue_loss AS(
    SELECT
        pay_month,
        revenue_month,
        revenue_lag,
        (revenue_month - revenue_lag) as revenue_loss
    FROM 
        cte_handle_null
    WHERE 
        revenue_lag > revenue_month

)
SELECT * FROM cte_revenue_loss
        );
[0m18:22:11.309687 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:22:13.897841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.591 seconds
[0m18:22:13.929527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33d96507-998c-43b3-8835-932ea2632f15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022055E80710>]}
[0m18:22:13.929527 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.67s]
[0m18:22:13.929527 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m18:22:13.929527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:22:13.929527 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:22:13.929527 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:22:14.448470 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m18:22:14.448470 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m18:22:14.981571 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m18:22:14.981571 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m18:22:15.537759 [info ] [MainThread]: 
[0m18:22:15.537759 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.63 seconds (8.63s).
[0m18:22:15.537759 [debug] [MainThread]: Command end result
[0m18:22:15.571492 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:22:15.575504 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:22:15.583663 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:22:15.583663 [info ] [MainThread]: 
[0m18:22:15.583663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:22:15.585664 [info ] [MainThread]: 
[0m18:22:15.585664 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:22:15.585664 [debug] [MainThread]: Command `dbt run` succeeded at 18:22:15.585664 after 10.40 seconds
[0m18:22:15.585664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022053C66180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205597E030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205689F770>]}
[0m18:22:15.585664 [debug] [MainThread]: Flushing usage events
[0m18:22:16.528713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:22:44.132695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032DF0EAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203311F3B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203311F3DA0>]}


============================== 18:22:44.132695 | e74403cc-fb01-4a5b-af8b-003537226bd5 ==============================
[0m18:22:44.132695 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:22:44.141582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'send_anonymous_usage_stats': 'True'}
[0m18:22:44.606300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e74403cc-fb01-4a5b-af8b-003537226bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203323E6810>]}
[0m18:22:44.664388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e74403cc-fb01-4a5b-af8b-003537226bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002033122DA30>]}
[0m18:22:44.664388 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:22:45.017011 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:22:45.207729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:22:45.207729 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m18:22:45.461175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:22:45.481507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e74403cc-fb01-4a5b-af8b-003537226bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020333873DA0>]}
[0m18:22:45.563349 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:22:45.567569 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:22:45.596200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e74403cc-fb01-4a5b-af8b-003537226bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032F372FF0>]}
[0m18:22:45.596200 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:22:45.599218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e74403cc-fb01-4a5b-af8b-003537226bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002033372B740>]}
[0m18:22:45.599218 [info ] [MainThread]: 
[0m18:22:45.599218 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:22:45.599218 [info ] [MainThread]: 
[0m18:22:45.599218 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:22:45.599218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:22:45.693944 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:22:45.693944 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:22:45.693944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:47.754921 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.057 seconds
[0m18:22:47.754921 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m18:22:47.779052 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:22:47.779052 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:22:47.779052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:49.323528 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.541 seconds
[0m18:22:49.323528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m18:22:49.323528 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:22:49.323528 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:22:49.681865 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.353 seconds
[0m18:22:49.681865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m18:22:49.727068 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:22:49.727068 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:22:50.114552 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.379 seconds
[0m18:22:50.117662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e74403cc-fb01-4a5b-af8b-003537226bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020333E65490>]}
[0m18:22:50.121678 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m18:22:50.121678 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m18:22:50.123688 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m18:22:50.123688 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m18:22:50.131700 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m18:22:50.132593 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m18:22:50.164962 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m18:22:50.164962 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m18:22:50.164962 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (

WITH cte_prev_revenue AS (
    SELECT
        date_trunc('MONTH', payment_date) pay_month,
        sum(revenue*quantity) AS revenue_month,
        lag(revenue_month) over (order by pay_month) as revenue_lag
    FROM 
        HEALTHCARE.stage.stg_transactions
    GROUP BY
         pay_month
),
cte_handle_null AS (
    SELECT
        pay_month, 
        revenue_month, 
        coalesce(revenue_lag, 0) AS revenue_lag 
    FROM 
        cte_prev_revenue
),
cte_revenue_loss AS(
    SELECT
        pay_month,
        revenue_month,
        revenue_lag,
        (revenue_month - revenue_lag) as revenue_loss
    FROM 
        cte_handle_null
    WHERE 
        revenue_lag > revenue_month

)
SELECT * FROM cte_revenue_loss
        );
[0m18:22:50.164962 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:22:52.595519 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.424 seconds
[0m18:22:52.620840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e74403cc-fb01-4a5b-af8b-003537226bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032EA5D850>]}
[0m18:22:52.620840 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.48s]
[0m18:22:52.620840 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m18:22:52.620840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:22:52.620840 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:22:52.620840 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:22:53.135920 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m18:22:53.135920 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m18:22:53.657828 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m18:22:53.657828 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m18:22:54.185352 [info ] [MainThread]: 
[0m18:22:54.185352 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.59 seconds (8.59s).
[0m18:22:54.185352 [debug] [MainThread]: Command end result
[0m18:22:54.218413 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:22:54.222998 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:22:54.229333 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:22:54.229333 [info ] [MainThread]: 
[0m18:22:54.230301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:22:54.231301 [info ] [MainThread]: 
[0m18:22:54.231745 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:22:54.232420 [debug] [MainThread]: Command `dbt run` succeeded at 18:22:54.232420 after 10.27 seconds
[0m18:22:54.233461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032E9718B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032E971850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002032E970560>]}
[0m18:22:54.233461 [debug] [MainThread]: Flushing usage events
[0m18:22:55.171176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:24:19.212673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021954DA56D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021954DA49E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021954DA6D50>]}


============================== 18:24:19.212673 | bac0ce3b-cacd-41db-8dd0-fa2912d95b9a ==============================
[0m18:24:19.212673 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:24:19.212673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:24:19.748530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bac0ce3b-cacd-41db-8dd0-fa2912d95b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219550B18E0>]}
[0m18:24:19.820202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bac0ce3b-cacd-41db-8dd0-fa2912d95b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021956449280>]}
[0m18:24:19.820202 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:24:20.290388 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:24:21.743667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:24:21.744890 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m18:24:22.047730 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:24:22.061010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bac0ce3b-cacd-41db-8dd0-fa2912d95b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021957C126C0>]}
[0m18:24:22.139125 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:24:22.154227 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:24:22.184416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bac0ce3b-cacd-41db-8dd0-fa2912d95b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021957BAA120>]}
[0m18:24:22.185416 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:24:22.185416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bac0ce3b-cacd-41db-8dd0-fa2912d95b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021957AB6CF0>]}
[0m18:24:22.187618 [info ] [MainThread]: 
[0m18:24:22.187618 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:22.188587 [info ] [MainThread]: 
[0m18:24:22.189587 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:24:22.190586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:24:24.953507 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:24:24.953507 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:24:24.953507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:26.953207 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.998 seconds
[0m18:24:26.970778 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m18:24:26.970778 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:24:26.970778 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:24:26.970778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:28.525181 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.552 seconds
[0m18:24:28.537391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m18:24:28.537391 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:24:28.537391 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:24:28.877328 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.336 seconds
[0m18:24:28.877328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m18:24:28.928909 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:24:28.928909 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:24:29.266077 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.339 seconds
[0m18:24:29.266077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bac0ce3b-cacd-41db-8dd0-fa2912d95b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021957AD8FE0>]}
[0m18:24:29.266077 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m18:24:29.266077 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m18:24:29.279810 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m18:24:29.279810 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m18:24:29.279810 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m18:24:29.279810 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m18:24:29.315875 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m18:24:29.315875 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m18:24:29.315875 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (

WITH cte_prev_revenue AS (
    SELECT
        date_trunc('MONTH', payment_date) pay_month,
        sum(revenue*quantity) AS revenue_month,
        lag(revenue_month,3) over (order by pay_month) as revenue_lag
    FROM 
        HEALTHCARE.stage.stg_transactions
    GROUP BY
         pay_month
),
cte_handle_null AS (
    SELECT
        pay_month, 
        revenue_month, 
        coalesce(revenue_lag, 0) AS revenue_lag 
    FROM 
        cte_prev_revenue
),
cte_revenue_loss AS(
    SELECT
        pay_month,
        revenue_month,
        revenue_lag,
        (revenue_month - revenue_lag) as revenue_loss
    FROM 
        cte_handle_null
    WHERE 
        revenue_lag > revenue_month

)
SELECT * FROM cte_revenue_loss
        );
[0m18:24:29.315875 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:24:32.042522 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.723 seconds
[0m18:24:32.063836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bac0ce3b-cacd-41db-8dd0-fa2912d95b9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021954DC0320>]}
[0m18:24:32.063836 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.80s]
[0m18:24:32.063836 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m18:24:32.063836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:32.063836 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:24:32.063836 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:24:32.599753 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m18:24:32.600701 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m18:24:33.118937 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m18:24:33.118937 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m18:24:34.398971 [info ] [MainThread]: 
[0m18:24:34.398971 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.21 seconds (12.21s).
[0m18:24:34.398971 [debug] [MainThread]: Command end result
[0m18:24:34.427289 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:24:34.427289 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:24:34.436893 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:24:34.437887 [info ] [MainThread]: 
[0m18:24:34.438887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:24:34.438887 [info ] [MainThread]: 
[0m18:24:34.439893 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:24:34.441512 [debug] [MainThread]: Command `dbt run` succeeded at 18:24:34.441512 after 15.40 seconds
[0m18:24:34.441512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219530453A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219555B30E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219555B2660>]}
[0m18:24:34.441512 [debug] [MainThread]: Flushing usage events
[0m18:24:35.453231 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:45.036516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AB2796D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AD8577A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201ABD76660>]}


============================== 18:35:45.036516 | 4471baf6-6688-4dbc-b1a6-69e5bc080b32 ==============================
[0m18:35:45.036516 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:35:45.049852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:revenue_contraction', 'send_anonymous_usage_stats': 'True'}
[0m18:35:45.506206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4471baf6-6688-4dbc-b1a6-69e5bc080b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AB37E7B0>]}
[0m18:35:45.569202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4471baf6-6688-4dbc-b1a6-69e5bc080b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201ACE50B00>]}
[0m18:35:45.569202 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:35:45.926478 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:35:46.116566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:35:46.116566 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\revenue_contraction.sql
[0m18:35:46.365040 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:35:46.380967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4471baf6-6688-4dbc-b1a6-69e5bc080b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B0382840>]}
[0m18:35:46.455416 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:35:46.471110 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:35:46.486997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4471baf6-6688-4dbc-b1a6-69e5bc080b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B0326000>]}
[0m18:35:46.486997 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:35:46.502667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4471baf6-6688-4dbc-b1a6-69e5bc080b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B010B2C0>]}
[0m18:35:46.502667 [info ] [MainThread]: 
[0m18:35:46.502667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:46.502667 [info ] [MainThread]: 
[0m18:35:46.502667 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:35:46.502667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:35:46.604635 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:35:46.604635 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:35:46.604635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:48.787032 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.189 seconds
[0m18:35:48.787032 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m18:35:48.802907 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:35:48.802907 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:35:48.802907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:50.442077 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.633 seconds
[0m18:35:50.444097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m18:35:50.448110 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:35:50.448110 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:35:50.921431 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.481 seconds
[0m18:35:50.921431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m18:35:50.988180 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:35:50.988180 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:35:51.455411 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.477 seconds
[0m18:35:51.470821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4471baf6-6688-4dbc-b1a6-69e5bc080b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201B07C4140>]}
[0m18:35:51.470821 [debug] [Thread-1 (]: Began running node model.dbt_first.revenue_contraction
[0m18:35:51.470821 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.revenue_contraction .......................... [RUN]
[0m18:35:51.470821 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.revenue_contraction'
[0m18:35:51.470821 [debug] [Thread-1 (]: Began compiling node model.dbt_first.revenue_contraction
[0m18:35:51.489740 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.revenue_contraction"
[0m18:35:51.491707 [debug] [Thread-1 (]: Began executing node model.dbt_first.revenue_contraction
[0m18:35:51.510134 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.revenue_contraction"
[0m18:35:51.510134 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.revenue_contraction"
[0m18:35:51.524891 [debug] [Thread-1 (]: On model.dbt_first.revenue_contraction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.revenue_contraction"} */
create or replace transient table HEALTHCARE.mart.revenue_contraction
         as
        (

WITH cte_prev_revenue AS (
    SELECT
        date_trunc('MONTH', payment_date) pay_month,
        sum(revenue*quantity) AS revenue_month,
        lag(revenue_month,3) over (order by pay_month) as revenue_lag
    FROM 
        HEALTHCARE.stage.stg_transactions
    GROUP BY
         pay_month
),
cte_handle_null AS (
    SELECT
        pay_month, 
        revenue_month, 
        coalesce(revenue_lag, 0) AS revenue_lag 
    FROM 
        cte_prev_revenue
),
cte_revenue_loss AS(
    SELECT
        pay_month,
        revenue_month,
        revenue_lag,
        (revenue_month - revenue_lag) as revenue_loss
    FROM 
        cte_handle_null
    WHERE 
        revenue_lag > revenue_month

)
SELECT * FROM cte_revenue_loss order by pay_month
        );
[0m18:35:51.524891 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:35:54.261104 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.750 seconds
[0m18:35:54.293069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4471baf6-6688-4dbc-b1a6-69e5bc080b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AB37D730>]}
[0m18:35:54.293069 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.revenue_contraction ..................... [[32mSUCCESS 1[0m in 2.82s]
[0m18:35:54.293069 [debug] [Thread-1 (]: Finished running node model.dbt_first.revenue_contraction
[0m18:35:54.293069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:54.293069 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:35:54.293069 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:35:54.813144 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m18:35:54.828281 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m18:35:55.364131 [debug] [MainThread]: Connection 'model.dbt_first.revenue_contraction' was left open.
[0m18:35:55.364131 [debug] [MainThread]: On model.dbt_first.revenue_contraction: Close
[0m18:35:55.895528 [info ] [MainThread]: 
[0m18:35:55.895528 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.39 seconds (9.39s).
[0m18:35:55.895528 [debug] [MainThread]: Command end result
[0m18:35:55.953663 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:35:55.957687 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:35:55.968303 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:35:55.968303 [info ] [MainThread]: 
[0m18:35:55.970313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:55.970313 [info ] [MainThread]: 
[0m18:35:56.001630 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:35:56.005681 [debug] [MainThread]: Command `dbt run` succeeded at 18:35:56.005681 after 11.16 seconds
[0m18:35:56.005681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201ADF87530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AD435C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201AD435010>]}
[0m18:35:56.005681 [debug] [MainThread]: Flushing usage events
[0m18:35:57.397416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:47:08.416535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054FCB2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055277F7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020552A192B0>]}


============================== 18:47:08.416535 | 1fefb699-ea67-4c7f-bc51-c7729ed93f80 ==============================
[0m18:47:08.416535 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:47:08.432643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:churn_new_cust', 'send_anonymous_usage_stats': 'True'}
[0m18:47:08.996775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fefb699-ea67-4c7f-bc51-c7729ed93f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205547F6750>]}
[0m18:47:09.043660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fefb699-ea67-4c7f-bc51-c7729ed93f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205536B18E0>]}
[0m18:47:09.059347 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:47:09.534293 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:47:10.896013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:47:10.896013 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\churned_new_customers.sql
[0m18:47:11.149860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:47:11.155873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fefb699-ea67-4c7f-bc51-c7729ed93f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020554C7B410>]}
[0m18:47:11.236938 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:47:11.252892 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:47:11.287346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fefb699-ea67-4c7f-bc51-c7729ed93f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020554D35D30>]}
[0m18:47:11.287346 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:47:11.287346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fefb699-ea67-4c7f-bc51-c7729ed93f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020554D76390>]}
[0m18:47:11.291367 [info ] [MainThread]: 
[0m18:47:11.291367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:47:11.291367 [info ] [MainThread]: 
[0m18:47:11.291367 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:47:11.291367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:47:14.164892 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:47:14.164892 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:47:14.164892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:16.184688 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.031 seconds
[0m18:47:16.200430 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m18:47:16.200430 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:47:16.200430 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:47:16.200430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:17.706140 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.493 seconds
[0m18:47:17.706140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m18:47:17.706140 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:47:17.706140 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:47:18.129659 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.423 seconds
[0m18:47:18.137699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m18:47:18.186087 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:47:18.188095 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:47:18.636240 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.449 seconds
[0m18:47:18.636240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fefb699-ea67-4c7f-bc51-c7729ed93f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205551269C0>]}
[0m18:47:18.636240 [debug] [Thread-1 (]: Began running node model.dbt_first.churned_new_customers
[0m18:47:18.636240 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.churned_new_customers ........................ [RUN]
[0m18:47:18.636240 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.churned_new_customers'
[0m18:47:18.636240 [debug] [Thread-1 (]: Began compiling node model.dbt_first.churned_new_customers
[0m18:47:18.655941 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.churned_new_customers"
[0m18:47:18.656911 [debug] [Thread-1 (]: Began executing node model.dbt_first.churned_new_customers
[0m18:47:18.687296 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.churned_new_customers"
[0m18:47:18.689264 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.churned_new_customers"
[0m18:47:18.690295 [debug] [Thread-1 (]: On model.dbt_first.churned_new_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.churned_new_customers"} */
create or replace transient table HEALTHCARE.mart.churned_new_customers
         as
        (

-- WITH first_last_purchase AS (
--     SELECT
--         customer_id,
--         MIN(payment_date) AS first_purchase_date,
--         MAX(payment_date) AS last_purchase_date
--     FROM HEALTHCARE.stage.stg_transactions  AS t
--     GROUP BY customer_id
-- ),
-- max_min_overall AS(
--     SELECT
--         MAX(payment_date) AS max_date,
--         MIN(payment_date) AS min_date
--     FROM HEALTHCARE.stage.stg_transactions
-- ),
-- customer_status AS (
--     SELECT
--         flp.customer_id,
--         flp.first_purchase_date,
--         flp.last_purchase_date, 
--         CASE
--             WHEN flp.last_purchase_date < DATEADD(month, -3, mmo.max_date) THEN 1
--             ELSE 0
--         END AS churned_customer,
--         CASE
--             WHEN flp.first_purchase_date > DATEADD(month, -3, mmo.max_date) THEN 1
--             ELSE 0
--         END AS new_customer
--     FROM first_last_purchase AS flp
--     CROSS JOIN max_min_overall AS mmo
-- ),
-- customer_status_over_time AS (
--     SELECT
--         DATE_TRUNC('month', flp.first_purchase_date) AS month,
--         SUM(cs.churned_customer) AS churned_customers,
--         SUM(cs.new_customer) AS new_customers
--     FROM customer_status AS cs
--     JOIN first_last_purchase AS flp ON cs.customer_id = flp.customer_id
--     GROUP BY month
-- )
-- SELECT 
--     month,
--     churned_customers,
--     new_customers
-- FROM 
--     customer_status_over_time
-- ORDER BY 
--     month

WITH transactions AS (
    SELECT DISTINCT CUSTOMER_ID, payment_date
    FROM HEALTHCARE.stage.stg_transactions
),

customer_lifetime AS (
    SELECT 
        CUSTOMER_ID, 
        MIN(payment_date) AS first_purchase_month, 
        MAX(payment_date) AS last_purchase_month
    FROM transactions
    GROUP BY CUSTOMER_ID
),

churn_analysis AS (
    SELECT 
        payment_date,
        COUNT(DISTINCT CASE WHEN first_purchase_month = payment_date THEN CUSTOMER_ID END) AS new_customers,
        COUNT(DISTINCT CASE WHEN last_purchase_month = payment_date THEN CUSTOMER_ID END) AS churned_customers
    FROM transactions
    JOIN customer_lifetime USING (CUSTOMER_ID)
    GROUP BY payment_date
)

SELECT * FROM churn_analysis
        );
[0m18:47:18.690295 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:47:21.481335 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.790 seconds
[0m18:47:21.530676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fefb699-ea67-4c7f-bc51-c7729ed93f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002054FDB9F40>]}
[0m18:47:21.530676 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.churned_new_customers ................... [[32mSUCCESS 1[0m in 2.89s]
[0m18:47:21.530676 [debug] [Thread-1 (]: Finished running node model.dbt_first.churned_new_customers
[0m18:47:21.530676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:21.530676 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:47:21.530676 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:47:22.059377 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m18:47:22.059377 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m18:47:22.592416 [debug] [MainThread]: Connection 'model.dbt_first.churned_new_customers' was left open.
[0m18:47:22.593413 [debug] [MainThread]: On model.dbt_first.churned_new_customers: Close
[0m18:47:23.167046 [info ] [MainThread]: 
[0m18:47:23.167046 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.88 seconds (11.88s).
[0m18:47:23.167046 [debug] [MainThread]: Command end result
[0m18:47:23.201048 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:47:23.204566 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:47:23.209307 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:47:23.209307 [info ] [MainThread]: 
[0m18:47:23.209307 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:47:23.209307 [info ] [MainThread]: 
[0m18:47:23.209307 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:47:23.215840 [debug] [MainThread]: Command `dbt run` succeeded at 18:47:23.214808 after 15.05 seconds
[0m18:47:23.216855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020551DE4E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002055247CCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020551EC1340>]}
[0m18:47:23.217841 [debug] [MainThread]: Flushing usage events
[0m18:47:24.561182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:18.982293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1C75AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1C75BFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1C758D40>]}


============================== 18:53:18.982293 | a1fc3daa-f9d3-4304-8edb-9bd0175c6bb4 ==============================
[0m18:53:18.982293 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:53:18.982293 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:fiscal', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:53:19.452746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1fc3daa-f9d3-4304-8edb-9bd0175c6bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1D464260>]}
[0m18:53:19.498102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1fc3daa-f9d3-4304-8edb-9bd0175c6bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1D16F260>]}
[0m18:53:19.498102 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:53:19.871902 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:53:20.054035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:53:20.054035 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\new_logo_each_fiscal.sql
[0m18:53:20.304354 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:53:20.327930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1fc3daa-f9d3-4304-8edb-9bd0175c6bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1EA623C0>]}
[0m18:53:20.408963 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:53:20.412896 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:53:20.437120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1fc3daa-f9d3-4304-8edb-9bd0175c6bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1E9FA090>]}
[0m18:53:20.437120 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:53:20.437120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1fc3daa-f9d3-4304-8edb-9bd0175c6bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1E8BDA60>]}
[0m18:53:20.437120 [info ] [MainThread]: 
[0m18:53:20.437120 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:20.437120 [info ] [MainThread]: 
[0m18:53:20.437120 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:53:20.437120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:53:20.542802 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:53:20.542802 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:53:20.543802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:22.434109 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.897 seconds
[0m18:53:22.434109 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m18:53:22.449774 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:53:22.449774 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:53:22.449774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:23.969695 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.521 seconds
[0m18:53:23.969695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m18:53:23.969695 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:53:23.969695 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:53:24.324064 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.344 seconds
[0m18:53:24.324064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m18:53:24.382811 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:53:24.383812 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:53:24.747182 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.366 seconds
[0m18:53:24.747182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1fc3daa-f9d3-4304-8edb-9bd0175c6bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1EE06540>]}
[0m18:53:24.747182 [debug] [Thread-1 (]: Began running node model.dbt_first.new_logo_each_fiscal
[0m18:53:24.747182 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.new_logo_each_fiscal ......................... [RUN]
[0m18:53:24.747182 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.new_logo_each_fiscal'
[0m18:53:24.747182 [debug] [Thread-1 (]: Began compiling node model.dbt_first.new_logo_each_fiscal
[0m18:53:24.769198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.new_logo_each_fiscal"
[0m18:53:24.771203 [debug] [Thread-1 (]: Began executing node model.dbt_first.new_logo_each_fiscal
[0m18:53:24.794667 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.new_logo_each_fiscal"
[0m18:53:24.794667 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.new_logo_each_fiscal"
[0m18:53:24.794667 [debug] [Thread-1 (]: On model.dbt_first.new_logo_each_fiscal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.new_logo_each_fiscal"} */
create or replace transient table HEALTHCARE.mart.new_logo_each_fiscal
         as
        (

-- WITH cte_first_purchase AS (
--     SELECT
--         customer_id,
--         MIN(payment_date) AS first_purchase_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
--     GROUP BY
--         customer_id
-- ),
 
-- cte_extract_year AS (
--     SELECT
--         customer_id,
--         EXTRACT(YEAR FROM first_purchase_date) AS fiscal_year
--     FROM
--         cte_first_purchase
-- )

-- SELECT
--     fiscal_year,
--     COUNT(DISTINCT customer_id) AS new_logos
-- FROM
--     cte_extract_year
-- GROUP BY
--     fiscal_year
-- ORDER BY
--     fiscal_year
WITH new_logos as (
    SELECT 
        CUSTOMER_ID, 
        MIN(PAYMENT_MONTH) AS first_purchase_month,
        EXTRACT(YEAR FROM MIN(PAYMENT_MONTH)) AS fiscal_year
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY CUSTOMER_ID
)

SELECT fiscal_year, COUNT(DISTINCT CUSTOMER_ID) AS new_customers FROM new_logos GROUP BY fiscal_year
        );
[0m18:53:24.794667 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:53:26.555745 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00c3-0004-c144-0005-a3d3000400c6
[0m18:53:26.555745 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 35 at position 12
invalid identifier 'PAYMENT_MONTH'
[0m18:53:26.571516 [debug] [Thread-1 (]: Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  000904 (42000): SQL compilation error: error line 35 at position 12
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql
[0m18:53:26.571516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1fc3daa-f9d3-4304-8edb-9bd0175c6bb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1F050FE0>]}
[0m18:53:26.571516 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.new_logo_each_fiscal ................ [[31mERROR[0m in 1.82s]
[0m18:53:26.571516 [debug] [Thread-1 (]: Finished running node model.dbt_first.new_logo_each_fiscal
[0m18:53:26.571516 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.new_logo_each_fiscal' to be skipped because of status 'error'.  Reason: Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  000904 (42000): SQL compilation error: error line 35 at position 12
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql.
[0m18:53:26.571516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:26.571516 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:53:26.571516 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:53:27.098750 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m18:53:27.098750 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m18:53:27.634280 [debug] [MainThread]: Connection 'model.dbt_first.new_logo_each_fiscal' was left open.
[0m18:53:27.634735 [debug] [MainThread]: On model.dbt_first.new_logo_each_fiscal: Close
[0m18:53:28.181611 [info ] [MainThread]: 
[0m18:53:28.182061 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.74 seconds (7.74s).
[0m18:53:28.183030 [debug] [MainThread]: Command end result
[0m18:53:28.208166 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:53:28.211730 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:53:28.218221 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:53:28.218221 [info ] [MainThread]: 
[0m18:53:28.218221 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:53:28.218221 [info ] [MainThread]: 
[0m18:53:28.218221 [error] [MainThread]:   Database Error in model new_logo_each_fiscal (models\Mart\new_logo_each_fiscal.sql)
  000904 (42000): SQL compilation error: error line 35 at position 12
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\new_logo_each_fiscal.sql
[0m18:53:28.218221 [info ] [MainThread]: 
[0m18:53:28.218221 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:53:28.218221 [debug] [MainThread]: Command `dbt run` failed at 18:53:28.218221 after 9.51 seconds
[0m18:53:28.218221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1C01A480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1A5067B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1A5064E0>]}
[0m18:53:28.218221 [debug] [MainThread]: Flushing usage events
[0m18:53:29.252780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:54.140745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E444ED070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E444EC0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E444EC4A0>]}


============================== 18:53:54.140745 | 071b6446-89ab-48aa-b107-3b5b55f09be4 ==============================
[0m18:53:54.140745 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:53:54.140745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:fiscal', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:53:54.657884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '071b6446-89ab-48aa-b107-3b5b55f09be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E452170E0>]}
[0m18:53:54.705882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '071b6446-89ab-48aa-b107-3b5b55f09be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E41AD1220>]}
[0m18:53:54.721599 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:53:55.179118 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:53:56.502986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:53:56.502986 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\new_logo_each_fiscal.sql
[0m18:53:56.744812 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:53:56.744812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '071b6446-89ab-48aa-b107-3b5b55f09be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E468425A0>]}
[0m18:53:56.824231 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:53:56.839952 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:53:56.877530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '071b6446-89ab-48aa-b107-3b5b55f09be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E467E4D70>]}
[0m18:53:56.877530 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:53:56.877530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '071b6446-89ab-48aa-b107-3b5b55f09be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E466889E0>]}
[0m18:53:56.877530 [info ] [MainThread]: 
[0m18:53:56.877530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:56.877530 [info ] [MainThread]: 
[0m18:53:56.877530 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:53:56.877530 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:53:59.446361 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:53:59.446361 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:53:59.446361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:01.378042 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.931 seconds
[0m18:54:01.391785 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m18:54:01.391785 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:54:01.391785 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:54:01.391785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:02.960648 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.555 seconds
[0m18:54:02.960648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m18:54:02.960648 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:54:02.960648 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:54:03.284118 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.319 seconds
[0m18:54:03.284118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m18:54:03.347572 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:54:03.347572 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:54:03.705211 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.355 seconds
[0m18:54:03.720012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '071b6446-89ab-48aa-b107-3b5b55f09be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E41953800>]}
[0m18:54:03.721052 [debug] [Thread-1 (]: Began running node model.dbt_first.new_logo_each_fiscal
[0m18:54:03.721052 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.new_logo_each_fiscal ......................... [RUN]
[0m18:54:03.721052 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.new_logo_each_fiscal'
[0m18:54:03.721052 [debug] [Thread-1 (]: Began compiling node model.dbt_first.new_logo_each_fiscal
[0m18:54:03.721052 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.new_logo_each_fiscal"
[0m18:54:03.721052 [debug] [Thread-1 (]: Began executing node model.dbt_first.new_logo_each_fiscal
[0m18:54:03.766830 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.new_logo_each_fiscal"
[0m18:54:03.768822 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.new_logo_each_fiscal"
[0m18:54:03.768822 [debug] [Thread-1 (]: On model.dbt_first.new_logo_each_fiscal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.new_logo_each_fiscal"} */
create or replace transient table HEALTHCARE.mart.new_logo_each_fiscal
         as
        (

-- WITH cte_first_purchase AS (
--     SELECT
--         customer_id,
--         MIN(payment_date) AS first_purchase_date
--     FROM
--         HEALTHCARE.stage.stg_transactions
--     GROUP BY
--         customer_id
-- ),
 
-- cte_extract_year AS (
--     SELECT
--         customer_id,
--         EXTRACT(YEAR FROM first_purchase_date) AS fiscal_year
--     FROM
--         cte_first_purchase
-- )

-- SELECT
--     fiscal_year,
--     COUNT(DISTINCT customer_id) AS new_logos
-- FROM
--     cte_extract_year
-- GROUP BY
--     fiscal_year
-- ORDER BY
--     fiscal_year
WITH new_logos as (
    SELECT 
        CUSTOMER_ID, 
        MIN(payment_date) AS first_purchase_month,
        EXTRACT(YEAR FROM MIN(payment_date)) AS fiscal_year
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY CUSTOMER_ID
)

SELECT fiscal_year, COUNT(DISTINCT CUSTOMER_ID) AS new_customers FROM new_logos GROUP BY fiscal_year
        );
[0m18:54:03.768822 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:54:06.159893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.392 seconds
[0m18:54:06.183366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '071b6446-89ab-48aa-b107-3b5b55f09be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E418BD7F0>]}
[0m18:54:06.183366 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.new_logo_each_fiscal .................... [[32mSUCCESS 1[0m in 2.46s]
[0m18:54:06.183366 [debug] [Thread-1 (]: Finished running node model.dbt_first.new_logo_each_fiscal
[0m18:54:06.183366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:06.183366 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:54:06.183366 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:54:06.701116 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m18:54:06.701116 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m18:54:07.217630 [debug] [MainThread]: Connection 'model.dbt_first.new_logo_each_fiscal' was left open.
[0m18:54:07.217630 [debug] [MainThread]: On model.dbt_first.new_logo_each_fiscal: Close
[0m18:54:07.737273 [info ] [MainThread]: 
[0m18:54:07.737273 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.86 seconds (10.86s).
[0m18:54:07.737273 [debug] [MainThread]: Command end result
[0m18:54:07.752263 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:54:07.752263 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:54:07.775329 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:54:07.775329 [info ] [MainThread]: 
[0m18:54:07.775329 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:54:07.775329 [info ] [MainThread]: 
[0m18:54:07.775329 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:54:07.775329 [debug] [MainThread]: Command `dbt run` succeeded at 18:54:07.775329 after 13.82 seconds
[0m18:54:07.775329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E43FC9BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E46843290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E3E488050>]}
[0m18:54:07.775329 [debug] [MainThread]: Flushing usage events
[0m18:54:08.819256 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:56:02.922280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD36488260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD35C731A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD34008B90>]}


============================== 18:56:02.922280 | bafd8871-d336-463b-950f-f1e1079c281f ==============================
[0m18:56:02.922280 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:56:02.931408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:fiscal', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:56:03.454521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bafd8871-d336-463b-950f-f1e1079c281f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD3388E8A0>]}
[0m18:56:03.528659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bafd8871-d336-463b-950f-f1e1079c281f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD37197470>]}
[0m18:56:03.530104 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:56:03.940025 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:56:04.152818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:56:04.152818 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\new_logo_each_fiscal.sql
[0m18:56:04.419376 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:56:04.432183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bafd8871-d336-463b-950f-f1e1079c281f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD38687A70>]}
[0m18:56:04.501438 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:56:04.516608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:56:04.538081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bafd8871-d336-463b-950f-f1e1079c281f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD387CAE10>]}
[0m18:56:04.538081 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:56:04.547907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bafd8871-d336-463b-950f-f1e1079c281f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD384469C0>]}
[0m18:56:04.547907 [info ] [MainThread]: 
[0m18:56:04.547907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:56:04.547907 [info ] [MainThread]: 
[0m18:56:04.551544 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:56:04.552587 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:56:04.650731 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:56:04.650731 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:56:04.651887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:06.576332 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.926 seconds
[0m18:56:06.584273 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m18:56:06.595761 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:56:06.600442 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:56:06.600442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:08.139373 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.539 seconds
[0m18:56:08.139373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m18:56:08.139373 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:56:08.139373 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:56:08.498862 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.354 seconds
[0m18:56:08.500862 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m18:56:08.552521 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:56:08.552521 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:56:08.870676 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.321 seconds
[0m18:56:08.875339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bafd8871-d336-463b-950f-f1e1079c281f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD33927350>]}
[0m18:56:08.875339 [debug] [Thread-1 (]: Began running node model.dbt_first.new_logo_each_fiscal
[0m18:56:08.875339 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.new_logo_each_fiscal ......................... [RUN]
[0m18:56:08.875339 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.new_logo_each_fiscal'
[0m18:56:08.875339 [debug] [Thread-1 (]: Began compiling node model.dbt_first.new_logo_each_fiscal
[0m18:56:08.890547 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.new_logo_each_fiscal"
[0m18:56:08.892553 [debug] [Thread-1 (]: Began executing node model.dbt_first.new_logo_each_fiscal
[0m18:56:08.922485 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.new_logo_each_fiscal"
[0m18:56:08.922485 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.new_logo_each_fiscal"
[0m18:56:08.922485 [debug] [Thread-1 (]: On model.dbt_first.new_logo_each_fiscal: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.new_logo_each_fiscal"} */
create or replace transient table HEALTHCARE.mart.new_logo_each_fiscal
         as
        (

WITH cte_new_logos as (
    SELECT 
        customer_id, 
        MIN(payment_date) AS first_purchase_date,
        EXTRACT(YEAR FROM MIN(payment_date)) AS fiscal_year
    FROM 
        HEALTHCARE.stage.stg_transactions
    GROUP BY 
        customer_id
)

SELECT 
    fiscal_year, 
    COUNT(DISTINCT customer_id) AS new_customers
FROM 
    cte_new_logos 
GROUP BY 
    fiscal_year
        );
[0m18:56:08.922485 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:56:11.258940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.328 seconds
[0m18:56:11.282209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bafd8871-d336-463b-950f-f1e1079c281f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD3866B170>]}
[0m18:56:11.284215 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.new_logo_each_fiscal .................... [[32mSUCCESS 1[0m in 2.41s]
[0m18:56:11.284215 [debug] [Thread-1 (]: Finished running node model.dbt_first.new_logo_each_fiscal
[0m18:56:11.286970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:56:11.286970 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:56:11.286970 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:56:11.810844 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m18:56:11.810844 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m18:56:12.333559 [debug] [MainThread]: Connection 'model.dbt_first.new_logo_each_fiscal' was left open.
[0m18:56:12.335565 [debug] [MainThread]: On model.dbt_first.new_logo_each_fiscal: Close
[0m18:56:12.860552 [info ] [MainThread]: 
[0m18:56:12.860552 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.31 seconds (8.31s).
[0m18:56:12.860552 [debug] [MainThread]: Command end result
[0m18:56:12.883289 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:56:12.883289 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:56:12.896894 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:56:12.896894 [info ] [MainThread]: 
[0m18:56:12.899575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:56:12.899575 [info ] [MainThread]: 
[0m18:56:12.900583 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:56:12.901582 [debug] [MainThread]: Command `dbt run` succeeded at 18:56:12.901582 after 10.16 seconds
[0m18:56:12.901582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD34008B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD364A2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD364A1C70>]}
[0m18:56:12.902615 [debug] [MainThread]: Flushing usage events
[0m18:56:13.896173 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:58:19.719260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F910B24920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9104DB770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F910B243E0>]}


============================== 18:58:19.719260 | 2efb7bc8-4b43-45c6-bb55-5b8fe1cd8b59 ==============================
[0m18:58:19.719260 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:58:19.719260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:rank_product_revenue', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:58:20.195140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2efb7bc8-4b43-45c6-bb55-5b8fe1cd8b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F910AFF800>]}
[0m18:58:20.254577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2efb7bc8-4b43-45c6-bb55-5b8fe1cd8b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90E25FFE0>]}
[0m18:58:20.254577 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:58:20.617620 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:58:20.808610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:58:20.808610 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m18:58:21.055600 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m18:58:21.077466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2efb7bc8-4b43-45c6-bb55-5b8fe1cd8b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F912E5E5D0>]}
[0m18:58:21.158221 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:58:21.162449 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:58:21.190862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2efb7bc8-4b43-45c6-bb55-5b8fe1cd8b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F912DF8440>]}
[0m18:58:21.190862 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m18:58:21.190862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2efb7bc8-4b43-45c6-bb55-5b8fe1cd8b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F912BE9640>]}
[0m18:58:21.190862 [info ] [MainThread]: 
[0m18:58:21.190862 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:58:21.190862 [info ] [MainThread]: 
[0m18:58:21.190862 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:58:21.190862 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m18:58:21.287520 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m18:58:21.287520 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m18:58:21.287520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:23.189238 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.907 seconds
[0m18:58:23.204566 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m18:58:23.204566 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m18:58:23.204566 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m18:58:23.204566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:24.702305 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.485 seconds
[0m18:58:24.704334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m18:58:24.706337 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m18:58:24.708331 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m18:58:25.066915 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.363 seconds
[0m18:58:25.066915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m18:58:25.114817 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m18:58:25.114817 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m18:58:25.469585 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.359 seconds
[0m18:58:25.485415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2efb7bc8-4b43-45c6-bb55-5b8fe1cd8b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F912EA02F0>]}
[0m18:58:25.485415 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m18:58:25.485415 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_product_revenue ......................... [RUN]
[0m18:58:25.485415 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_product_revenue'
[0m18:58:25.485415 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m18:58:25.502212 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m18:58:25.503083 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m18:58:25.540507 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m18:58:25.541515 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m18:58:25.544075 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

-- WITH cte_product_revenue AS (
--     SELECT 
--         product_id,
--         SUM(revenue*quantity) AS total_revenue
--     FROM HEALTHCARE.stage.stg_transactions 
--     where revenue_type = 1 and revenue > 0
--     GROUP BY 
--         product_id
-- )
-- SELECT 
--     product_id,
--     total_revenue,
--     DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS product_rank
-- FROM cte_product_revenue 


WITH product_revenue AS (
    SELECT 
        t.PRODUCT_ID, 
        p.PRODUCT_Family,
        SUM(t.REVENUE) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions t
    JOIN HEALTHCARE.stage.stg_products p
    ON t.PRODUCT_ID = p.PRODUCT_ID
    GROUP BY t.PRODUCT_ID, p.PRODUCT_Family
)

SELECT 
    PRODUCT_ID, 
    PRODUCT_Family,
    total_revenue, 
    RANK() over (ORDER BY total_revenue DESC) AS revenue_rank
FROM product_revenue
        );
[0m18:58:25.544075 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:58:27.976407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.439 seconds
[0m18:58:28.007959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efb7bc8-4b43-45c6-bb55-5b8fe1cd8b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90FFE0B00>]}
[0m18:58:28.007959 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_product_revenue .................... [[32mSUCCESS 1[0m in 2.51s]
[0m18:58:28.007959 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m18:58:28.007959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:28.007959 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m18:58:28.007959 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m18:58:28.538141 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m18:58:28.539181 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m18:58:29.049067 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was left open.
[0m18:58:29.049067 [debug] [MainThread]: On model.dbt_first.rank_product_revenue: Close
[0m18:58:29.578561 [info ] [MainThread]: 
[0m18:58:29.579609 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.38 seconds (8.38s).
[0m18:58:29.581571 [debug] [MainThread]: Command end result
[0m18:58:29.604414 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m18:58:29.604414 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m18:58:29.620580 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m18:58:29.621548 [info ] [MainThread]: 
[0m18:58:29.621548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:29.621548 [info ] [MainThread]: 
[0m18:58:29.621548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:58:29.621548 [debug] [MainThread]: Command `dbt run` succeeded at 18:58:29.621548 after 10.14 seconds
[0m18:58:29.621548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90FF6BFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F910699D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F91151B020>]}
[0m18:58:29.621548 [debug] [MainThread]: Flushing usage events
[0m18:58:30.569140 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:01:28.065299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD979ED010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD979ECC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD979EC290>]}


============================== 19:01:28.082894 | a50e51ae-40b7-4d8f-8165-5448cbf72a9e ==============================
[0m19:01:28.082894 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:01:28.082894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:rank_product_revenue', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:01:28.536016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a50e51ae-40b7-4d8f-8165-5448cbf72a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD98472F60>]}
[0m19:01:28.602768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a50e51ae-40b7-4d8f-8165-5448cbf72a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD985B8740>]}
[0m19:01:28.604772 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:01:28.959237 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:01:29.170232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:01:29.172238 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m19:01:29.419365 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m19:01:29.423377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a50e51ae-40b7-4d8f-8165-5448cbf72a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD99D2E420>]}
[0m19:01:29.509844 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:01:29.512846 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:01:29.541504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a50e51ae-40b7-4d8f-8165-5448cbf72a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD99CC9E20>]}
[0m19:01:29.541504 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m19:01:29.544422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a50e51ae-40b7-4d8f-8165-5448cbf72a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD99796000>]}
[0m19:01:29.544422 [info ] [MainThread]: 
[0m19:01:29.544422 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:01:29.544422 [info ] [MainThread]: 
[0m19:01:29.544422 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:01:29.544422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m19:01:29.646477 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m19:01:29.647512 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m19:01:29.647512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:31.659172 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.014 seconds
[0m19:01:31.659172 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m19:01:31.677093 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m19:01:31.677093 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m19:01:31.677093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:33.142021 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.464 seconds
[0m19:01:33.144022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m19:01:33.149020 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m19:01:33.149020 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m19:01:33.490756 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.342 seconds
[0m19:01:33.492764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m19:01:33.546887 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m19:01:33.546887 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m19:01:33.963164 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.406 seconds
[0m19:01:33.964986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a50e51ae-40b7-4d8f-8165-5448cbf72a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD94E536E0>]}
[0m19:01:33.964986 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_product_revenue
[0m19:01:33.964986 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_product_revenue ......................... [RUN]
[0m19:01:33.964986 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_product_revenue'
[0m19:01:33.964986 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_product_revenue
[0m19:01:33.982684 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_product_revenue"
[0m19:01:33.984645 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_product_revenue
[0m19:01:34.018004 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_product_revenue"
[0m19:01:34.020015 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_product_revenue"
[0m19:01:34.020015 [debug] [Thread-1 (]: On model.dbt_first.rank_product_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_product_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_product_revenue
         as
        (

-- WITH cte_product_revenue AS (
--     SELECT 
--         product_id,
--         SUM(revenue*quantity) AS total_revenue
--     FROM HEALTHCARE.stage.stg_transactions 
--     where revenue_type = 1 and revenue > 0
--     GROUP BY 
--         product_id
-- )
-- SELECT 
--     product_id,
--     total_revenue,
--     DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS product_rank
-- FROM cte_product_revenue 


WITH product_revenue AS (
    SELECT 
        t.product_id, 
        p.product_family,
        SUM(t.revenue) AS total_revenue
    FROM HEALTHCARE.stage.stg_transactions t
    JOIN HEALTHCARE.stage.stg_products p
    ON t.product_id = p.product_id
    WHERE t.revenue_type = 1 
    GROUP BY t.product_id, p.product_family
)

SELECT 
    product_id, 
    product_family,
    total_revenue, 
    RANK() over (ORDER BY total_revenue DESC) AS revenue_rank
FROM product_revenue
        );
[0m19:01:34.022023 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:01:36.472721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.456 seconds
[0m19:01:36.488734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a50e51ae-40b7-4d8f-8165-5448cbf72a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD99BBAD50>]}
[0m19:01:36.488734 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_product_revenue .................... [[32mSUCCESS 1[0m in 2.52s]
[0m19:01:36.488734 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_product_revenue
[0m19:01:36.488734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:36.488734 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m19:01:36.488734 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m19:01:37.022484 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m19:01:37.022484 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m19:01:37.533400 [debug] [MainThread]: Connection 'model.dbt_first.rank_product_revenue' was left open.
[0m19:01:37.549245 [debug] [MainThread]: On model.dbt_first.rank_product_revenue: Close
[0m19:01:38.089544 [info ] [MainThread]: 
[0m19:01:38.089544 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m19:01:38.089544 [debug] [MainThread]: Command end result
[0m19:01:38.123458 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:01:38.125457 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:01:38.125457 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m19:01:38.125457 [info ] [MainThread]: 
[0m19:01:38.133016 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:01:38.134039 [info ] [MainThread]: 
[0m19:01:38.136023 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:01:38.137024 [debug] [MainThread]: Command `dbt run` succeeded at 19:01:38.137024 after 10.29 seconds
[0m19:01:38.137024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD94C21A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD978BFFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD978BDB80>]}
[0m19:01:38.138021 [debug] [MainThread]: Flushing usage events
[0m19:01:40.537563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:08:03.800531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242F9971FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242F9972030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242F9972060>]}


============================== 19:08:03.815959 | 401c87ac-614c-48fe-85b4-fcaec55b92da ==============================
[0m19:08:03.815959 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:08:03.815959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'send_anonymous_usage_stats': 'True'}
[0m19:08:04.280912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '401c87ac-614c-48fe-85b4-fcaec55b92da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242FA3E7A10>]}
[0m19:08:04.340696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '401c87ac-614c-48fe-85b4-fcaec55b92da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242FB0BD7C0>]}
[0m19:08:04.351031 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:08:04.718565 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:08:04.918849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:08:04.918849 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m19:08:04.918849 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m19:08:05.120189 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_first.rank_customers_revenue' (models\Mart\rank_customers_revenue.sql) depends on a node named 'remove_null_transactions' which was not found
[0m19:08:05.120189 [debug] [MainThread]: Command `dbt run` failed at 19:08:05.120189 after 1.55 seconds
[0m19:08:05.120189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242FA23F770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242FADB3FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242FA40D460>]}
[0m19:08:05.120189 [debug] [MainThread]: Flushing usage events
[0m19:08:06.488984 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:08:31.728378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9C01CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9C01CFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9C01D1F0>]}


============================== 19:08:31.728378 | b60db5cf-4910-4654-82df-ce2a6e2013f1 ==============================
[0m19:08:31.728378 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:08:31.728378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'send_anonymous_usage_stats': 'True'}
[0m19:08:32.193202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b60db5cf-4910-4654-82df-ce2a6e2013f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9BC5CA40>]}
[0m19:08:32.245792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b60db5cf-4910-4654-82df-ce2a6e2013f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9CD13B90>]}
[0m19:08:32.245792 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:08:32.601470 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:08:32.779541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:08:32.779541 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m19:08:32.779541 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_product_revenue.sql
[0m19:08:33.017030 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m19:08:33.039385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b60db5cf-4910-4654-82df-ce2a6e2013f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9DE35760>]}
[0m19:08:33.113339 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:08:33.113339 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:08:33.147387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b60db5cf-4910-4654-82df-ce2a6e2013f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9E00B860>]}
[0m19:08:33.150022 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m19:08:33.150022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b60db5cf-4910-4654-82df-ce2a6e2013f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9E050A40>]}
[0m19:08:33.150022 [info ] [MainThread]: 
[0m19:08:33.150022 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:08:33.150022 [info ] [MainThread]: 
[0m19:08:33.150022 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:08:33.150022 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m19:08:33.251853 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m19:08:33.251853 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m19:08:33.251853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:35.408285 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.157 seconds
[0m19:08:35.421633 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m19:08:35.431633 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m19:08:35.432098 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m19:08:35.432098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:08:36.873893 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.442 seconds
[0m19:08:36.875644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m19:08:36.924738 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m19:08:36.924738 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m19:08:37.254040 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.327 seconds
[0m19:08:37.256049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_raw)
[0m19:08:37.258055 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m19:08:37.258055 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m19:08:37.664329 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.411 seconds
[0m19:08:37.664329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b60db5cf-4910-4654-82df-ce2a6e2013f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E99483830>]}
[0m19:08:37.680219 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m19:08:37.680219 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m19:08:37.680219 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m19:08:37.680219 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m19:08:37.690499 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m19:08:37.690499 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m19:08:37.718702 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m19:08:37.718702 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m19:08:37.718702 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (

WITH cte_customer_revenue AS (
    SELECT 
        customer_id, 
        SUM(revenue) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    GROUP BY 
        customer_id
)

SELECT 
    cr.customer_id, 
    c.customer_name, 
    cr.total_revenue, 
    RANK() OVER (ORDER BY cr.total_revenue DESC) as revenue_rank,
    crg.country,
    crg.region
FROM 
    cte_customer_revenue cr
JOIN   
    HEALTHCARE.stage.stg_customers c
ON 
    cr.customer_id = c.customer_id
LEFT JOIN 
    HEALTHCARE.stage.stg_country_region crg
ON 
    cr.customer_id = crg.customer_id
        );
[0m19:08:37.718702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:08:40.106375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.388 seconds
[0m19:08:40.131348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b60db5cf-4910-4654-82df-ce2a6e2013f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E993EDBE0>]}
[0m19:08:40.131348 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_customers_revenue .................. [[32mSUCCESS 1[0m in 2.45s]
[0m19:08:40.131348 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m19:08:40.131348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:08:40.131348 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m19:08:40.131348 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m19:08:40.667288 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m19:08:40.683192 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m19:08:41.185781 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m19:08:41.185781 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m19:08:41.713724 [info ] [MainThread]: 
[0m19:08:41.714723 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.56 seconds (8.56s).
[0m19:08:41.715722 [debug] [MainThread]: Command end result
[0m19:08:41.740155 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:08:41.743070 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:08:41.749868 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m19:08:41.749868 [info ] [MainThread]: 
[0m19:08:41.749868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:08:41.749868 [info ] [MainThread]: 
[0m19:08:41.751873 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:08:41.751873 [debug] [MainThread]: Command `dbt run` succeeded at 19:08:41.751873 after 10.18 seconds
[0m19:08:41.751873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9E098CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9E098D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E9CC858E0>]}
[0m19:08:41.751873 [debug] [MainThread]: Flushing usage events
[0m19:08:42.799984 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:09:13.611013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07A774590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A077D317C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07A774260>]}


============================== 19:09:13.616045 | b6924b0d-b88a-4408-b40c-255c0e6f0122 ==============================
[0m19:09:13.616045 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:09:13.617012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:rank_customers_revenue', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:09:14.139274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6924b0d-b88a-4408-b40c-255c0e6f0122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07A642750>]}
[0m19:09:14.204388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6924b0d-b88a-4408-b40c-255c0e6f0122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07B445B50>]}
[0m19:09:14.206394 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:09:14.662673 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:09:16.033371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:09:16.035377 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\rank_customers_revenue.sql
[0m19:09:16.276144 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m19:09:16.289475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6924b0d-b88a-4408-b40c-255c0e6f0122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07CACE780>]}
[0m19:09:16.357119 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:09:16.373778 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:09:16.418132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6924b0d-b88a-4408-b40c-255c0e6f0122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07CA69CA0>]}
[0m19:09:16.418132 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m19:09:16.419132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6924b0d-b88a-4408-b40c-255c0e6f0122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07C5EB260>]}
[0m19:09:16.420132 [info ] [MainThread]: 
[0m19:09:16.421132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:09:16.422172 [info ] [MainThread]: 
[0m19:09:16.423135 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:09:16.424164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m19:09:19.060414 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m19:09:19.060414 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m19:09:19.062420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:21.076213 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.021 seconds
[0m19:09:21.076213 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m19:09:21.092021 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m19:09:21.092021 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m19:09:21.092021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:09:22.577922 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.478 seconds
[0m19:09:22.580655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m19:09:22.583646 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m19:09:22.584647 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m19:09:22.920142 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.347 seconds
[0m19:09:22.920142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m19:09:22.985702 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m19:09:22.985702 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m19:09:23.322502 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.336 seconds
[0m19:09:23.322502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6924b0d-b88a-4408-b40c-255c0e6f0122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07CE78170>]}
[0m19:09:23.322502 [debug] [Thread-1 (]: Began running node model.dbt_first.rank_customers_revenue
[0m19:09:23.322502 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.rank_customers_revenue ....................... [RUN]
[0m19:09:23.322502 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.rank_customers_revenue'
[0m19:09:23.322502 [debug] [Thread-1 (]: Began compiling node model.dbt_first.rank_customers_revenue
[0m19:09:23.341251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.rank_customers_revenue"
[0m19:09:23.342251 [debug] [Thread-1 (]: Began executing node model.dbt_first.rank_customers_revenue
[0m19:09:23.363602 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.rank_customers_revenue"
[0m19:09:23.363602 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.rank_customers_revenue"
[0m19:09:23.363602 [debug] [Thread-1 (]: On model.dbt_first.rank_customers_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.rank_customers_revenue"} */
create or replace transient table HEALTHCARE.mart.rank_customers_revenue
         as
        (

WITH cte_customer_revenue AS (
    SELECT 
        customer_id, 
        SUM(revenue) AS total_revenue
    FROM 
        HEALTHCARE.stage.stg_transactions
    GROUP BY 
        customer_id
)

SELECT 
    cr.customer_id, 
    c.customer_name, 
    cr.total_revenue, 
    crg.country,
    crg.region,
    RANK() OVER (ORDER BY cr.total_revenue DESC) as revenue_rank
    
FROM 
    cte_customer_revenue cr
JOIN   
    HEALTHCARE.stage.stg_customers c
ON 
    cr.customer_id = c.customer_id
LEFT JOIN 
    HEALTHCARE.stage.stg_country_region crg
ON 
    cr.customer_id = crg.customer_id
        );
[0m19:09:23.379104 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:09:25.766158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.386 seconds
[0m19:09:25.783248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6924b0d-b88a-4408-b40c-255c0e6f0122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A079C20AA0>]}
[0m19:09:25.783248 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.rank_customers_revenue .................. [[32mSUCCESS 1[0m in 2.46s]
[0m19:09:25.783248 [debug] [Thread-1 (]: Finished running node model.dbt_first.rank_customers_revenue
[0m19:09:25.783248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:09:25.783248 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m19:09:25.783248 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m19:09:26.348880 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m19:09:26.348880 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m19:09:26.885463 [debug] [MainThread]: Connection 'model.dbt_first.rank_customers_revenue' was left open.
[0m19:09:26.885463 [debug] [MainThread]: On model.dbt_first.rank_customers_revenue: Close
[0m19:09:27.452851 [info ] [MainThread]: 
[0m19:09:27.452851 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.03 seconds (11.03s).
[0m19:09:27.452851 [debug] [MainThread]: Command end result
[0m19:09:27.474921 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:09:27.474921 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:09:27.484844 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m19:09:27.486351 [info ] [MainThread]: 
[0m19:09:27.487362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:09:27.488359 [info ] [MainThread]: 
[0m19:09:27.488359 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:09:27.489390 [debug] [MainThread]: Command `dbt run` succeeded at 19:09:27.489390 after 14.07 seconds
[0m19:09:27.490390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A078516720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07A423FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A07B445460>]}
[0m19:09:27.490390 [debug] [MainThread]: Flushing usage events
[0m19:09:28.471246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:17:42.029766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62D4E21B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62D4E2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62D4E05F0>]}


============================== 19:17:42.031168 | 6efc08e3-cbda-48af-8cae-6becd7c612b0 ==============================
[0m19:17:42.031168 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:17:42.031168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:cross_sell', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:17:42.771917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6efc08e3-cbda-48af-8cae-6becd7c612b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62CAC3FB0>]}
[0m19:17:42.828685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6efc08e3-cbda-48af-8cae-6becd7c612b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62E229160>]}
[0m19:17:42.828685 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:17:43.209257 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:17:43.448915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:17:43.448915 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\product_churn.sql
[0m19:17:43.448915 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\highest_cross_sell.sql
[0m19:17:43.711965 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m19:17:43.731844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6efc08e3-cbda-48af-8cae-6becd7c612b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62F84CA70>]}
[0m19:17:43.796622 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:17:43.816371 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:17:43.862833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6efc08e3-cbda-48af-8cae-6becd7c612b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62F9C4BF0>]}
[0m19:17:43.863834 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m19:17:43.863834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6efc08e3-cbda-48af-8cae-6becd7c612b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62F7703B0>]}
[0m19:17:43.866549 [info ] [MainThread]: 
[0m19:17:43.866907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:17:43.867914 [info ] [MainThread]: 
[0m19:17:43.867914 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:17:43.868948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m19:17:43.962238 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m19:17:43.962238 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m19:17:43.962238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:46.165352 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.193 seconds
[0m19:17:46.169322 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_mart'
[0m19:17:46.184102 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m19:17:46.184102 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m19:17:46.184102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:17:47.846074 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.662 seconds
[0m19:17:47.846074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m19:17:47.893899 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m19:17:47.893899 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m19:17:48.278420 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.393 seconds
[0m19:17:48.278420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m19:17:48.294133 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m19:17:48.294133 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m19:17:48.620161 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.323 seconds
[0m19:17:48.620161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6efc08e3-cbda-48af-8cae-6becd7c612b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62AA574A0>]}
[0m19:17:48.620161 [debug] [Thread-1 (]: Began running node model.dbt_first.highest_cross_sell
[0m19:17:48.620161 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.highest_cross_sell ........................... [RUN]
[0m19:17:48.620161 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.highest_cross_sell'
[0m19:17:48.620161 [debug] [Thread-1 (]: Began compiling node model.dbt_first.highest_cross_sell
[0m19:17:48.636207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.highest_cross_sell"
[0m19:17:48.636207 [debug] [Thread-1 (]: Began executing node model.dbt_first.highest_cross_sell
[0m19:17:48.669476 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.highest_cross_sell"
[0m19:17:48.669476 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.highest_cross_sell"
[0m19:17:48.669476 [debug] [Thread-1 (]: On model.dbt_first.highest_cross_sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.highest_cross_sell"} */
create or replace transient table HEALTHCARE.mart.highest_cross_sell
         as
        (

WITH cte_customer_product_count AS (
    SELECT 
        customer_id,
        COUNT(DISTINCT product_id) AS product_count
    FROM 
        HEALTHCARE.stage.stg_transactions
    GROUP BY 
        customer_id
),
cte_highest_cross_sell AS (
    SELECT 
        customer_id,
        product_count,
        DENSE_RANK() OVER(ORDER BY product_count DESC) AS cross_sell_rank
    FROM 
        cte_customer_product_count
)
SELECT 
    hcs.customer_id,
    c.customer_name,
    hcs.product_count,
    hcs.cross_sell_rank
FROM 
    cte_highest_cross_sell AS hcs
INNER JOIN 
      HEALTHCARE.stage.stg_customers AS c
ON 
    hcs.customer_id = c.customer_id
ORDER BY 
    hcs.cross_sell_rank
        );
[0m19:17:48.669476 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:17:51.018915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.352 seconds
[0m19:17:51.048756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6efc08e3-cbda-48af-8cae-6becd7c612b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62A9BD6A0>]}
[0m19:17:51.048756 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.highest_cross_sell ...................... [[32mSUCCESS 1[0m in 2.43s]
[0m19:17:51.048756 [debug] [Thread-1 (]: Finished running node model.dbt_first.highest_cross_sell
[0m19:17:51.048756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:17:51.048756 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m19:17:51.048756 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m19:17:51.591082 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m19:17:51.591082 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m19:17:52.143173 [debug] [MainThread]: Connection 'model.dbt_first.highest_cross_sell' was left open.
[0m19:17:52.145233 [debug] [MainThread]: On model.dbt_first.highest_cross_sell: Close
[0m19:17:52.655163 [info ] [MainThread]: 
[0m19:17:52.655163 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m19:17:52.655163 [debug] [MainThread]: Command end result
[0m19:17:52.691023 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:17:52.693938 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:17:52.698970 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m19:17:52.698970 [info ] [MainThread]: 
[0m19:17:52.698970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:17:52.698970 [info ] [MainThread]: 
[0m19:17:52.698970 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:17:52.698970 [debug] [MainThread]: Command `dbt run` succeeded at 19:17:52.698970 after 10.97 seconds
[0m19:17:52.703940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62D07C470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62D005F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B62D0061E0>]}
[0m19:17:52.703940 [debug] [MainThread]: Flushing usage events
[0m19:17:54.042450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:19:48.164785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C0BF5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C0BF5A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C0BF4D70>]}


============================== 19:19:48.178772 | 5dfb3fd9-c064-4cc9-902f-47af621a4fb4 ==============================
[0m19:19:48.178772 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:19:48.178772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:pchurn', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:19:48.652569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dfb3fd9-c064-4cc9-902f-47af621a4fb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C0BF4B00>]}
[0m19:19:48.718382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dfb3fd9-c064-4cc9-902f-47af621a4fb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C0D5CE90>]}
[0m19:19:48.721850 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:19:49.073169 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:19:49.270206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:19:49.270206 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\product_churn.sql
[0m19:19:49.541367 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m19:19:49.558005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dfb3fd9-c064-4cc9-902f-47af621a4fb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C2CDB410>]}
[0m19:19:49.641782 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:19:49.644781 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:19:49.670232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dfb3fd9-c064-4cc9-902f-47af621a4fb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C2ECDBE0>]}
[0m19:19:49.670232 [info ] [MainThread]: Found 11 models, 1 seed, 4 sources, 477 macros
[0m19:19:49.670232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dfb3fd9-c064-4cc9-902f-47af621a4fb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C2C90860>]}
[0m19:19:49.670232 [info ] [MainThread]: 
[0m19:19:49.670232 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:49.670232 [info ] [MainThread]: 
[0m19:19:49.670232 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:19:49.670232 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m19:19:49.770929 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m19:19:49.770929 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m19:19:49.770929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:51.582555 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.819 seconds
[0m19:19:51.598466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m19:19:51.598466 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m19:19:51.598466 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m19:19:51.598466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:53.089901 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.484 seconds
[0m19:19:53.089901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m19:19:53.101816 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m19:19:53.101816 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m19:19:53.425939 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.335 seconds
[0m19:19:53.425939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m19:19:53.489480 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m19:19:53.489480 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m19:19:53.927975 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.444 seconds
[0m19:19:53.927975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dfb3fd9-c064-4cc9-902f-47af621a4fb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C0C7AF30>]}
[0m19:19:53.944027 [debug] [Thread-1 (]: Began running node model.dbt_first.product_churn
[0m19:19:53.944027 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.product_churn ................................ [RUN]
[0m19:19:53.944027 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.product_churn'
[0m19:19:53.944027 [debug] [Thread-1 (]: Began compiling node model.dbt_first.product_churn
[0m19:19:53.957203 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.product_churn"
[0m19:19:53.957203 [debug] [Thread-1 (]: Began executing node model.dbt_first.product_churn
[0m19:19:53.991307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.product_churn"
[0m19:19:53.993326 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.product_churn"
[0m19:19:53.993326 [debug] [Thread-1 (]: On model.dbt_first.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.product_churn"} */
create or replace transient table HEALTHCARE.mart.product_churn
         as
        (

WITH cte_trunc_date AS (
    SELECT
        PRODUCT_ID,
        DATE_TRUNC('month',PAYMENT_DATE) AS transaction_month
    FROM HEALTHCARE.stage.stg_transactions
),
 
cte_max_month AS (
    SELECT MAX(transaction_month) AS latest_month FROM cte_trunc_date
),
 
churn_status AS (
    SELECT
        t.PRODUCT_ID,
        m.latest_month,
        CASE
            WHEN MAX(t.transaction_month) <= DATEADD('month', -3, m.latest_month) THEN 'Inactive'
            ELSE 'Active'
        END AS L3m_status,
        CASE
            WHEN MAX(t.transaction_month) <= DATEADD('month', -1, m.latest_month) THEN 'Inactive'
            ELSE 'Active'
        END AS LM_status,
        CASE
            WHEN MAX(t.transaction_month) <= DATEADD('month', -12, m.latest_month) THEN 'Inactive'
            ELSE 'Active'
        END AS Ltm_status
    FROM cte_trunc_date t
    CROSS JOIN cte_max_month m
    GROUP BY t.PRODUCT_ID,m.latest_month
)
 
SELECT * FROM churn_status
        );
[0m19:19:53.993326 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:19:56.241944 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.246 seconds
[0m19:19:56.258763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dfb3fd9-c064-4cc9-902f-47af621a4fb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C00B0950>]}
[0m19:19:56.258763 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.product_churn ........................... [[32mSUCCESS 1[0m in 2.31s]
[0m19:19:56.258763 [debug] [Thread-1 (]: Finished running node model.dbt_first.product_churn
[0m19:19:56.258763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:56.258763 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m19:19:56.258763 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m19:19:56.800813 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m19:19:56.800813 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m19:19:57.313828 [debug] [MainThread]: Connection 'model.dbt_first.product_churn' was left open.
[0m19:19:57.313828 [debug] [MainThread]: On model.dbt_first.product_churn: Close
[0m19:19:57.828823 [info ] [MainThread]: 
[0m19:19:57.828823 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.16 seconds (8.16s).
[0m19:19:57.846261 [debug] [MainThread]: Command end result
[0m19:19:57.885713 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:19:57.888793 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:19:57.896113 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m19:19:57.896113 [info ] [MainThread]: 
[0m19:19:57.897121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:57.898112 [info ] [MainThread]: 
[0m19:19:57.899113 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:19:57.902121 [debug] [MainThread]: Command `dbt run` succeeded at 19:19:57.901137 after 9.96 seconds
[0m19:19:57.902121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C19661E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C19665D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0C1964590>]}
[0m19:19:57.903123 [debug] [MainThread]: Flushing usage events
[0m19:19:58.846981 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:21:45.501352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78582F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78582C830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78582E300>]}


============================== 19:21:45.509638 | 031adeae-a5b5-436b-a882-434e35addeae ==============================
[0m19:21:45.509638 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:21:45.511647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:rr', 'send_anonymous_usage_stats': 'True'}
[0m19:21:45.979778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '031adeae-a5b5-436b-a882-434e35addeae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A787708B60>]}
[0m19:21:46.054049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '031adeae-a5b5-436b-a882-434e35addeae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7863BAF60>]}
[0m19:21:46.054049 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:21:46.419121 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:21:46.620533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:21:46.620533 [debug] [MainThread]: Partial parsing: added file: dbt_first://models\Mart\retention_revenue.sql
[0m19:21:46.620533 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\product_churn.sql
[0m19:21:46.889223 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m19:21:46.905347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '031adeae-a5b5-436b-a882-434e35addeae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A787758B30>]}
[0m19:21:46.988013 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:21:46.991051 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:21:47.020514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '031adeae-a5b5-436b-a882-434e35addeae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7865A10A0>]}
[0m19:21:47.020514 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 477 macros
[0m19:21:47.020514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '031adeae-a5b5-436b-a882-434e35addeae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A787C89940>]}
[0m19:21:47.020514 [info ] [MainThread]: 
[0m19:21:47.020514 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:21:47.020514 [info ] [MainThread]: 
[0m19:21:47.020514 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:21:47.020514 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m19:21:47.121140 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m19:21:47.121140 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m19:21:47.121140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:48.972740 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.860 seconds
[0m19:21:48.988470 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m19:21:49.002259 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m19:21:49.004265 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m19:21:49.004265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:50.601248 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.597 seconds
[0m19:21:50.603123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_mart)
[0m19:21:50.605128 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m19:21:50.605128 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m19:21:50.943945 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.339 seconds
[0m19:21:50.945690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_stage)
[0m19:21:50.949697 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m19:21:50.949697 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m19:21:51.293813 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.343 seconds
[0m19:21:51.301928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '031adeae-a5b5-436b-a882-434e35addeae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A787C75490>]}
[0m19:21:51.317629 [debug] [Thread-1 (]: Began running node model.dbt_first.retention_revenue
[0m19:21:51.317629 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.retention_revenue ............................ [RUN]
[0m19:21:51.317629 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.retention_revenue'
[0m19:21:51.317629 [debug] [Thread-1 (]: Began compiling node model.dbt_first.retention_revenue
[0m19:21:51.339435 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.retention_revenue"
[0m19:21:51.341409 [debug] [Thread-1 (]: Began executing node model.dbt_first.retention_revenue
[0m19:21:51.374162 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.retention_revenue"
[0m19:21:51.375590 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.retention_revenue"
[0m19:21:51.375590 [debug] [Thread-1 (]: On model.dbt_first.retention_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.retention_revenue"} */
create or replace transient table HEALTHCARE.mart.retention_revenue
         as
        (

WITH monthly_revenue AS (
    SELECT 
        PAYMENT_MONTH, 
        SUM(REVENUE) AS total_revenue,
        SUM(CASE WHEN REVENUE > 0 THEN REVENUE ELSE 0 END) AS retained_revenue,
        SUM(CASE WHEN REVENUE < 0 THEN REVENUE ELSE 0 END) AS churned_revenue
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY PAYMENT_MONTH
)

SELECT 
    PAYMENT_MONTH,
    retained_revenue / total_revenue AS GRR,
    (retained_revenue + churned_revenue) / total_revenue AS NRR
FROM monthly_revenue
        );
[0m19:21:51.375590 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:21:52.991926 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00df-0004-bb9f-0005-a3d30003c75a
[0m19:21:52.991926 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'PAYMENT_MONTH'
[0m19:21:53.006034 [debug] [Thread-1 (]: Database Error in model retention_revenue (models\Mart\retention_revenue.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\retention_revenue.sql
[0m19:21:53.006034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031adeae-a5b5-436b-a882-434e35addeae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A784E20AA0>]}
[0m19:21:53.006034 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.retention_revenue ................... [[31mERROR[0m in 1.69s]
[0m19:21:53.006034 [debug] [Thread-1 (]: Finished running node model.dbt_first.retention_revenue
[0m19:21:53.006034 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.retention_revenue' to be skipped because of status 'error'.  Reason: Database Error in model retention_revenue (models\Mart\retention_revenue.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\retention_revenue.sql.
[0m19:21:53.013668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:21:53.013668 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m19:21:53.013668 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m19:21:53.530351 [debug] [MainThread]: Connection 'list_HEALTHCARE_stage' was left open.
[0m19:21:53.532361 [debug] [MainThread]: On list_HEALTHCARE_stage: Close
[0m19:21:54.115505 [debug] [MainThread]: Connection 'model.dbt_first.retention_revenue' was left open.
[0m19:21:54.115505 [debug] [MainThread]: On model.dbt_first.retention_revenue: Close
[0m19:21:54.632278 [info ] [MainThread]: 
[0m19:21:54.633278 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m19:21:54.634278 [debug] [MainThread]: Command end result
[0m19:21:54.652280 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:21:54.661316 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:21:54.667324 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m19:21:54.670774 [info ] [MainThread]: 
[0m19:21:54.670774 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:21:54.670774 [info ] [MainThread]: 
[0m19:21:54.670774 [error] [MainThread]:   Database Error in model retention_revenue (models\Mart\retention_revenue.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\retention_revenue.sql
[0m19:21:54.670774 [info ] [MainThread]: 
[0m19:21:54.670774 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:21:54.670774 [debug] [MainThread]: Command `dbt run` failed at 19:21:54.670774 after 9.34 seconds
[0m19:21:54.670774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7834631A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A784A31820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7857CB320>]}
[0m19:21:54.670774 [debug] [MainThread]: Flushing usage events
[0m19:21:55.963978 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:33.325746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B989B29C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98992F800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B989B29400>]}


============================== 19:22:33.325746 | 0df0099d-fc08-4fc1-857a-e7a41f2580e2 ==============================
[0m19:22:33.325746 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:22:33.325746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:rr', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:22:33.781068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0df0099d-fc08-4fc1-857a-e7a41f2580e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B986ECE9C0>]}
[0m19:22:33.844261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0df0099d-fc08-4fc1-857a-e7a41f2580e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98A886F00>]}
[0m19:22:33.844261 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:22:34.205964 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:22:34.395455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:22:34.395455 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\retention_revenue.sql
[0m19:22:34.659812 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m19:22:34.673352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0df0099d-fc08-4fc1-857a-e7a41f2580e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98BE2E810>]}
[0m19:22:34.751118 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:22:34.751118 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:22:34.782571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0df0099d-fc08-4fc1-857a-e7a41f2580e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98BB41850>]}
[0m19:22:34.786073 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 477 macros
[0m19:22:34.786073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0df0099d-fc08-4fc1-857a-e7a41f2580e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98BDE8230>]}
[0m19:22:34.786073 [info ] [MainThread]: 
[0m19:22:34.786073 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:22:34.786073 [info ] [MainThread]: 
[0m19:22:34.786073 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:22:34.786073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m19:22:34.893145 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m19:22:34.893145 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m19:22:34.894173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:36.811678 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.928 seconds
[0m19:22:36.827408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_stage'
[0m19:22:36.836425 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m19:22:36.838431 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m19:22:36.838431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:38.315147 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.476 seconds
[0m19:22:38.317151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m19:22:38.366478 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m19:22:38.366478 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m19:22:38.722739 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.363 seconds
[0m19:22:38.722739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_mart, now list_HEALTHCARE_raw)
[0m19:22:38.722739 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m19:22:38.722739 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m19:22:39.107754 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.372 seconds
[0m19:22:39.109764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0df0099d-fc08-4fc1-857a-e7a41f2580e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B986F63800>]}
[0m19:22:39.111545 [debug] [Thread-1 (]: Began running node model.dbt_first.retention_revenue
[0m19:22:39.111545 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.retention_revenue ............................ [RUN]
[0m19:22:39.111545 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.retention_revenue'
[0m19:22:39.111545 [debug] [Thread-1 (]: Began compiling node model.dbt_first.retention_revenue
[0m19:22:39.111545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.retention_revenue"
[0m19:22:39.111545 [debug] [Thread-1 (]: Began executing node model.dbt_first.retention_revenue
[0m19:22:39.156728 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.retention_revenue"
[0m19:22:39.158759 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.retention_revenue"
[0m19:22:39.158759 [debug] [Thread-1 (]: On model.dbt_first.retention_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.retention_revenue"} */
create or replace transient table HEALTHCARE.mart.retention_revenue
         as
        (

WITH cte_monthly_revenue AS (
    SELECT 
        payment_date, 
        SUM(REVENUE) AS total_revenue,
        SUM(CASE WHEN REVENUE > 0 THEN REVENUE ELSE 0 END) AS retained_revenue,
        SUM(CASE WHEN REVENUE < 0 THEN REVENUE ELSE 0 END) AS churned_revenue
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY PAYMENT_MONTH
)

SELECT 
    payment_date,
    retained_revenue / total_revenue AS GRR,
    (retained_revenue + churned_revenue) / total_revenue AS NRR
FROM cte_monthly_revenue
        );
[0m19:22:39.159761 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:22:40.656426 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00e0-0004-bb9d-0005-a3d30003d60a
[0m19:22:40.656426 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 13
invalid identifier 'PAYMENT_MONTH'
[0m19:22:40.656426 [debug] [Thread-1 (]: Database Error in model retention_revenue (models\Mart\retention_revenue.sql)
  000904 (42000): SQL compilation error: error line 12 at position 13
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\retention_revenue.sql
[0m19:22:40.656426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0df0099d-fc08-4fc1-857a-e7a41f2580e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B98BBBA960>]}
[0m19:22:40.656426 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mart.retention_revenue ................... [[31mERROR[0m in 1.54s]
[0m19:22:40.656426 [debug] [Thread-1 (]: Finished running node model.dbt_first.retention_revenue
[0m19:22:40.656426 [debug] [Thread-4 (]: Marking all children of 'model.dbt_first.retention_revenue' to be skipped because of status 'error'.  Reason: Database Error in model retention_revenue (models\Mart\retention_revenue.sql)
  000904 (42000): SQL compilation error: error line 12 at position 13
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\retention_revenue.sql.
[0m19:22:40.656426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:40.656426 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m19:22:40.656426 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m19:22:41.178122 [debug] [MainThread]: Connection 'list_HEALTHCARE_raw' was left open.
[0m19:22:41.178122 [debug] [MainThread]: On list_HEALTHCARE_raw: Close
[0m19:22:41.710311 [debug] [MainThread]: Connection 'model.dbt_first.retention_revenue' was left open.
[0m19:22:41.711515 [debug] [MainThread]: On model.dbt_first.retention_revenue: Close
[0m19:22:42.227128 [info ] [MainThread]: 
[0m19:22:42.232798 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.44 seconds (7.44s).
[0m19:22:42.232798 [debug] [MainThread]: Command end result
[0m19:22:42.258762 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:22:42.261770 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:22:42.271221 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m19:22:42.272222 [info ] [MainThread]: 
[0m19:22:42.273219 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:22:42.273219 [info ] [MainThread]: 
[0m19:22:42.273219 [error] [MainThread]:   Database Error in model retention_revenue (models\Mart\retention_revenue.sql)
  000904 (42000): SQL compilation error: error line 12 at position 13
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\dbt_first\models\Mart\retention_revenue.sql
[0m19:22:42.273219 [info ] [MainThread]: 
[0m19:22:42.275483 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:22:42.278524 [debug] [MainThread]: Command `dbt run` failed at 19:22:42.278524 after 9.12 seconds
[0m19:22:42.278524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B988BBA0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9894D6630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9878C6450>]}
[0m19:22:42.279527 [debug] [MainThread]: Flushing usage events
[0m19:22:43.255302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:54.868687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6906A87D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6906A83E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6906A8D10>]}


============================== 19:22:54.873296 | 720e5c65-1b3e-4460-b802-30e19b8a0503 ==============================
[0m19:22:54.873296 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:22:54.874294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\VarshaS\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\VarshaS\\dbt_first\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:rr', 'send_anonymous_usage_stats': 'True'}
[0m19:22:55.353522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '720e5c65-1b3e-4460-b802-30e19b8a0503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F691114170>]}
[0m19:22:55.402563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '720e5c65-1b3e-4460-b802-30e19b8a0503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6906C0470>]}
[0m19:22:55.402563 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:22:55.759527 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:22:55.946578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:22:55.946578 [debug] [MainThread]: Partial parsing: updated file: dbt_first://models\Mart\retention_revenue.sql
[0m19:22:56.200066 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.healthcare.schema
[0m19:22:56.216008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '720e5c65-1b3e-4460-b802-30e19b8a0503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F692495760>]}
[0m19:22:56.289760 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:22:56.289760 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:22:56.335082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '720e5c65-1b3e-4460-b802-30e19b8a0503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6926E8FE0>]}
[0m19:22:56.338196 [info ] [MainThread]: Found 12 models, 1 seed, 4 sources, 477 macros
[0m19:22:56.338196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '720e5c65-1b3e-4460-b802-30e19b8a0503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6929B9CD0>]}
[0m19:22:56.340206 [info ] [MainThread]: 
[0m19:22:56.340206 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:22:56.342215 [info ] [MainThread]: 
[0m19:22:56.342215 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:22:56.342215 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE'
[0m19:22:56.451129 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE"
[0m19:22:56.451129 [debug] [ThreadPool]: On list_HEALTHCARE: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE"} */
show terse schemas in database HEALTHCARE
    limit 10000
[0m19:22:56.451129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:58.443804 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.997 seconds
[0m19:22:58.443804 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_HEALTHCARE_raw'
[0m19:22:58.457268 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_raw"
[0m19:22:58.457268 [debug] [ThreadPool]: On list_HEALTHCARE_raw: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_raw"} */
show objects in HEALTHCARE.raw limit 10000;
[0m19:22:58.457268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:00.154753 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.692 seconds
[0m19:23:00.154753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_raw, now list_HEALTHCARE_stage)
[0m19:23:00.202673 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_stage"
[0m19:23:00.202673 [debug] [ThreadPool]: On list_HEALTHCARE_stage: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_stage"} */
show objects in HEALTHCARE.stage limit 10000;
[0m19:23:00.538075 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.331 seconds
[0m19:23:00.538632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_HEALTHCARE_stage, now list_HEALTHCARE_mart)
[0m19:23:00.538632 [debug] [ThreadPool]: Using snowflake connection "list_HEALTHCARE_mart"
[0m19:23:00.538632 [debug] [ThreadPool]: On list_HEALTHCARE_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "connection_name": "list_HEALTHCARE_mart"} */
show objects in HEALTHCARE.mart limit 10000;
[0m19:23:00.852892 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.323 seconds
[0m19:23:00.868720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '720e5c65-1b3e-4460-b802-30e19b8a0503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F68DAF3920>]}
[0m19:23:00.868720 [debug] [Thread-1 (]: Began running node model.dbt_first.retention_revenue
[0m19:23:00.868720 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.retention_revenue ............................ [RUN]
[0m19:23:00.868720 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_first.retention_revenue'
[0m19:23:00.868720 [debug] [Thread-1 (]: Began compiling node model.dbt_first.retention_revenue
[0m19:23:00.868720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_first.retention_revenue"
[0m19:23:00.868720 [debug] [Thread-1 (]: Began executing node model.dbt_first.retention_revenue
[0m19:23:00.916742 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_first.retention_revenue"
[0m19:23:00.918742 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_first.retention_revenue"
[0m19:23:00.918742 [debug] [Thread-1 (]: On model.dbt_first.retention_revenue: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "dbt_first", "target_name": "dev", "node_id": "model.dbt_first.retention_revenue"} */
create or replace transient table HEALTHCARE.mart.retention_revenue
         as
        (

WITH cte_monthly_revenue AS (
    SELECT 
        payment_date, 
        SUM(REVENUE) AS total_revenue,
        SUM(CASE WHEN REVENUE > 0 THEN REVENUE ELSE 0 END) AS retained_revenue,
        SUM(CASE WHEN REVENUE < 0 THEN REVENUE ELSE 0 END) AS churned_revenue
    FROM HEALTHCARE.stage.stg_transactions
    GROUP BY payment_date
)

SELECT 
    payment_date,
    retained_revenue / total_revenue AS GRR,
    (retained_revenue + churned_revenue) / total_revenue AS NRR
FROM cte_monthly_revenue
        );
[0m19:23:00.919743 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:23:03.305371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.389 seconds
[0m19:23:03.321023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '720e5c65-1b3e-4460-b802-30e19b8a0503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F68DA5DA00>]}
[0m19:23:03.321023 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.retention_revenue ....................... [[32mSUCCESS 1[0m in 2.45s]
[0m19:23:03.321023 [debug] [Thread-1 (]: Finished running node model.dbt_first.retention_revenue
[0m19:23:03.321023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:03.321023 [debug] [MainThread]: Connection 'list_HEALTHCARE' was left open.
[0m19:23:03.321023 [debug] [MainThread]: On list_HEALTHCARE: Close
[0m19:23:03.847356 [debug] [MainThread]: Connection 'list_HEALTHCARE_mart' was left open.
[0m19:23:03.847356 [debug] [MainThread]: On list_HEALTHCARE_mart: Close
[0m19:23:04.371190 [debug] [MainThread]: Connection 'model.dbt_first.retention_revenue' was left open.
[0m19:23:04.371190 [debug] [MainThread]: On model.dbt_first.retention_revenue: Close
[0m19:23:04.908012 [info ] [MainThread]: 
[0m19:23:04.914009 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.57 seconds (8.57s).
[0m19:23:04.914009 [debug] [MainThread]: Command end result
[0m19:23:04.936565 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\VarshaS\dbt_first\target\manifest.json
[0m19:23:04.936565 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\VarshaS\dbt_first\target\semantic_manifest.json
[0m19:23:04.949971 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\VarshaS\dbt_first\target\run_results.json
[0m19:23:04.949971 [info ] [MainThread]: 
[0m19:23:04.949971 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:04.949971 [info ] [MainThread]: 
[0m19:23:04.949971 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:23:04.949971 [debug] [MainThread]: Command `dbt run` succeeded at 19:23:04.949971 after 10.25 seconds
[0m19:23:04.949971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F692D78140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F68FC8BAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6913A7860>]}
[0m19:23:04.949971 [debug] [MainThread]: Flushing usage events
[0m19:23:06.314064 [debug] [MainThread]: An error was encountered while trying to flush usage events
